var injectscript=function(){"use strict";var Q$=Object.defineProperty;var Z$=(ks,yn,ca)=>yn in ks?Q$(ks,yn,{enumerable:!0,configurable:!0,writable:!0,value:ca}):ks[yn]=ca;var re=(ks,yn,ca)=>Z$(ks,typeof yn!="symbol"?yn+"":yn,ca);function ks(i){return i==null||typeof i=="function"?{main:i}:i}const yn=[EvalError,RangeError,ReferenceError,SyntaxError,TypeError,URIError,globalThis.DOMException,globalThis.AssertionError,globalThis.SystemError].filter(Boolean).map(i=>[i.name,i]),ca=new Map(yn);class Eh extends Error{constructor(t){super(Eh._prepareSuperMessage(t));re(this,"name","NonError")}static _prepareSuperMessage(t){try{return JSON.stringify(t)}catch{return String(t)}}}const $T=[{property:"name",enumerable:!1},{property:"message",enumerable:!1},{property:"stack",enumerable:!1},{property:"code",enumerable:!0},{property:"cause",enumerable:!1}],bh=new WeakSet,GT=i=>{bh.add(i);const e=i.toJSON();return bh.delete(i),e},Jm=i=>ca.get(i)??Error,Ah=({from:i,seen:e,to:t,forceEnumerable:r,maxDepth:n,depth:s,useToJSON:a,serialize:o})=>{if(!t)if(Array.isArray(i))t=[];else if(!o&&Qm(i)){const u=Jm(i.name);t=new u}else t={};if(e.push(i),s>=n)return t;if(a&&typeof i.toJSON=="function"&&!bh.has(i))return GT(i);const l=u=>Ah({from:u,seen:[...e],forceEnumerable:r,maxDepth:n,depth:s,useToJSON:a,serialize:o});for(const[u,h]of Object.entries(i)){if(h&&h instanceof Uint8Array&&h.constructor.name==="Buffer"){t[u]="[object Buffer]";continue}if(h!==null&&typeof h=="object"&&typeof h.pipe=="function"){t[u]="[object Stream]";continue}if(typeof h!="function"){if(!h||typeof h!="object"){try{t[u]=h}catch{}continue}if(!e.includes(i[u])){s++,t[u]=l(i[u]);continue}t[u]="[Circular]"}}for(const{property:u,enumerable:h}of $T)typeof i[u]<"u"&&i[u]!==null&&Object.defineProperty(t,u,{value:Qm(i[u])?l(i[u]):i[u],enumerable:r?!0:h,configurable:!0,writable:!0});return t};function qT(i,e={}){const{maxDepth:t=Number.POSITIVE_INFINITY,useToJSON:r=!0}=e;return typeof i=="object"&&i!==null?Ah({from:i,seen:[],forceEnumerable:!0,maxDepth:t,depth:0,useToJSON:r,serialize:!0}):typeof i=="function"?`[Function: ${i.name||"anonymous"}]`:i}function VT(i,e={}){const{maxDepth:t=Number.POSITIVE_INFINITY}=e;if(i instanceof Error)return i;if(HT(i)){const r=Jm(i.name);return Ah({from:i,seen:[],to:new r,maxDepth:t,depth:0,serialize:!1})}return new Eh(i)}function Qm(i){return!!i&&typeof i=="object"&&"name"in i&&"message"in i&&"stack"in i}function HT(i){return!!i&&typeof i=="object"&&"message"in i&&!Array.isArray(i)}var KT=Object.defineProperty,WT=Object.defineProperties,YT=Object.getOwnPropertyDescriptors,Gl=Object.getOwnPropertySymbols,Zm=Object.prototype.hasOwnProperty,e0=Object.prototype.propertyIsEnumerable,t0=(i,e,t)=>e in i?KT(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,Sh=(i,e)=>{for(var t in e||(e={}))Zm.call(e,t)&&t0(i,t,e[t]);if(Gl)for(var t of Gl(e))e0.call(e,t)&&t0(i,t,e[t]);return i},xh=(i,e)=>WT(i,YT(e)),XT=(i,e)=>{var t={};for(var r in i)Zm.call(i,r)&&e.indexOf(r)<0&&(t[r]=i[r]);if(i!=null&&Gl)for(var r of Gl(i))e.indexOf(r)<0&&e0.call(i,r)&&(t[r]=i[r]);return t},r0=(i,e,t)=>new Promise((r,n)=>{var s=l=>{try{o(t.next(l))}catch(u){n(u)}},a=l=>{try{o(t.throw(l))}catch(u){n(u)}},o=l=>l.done?r(l.value):Promise.resolve(l.value).then(s,a);o((t=t.apply(i,e)).next())});function jT(i){let e,t={};function r(){Object.entries(t).length===0&&(e==null||e(),e=void 0)}let n=Math.floor(Math.random()*1e4);function s(){return n++}return{sendMessage(a,o,...l){return r0(this,null,function*(){var u,h,d,p;const g={id:s(),type:a,data:o,timestamp:Date.now()},m=(h=yield(u=i.verifyMessageData)==null?void 0:u.call(i,g))!=null?h:g;(d=i.logger)==null||d.debug(`[messaging] sendMessage {id=${m.id}} ─ᐅ`,m,...l);const v=yield i.sendMessage(m,...l),{res:E,err:A}=v??{err:new Error("No response")};if((p=i.logger)==null||p.debug(`[messaging] sendMessage {id=${m.id}} ᐊ─`,{res:E,err:A}),A!=null)throw VT(A);return E})},onMessage(a,o){var l,u,h;if(e==null&&((l=i.logger)==null||l.debug(`[messaging] "${a}" initialized the message listener for this context`),e=i.addRootListener(d=>{var p,g;if(typeof d.type!="string"||typeof d.timestamp!="number"){if(i.breakError)return;const E=Error(`[messaging] Unknown message format, must include the 'type' & 'timestamp' fields, received: ${JSON.stringify(d)}`);throw(p=i.logger)==null||p.error(E),E}(g=i==null?void 0:i.logger)==null||g.debug("[messaging] Received message",d);const m=t[d.type];if(m==null)return;const v=m(d);return Promise.resolve(v).then(E=>{var A,D;return(D=(A=i.verifyMessageData)==null?void 0:A.call(i,E))!=null?D:E}).then(E=>{var A;return(A=i==null?void 0:i.logger)==null||A.debug(`[messaging] onMessage {id=${d.id}} ─ᐅ`,{res:E}),{res:E}}).catch(E=>{var A;return(A=i==null?void 0:i.logger)==null||A.debug(`[messaging] onMessage {id=${d.id}} ─ᐅ`,{err:E}),{err:qT(E)}})})),t[a]!=null){const d=Error(`[messaging] In this JS context, only one listener can be setup for ${a}`);throw(u=i.logger)==null||u.error(d),d}return t[a]=o,(h=i.logger)==null||h.log(`[messaging] Added listener for ${a}`),()=>{delete t[a],r()}},removeAllListeners(){Object.keys(t).forEach(a=>{delete t[a]}),r()}}}for(var Os=256,i0=[],n0=256,ql;Os--;)i0[Os]=(Os+256).toString(16).substring(1);function zT(i){var e=0,t=11;if(!ql||Os+t>n0*2)for(ql="",Os=0;e<n0;e++)ql+=i0[Math.random()*256|0];return ql.substring(Os,Os+++t)}function s0(i,e={targetScope:window??void 0}){return typeof cloneInto<"u"?cloneInto(i,e.targetScope):i}var Th="@webext-core/messaging/custom-events",Dh="@webext-core/messaging/custom-events/response";function JT(i){const e=i.namespace,t=zT(),r=[],n=a=>new Promise(o=>{const l=u=>{const{detail:h}=u;h.namespace===e&&h.instanceId!==t&&h.message.type===a.detail.message.type&&o(h.response)};r.push(()=>window.removeEventListener(Dh,l)),window.addEventListener(Dh,l),window.dispatchEvent(a)}),s=jT(xh(Sh({},i),{sendMessage(a){const o={message:a,namespace:e,instanceId:t},l=new CustomEvent(Th,{detail:s0(o)});return n(l)},addRootListener(a){const o=l=>r0(this,null,function*(){const u=l,{detail:h}=u,d=XT(u,["detail"]);if(h.namespace!==e||h.instanceId===t)return;const p=xh(Sh({},h.message),{event:d}),m={response:yield a(p),message:p,instanceId:t,namespace:e},v=new CustomEvent(Dh,{detail:s0(m)});window.dispatchEvent(v)});return window.addEventListener(Th,o),()=>window.removeEventListener(Th,o)},verifyMessageData(a){return structuredClone(a)}}));return xh(Sh({},s),{removeAllListeners(){s.removeAllListeners(),r.forEach(a=>a())}})}const QT="test";window.pageContentRpc||(window.pageContentRpc=JT({namespace:"kocjgbieikboloadkgcijaceaadcegnl"}));const vn=Symbol.for("@ts-pattern/matcher"),ZT=Symbol.for("@ts-pattern/isVariadic"),Vl="@ts-pattern/anonymous-select-key",Rh=i=>!!(i&&typeof i=="object"),Hl=i=>i&&!!i[vn],Bi=(i,e,t)=>{if(Hl(i)){const r=i[vn](),{matched:n,selections:s}=r.match(e);return n&&s&&Object.keys(s).forEach(a=>t(a,s[a])),n}if(Rh(i)){if(!Rh(e))return!1;if(Array.isArray(i)){if(!Array.isArray(e))return!1;let r=[],n=[],s=[];for(const a of i.keys()){const o=i[a];Hl(o)&&o[ZT]?s.push(o):s.length?n.push(o):r.push(o)}if(s.length){if(s.length>1)throw new Error("Pattern error: Using `...P.array(...)` several times in a single pattern is not allowed.");if(e.length<r.length+n.length)return!1;const a=e.slice(0,r.length),o=n.length===0?[]:e.slice(-n.length),l=e.slice(r.length,n.length===0?1/0:-n.length);return r.every((u,h)=>Bi(u,a[h],t))&&n.every((u,h)=>Bi(u,o[h],t))&&(s.length===0||Bi(s[0],l,t))}return i.length===e.length&&i.every((a,o)=>Bi(a,e[o],t))}return Reflect.ownKeys(i).every(r=>{const n=i[r];return(r in e||Hl(s=n)&&s[vn]().matcherType==="optional")&&Bi(n,e[r],t);var s})}return Object.is(e,i)},Xn=i=>{var e,t,r;return Rh(i)?Hl(i)?(e=(t=(r=i[vn]()).getSelectionKeys)==null?void 0:t.call(r))!=null?e:[]:Array.isArray(i)?Ro(i,Xn):Ro(Object.values(i),Xn):[]},Ro=(i,e)=>i.reduce((t,r)=>t.concat(e(r)),[]);function fi(i){return Object.assign(i,{optional:()=>eD(i),and:e=>Bt(i,e),or:e=>tD(i,e),select:e=>e===void 0?a0(i):a0(e,i)})}function eD(i){return fi({[vn]:()=>({match:e=>{let t={};const r=(n,s)=>{t[n]=s};return e===void 0?(Xn(i).forEach(n=>r(n,void 0)),{matched:!0,selections:t}):{matched:Bi(i,e,r),selections:t}},getSelectionKeys:()=>Xn(i),matcherType:"optional"})})}function Bt(...i){return fi({[vn]:()=>({match:e=>{let t={};const r=(n,s)=>{t[n]=s};return{matched:i.every(n=>Bi(n,e,r)),selections:t}},getSelectionKeys:()=>Ro(i,Xn),matcherType:"and"})})}function tD(...i){return fi({[vn]:()=>({match:e=>{let t={};const r=(n,s)=>{t[n]=s};return Ro(i,Xn).forEach(n=>r(n,void 0)),{matched:i.some(n=>Bi(n,e,r)),selections:t}},getSelectionKeys:()=>Ro(i,Xn),matcherType:"or"})})}function yt(i){return{[vn]:()=>({match:e=>({matched:!!i(e)})})}}function a0(...i){const e=typeof i[0]=="string"?i[0]:void 0,t=i.length===2?i[1]:typeof i[0]=="string"?void 0:i[0];return fi({[vn]:()=>({match:r=>{let n={[e??Vl]:r};return{matched:t===void 0||Bi(t,r,(s,a)=>{n[s]=a}),selections:n}},getSelectionKeys:()=>[e??Vl].concat(t===void 0?[]:Xn(t))})})}function Ui(i){return typeof i=="number"}function jn(i){return typeof i=="string"}function zn(i){return typeof i=="bigint"}fi(yt(function(i){return!0}));const Jn=i=>Object.assign(fi(i),{startsWith:e=>{return Jn(Bt(i,(t=e,yt(r=>jn(r)&&r.startsWith(t)))));var t},endsWith:e=>{return Jn(Bt(i,(t=e,yt(r=>jn(r)&&r.endsWith(t)))));var t},minLength:e=>Jn(Bt(i,(t=>yt(r=>jn(r)&&r.length>=t))(e))),length:e=>Jn(Bt(i,(t=>yt(r=>jn(r)&&r.length===t))(e))),maxLength:e=>Jn(Bt(i,(t=>yt(r=>jn(r)&&r.length<=t))(e))),includes:e=>{return Jn(Bt(i,(t=e,yt(r=>jn(r)&&r.includes(t)))));var t},regex:e=>{return Jn(Bt(i,(t=e,yt(r=>jn(r)&&!!r.match(t)))));var t}});Jn(yt(jn));const $i=i=>Object.assign(fi(i),{between:(e,t)=>$i(Bt(i,((r,n)=>yt(s=>Ui(s)&&r<=s&&n>=s))(e,t))),lt:e=>$i(Bt(i,(t=>yt(r=>Ui(r)&&r<t))(e))),gt:e=>$i(Bt(i,(t=>yt(r=>Ui(r)&&r>t))(e))),lte:e=>$i(Bt(i,(t=>yt(r=>Ui(r)&&r<=t))(e))),gte:e=>$i(Bt(i,(t=>yt(r=>Ui(r)&&r>=t))(e))),int:()=>$i(Bt(i,yt(e=>Ui(e)&&Number.isInteger(e)))),finite:()=>$i(Bt(i,yt(e=>Ui(e)&&Number.isFinite(e)))),positive:()=>$i(Bt(i,yt(e=>Ui(e)&&e>0))),negative:()=>$i(Bt(i,yt(e=>Ui(e)&&e<0)))});$i(yt(Ui));const Qn=i=>Object.assign(fi(i),{between:(e,t)=>Qn(Bt(i,((r,n)=>yt(s=>zn(s)&&r<=s&&n>=s))(e,t))),lt:e=>Qn(Bt(i,(t=>yt(r=>zn(r)&&r<t))(e))),gt:e=>Qn(Bt(i,(t=>yt(r=>zn(r)&&r>t))(e))),lte:e=>Qn(Bt(i,(t=>yt(r=>zn(r)&&r<=t))(e))),gte:e=>Qn(Bt(i,(t=>yt(r=>zn(r)&&r>=t))(e))),positive:()=>Qn(Bt(i,yt(e=>zn(e)&&e>0))),negative:()=>Qn(Bt(i,yt(e=>zn(e)&&e<0)))});Qn(yt(zn)),fi(yt(function(i){return typeof i=="boolean"})),fi(yt(function(i){return typeof i=="symbol"})),fi(yt(function(i){return i==null})),fi(yt(function(i){return i!=null}));let rD=class extends Error{constructor(e){let t;try{t=JSON.stringify(e)}catch{t=e}super(`Pattern matching error: no pattern matches value ${t}`),this.input=void 0,this.input=e}};const Ih={matched:!1,value:void 0};function Io(i){return new iD(i,Ih)}let iD=class jm{constructor(e,t){this.input=void 0,this.state=void 0,this.input=e,this.state=t}with(...e){if(this.state.matched)return this;const t=e[e.length-1],r=[e[0]];let n;e.length===3&&typeof e[1]=="function"?n=e[1]:e.length>2&&r.push(...e.slice(1,e.length-1));let s=!1,a={};const o=(u,h)=>{s=!0,a[u]=h},l=!r.some(u=>Bi(u,this.input,o))||n&&!n(this.input)?Ih:{matched:!0,value:t(s?Vl in a?a[Vl]:a:this.input,this.input)};return new jm(this.input,l)}when(e,t){if(this.state.matched)return this;const r=!!e(this.input);return new jm(this.input,r?{matched:!0,value:t(this.input,this.input)}:Ih)}otherwise(e){return this.state.matched?this.state.value:e(this.input)}exhaustive(e=nD){return this.state.matched?this.state.value:e(this.input)}run(){return this.exhaustive()}returnType(){return this}};function nD(i){throw new rD(i)}var Nh=function(i,e){return Nh=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])},Nh(i,e)};function Gi(i,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");Nh(i,e);function t(){this.constructor=i}i.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}function sD(i,e,t,r){function n(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function o(h){try{u(r.next(h))}catch(d){a(d)}}function l(h){try{u(r.throw(h))}catch(d){a(d)}}function u(h){h.done?s(h.value):n(h.value).then(o,l)}u((r=r.apply(i,e||[])).next())})}function o0(i,e){var t={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},r,n,s,a=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return a.next=o(0),a.throw=o(1),a.return=o(2),typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function o(u){return function(h){return l([u,h])}}function l(u){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,u[0]&&(t=0)),t;)try{if(r=1,n&&(s=u[0]&2?n.return:u[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,u[1])).done)return s;switch(n=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return t.label++,{value:u[1],done:!1};case 5:t.label++,n=u[1],u=[0];continue;case 7:u=t.ops.pop(),t.trys.pop();continue;default:if(s=t.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){t=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){t.label=u[1];break}if(u[0]===6&&t.label<s[1]){t.label=s[1],s=u;break}if(s&&t.label<s[2]){t.label=s[2],t.ops.push(u);break}s[2]&&t.ops.pop(),t.trys.pop();continue}u=e.call(i,t)}catch(h){u=[6,h],n=0}finally{r=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}function ha(i){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&i[e],r=0;if(t)return t.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&r>=i.length&&(i=void 0),{value:i&&i[r++],done:!i}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function da(i,e){var t=typeof Symbol=="function"&&i[Symbol.iterator];if(!t)return i;var r=t.call(i),n,s=[],a;try{for(;(e===void 0||e-- >0)&&!(n=r.next()).done;)s.push(n.value)}catch(o){a={error:o}}finally{try{n&&!n.done&&(t=r.return)&&t.call(r)}finally{if(a)throw a.error}}return s}function No(i,e,t){if(t||arguments.length===2)for(var r=0,n=e.length,s;r<n;r++)(s||!(r in e))&&(s||(s=Array.prototype.slice.call(e,0,r)),s[r]=e[r]);return i.concat(s||Array.prototype.slice.call(e))}function fa(i){return this instanceof fa?(this.v=i,this):new fa(i)}function aD(i,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(i,e||[]),n,s=[];return n=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),o("next"),o("throw"),o("return",a),n[Symbol.asyncIterator]=function(){return this},n;function a(g){return function(m){return Promise.resolve(m).then(g,d)}}function o(g,m){r[g]&&(n[g]=function(v){return new Promise(function(E,A){s.push([g,v,E,A])>1||l(g,v)})},m&&(n[g]=m(n[g])))}function l(g,m){try{u(r[g](m))}catch(v){p(s[0][3],v)}}function u(g){g.value instanceof fa?Promise.resolve(g.value.v).then(h,d):p(s[0][2],g)}function h(g){l("next",g)}function d(g){l("throw",g)}function p(g,m){g(m),s.shift(),s.length&&l(s[0][0],s[0][1])}}function oD(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=i[Symbol.asyncIterator],t;return e?e.call(i):(i=typeof ha=="function"?ha(i):i[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(s){t[s]=i[s]&&function(a){return new Promise(function(o,l){a=i[s](a),n(o,l,a.done,a.value)})}}function n(s,a,o,l){Promise.resolve(l).then(function(u){s({value:u,done:o})},a)}}typeof SuppressedError=="function"&&SuppressedError;function St(i){return typeof i=="function"}function Kl(i){var e=function(r){Error.call(r),r.stack=new Error().stack},t=i(e);return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var Ch=Kl(function(i){return function(t){i(this),this.message=t?t.length+` errors occurred during unsubscription:
`+t.map(function(r,n){return n+1+") "+r.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=t}});function Wl(i,e){if(i){var t=i.indexOf(e);0<=t&&i.splice(t,1)}}var Co=function(){function i(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return i.prototype.unsubscribe=function(){var e,t,r,n,s;if(!this.closed){this.closed=!0;var a=this._parentage;if(a)if(this._parentage=null,Array.isArray(a))try{for(var o=ha(a),l=o.next();!l.done;l=o.next()){var u=l.value;u.remove(this)}}catch(v){e={error:v}}finally{try{l&&!l.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}else a.remove(this);var h=this.initialTeardown;if(St(h))try{h()}catch(v){s=v instanceof Ch?v.errors:[v]}var d=this._finalizers;if(d){this._finalizers=null;try{for(var p=ha(d),g=p.next();!g.done;g=p.next()){var m=g.value;try{c0(m)}catch(v){s=s??[],v instanceof Ch?s=No(No([],da(s)),da(v.errors)):s.push(v)}}}catch(v){r={error:v}}finally{try{g&&!g.done&&(n=p.return)&&n.call(p)}finally{if(r)throw r.error}}}if(s)throw new Ch(s)}},i.prototype.add=function(e){var t;if(e&&e!==this)if(this.closed)c0(e);else{if(e instanceof i){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}},i.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},i.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},i.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&Wl(t,e)},i.prototype.remove=function(e){var t=this._finalizers;t&&Wl(t,e),e instanceof i&&e._removeParent(this)},i.EMPTY=function(){var e=new i;return e.closed=!0,e}(),i}(),l0=Co.EMPTY;function u0(i){return i instanceof Co||i&&"closed"in i&&St(i.remove)&&St(i.add)&&St(i.unsubscribe)}function c0(i){St(i)?i():i.unsubscribe()}var lD={Promise:void 0},uD={setTimeout:function(i,e){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];return setTimeout.apply(void 0,No([i,e],da(t)))},clearTimeout:function(i){return clearTimeout(i)},delegate:void 0};function h0(i){uD.setTimeout(function(){throw i})}function d0(){}function Yl(i){i()}var wh=function(i){Gi(e,i);function e(t){var r=i.call(this)||this;return r.isStopped=!1,t?(r.destination=t,u0(t)&&t.add(r)):r.destination=dD,r}return e.create=function(t,r,n){return new Xl(t,r,n)},e.prototype.next=function(t){this.isStopped||this._next(t)},e.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,i.prototype.unsubscribe.call(this),this.destination=null)},e.prototype._next=function(t){this.destination.next(t)},e.prototype._error=function(t){try{this.destination.error(t)}finally{this.unsubscribe()}},e.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},e}(Co),cD=function(){function i(e){this.partialObserver=e}return i.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(r){jl(r)}},i.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(r){jl(r)}else jl(e)},i.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(t){jl(t)}},i}(),Xl=function(i){Gi(e,i);function e(t,r,n){var s=i.call(this)||this,a;return St(t)||!t?a={next:t??void 0,error:r??void 0,complete:n??void 0}:a=t,s.destination=new cD(a),s}return e}(wh);function jl(i){h0(i)}function hD(i){throw i}var dD={closed:!0,next:d0,error:hD,complete:d0},Lh=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function wo(i){return i}function fD(i){return i.length===0?wo:i.length===1?i[0]:function(t){return i.reduce(function(r,n){return n(r)},t)}}var xr=function(){function i(e){e&&(this._subscribe=e)}return i.prototype.lift=function(e){var t=new i;return t.source=this,t.operator=e,t},i.prototype.subscribe=function(e,t,r){var n=this,s=pD(e)?e:new Xl(e,t,r);return Yl(function(){var a=n,o=a.operator,l=a.source;s.add(o?o.call(s,l):l?n._subscribe(s):n._trySubscribe(s))}),s},i.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},i.prototype.forEach=function(e,t){var r=this;return t=f0(t),new t(function(n,s){var a=new Xl({next:function(o){try{e(o)}catch(l){s(l),a.unsubscribe()}},error:s,complete:n});r.subscribe(a)})},i.prototype._subscribe=function(e){var t;return(t=this.source)===null||t===void 0?void 0:t.subscribe(e)},i.prototype[Lh]=function(){return this},i.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return fD(e)(this)},i.prototype.toPromise=function(e){var t=this;return e=f0(e),new e(function(r,n){var s;t.subscribe(function(a){return s=a},function(a){return n(a)},function(){return r(s)})})},i.create=function(e){return new i(e)},i}();function f0(i){var e;return(e=i??lD.Promise)!==null&&e!==void 0?e:Promise}function gD(i){return i&&St(i.next)&&St(i.error)&&St(i.complete)}function pD(i){return i&&i instanceof wh||gD(i)&&u0(i)}function mD(i){return St(i==null?void 0:i.lift)}function Vr(i){return function(e){if(mD(e))return e.lift(function(t){try{return i(t,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function wr(i,e,t,r,n){return new yD(i,e,t,r,n)}var yD=function(i){Gi(e,i);function e(t,r,n,s,a,o){var l=i.call(this,t)||this;return l.onFinalize=a,l.shouldUnsubscribe=o,l._next=r?function(u){try{r(u)}catch(h){t.error(h)}}:i.prototype._next,l._error=s?function(u){try{s(u)}catch(h){t.error(h)}finally{this.unsubscribe()}}:i.prototype._error,l._complete=n?function(){try{n()}catch(u){t.error(u)}finally{this.unsubscribe()}}:i.prototype._complete,l}return e.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var r=this.closed;i.prototype.unsubscribe.call(this),!r&&((t=this.onFinalize)===null||t===void 0||t.call(this))}},e}(wh),vD=Kl(function(i){return function(){i(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),_h=function(i){Gi(e,i);function e(){var t=i.call(this)||this;return t.closed=!1,t.currentObservers=null,t.observers=[],t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return e.prototype.lift=function(t){var r=new g0(this,this);return r.operator=t,r},e.prototype._throwIfClosed=function(){if(this.closed)throw new vD},e.prototype.next=function(t){var r=this;Yl(function(){var n,s;if(r._throwIfClosed(),!r.isStopped){r.currentObservers||(r.currentObservers=Array.from(r.observers));try{for(var a=ha(r.currentObservers),o=a.next();!o.done;o=a.next()){var l=o.value;l.next(t)}}catch(u){n={error:u}}finally{try{o&&!o.done&&(s=a.return)&&s.call(a)}finally{if(n)throw n.error}}}})},e.prototype.error=function(t){var r=this;Yl(function(){if(r._throwIfClosed(),!r.isStopped){r.hasError=r.isStopped=!0,r.thrownError=t;for(var n=r.observers;n.length;)n.shift().error(t)}})},e.prototype.complete=function(){var t=this;Yl(function(){if(t._throwIfClosed(),!t.isStopped){t.isStopped=!0;for(var r=t.observers;r.length;)r.shift().complete()}})},e.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(e.prototype,"observed",{get:function(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0},enumerable:!1,configurable:!0}),e.prototype._trySubscribe=function(t){return this._throwIfClosed(),i.prototype._trySubscribe.call(this,t)},e.prototype._subscribe=function(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)},e.prototype._innerSubscribe=function(t){var r=this,n=this,s=n.hasError,a=n.isStopped,o=n.observers;return s||a?l0:(this.currentObservers=null,o.push(t),new Co(function(){r.currentObservers=null,Wl(o,t)}))},e.prototype._checkFinalizedStatuses=function(t){var r=this,n=r.hasError,s=r.thrownError,a=r.isStopped;n?t.error(s):a&&t.complete()},e.prototype.asObservable=function(){var t=new xr;return t.source=this,t},e.create=function(t,r){return new g0(t,r)},e}(xr),g0=function(i){Gi(e,i);function e(t,r){var n=i.call(this)||this;return n.destination=t,n.source=r,n}return e.prototype.next=function(t){var r,n;(n=(r=this.destination)===null||r===void 0?void 0:r.next)===null||n===void 0||n.call(r,t)},e.prototype.error=function(t){var r,n;(n=(r=this.destination)===null||r===void 0?void 0:r.error)===null||n===void 0||n.call(r,t)},e.prototype.complete=function(){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.complete)===null||r===void 0||r.call(t)},e.prototype._subscribe=function(t){var r,n;return(n=(r=this.source)===null||r===void 0?void 0:r.subscribe(t))!==null&&n!==void 0?n:l0},e}(_h),ED=function(i){Gi(e,i);function e(t){var r=i.call(this)||this;return r._value=t,r}return Object.defineProperty(e.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),e.prototype._subscribe=function(t){var r=i.prototype._subscribe.call(this,t);return!r.closed&&t.next(this._value),r},e.prototype.getValue=function(){var t=this,r=t.hasError,n=t.thrownError,s=t._value;if(r)throw n;return this._throwIfClosed(),s},e.prototype.next=function(t){i.prototype.next.call(this,this._value=t)},e}(_h),Mh={now:function(){return(Mh.delegate||Date).now()},delegate:void 0},bD=function(i){Gi(e,i);function e(t,r,n){t===void 0&&(t=1/0),r===void 0&&(r=1/0),n===void 0&&(n=Mh);var s=i.call(this)||this;return s._bufferSize=t,s._windowTime=r,s._timestampProvider=n,s._buffer=[],s._infiniteTimeWindow=!0,s._infiniteTimeWindow=r===1/0,s._bufferSize=Math.max(1,t),s._windowTime=Math.max(1,r),s}return e.prototype.next=function(t){var r=this,n=r.isStopped,s=r._buffer,a=r._infiniteTimeWindow,o=r._timestampProvider,l=r._windowTime;n||(s.push(t),!a&&s.push(o.now()+l)),this._trimBuffer(),i.prototype.next.call(this,t)},e.prototype._subscribe=function(t){this._throwIfClosed(),this._trimBuffer();for(var r=this._innerSubscribe(t),n=this,s=n._infiniteTimeWindow,a=n._buffer,o=a.slice(),l=0;l<o.length&&!t.closed;l+=s?1:2)t.next(o[l]);return this._checkFinalizedStatuses(t),r},e.prototype._trimBuffer=function(){var t=this,r=t._bufferSize,n=t._timestampProvider,s=t._buffer,a=t._infiniteTimeWindow,o=(a?1:2)*r;if(r<1/0&&o<s.length&&s.splice(0,s.length-o),!a){for(var l=n.now(),u=0,h=1;h<s.length&&s[h]<=l;h+=2)u=h;u&&s.splice(0,u+1)}},e}(_h),AD=function(i){Gi(e,i);function e(t,r){return i.call(this)||this}return e.prototype.schedule=function(t,r){return this},e}(Co),p0={setInterval:function(i,e){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];return setInterval.apply(void 0,No([i,e],da(t)))},clearInterval:function(i){return clearInterval(i)},delegate:void 0},SD=function(i){Gi(e,i);function e(t,r){var n=i.call(this,t,r)||this;return n.scheduler=t,n.work=r,n.pending=!1,n}return e.prototype.schedule=function(t,r){var n;if(r===void 0&&(r=0),this.closed)return this;this.state=t;var s=this.id,a=this.scheduler;return s!=null&&(this.id=this.recycleAsyncId(a,s,r)),this.pending=!0,this.delay=r,this.id=(n=this.id)!==null&&n!==void 0?n:this.requestAsyncId(a,this.id,r),this},e.prototype.requestAsyncId=function(t,r,n){return n===void 0&&(n=0),p0.setInterval(t.flush.bind(t,this),n)},e.prototype.recycleAsyncId=function(t,r,n){if(n===void 0&&(n=0),n!=null&&this.delay===n&&this.pending===!1)return r;r!=null&&p0.clearInterval(r)},e.prototype.execute=function(t,r){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var n=this._execute(t,r);if(n)return n;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},e.prototype._execute=function(t,r){var n=!1,s;try{this.work(t)}catch(a){n=!0,s=a||new Error("Scheduled action threw falsy error")}if(n)return this.unsubscribe(),s},e.prototype.unsubscribe=function(){if(!this.closed){var t=this,r=t.id,n=t.scheduler,s=n.actions;this.work=this.state=this.scheduler=null,this.pending=!1,Wl(s,this),r!=null&&(this.id=this.recycleAsyncId(n,r,null)),this.delay=null,i.prototype.unsubscribe.call(this)}},e}(AD),m0=function(){function i(e,t){t===void 0&&(t=i.now),this.schedulerActionCtor=e,this.now=t}return i.prototype.schedule=function(e,t,r){return t===void 0&&(t=0),new this.schedulerActionCtor(this,e).schedule(r,t)},i.now=Mh.now,i}(),xD=function(i){Gi(e,i);function e(t,r){r===void 0&&(r=m0.now);var n=i.call(this,t,r)||this;return n.actions=[],n._active=!1,n}return e.prototype.flush=function(t){var r=this.actions;if(this._active){r.push(t);return}var n;this._active=!0;do if(n=t.execute(t.state,t.delay))break;while(t=r.shift());if(this._active=!1,n){for(;t=r.shift();)t.unsubscribe();throw n}},e}(m0),Ph=new xD(SD),TD=Ph,Lo=new xr(function(i){return i.complete()});function y0(i){return i&&St(i.schedule)}function DD(i){return i[i.length-1]}function v0(i){return y0(DD(i))?i.pop():void 0}var kh=function(i){return i&&typeof i.length=="number"&&typeof i!="function"};function E0(i){return St(i==null?void 0:i.then)}function b0(i){return St(i[Lh])}function A0(i){return Symbol.asyncIterator&&St(i==null?void 0:i[Symbol.asyncIterator])}function S0(i){return new TypeError("You provided "+(i!==null&&typeof i=="object"?"an invalid object":"'"+i+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function RD(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var x0=RD();function T0(i){return St(i==null?void 0:i[x0])}function D0(i){return aD(this,arguments,function(){var t,r,n,s;return o0(this,function(a){switch(a.label){case 0:t=i.getReader(),a.label=1;case 1:a.trys.push([1,,9,10]),a.label=2;case 2:return[4,fa(t.read())];case 3:return r=a.sent(),n=r.value,s=r.done,s?[4,fa(void 0)]:[3,5];case 4:return[2,a.sent()];case 5:return[4,fa(n)];case 6:return[4,a.sent()];case 7:return a.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}})})}function R0(i){return St(i==null?void 0:i.getReader)}function qi(i){if(i instanceof xr)return i;if(i!=null){if(b0(i))return ID(i);if(kh(i))return ND(i);if(E0(i))return CD(i);if(A0(i))return I0(i);if(T0(i))return wD(i);if(R0(i))return LD(i)}throw S0(i)}function ID(i){return new xr(function(e){var t=i[Lh]();if(St(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function ND(i){return new xr(function(e){for(var t=0;t<i.length&&!e.closed;t++)e.next(i[t]);e.complete()})}function CD(i){return new xr(function(e){i.then(function(t){e.closed||(e.next(t),e.complete())},function(t){return e.error(t)}).then(null,h0)})}function wD(i){return new xr(function(e){var t,r;try{for(var n=ha(i),s=n.next();!s.done;s=n.next()){var a=s.value;if(e.next(a),e.closed)return}}catch(o){t={error:o}}finally{try{s&&!s.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}e.complete()})}function I0(i){return new xr(function(e){_D(i,e).catch(function(t){return e.error(t)})})}function LD(i){return I0(D0(i))}function _D(i,e){var t,r,n,s;return sD(this,void 0,void 0,function(){var a,o;return o0(this,function(l){switch(l.label){case 0:l.trys.push([0,5,6,11]),t=oD(i),l.label=1;case 1:return[4,t.next()];case 2:if(r=l.sent(),!!r.done)return[3,4];if(a=r.value,e.next(a),e.closed)return[2];l.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return o=l.sent(),n={error:o},[3,11];case 6:return l.trys.push([6,,9,10]),r&&!r.done&&(s=t.return)?[4,s.call(t)]:[3,8];case 7:l.sent(),l.label=8;case 8:return[3,10];case 9:if(n)throw n.error;return[7];case 10:return[7];case 11:return e.complete(),[2]}})})}function Zn(i,e,t,r,n){r===void 0&&(r=0),n===void 0&&(n=!1);var s=e.schedule(function(){t(),n?i.add(this.schedule(null,r)):this.unsubscribe()},r);if(i.add(s),!n)return s}function N0(i,e){return e===void 0&&(e=0),Vr(function(t,r){t.subscribe(wr(r,function(n){return Zn(r,i,function(){return r.next(n)},e)},function(){return Zn(r,i,function(){return r.complete()},e)},function(n){return Zn(r,i,function(){return r.error(n)},e)}))})}function C0(i,e){return e===void 0&&(e=0),Vr(function(t,r){r.add(i.schedule(function(){return t.subscribe(r)},e))})}function MD(i,e){return qi(i).pipe(C0(e),N0(e))}function PD(i,e){return qi(i).pipe(C0(e),N0(e))}function kD(i,e){return new xr(function(t){var r=0;return e.schedule(function(){r===i.length?t.complete():(t.next(i[r++]),t.closed||this.schedule())})})}function OD(i,e){return new xr(function(t){var r;return Zn(t,e,function(){r=i[x0](),Zn(t,e,function(){var n,s,a;try{n=r.next(),s=n.value,a=n.done}catch(o){t.error(o);return}a?t.complete():t.next(s)},0,!0)}),function(){return St(r==null?void 0:r.return)&&r.return()}})}function w0(i,e){if(!i)throw new Error("Iterable cannot be null");return new xr(function(t){Zn(t,e,function(){var r=i[Symbol.asyncIterator]();Zn(t,e,function(){r.next().then(function(n){n.done?t.complete():t.next(n.value)})},0,!0)})})}function FD(i,e){return w0(D0(i),e)}function BD(i,e){if(i!=null){if(b0(i))return MD(i,e);if(kh(i))return kD(i,e);if(E0(i))return PD(i,e);if(A0(i))return w0(i,e);if(T0(i))return OD(i,e);if(R0(i))return FD(i,e)}throw S0(i)}function er(i,e){return e?BD(i,e):qi(i)}function or(){for(var i=[],e=0;e<arguments.length;e++)i[e]=arguments[e];var t=v0(i);return er(i,t)}function L0(i,e){var t=St(i)?i:function(){return i},r=function(n){return n.error(t())};return new xr(r)}var UD=Kl(function(i){return function(){i(this),this.name="EmptyError",this.message="no elements in sequence"}});function Oh(i,e){return new Promise(function(t,r){var n=new Xl({next:function(s){t(s),n.unsubscribe()},error:r,complete:function(){r(new UD)}});i.subscribe(n)})}function _0(i){return i instanceof Date&&!isNaN(i)}var M0=Kl(function(i){return function(t){t===void 0&&(t=null),i(this),this.message="Timeout has occurred",this.name="TimeoutError",this.info=t}});function P0(i,e){var t=_0(i)?{first:i}:typeof i=="number"?{each:i}:i,r=t.first,n=t.each,s=t.with,a=s===void 0?$D:s,o=t.scheduler,l=o===void 0?Ph:o,u=t.meta,h=u===void 0?null:u;if(r==null&&n==null)throw new TypeError("No timeout provided.");return Vr(function(d,p){var g,m,v=null,E=0,A=function(D){m=Zn(p,l,function(){try{g.unsubscribe(),qi(a({meta:h,lastValue:v,seen:E})).subscribe(p)}catch(R){p.error(R)}},D)};g=d.subscribe(wr(p,function(D){m==null||m.unsubscribe(),E++,p.next(v=D),n>0&&A(n)},void 0,void 0,function(){m!=null&&m.closed||m==null||m.unsubscribe(),v=null})),!E&&A(r!=null?typeof r=="number"?r:+r-l.now():n)})}function $D(i){throw new M0(i)}function lr(i,e){return Vr(function(t,r){var n=0;t.subscribe(wr(r,function(s){r.next(i.call(e,s,n++))}))})}var GD=Array.isArray;function qD(i,e){return GD(e)?i.apply(void 0,No([],da(e))):i(e)}function VD(i){return lr(function(e){return qD(i,e)})}function HD(i,e,t,r,n,s,a,o){var l=[],u=0,h=0,d=!1,p=function(){d&&!l.length&&!u&&e.complete()},g=function(v){return u<r?m(v):l.push(v)},m=function(v){u++;var E=!1;qi(t(v,h++)).subscribe(wr(e,function(A){e.next(A)},function(){E=!0},void 0,function(){if(E)try{u--;for(var A=function(){var D=l.shift();a||m(D)};l.length&&u<r;)A();p()}catch(D){e.error(D)}}))};return i.subscribe(wr(e,g,function(){d=!0,p()})),function(){}}function Fh(i,e,t){return t===void 0&&(t=1/0),St(e)?Fh(function(r,n){return lr(function(s,a){return e(r,s,n,a)})(qi(i(r,n)))},t):(typeof e=="number"&&(t=e),Vr(function(r,n){return HD(r,n,i,t)}))}function KD(i){return Fh(wo,i)}function WD(){return KD(1)}function YD(){for(var i=[],e=0;e<arguments.length;e++)i[e]=arguments[e];return WD()(er(i,v0(i)))}var XD=["addListener","removeListener"],jD=["addEventListener","removeEventListener"],zD=["on","off"];function Bh(i,e,t,r){if(St(t)&&(r=t,t=void 0),r)return Bh(i,e,t).pipe(VD(r));var n=da(ZD(i)?jD.map(function(o){return function(l){return i[o](e,l,t)}}):JD(i)?XD.map(k0(i,e)):QD(i)?zD.map(k0(i,e)):[],2),s=n[0],a=n[1];if(!s&&kh(i))return Fh(function(o){return Bh(o,e,t)})(qi(i));if(!s)throw new TypeError("Invalid event target");return new xr(function(o){var l=function(){for(var u=[],h=0;h<arguments.length;h++)u[h]=arguments[h];return o.next(1<u.length?u:u[0])};return s(l),function(){return a(l)}})}function k0(i,e){return function(t){return function(r){return i[t](e,r)}}}function JD(i){return St(i.addListener)&&St(i.removeListener)}function QD(i){return St(i.on)&&St(i.off)}function ZD(i){return St(i.addEventListener)&&St(i.removeEventListener)}function eR(i,e,t){return new xr(function(r){var n=function(){for(var a=[],o=0;o<arguments.length;o++)a[o]=arguments[o];return r.next(a.length===1?a[0]:a)},s=i(n);return St(e)?function(){return e(n,s)}:void 0})}function Uh(i,e,t){i===void 0&&(i=0),t===void 0&&(t=TD);var r=-1;return e!=null&&(y0(e)?t=e:r=e),new xr(function(n){var s=_0(i)?+i-t.now():i;s<0&&(s=0);var a=0;return t.schedule(function(){n.closed||(n.next(a++),0<=r?this.schedule(void 0,r):n.complete())},s)})}function es(i,e){return i===void 0&&(i=0),e===void 0&&(e=Ph),i<0&&(i=0),Uh(i,i,e)}function Tr(i,e){return Vr(function(t,r){var n=0;t.subscribe(wr(r,function(s){return i.call(e,s,n++)&&r.next(s)}))})}function zl(i){return Vr(function(e,t){var r=null,n=!1,s;r=e.subscribe(wr(t,void 0,void 0,function(a){s=qi(i(a,zl(i)(e))),r?(r.unsubscribe(),r=null,s.subscribe(t)):n=!0})),n&&(r.unsubscribe(),r=null,s.subscribe(t))})}function tR(i){return Vr(function(e,t){var r=!1;e.subscribe(wr(t,function(n){r=!0,t.next(n)},function(){r||t.next(i),t.complete()}))})}function ts(i){return i<=0?function(){return Lo}:Vr(function(e,t){var r=0;e.subscribe(wr(t,function(n){++r<=i&&(t.next(n),i<=r&&t.complete())}))})}function rR(i,e){return e===void 0&&(e=wo),i=i??iR,Vr(function(t,r){var n,s=!0;t.subscribe(wr(r,function(a){var o=e(a);(s||!i(n,o))&&(s=!1,n=o,r.next(a))}))})}function iR(i,e){return i===e}function nR(i){return Vr(function(e,t){try{e.subscribe(t)}finally{t.add(i)}})}function sR(i){i===void 0&&(i=1/0);var e;i&&typeof i=="object"?e=i:e={count:i};var t=e.count,r=t===void 0?1/0:t,n=e.delay,s=e.resetOnSuccess,a=s===void 0?!1:s;return r<=0?wo:Vr(function(o,l){var u=0,h,d=function(){var p=!1;h=o.subscribe(wr(l,function(g){a&&(u=0),l.next(g)},void 0,function(g){if(u++<r){var m=function(){h?(h.unsubscribe(),h=null,d()):p=!0};if(n!=null){var v=typeof n=="number"?Uh(n):qi(n(g,u)),E=wr(l,function(){E.unsubscribe(),m()},function(){l.complete()});v.subscribe(E)}else m()}else l.error(g)})),p&&(h.unsubscribe(),h=null,d())};d()})}function Mt(i,e){return Vr(function(t,r){var n=null,s=0,a=!1,o=function(){return a&&!n&&r.complete()};t.subscribe(wr(r,function(l){n==null||n.unsubscribe();var u=0,h=s++;qi(i(l,h)).subscribe(n=wr(r,function(d){return r.next(e?e(l,d,h,u++):d)},function(){n=null,o()}))},function(){a=!0,o()}))})}function Jl(i,e,t){var r=St(i)||e||t?{next:i,error:e,complete:t}:i;return r?Vr(function(n,s){var a;(a=r.subscribe)===null||a===void 0||a.call(r);var o=!0;n.subscribe(wr(s,function(l){var u;(u=r.next)===null||u===void 0||u.call(r,l),s.next(l)},function(){var l;o=!1,(l=r.complete)===null||l===void 0||l.call(r),s.complete()},function(l){var u;o=!1,(u=r.error)===null||u===void 0||u.call(r,l),s.error(l)},function(){var l,u;o&&((l=r.unsubscribe)===null||l===void 0||l.call(r)),(u=r.finalize)===null||u===void 0||u.call(r)}))}):wo}class ur{constructor(e,t,r){re(this,"matchResult");re(this,"parsedQs");re(this,"map",new Map);this.media=e,this.tabTitle=t,this.data=r}computeUrlMatchResultIfAbsent(e){return this.matchResult??(this.matchResult=e())}computeParsedQsIfAbsent(e){return this.parsedQs??(this.parsedQs=e())}setParam(e,t){this.map.set(e,t)}getParam(e){return this.map.get(e)}}class Yt extends Error{}class rs extends Error{}var Fs=function(i,e,t,r){function n(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function o(h){try{u(r.next(h))}catch(d){a(d)}}function l(h){try{u(r.throw(h))}catch(d){a(d)}}function u(h){h.done?s(h.value):n(h.value).then(o,l)}u((r=r.apply(i,e||[])).next())})},Vi=function(i){return this instanceof Vi?(this.v=i,this):new Vi(i)},O0=function(i,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(i,e||[]),n,s=[];return n=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),o("next"),o("throw"),o("return",a),n[Symbol.asyncIterator]=function(){return this},n;function a(g){return function(m){return Promise.resolve(m).then(g,d)}}function o(g,m){r[g]&&(n[g]=function(v){return new Promise(function(E,A){s.push([g,v,E,A])>1||l(g,v)})},m&&(n[g]=m(n[g])))}function l(g,m){try{u(r[g](m))}catch(v){p(s[0][3],v)}}function u(g){g.value instanceof Vi?Promise.resolve(g.value.v).then(h,d):p(s[0][2],g)}function h(g){l("next",g)}function d(g){l("throw",g)}function p(g,m){g(m),s.shift(),s.length&&l(s[0][0],s[0][1])}},cr;(function(i){i[i.SHORTEST=0]="SHORTEST",i[i.LONGEST=1]="LONGEST",i[i.STRICT_EQUAL=2]="STRICT_EQUAL"})(cr||(cr={}));function*ga(i,e,...t){if(t.length===0)return;const r=[];for(const n of t)r.push(sy(n));e:for(;;){const n=ed.map(r,l=>l.next()),s=[];let a=!0,o=!1;for(const l of n){let u;l.done?(a=!1,u=e):(o=!0,u=l.value),s.push(u)}if(!a&&o)switch(i){case cr.SHORTEST:break e;case cr.STRICT_EQUAL:throw new rs("Iterators must have equal lengths")}if(!o)break;yield s}}function pa(i,e,...t){return O0(this,arguments,function*(){if(t.length===0)return yield Vi(void 0);const n=[];for(const s of t)n.push(ay(s));e:for(;;){const s=[];for(const u of n){const h=yield Vi(u.next());s.push(h)}const a=[];let o=!0,l=!1;for(const u of s){let h;u.done?(o=!1,h=e):(l=!0,h=u.value),a.push(h)}if(!o&&l)switch(i){case cr.SHORTEST:break e;case cr.STRICT_EQUAL:throw new rs("Iterators must have equal lengths")}if(!l)break;yield yield Vi(a)}})}class Ql{constructor(){this.addedMap=new Map,this.deletedMap=new Map}addUsage(e,t){this.addedMap.has(e)||this.addedMap.set(e,new Map);const r=this.addedMap.get(e);r.has(t)||r.set(t,0),r.set(t,r.get(t)+1)}deleteUsage(e){this.deletedMap.has(e)?this.deletedMap.set(e,this.deletedMap.get(e)+1):this.deletedMap.set(e,1)}getOwnersCount(e){var t,r;const n=(t=this.deletedMap.get(e))!==null&&t!==void 0?t:0;return Qr.of((r=this.addedMap.get(e))!==null&&r!==void 0?r:new Map).map(s=>s[1]).filter(s=>s>n).toValue(s=>s+1,0)}getUsagesCount(e,t=1){var r,n;const s=(r=this.deletedMap.get(e))!==null&&r!==void 0?r:0;let a=Qr.of((n=this.addedMap.get(e))!==null&&n!==void 0?n:new Map).map(o=>o[1]).map(o=>o-s).filter(o=>o>0).toArray();for(;a.length>t;){const o=Hy.toMin(a);a=Qr.of(a).map(l=>l-o).filter(l=>l>0).toArray()}return Hy.toSum(a)}}class Dr{}class aR{constructor(e,t){this.related=[],this.positions=[],this.cache=new Map,this.lastCacheIndex=0,this.isValid=!0,this.iterator=e;for(let r=0;r<t;++r)this.related.push(new oR(this,r)),this.positions.push(0);this.cacheNextValue()}current(e){const t=this.getPosition(e);return this.cache.get(t)}next(e){const[t,r,n]=[this.getPosition(e),Math.min(...this.positions),Math.max(...this.positions)];t===n&&this.cacheNextValue(),this.positions[e.getId()]++,r<Math.min(...this.positions)&&this.cache.delete(r)}valid(e){return this.getPosition(e)<this.lastCacheIndex||this.isValid}getRelatedIterables(){return this.related}cacheNextValue(){const e=this.iterator.next();e.done||this.cache.set(this.lastCacheIndex++,e.value),this.isValid=!e.done}getPosition(e){return this.positions[e.getId()]}}class oR{constructor(e,t){this.parent=e,this.id=t}getId(){return this.id}valid(){return this.parent.valid(this)}next(){const e={value:this.current(),done:!this.valid()};return e.done||this.parent.next(this),e}current(){return this.parent.valid(this)?this.parent.current(this):void 0}*[Symbol.iterator](){for(;this.parent.valid(this);)yield this.parent.current(this),this.parent.next(this)}}class lR{constructor(e,t){this.related=[],this.positions=[],this.cache=new Map,this.lastCacheIndex=0,this.isValid=!0,this.isFirstIteration=!0,this.iterator=e;for(let r=0;r<t;++r)this.related.push(new uR(this,r)),this.positions.push(0)}current(e){return Fs(this,void 0,void 0,function*(){this.isFirstIteration&&(yield this.cacheNextValue());const t=this.getPosition(e);return this.cache.get(t)})}next(e){return Fs(this,void 0,void 0,function*(){const[t,r,n]=[this.getPosition(e),Math.min(...this.positions),Math.max(...this.positions)];t===n&&(yield this.cacheNextValue()),this.positions[e.getId()]++,r<Math.min(...this.positions)&&this.cache.delete(r)})}valid(e){return Fs(this,void 0,void 0,function*(){return this.isFirstIteration&&(yield this.cacheNextValue()),this.getPosition(e)<this.lastCacheIndex||this.isValid})}getRelatedIterables(){return this.related}cacheNextValue(){return Fs(this,void 0,void 0,function*(){const e=yield this.iterator.next();e.done||this.cache.set(this.lastCacheIndex++,e.value),this.isFirstIteration=!1,this.isValid=!e.done})}getPosition(e){return this.positions[e.getId()]}}class uR{constructor(e,t){this.parent=e,this.id=t}getId(){return this.id}valid(){return Fs(this,void 0,void 0,function*(){return yield this.parent.valid(this)})}next(){return Fs(this,void 0,void 0,function*(){const e={value:yield this.current(),done:!(yield this.valid())};return e.done||(yield this.parent.next(this)),e})}current(){return Fs(this,void 0,void 0,function*(){return(yield this.parent.valid(this))?yield this.parent.current(this):void 0})}[Symbol.asyncIterator](){return O0(this,arguments,function*(){for(;yield Vi(this.parent.valid(this));)yield yield Vi(yield Vi(this.parent.current(this))),yield Vi(this.parent.next(this))})}}var _o=function(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=i[Symbol.asyncIterator],t;return e?e.call(i):(i=typeof __values=="function"?__values(i):i[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(s){t[s]=i[s]&&function(a){return new Promise(function(o,l){a=i[s](a),n(o,l,a.done,a.value)})}}function n(s,a,o,l){Promise.resolve(l).then(function(u){s({value:u,done:o})},a)}},hr=function(i){return this instanceof hr?(this.v=i,this):new hr(i)},Mo=function(i,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(i,e||[]),n,s=[];return n=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),o("next"),o("throw"),o("return",a),n[Symbol.asyncIterator]=function(){return this},n;function a(g){return function(m){return Promise.resolve(m).then(g,d)}}function o(g,m){r[g]&&(n[g]=function(v){return new Promise(function(E,A){s.push([g,v,E,A])>1||l(g,v)})},m&&(n[g]=m(n[g])))}function l(g,m){try{u(r[g](m))}catch(v){p(s[0][3],v)}}function u(g){g.value instanceof hr?Promise.resolve(g.value.v).then(h,d):p(s[0][2],g)}function h(g){l("next",g)}function d(g){l("throw",g)}function p(g,m){g(m),s.shift(),s.length&&l(s[0][0],s[0][1])}};function*F0(...i){for(const e of ga(cr.SHORTEST,void 0,...i))yield e}function B0(...i){return Mo(this,arguments,function*(){var t,r,n,s;try{for(var a=!0,o=_o(pa(cr.SHORTEST,void 0,...i)),l;l=yield hr(o.next()),t=l.done,!t;a=!0)s=l.value,a=!1,yield yield hr(s)}catch(u){r={error:u}}finally{try{!a&&!t&&(n=o.return)&&(yield hr(n.call(o)))}finally{if(r)throw r.error}}})}function*cR(i,...e){for(const t of ga(cr.LONGEST,i,...e))yield t}function hR(i,...e){return Mo(this,arguments,function*(){var r,n,s,a;try{for(var o=!0,l=_o(pa(cr.LONGEST,i,...e)),u;u=yield hr(l.next()),r=u.done,!r;o=!0)a=u.value,o=!1,yield yield hr(a)}catch(h){n={error:h}}finally{try{!o&&!r&&(s=l.return)&&(yield hr(s.call(l)))}finally{if(n)throw n.error}}})}function*dR(...i){for(const e of ga(cr.LONGEST,void 0,...i))yield e}function fR(...i){return Mo(this,arguments,function*(){var t,r,n,s;try{for(var a=!0,o=_o(pa(cr.LONGEST,void 0,...i)),l;l=yield hr(o.next()),t=l.done,!t;a=!0)s=l.value,a=!1,yield yield hr(s)}catch(u){r={error:u}}finally{try{!a&&!t&&(n=o.return)&&(yield hr(n.call(o)))}finally{if(r)throw r.error}}})}function*U0(...i){for(const e of ga(cr.STRICT_EQUAL,void 0,...i))yield e}function $0(...i){return Mo(this,arguments,function*(){var t,r,n,s;try{for(var a=!0,o=_o(pa(cr.STRICT_EQUAL,void 0,...i)),l;l=yield hr(o.next()),t=l.done,!t;a=!0)s=l.value,a=!1,yield yield hr(s)}catch(u){r={error:u}}finally{try{!a&&!t&&(n=o.return)&&(yield hr(n.call(o)))}finally{if(r)throw r.error}}})}function*gR(...i){for(const e of i)for(const t of Je(e))yield t}function pR(...i){return Mo(this,arguments,function*(){var t,r,n,s;for(const u of i)try{for(var a=!0,o=(r=void 0,_o(Ye(u))),l;l=yield hr(o.next()),t=l.done,!t;a=!0)s=l.value,a=!1,yield yield hr(s)}catch(h){r={error:h}}finally{try{!a&&!t&&(n=o.return)&&(yield hr(n.call(o)))}finally{if(r)throw r.error}}})}var Lr=function(i,e,t,r){function n(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function o(h){try{u(r.next(h))}catch(d){a(d)}}function l(h){try{u(r.throw(h))}catch(d){a(d)}}function u(h){h.done?s(h.value):n(h.value).then(o,l)}u((r=r.apply(i,e||[])).next())})},Zl=function(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=i[Symbol.asyncIterator],t;return e?e.call(i):(i=typeof __values=="function"?__values(i):i[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(s){t[s]=i[s]&&function(a){return new Promise(function(o,l){a=i[s](a),n(o,l,a.done,a.value)})}}function n(s,a,o,l){Promise.resolve(l).then(function(u){s({value:u,done:o})},a)}};function Ni(i,e,t){let r=t;for(const n of Je(i))r=e(r,n);return r}function Ci(i,e,t){return Lr(this,void 0,void 0,function*(){var r,n,s,a;let o=t;try{for(var l=!0,u=Zl(Ye(i)),h;h=yield u.next(),r=h.done,!r;l=!0)a=h.value,l=!1,o=yield e(o,a)}catch(d){n={error:d}}finally{try{!l&&!r&&(s=u.return)&&(yield s.call(u))}finally{if(n)throw n.error}}return o})}function G0(i){const[e,t]=Ni(i,(r,n)=>{const[s,a]=r;return[s+1,a+Number(n)]},[0,0]);return e?t/e:void 0}function q0(i){return Lr(this,void 0,void 0,function*(){const[e,t]=yield Ci(i,(r,n)=>{const[s,a]=r;return[s+1,a+Number(n)]},[0,0]);return e?t/e:void 0})}function V0(i,e){return e!==void 0?Ni(i,(t,r)=>e(r)>e(t??r)?r:t??r):Ni(i,(t,r)=>{const n=t??r,s=r;return n>=s?n:s})}function H0(i,e){return Lr(this,void 0,void 0,function*(){return e!==void 0?yield Ci(i,(t,r)=>Lr(this,void 0,void 0,function*(){return(yield e(r))>(yield e(t??r))?r:t??r})):yield Ci(i,(t,r)=>{const n=t??r,s=r;return n>=s?n:s})})}function K0(i,e){return e!==void 0?Ni(i,(t,r)=>e(r)<e(t??r)?r:t??r):Ni(i,(t,r)=>{const n=t??r,s=r;return n<=s?n:s})}function W0(i,e){return Lr(this,void 0,void 0,function*(){return e!==void 0?yield Ci(i,(t,r)=>Lr(this,void 0,void 0,function*(){return(yield e(r))<(yield e(t??r))?r:t??r})):yield Ci(i,(t,r)=>{const n=t??r,s=r;return n<=s?n:s})})}function $h(i,e){const t=e!==void 0?e:r=>r;return Ni(i,(r,n)=>{var s,a,o,l;return r=r,[t(n)<=t((s=r[0])!==null&&s!==void 0?s:n)?n:(a=r[0])!==null&&a!==void 0?a:n,t(n)>=t((o=r[1])!==null&&o!==void 0?o:n)?n:(l=r[1])!==null&&l!==void 0?l:n]},[void 0,void 0])}function Gh(i,e){return Lr(this,void 0,void 0,function*(){const t=e!==void 0?e:r=>r;return yield Ci(i,(r,n)=>Lr(this,void 0,void 0,function*(){var s,a,o,l;return r=r,[(yield t(n))<=(yield t((s=r[0])!==null&&s!==void 0?s:n))?n:(a=r[0])!==null&&a!==void 0?a:n,(yield t(n))>=(yield t((o=r[1])!==null&&o!==void 0?o:n))?n:(l=r[1])!==null&&l!==void 0?l:n]}),[void 0,void 0])})}function Y0(i){const[e,t]=$h(ru(i,r=>Number(r)));return(t??0)-(e??0)}function X0(i){return Lr(this,void 0,void 0,function*(){const[e,t]=yield Gh(Fo(i,r=>Number(r)));return(t??0)-(e??0)})}function j0(i){return Ni(i,(e,t)=>e+Number(t),0)}function z0(i){return Lr(this,void 0,void 0,function*(){return yield Ci(i,(e,t)=>e+Number(t),0)})}function J0(i){return Ni(i,(e,t)=>(e??1)*t)}function Q0(i){return Lr(this,void 0,void 0,function*(){return yield Ci(i,(e,t)=>(e??1)*t)})}function eu(i){switch(!0){case i instanceof Array:return i.length;case ma(i):return i.length;case i instanceof Set:return i.size;case i instanceof Map:return i.size}return Ni(i,e=>e+1,0)}function qh(i){return Lr(this,void 0,void 0,function*(){switch(!0){case i instanceof Array:case ma(i):case i instanceof Set:case i instanceof Map:return eu(i)}return yield Ci(i,e=>e+1,0)})}function Z0(i){for(const e of Je(i))return e;throw new rs("Collection is empty")}function ey(i){return Lr(this,void 0,void 0,function*(){var e,t,r,n;try{for(var s=!0,a=Zl(Ye(i)),o;o=yield a.next(),e=o.done,!e;s=!0)return n=o.value,s=!1,n}catch(l){t={error:l}}finally{try{!s&&!e&&(r=a.return)&&(yield r.call(a))}finally{if(t)throw t.error}}throw new rs("Collection is empty")})}function ty(i){let e=!0,t;for(const r of Je(i))t=r,e=!1;if(e)throw new rs("Collection is empty");return t}function ry(i){return Lr(this,void 0,void 0,function*(){var e,t,r,n;let s=!0,a;try{for(var o=!0,l=Zl(Ye(i)),u;u=yield l.next(),e=u.done,!e;o=!0)n=u.value,o=!1,a=n,s=!1}catch(h){t={error:h}}finally{try{!o&&!e&&(r=l.return)&&(yield r.call(l))}finally{if(t)throw t.error}}if(s)throw new rs("Collection is empty");return a})}function iy(i){let e=Dr,t=Dr;for(const r of Je(i))e===Dr&&(e=r),t=r;if(e===Dr)throw new rs("Collection is empty");return[e,t]}function ny(i){return Lr(this,void 0,void 0,function*(){var e,t,r,n;let s=Dr,a=Dr;try{for(var o=!0,l=Zl(Ye(i)),u;u=yield l.next(),e=u.done,!e;o=!0){n=u.value,o=!1;const h=n;s===Dr&&(s=h),a=h}}catch(h){t={error:h}}finally{try{!o&&!e&&(r=l.return)&&(yield r.call(l))}finally{if(t)throw t.error}}if(s===Dr)throw new rs("Collection is empty");return[s,a]})}var Hi=function(i,e,t,r){function n(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function o(h){try{u(r.next(h))}catch(d){a(d)}}function l(h){try{u(r.throw(h))}catch(d){a(d)}}function u(h){h.done?s(h.value):n(h.value).then(o,l)}u((r=r.apply(i,e||[])).next())})},is=function(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=i[Symbol.asyncIterator],t;return e?e.call(i):(i=typeof __values=="function"?__values(i):i[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(s){t[s]=i[s]&&function(a){return new Promise(function(o,l){a=i[s](a),n(o,l,a.done,a.value)})}}function n(s,a,o,l){Promise.resolve(l).then(function(u){s({value:u,done:o})},a)}};function mR(i,e){for(const t of Je(i))if(!e(t))return!1;return!0}function yR(i,e){return Hi(this,void 0,void 0,function*(){var t,r,n,s;try{for(var a=!0,o=is(Ye(i)),l;l=yield o.next(),t=l.done,!t;a=!0)if(s=l.value,a=!1,!(yield e(s)))return!1}catch(u){r={error:u}}finally{try{!a&&!t&&(n=o.return)&&(yield n.call(o))}finally{if(r)throw r.error}}return!0})}function vR(i){const e=new Set;for(const t of Je(i)){if(e.has(t))return!1;e.add(t)}return!0}function ER(i){return Hi(this,void 0,void 0,function*(){var e,t,r,n;const s=new Set;try{for(var a=!0,o=is(Ye(i)),l;l=yield o.next(),e=l.done,!e;a=!0){n=l.value,a=!1;const u=n;if(s.has(u))return!1;s.add(u)}}catch(u){t={error:u}}finally{try{!a&&!e&&(r=o.return)&&(yield r.call(o))}finally{if(t)throw t.error}}return!0})}function bR(i,e){for(const t of Je(i))if(e(t))return!0;return!1}function AR(i,e){return Hi(this,void 0,void 0,function*(){var t,r,n,s;try{for(var a=!0,o=is(Ye(i)),l;l=yield o.next(),t=l.done,!t;a=!0)if(s=l.value,a=!1,yield e(s))return!0}catch(u){r={error:u}}finally{try{!a&&!t&&(n=o.return)&&(yield n.call(o))}finally{if(r)throw r.error}}return!1})}function SR(i,e,t){if(e<0)return!1;t===void 0&&(t=n=>!!n);let r=0;for(const n of Je(i))if(t(n)&&(r++,r>e))return!1;return r===e}function xR(i,e,t){return Hi(this,void 0,void 0,function*(){var r,n,s,a;if(e<0)return!1;t===void 0&&(t=d=>!!d);let o=0;try{for(var l=!0,u=is(Ye(i)),h;h=yield u.next(),r=h.done,!r;l=!0)if(a=h.value,l=!1,(yield t(a))&&(o++,o>e))return!1}catch(d){n={error:d}}finally{try{!l&&!r&&(s=u.return)&&(yield s.call(u))}finally{if(n)throw n.error}}return o===e})}function Ki(i){return i==null?!1:typeof i[Symbol.iterator]=="function"}function Po(i){return i==null?!1:typeof i[Symbol.asyncIterator]=="function"}function ns(i){return i==null?!1:i.next!==void 0&&typeof i.next=="function"}function TR(i){for(const[e,t]of va(Je(i)))if(e<t)return!1;return!0}function DR(i){return Hi(this,void 0,void 0,function*(){var e,t,r,n;try{for(var s=!0,a=is(su(Ye(i))),o;o=yield a.next(),e=o.done,!e;s=!0){n=o.value,s=!1;const[l,u]=n;if(l<u)return!1}}catch(l){t={error:l}}finally{try{!s&&!e&&(r=a.return)&&(yield r.call(a))}finally{if(t)throw t.error}}return!0})}function RR(i){for(const[e,t]of va(Je(i)))if(e>t)return!1;return!0}function IR(i){return Hi(this,void 0,void 0,function*(){var e,t,r,n;try{for(var s=!0,a=is(su(Ye(i))),o;o=yield a.next(),e=o.done,!e;s=!0){n=o.value,s=!1;const[l,u]=n;if(l>u)return!1}}catch(l){t={error:l}}finally{try{!s&&!e&&(r=a.return)&&(yield r.call(a))}finally{if(t)throw t.error}}return!0})}function ma(i){return typeof i=="string"||i instanceof String}function NR(i,e){for(const t of Je(i))if(e(t))return!1;return!0}function CR(i,e){return Hi(this,void 0,void 0,function*(){var t,r,n,s;try{for(var a=!0,o=is(Ye(i)),l;l=yield o.next(),t=l.done,!t;a=!0)if(s=l.value,a=!1,yield e(s))return!1}catch(u){r={error:u}}finally{try{!a&&!t&&(n=o.return)&&(yield n.call(o))}finally{if(r)throw r.error}}return!0})}function wR(...i){try{for(const e of U0(...i))for(const[t,r]of va(e))if(t!==r)return!1}catch{return!1}return!0}function LR(...i){return Hi(this,void 0,void 0,function*(){var e,t,r,n;try{try{for(var s=!0,a=is($0(...i)),o;o=yield a.next(),e=o.done,!e;s=!0){n=o.value,s=!1;const l=n;for(const[u,h]of va(l))if(u!==h)return!1}}catch(l){t={error:l}}finally{try{!s&&!e&&(r=a.return)&&(yield r.call(a))}finally{if(t)throw t.error}}}catch{return!1}return!0})}function _R(...i){if(i.length<=1)return!0;const e=i.map(t=>eu(t));return new Set(e).size===1}function MR(...i){return Hi(this,void 0,void 0,function*(){if(i.length<=1)return!0;const e=yield Fo(i,t=>Hi(this,void 0,void 0,function*(){return yield qh(t)}));return new Set(yield Bs(e)).size===1})}var Vh=function(i,e,t,r){function n(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function o(h){try{u(r.next(h))}catch(d){a(d)}}function l(h){try{u(r.throw(h))}catch(d){a(d)}}function u(h){h.done?s(h.value):n(h.value).then(o,l)}u((r=r.apply(i,e||[])).next())})},Wi=function(i){return this instanceof Wi?(this.v=i,this):new Wi(i)},Hh=function(i,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(i,e||[]),n,s=[];return n=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),o("next"),o("throw"),o("return",a),n[Symbol.asyncIterator]=function(){return this},n;function a(g){return function(m){return Promise.resolve(m).then(g,d)}}function o(g,m){r[g]&&(n[g]=function(v){return new Promise(function(E,A){s.push([g,v,E,A])>1||l(g,v)})},m&&(n[g]=m(n[g])))}function l(g,m){try{u(r[g](m))}catch(v){p(s[0][3],v)}}function u(g){g.value instanceof Wi?Promise.resolve(g.value.v).then(h,d):p(s[0][2],g)}function h(g){l("next",g)}function d(g){l("throw",g)}function p(g,m){g(m),s.shift(),s.length&&l(s[0][0],s[0][1])}},tu=function(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=i[Symbol.asyncIterator],t;return e?e.call(i):(i=typeof __values=="function"?__values(i):i[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(s){t[s]=i[s]&&function(a){return new Promise(function(o,l){a=i[s](a),n(o,l,a.done,a.value)})}}function n(s,a,o,l){Promise.resolve(l).then(function(u){s({value:u,done:o})},a)}};function Je(i){if(Ki(i))return i;if(ns(i))return{[Symbol.iterator](){return i}};if(typeof i=="object"&&i!==null)return function*(){for(const e in i)Object.prototype.hasOwnProperty.call(i,e)&&(yield[e,i[e]])}();throw new Yt("Given collection is not iterable or iterator.")}function Ye(i){if(Po(i))return i;if(ns(i))return{[Symbol.asyncIterator](){return Hh(this,arguments,function*(){for(;;){const t=yield Wi(i.next());if(t.done)return yield Wi(void 0);yield yield Wi(t.value)}})}};if(typeof i=="object"&&i!==null&&(i=Je(i)),Ki(i))return{[Symbol.asyncIterator](){return Hh(this,arguments,function*(){for(const t of i)yield yield Wi(t)})}};throw new Yt("Given collection is not async iterable or iterator.")}function sy(i){if(ns(i))return i;if(Ki(i))return function*(){for(const e of i)yield e}();throw new Yt("Given collection is not iterable or iterator.")}function ay(i){if((ns(i)||Ki(i))&&(i=Ye(i)),Po(i))return function(){return Hh(this,arguments,function*(){var e,t,r,n;try{for(var s=!0,a=tu(i),o;o=yield Wi(a.next()),e=o.done,!e;s=!0)n=o.value,s=!1,yield yield Wi(n)}catch(l){t={error:l}}finally{try{!s&&!e&&(r=a.return)&&(yield Wi(r.call(a)))}finally{if(t)throw t.error}}})}();throw new Yt("Given collection is not iterable or iterator.")}function ya(i){if(Array.isArray(i))return i;const e=[];for(const t of Je(i))e.push(t);return e}function Bs(i){return Vh(this,void 0,void 0,function*(){var e,t,r,n;if(Array.isArray(i))return i;const s=[];try{for(var a=!0,o=tu(Ye(i)),l;l=yield o.next(),e=l.done,!e;a=!0){n=l.value,a=!1;const u=n;s.push(u)}}catch(u){t={error:u}}finally{try{!a&&!e&&(r=o.return)&&(yield r.call(o))}finally{if(t)throw t.error}}return s})}function PR(i){const e=new Map;for(const[t,r]of Je(i))e.set(t,r);return e}function kR(i){return Vh(this,void 0,void 0,function*(){var e,t,r,n;const s=new Map;try{for(var a=!0,o=tu(Ye(i)),l;l=yield o.next(),e=l.done,!e;a=!0){n=l.value,a=!1;const[u,h]=n;s.set(u,h)}}catch(u){t={error:u}}finally{try{!a&&!e&&(r=o.return)&&(yield r.call(o))}finally{if(t)throw t.error}}return s})}function OR(i){const e=new Set;for(const t of Je(i))e.add(t);return e}function FR(i){return Vh(this,void 0,void 0,function*(){var e,t,r,n;const s=new Set;try{for(var a=!0,o=tu(Ye(i)),l;l=yield o.next(),e=l.done,!e;a=!0){n=l.value,a=!1;const u=n;s.add(u)}}catch(u){t={error:u}}finally{try{!a&&!e&&(r=o.return)&&(yield r.call(o))}finally{if(t)throw t.error}}return s})}function Kh(i,e){return new aR(sy(i),e).getRelatedIterables()}function Wh(i,e){return new lR(ay(i),e).getRelatedIterables()}var vr=function(i){return this instanceof vr?(this.v=i,this):new vr(i)},ko=function(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=i[Symbol.asyncIterator],t;return e?e.call(i):(i=typeof __values=="function"?__values(i):i[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(s){t[s]=i[s]&&function(a){return new Promise(function(o,l){a=i[s](a),n(o,l,a.done,a.value)})}}function n(s,a,o,l){Promise.resolve(l).then(function(u){s({value:u,done:o})},a)}},Oo=function(i,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(i,e||[]),n,s=[];return n=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),o("next"),o("throw"),o("return",a),n[Symbol.asyncIterator]=function(){return this},n;function a(g){return function(m){return Promise.resolve(m).then(g,d)}}function o(g,m){r[g]&&(n[g]=function(v){return new Promise(function(E,A){s.push([g,v,E,A])>1||l(g,v)})},m&&(n[g]=m(n[g])))}function l(g,m){try{u(r[g](m))}catch(v){p(s[0][3],v)}}function u(g){g.value instanceof vr?Promise.resolve(g.value.v).then(h,d):p(s[0][2],g)}function h(g){l("next",g)}function d(g){l("throw",g)}function p(g,m){g(m),s.shift(),s.length&&l(s[0][0],s[0][1])}},oy=function(i){var e,t;return e={},r("next"),r("throw",function(n){throw n}),r("return"),e[Symbol.iterator]=function(){return this},e;function r(n,s){e[n]=i[n]?function(a){return(t=!t)?{value:vr(i[n](a)),done:!1}:s?s(a):a}:s}};function*Yh(i,e){const t=new Set;if(i instanceof Map){e===void 0&&(e=r=>r[1]);for(const r of i){const n=e(r);t.has(n)||(yield r,t.add(n))}}else{e===void 0&&(e=r=>r);for(const r of Je(i)){const n=e(r);t.has(n)||(yield r,t.add(n))}}}function ly(i,e){return Oo(this,arguments,function*(){var r,n,s,a;const o=new Set;if(i instanceof Map)for(const d of Yh(i,e))yield yield vr(yield vr(d));else{e===void 0&&(e=d=>d);try{for(var l=!0,u=ko(Ye(i)),h;h=yield vr(u.next()),r=h.done,!r;l=!0){a=h.value,l=!1;const d=a,p=e(d);o.has(p)||(yield yield vr(d),o.add(p))}}catch(d){n={error:d}}finally{try{!l&&!r&&(s=u.return)&&(yield vr(s.call(u)))}finally{if(n)throw n.error}}}})}function*BR(...i){yield*Xh(i.length,...i)}function UR(...i){return Oo(this,arguments,function*(){yield vr(yield*oy(ko(jh(i.length,...i))))})}function*Xh(i,...e){const t=new Ql,r=ga(cr.LONGEST,Dr,...e);for(const n of r)for(const[s,a]of Ea(n))a!==Dr&&(t.addUsage(a,`${s}`),t.getOwnersCount(a)===i&&(yield a,t.deleteUsage(a)))}function jh(i,...e){return Oo(this,arguments,function*(){var r,n,s,a;const o=new Ql,l=pa(cr.LONGEST,Dr,...e);try{for(var u=!0,h=ko(l),d;d=yield vr(h.next()),r=d.done,!r;u=!0){a=d.value,u=!1;const p=a;for(const[g,m]of Ea(p))m!==Dr&&(o.addUsage(m,`${g}`),o.getOwnersCount(m)===i&&(yield yield vr(m),o.deleteUsage(m)))}}catch(p){n={error:p}}finally{try{!u&&!r&&(s=h.return)&&(yield vr(s.call(h)))}finally{if(n)throw n.error}}})}function*$R(...i){const e=new Ql,t=new Set,r=ga(cr.LONGEST,Dr,...i);for(const n of r)for(const[s,a]of Ea(n))a!==Dr&&(e.addUsage(a,`${s}`),t.add(a),e.getOwnersCount(a)===i.length&&e.deleteUsage(a));for(const n of t)for(const s of ed.repeat(n,e.getUsagesCount(n)))yield s}function GR(...i){return Oo(this,arguments,function*(){var t,r,n,s;const a=new Ql,o=new Set,l=pa(cr.LONGEST,Dr,...i);try{for(var u=!0,h=ko(l),d;d=yield vr(h.next()),t=d.done,!t;u=!0){s=d.value,u=!1;const p=s;for(const[g,m]of Ea(p))m!==Dr&&(a.addUsage(m,`${g}`),o.add(m),a.getOwnersCount(m)===i.length&&a.deleteUsage(m))}}catch(p){r={error:p}}finally{try{!u&&!t&&(n=h.return)&&(yield vr(n.call(h)))}finally{if(r)throw r.error}}for(const p of o)for(const g of ed.repeat(p,a.getUsagesCount(p)))yield yield vr(g)})}function*qR(...i){yield*Xh(1,...i)}function VR(...i){return Oo(this,arguments,function*(){yield vr(yield*oy(ko(jh(1,...i))))})}var Jt=function(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=i[Symbol.asyncIterator],t;return e?e.call(i):(i=typeof __values=="function"?__values(i):i[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(s){t[s]=i[s]&&function(a){return new Promise(function(o,l){a=i[s](a),n(o,l,a.done,a.value)})}}function n(s,a,o,l){Promise.resolve(l).then(function(u){s({value:u,done:o})},a)}},Se=function(i){return this instanceof Se?(this.v=i,this):new Se(i)},tr=function(i,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(i,e||[]),n,s=[];return n=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),o("next"),o("throw"),o("return",a),n[Symbol.asyncIterator]=function(){return this},n;function a(g){return function(m){return Promise.resolve(m).then(g,d)}}function o(g,m){r[g]&&(n[g]=function(v){return new Promise(function(E,A){s.push([g,v,E,A])>1||l(g,v)})},m&&(n[g]=m(n[g])))}function l(g,m){try{u(r[g](m))}catch(v){p(s[0][3],v)}}function u(g){g.value instanceof Se?Promise.resolve(g.value.v).then(h,d):p(s[0][2],g)}function h(g){l("next",g)}function d(g){l("throw",g)}function p(g,m){g(m),s.shift(),s.length&&l(s[0][0],s[0][1])}};function*ru(i,e){for(const t of Je(i))yield e(t)}function Fo(i,e){return tr(this,arguments,function*(){var r,n,s,a;try{for(var o=!0,l=Jt(Ye(i)),u;u=yield Se(l.next()),r=u.done,!r;o=!0)a=u.value,o=!1,yield yield Se(yield Se(e(a)))}catch(h){n={error:h}}finally{try{!o&&!r&&(s=l.return)&&(yield Se(s.call(l)))}finally{if(n)throw n.error}}})}function*uy(i,e){for(const[t,r]of F0(i,e))r&&(yield t)}function cy(i,e){return tr(this,arguments,function*(){var r,n,s,a;try{for(var o=!0,l=Jt(B0(i,e)),u;u=yield Se(l.next()),r=u.done,!r;o=!0){a=u.value,o=!1;const[h,d]=a;d&&(yield yield Se(h))}}catch(h){n={error:h}}finally{try{!o&&!r&&(s=l.return)&&(yield Se(s.call(l)))}finally{if(n)throw n.error}}})}function*hy(i,e){let t=!0;for(const r of Je(i)){if(t){if(!e(r)){t=!1,yield r;continue}continue}yield r}}function dy(i,e){return tr(this,arguments,function*(){var r,n,s,a;let o=!0;try{for(var l=!0,u=Jt(Ye(i)),h;h=yield Se(u.next()),r=h.done,!r;l=!0){a=h.value,l=!1;const d=a;if(o){if(!(yield Se(e(d)))){o=!1,yield yield Se(d);continue}continue}yield yield Se(d)}}catch(d){n={error:d}}finally{try{!l&&!r&&(s=u.return)&&(yield Se(s.call(u)))}finally{if(n)throw n.error}}})}function*fy(i,e){for(const t of Je(i))if(e(t))yield t;else break}function gy(i,e){return tr(this,arguments,function*(){var r,n,s,a;try{for(var o=!0,l=Jt(Ye(i)),u;u=yield Se(l.next()),r=u.done,!r;o=!0){a=u.value,o=!1;const h=a;if(yield Se(e(h)))yield yield Se(h);else break}}catch(h){n={error:h}}finally{try{!o&&!r&&(s=l.return)&&(yield Se(s.call(l)))}finally{if(n)throw n.error}}})}function*HR(i,e){if(e<0)throw new Yt(`Number of repetitions cannot be negative: ${e}`);for(let t=e;t>0;--t)yield i}function KR(i,e){return tr(this,arguments,function*(){if(e<0)throw new Yt(`Number of repetitions cannot be negative: ${e}`);const r=yield Se(i);for(let n=e;n>0;--n)yield yield Se(r)})}function*py(i,e){for(const t of Je(i)){const r=e(t,e);if(Ki(r))for(const n of Je(r))yield n;else yield r}}function my(i,e){return tr(this,arguments,function*(){var r,n,s,a,o,l,u,h;try{for(var d=!0,p=Jt(Ye(i)),g;g=yield Se(p.next()),r=g.done,!r;d=!0){a=g.value,d=!1;const D=yield Se(e(a,e));if(Ki(D)||Po(D))try{for(var m=!0,v=(l=void 0,Jt(Ye(D))),E;E=yield Se(v.next()),o=E.done,!o;m=!0)h=E.value,m=!1,yield yield Se(h)}catch(R){l={error:R}}finally{try{!m&&!o&&(u=v.return)&&(yield Se(u.call(v)))}finally{if(l)throw l.error}}else yield yield Se(D)}}catch(A){n={error:A}}finally{try{!d&&!r&&(s=p.return)&&(yield Se(s.call(p)))}finally{if(n)throw n.error}}})}function*zh(i,e=1/0){if(e<1){for(let t of Je(i))i instanceof Map&&(t=t[1]),yield t;return}for(let t of Je(i))if(i instanceof Map&&(t=t[1]),(Ki(t)||ns(t))&&!ma(t))for(const r of zh(t,e-1))yield r;else yield t}function Jh(i){return tr(this,arguments,function*(t,r=1/0){var n,s,a,o,l,u,h,d,p,g,m,v;if(r<1){try{for(var E=!0,A=Jt(Ye(t)),D;D=yield Se(A.next()),n=D.done,!n;E=!0){o=D.value,E=!1;let L=o;t instanceof Map&&(L=L[1]),yield yield Se(L)}}catch(L){s={error:L}}finally{try{!E&&!n&&(a=A.return)&&(yield Se(a.call(A)))}finally{if(s)throw s.error}}return yield Se(void 0)}try{for(var R=!0,_=Jt(Ye(t)),F;F=yield Se(_.next()),l=F.done,!l;R=!0){d=F.value,R=!1;let L=d;if(t instanceof Map&&(L=L[1]),(Po(L)||Ki(L)||ns(L))&&!ma(L))try{for(var w=!0,C=(g=void 0,Jt(Jh(L,r-1))),M;M=yield Se(C.next()),p=M.done,!p;w=!0)v=M.value,w=!1,yield yield Se(v)}catch(I){g={error:I}}finally{try{!w&&!p&&(m=C.return)&&(yield Se(m.call(C)))}finally{if(g)throw g.error}}else yield yield Se(L)}}catch(L){u={error:L}}finally{try{!R&&!l&&(h=_.return)&&(yield Se(h.call(_)))}finally{if(u)throw u.error}}})}function*yy(i,e){for(const t of Je(i))e(t)&&(yield t)}function vy(i,e){return tr(this,arguments,function*(){var r,n,s,a;try{for(var o=!0,l=Jt(Ye(i)),u;u=yield Se(l.next()),r=u.done,!r;o=!0){a=u.value,o=!1;const h=a;(yield Se(e(h)))&&(yield yield Se(h))}}catch(h){n={error:h}}finally{try{!o&&!r&&(s=l.return)&&(yield Se(s.call(l)))}finally{if(n)throw n.error}}})}function*iu(i,e,t,r=!0){if(e<1)throw new Yt(`Chunk size must be ≥ 1. Got ${e}`);if(t>=e)throw new Yt("Overlap size must be less than chunk size");let n=[],s=!1;for(const a of Je(i))s=!1,n.push(a),n.length===e&&(yield n,n=n.slice(e-t),s=!0);!s&&n.length>0&&r&&(yield n)}function nu(i,e,t){return tr(this,arguments,function*(n,s,a,o=!0){var l,u,h,d;if(s<1)throw new Yt(`Chunk size must be ≥ 1. Got ${s}`);if(a>=s)throw new Yt("Overlap size must be less than chunk size");let p=[],g=!1;try{for(var m=!0,v=Jt(Ye(n)),E;E=yield Se(v.next()),l=E.done,!l;m=!0){d=E.value,m=!1;const A=d;g=!1,p.push(A),p.length===s&&(yield yield Se(p),p=p.slice(s-a),g=!0)}}catch(A){u={error:A}}finally{try{!m&&!l&&(h=v.return)&&(yield Se(h.call(v)))}finally{if(u)throw u.error}}!g&&p.length>0&&o&&(yield yield Se(p))})}function*Ey(i,e){for(const t of iu(i,e,0))yield t}function by(i,e){return tr(this,arguments,function*(){var r,n,s,a;try{for(var o=!0,l=Jt(nu(i,e,0)),u;u=yield Se(l.next()),r=u.done,!r;o=!0)a=u.value,o=!1,yield yield Se(a)}catch(h){n={error:h}}finally{try{!o&&!r&&(s=l.return)&&(yield Se(s.call(l)))}finally{if(n)throw n.error}}})}function*va(i){const e=iu(i,2,1,!1);for(const t of e)yield t}function su(i){return tr(this,arguments,function*(){var t,r,n,s;const a=nu(i,2,1,!1);try{for(var o=!0,l=Jt(a),u;u=yield Se(l.next()),t=u.done,!t;o=!0)s=u.value,o=!1,yield yield Se(s)}catch(h){r={error:h}}finally{try{!o&&!t&&(n=l.return)&&(yield Se(n.call(l)))}finally{if(r)throw r.error}}})}function*Ay(i,e){if(e<0)throw new Yt(`Limit must be ≥ 0. Got ${e}`);let t=0;for(const r of Je(i)){if(t>=e)return;yield r,++t}}function Sy(i,e){return tr(this,arguments,function*(){var r,n,s,a;if(e<0)throw new Yt(`Limit must be ≥ 0. Got ${e}`);let o=0;try{for(var l=!0,u=Jt(Ye(i)),h;h=yield Se(u.next()),r=h.done,!r;l=!0){a=h.value,l=!1;const d=a;if(o>=e)return yield Se(void 0);yield yield Se(d),++o}}catch(d){n={error:d}}finally{try{!l&&!r&&(s=u.return)&&(yield Se(s.call(u)))}finally{if(n)throw n.error}}})}function*Ea(i){let e=0;for(const t of Je(i))yield[e++,t]}function xy(i){return tr(this,arguments,function*(){var t,r,n,s;let a=0;try{for(var o=!0,l=Jt(Ye(i)),u;u=yield Se(l.next()),t=u.done,!t;o=!0){s=u.value,o=!1;const h=s;yield yield Se([a++,h])}}catch(h){r={error:h}}finally{try{!o&&!t&&(n=l.return)&&(yield Se(n.call(l)))}finally{if(r)throw r.error}}})}function*Ty(i,e=0,t,r=1){if(e<0)throw new Yt("Parameter 'start' cannot be negative");if(t!==void 0&&t<0)throw new Yt("Parameter 'count' cannot be negative");if(r<=0)throw new Yt("Parameter 'step' must be positive");let n=0,s=0;for(const a of Je(i))if(!(n++<e||(n-e-1)%r!==0)){if(s++===t&&t!==void 0)break;yield a}}function Dy(i){return tr(this,arguments,function*(t,r=0,n,s=1){var a,o,l,u;if(r<0)throw new Yt("Parameter 'start' cannot be negative");if(n!==void 0&&n<0)throw new Yt("Parameter 'count' cannot be negative");if(s<=0)throw new Yt("Parameter 'step' must be positive");let h=0,d=0;try{for(var p=!0,g=Jt(Ye(t)),m;m=yield Se(g.next()),a=m.done,!a;p=!0){u=m.value,p=!1;const v=u;if(!(h++<r||(h-r-1)%s!==0)){if(d++===n&&n!==void 0)break;yield yield Se(v)}}}catch(v){o={error:v}}finally{try{!p&&!a&&(l=g.return)&&(yield Se(l.call(g)))}finally{if(o)throw o.error}}})}function*Ry(i){for(const[e]of Je(i))yield e}function Iy(i){return tr(this,arguments,function*(){var t,r,n,s;try{for(var a=!0,o=Jt(Ye(i)),l;l=yield Se(o.next()),t=l.done,!t;a=!0){s=l.value,a=!1;const[u]=s;yield yield Se(u)}}catch(u){r={error:u}}finally{try{!a&&!t&&(n=o.return)&&(yield Se(n.call(o)))}finally{if(r)throw r.error}}})}function*Ny(i,e,t=0){if(e<0||t<0)throw new Yt;let r=-t;for(const n of Je(i))(r<0||r>=e)&&(yield n),++r}function Cy(i,e){return tr(this,arguments,function*(r,n,s=0){var a,o,l,u;if(n<0||s<0)throw new Yt;let h=-s;try{for(var d=!0,p=Jt(Ye(r)),g;g=yield Se(p.next()),a=g.done,!a;d=!0){u=g.value,d=!1;const m=u;(h<0||h>=n)&&(yield yield Se(m)),++h}}catch(m){o={error:m}}finally{try{!d&&!a&&(l=p.return)&&(yield Se(l.call(p)))}finally{if(o)throw o.error}}})}function*wy(i){for(const[,e]of Je(i))yield e}function Ly(i){return tr(this,arguments,function*(){var t,r,n,s;try{for(var a=!0,o=Jt(Ye(i)),l;l=yield Se(o.next()),t=l.done,!t;a=!0){s=l.value,a=!1;const[,u]=s;yield yield Se(u)}}catch(u){r={error:u}}finally{try{!a&&!t&&(n=o.return)&&(yield Se(n.call(o)))}finally{if(r)throw r.error}}})}function*_y(i,e,t){const r=new Map,n=s=>{r.has(s)||(t!==void 0?r.set(s,{}):r.set(s,[]))};for(const s of Je(i)){const a=e(s),o=t!==void 0?t(s):void 0,l=(Ki(a)||ns(a))&&!ma(a)?a:[a];for(const u of Yh(l))n(u),o===void 0?r.get(u).push(s):r.get(u)[o]=s}for(const s of r)yield s}function My(i,e,t){return tr(this,arguments,function*(){var n,s,a,o,l,u,h,d;const p=new Map,g=_=>{p.has(_)||(t!==void 0?p.set(_,{}):p.set(_,[]))};try{for(var m=!0,v=Jt(Ye(i)),E;E=yield Se(v.next()),n=E.done,!n;m=!0){o=E.value,m=!1;const _=o,F=yield Se(e(_)),w=t!==void 0?yield Se(t(_)):void 0,C=(Po(F)||Ki(F)||ns(F))&&!ma(F)?F:[F];try{for(var A=!0,D=(u=void 0,Jt(ly(C))),R;R=yield Se(D.next()),l=R.done,!l;A=!0){d=R.value,A=!1;const M=d;g(M),w===void 0?p.get(M).push(_):p.get(M)[w]=_}}catch(M){u={error:M}}finally{try{!A&&!l&&(h=D.return)&&(yield Se(h.call(D)))}finally{if(u)throw u.error}}}}catch(_){s={error:_}}finally{try{!m&&!n&&(a=v.return)&&(yield Se(a.call(v)))}finally{if(s)throw s.error}}for(const _ of p)yield yield Se(_)})}function*Py(i,e){const t=ya(i);e!==void 0?t.sort(e):t.sort();for(const r of t)yield r}function ky(i,e){return tr(this,arguments,function*(){const r=yield Se(Bs(i));e!==void 0?r.sort(e):r.sort();for(const n of r)yield yield Se(n)})}var Oy=function(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=i[Symbol.asyncIterator],t;return e?e.call(i):(i=typeof __values=="function"?__values(i):i[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(s){t[s]=i[s]&&function(a){return new Promise(function(o,l){a=i[s](a),n(o,l,a.done,a.value)})}}function n(s,a,o,l){Promise.resolve(l).then(function(u){s({value:u,done:o})},a)}},ss=function(i){return this instanceof ss?(this.v=i,this):new ss(i)},WR=function(i){var e,t;return e={},r("next"),r("throw",function(n){throw n}),r("return"),e[Symbol.iterator]=function(){return this},e;function r(n,s){e[n]=i[n]?function(a){return(t=!t)?{value:ss(i[n](a)),done:!1}:s?s(a):a}:s}},YR=function(i,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(i,e||[]),n,s=[];return n=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),o("next"),o("throw"),o("return",a),n[Symbol.asyncIterator]=function(){return this},n;function a(g){return function(m){return Promise.resolve(m).then(g,d)}}function o(g,m){r[g]&&(n[g]=function(v){return new Promise(function(E,A){s.push([g,v,E,A])>1||l(g,v)})},m&&(n[g]=m(n[g])))}function l(g,m){try{u(r[g](m))}catch(v){p(s[0][3],v)}}function u(g){g.value instanceof ss?Promise.resolve(g.value.v).then(h,d):p(s[0][2],g)}function h(g){l("next",g)}function d(g){l("throw",g)}function p(g,m){g(m),s.shift(),s.length&&l(s[0][0],s[0][1])}};function*XR(i=1,e=1){for(let t=i;;t+=e)yield t}function*Fy(i){const e=[...Je(i)];if(e.length!==0)for(;;)for(const t of e)yield t}function jR(i){return YR(this,arguments,function*(){var t,r,n,s;const a=[];try{for(var o=!0,l=Oy(Ye(i)),u;u=yield ss(l.next()),t=u.done,!t;o=!0){s=u.value,o=!1;const h=s;a.push(h),yield yield ss(h)}}catch(h){r={error:h}}finally{try{!o&&!t&&(n=l.return)&&(yield ss(n.call(l)))}finally{if(r)throw r.error}}yield ss(yield*WR(Oy(Fy(a))))})}function*zR(i){for(;;)yield i}var ba=function(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=i[Symbol.asyncIterator],t;return e?e.call(i):(i=typeof __values=="function"?__values(i):i[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(s){t[s]=i[s]&&function(a){return new Promise(function(o,l){a=i[s](a),n(o,l,a.done,a.value)})}}function n(s,a,o,l){Promise.resolve(l).then(function(u){s({value:u,done:o})},a)}},Lt=function(i){return this instanceof Lt?(this.v=i,this):new Lt(i)},Aa=function(i,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(i,e||[]),n,s=[];return n=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),o("next"),o("throw"),o("return",a),n[Symbol.asyncIterator]=function(){return this},n;function a(g){return function(m){return Promise.resolve(m).then(g,d)}}function o(g,m){r[g]&&(n[g]=function(v){return new Promise(function(E,A){s.push([g,v,E,A])>1||l(g,v)})},m&&(n[g]=m(n[g])))}function l(g,m){try{u(r[g](m))}catch(v){p(s[0][3],v)}}function u(g){g.value instanceof Lt?Promise.resolve(g.value.v).then(h,d):p(s[0][2],g)}function h(g){l("next",g)}function d(g){l("throw",g)}function p(g,m){g(m),s.shift(),s.length&&l(s[0][0],s[0][1])}};function*JR(i,e){let t=0;for(const r of By(Je(i),e))t++,yield r/t}function QR(i,e){return Aa(this,arguments,function*(){var r,n,s,a;let o=0;try{for(var l=!0,u=ba(Uy(Ye(i),e)),h;h=yield Lt(u.next()),r=h.done,!r;l=!0){a=h.value,l=!1;const d=a;o++,yield yield Lt(d/o)}}catch(d){n={error:d}}finally{try{!l&&!r&&(s=u.return)&&(yield Lt(s.call(u)))}finally{if(n)throw n.error}}})}function*ZR(i,e){e!==void 0&&(yield e);let t=e??0;for(const r of Je(i))t-=Number(r),yield t}function eI(i,e){return Aa(this,arguments,function*(){var r,n,s,a;e!==void 0&&(yield yield Lt(e));let o=e??0;try{for(var l=!0,u=ba(Ye(i)),h;h=yield Lt(u.next()),r=h.done,!r;l=!0)a=h.value,l=!1,o-=Number(a),yield yield Lt(o)}catch(d){n={error:d}}finally{try{!l&&!r&&(s=u.return)&&(yield Lt(s.call(u)))}finally{if(n)throw n.error}}})}function*tI(i,e){e!==void 0&&(yield e);let t=e??-1/0;for(const r of Je(i))t=Math.max(t,r),yield t}function rI(i,e){return Aa(this,arguments,function*(){var r,n,s,a;e!==void 0&&(yield yield Lt(e));let o=e??-1/0;try{for(var l=!0,u=ba(Ye(i)),h;h=yield Lt(u.next()),r=h.done,!r;l=!0)a=h.value,l=!1,o=Math.max(o,a),yield yield Lt(o)}catch(d){n={error:d}}finally{try{!l&&!r&&(s=u.return)&&(yield Lt(s.call(u)))}finally{if(n)throw n.error}}})}function*iI(i,e){e!==void 0&&(yield e);let t=e??1/0;for(const r of Je(i))t=Math.min(t,r),yield t}function nI(i,e){return Aa(this,arguments,function*(){var r,n,s,a;e!==void 0&&(yield yield Lt(e));let o=e??1/0;try{for(var l=!0,u=ba(Ye(i)),h;h=yield Lt(u.next()),r=h.done,!r;l=!0)a=h.value,l=!1,o=Math.min(o,a),yield yield Lt(o)}catch(d){n={error:d}}finally{try{!l&&!r&&(s=u.return)&&(yield Lt(s.call(u)))}finally{if(n)throw n.error}}})}function*sI(i,e){e!==void 0&&(yield e);let t=e??1;for(const r of Je(i))t*=Number(r),yield t}function aI(i,e){return Aa(this,arguments,function*(){var r,n,s,a;e!==void 0&&(yield yield Lt(e));let o=e??1;try{for(var l=!0,u=ba(Ye(i)),h;h=yield Lt(u.next()),r=h.done,!r;l=!0)a=h.value,l=!1,o*=Number(a),yield yield Lt(o)}catch(d){n={error:d}}finally{try{!l&&!r&&(s=u.return)&&(yield Lt(s.call(u)))}finally{if(n)throw n.error}}})}function*By(i,e){e!==void 0&&(yield e);let t=e??0;for(const r of Je(i))t+=Number(r),yield t}function Uy(i,e){return Aa(this,arguments,function*(){var r,n,s,a;e!==void 0&&(yield yield Lt(e));let o=e??0;try{for(var l=!0,u=ba(Ye(i)),h;h=yield Lt(u.next()),r=h.done,!r;l=!0)a=h.value,l=!1,o+=Number(a),yield yield Lt(o)}catch(d){n={error:d}}finally{try{!l&&!r&&(s=u.return)&&(yield Lt(s.call(u)))}finally{if(n)throw n.error}}})}var oI=function(i,e,t,r){function n(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function o(h){try{u(r.next(h))}catch(d){a(d)}}function l(h){try{u(r.throw(h))}catch(d){a(d)}}function u(h){h.done?s(h.value):n(h.value).then(o,l)}u((r=r.apply(i,e||[])).next())})},_r=function(i){return this instanceof _r?(this.v=i,this):new _r(i)},Qh=function(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=i[Symbol.asyncIterator],t;return e?e.call(i):(i=typeof __values=="function"?__values(i):i[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(s){t[s]=i[s]&&function(a){return new Promise(function(o,l){a=i[s](a),n(o,l,a.done,a.value)})}}function n(s,a,o,l){Promise.resolve(l).then(function(u){s({value:u,done:o})},a)}},Zh=function(i,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(i,e||[]),n,s=[];return n=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),o("next"),o("throw"),o("return",a),n[Symbol.asyncIterator]=function(){return this},n;function a(g){return function(m){return Promise.resolve(m).then(g,d)}}function o(g,m){r[g]&&(n[g]=function(v){return new Promise(function(E,A){s.push([g,v,E,A])>1||l(g,v)})},m&&(n[g]=m(n[g])))}function l(g,m){try{u(r[g](m))}catch(v){p(s[0][3],v)}}function u(g){g.value instanceof _r?Promise.resolve(g.value.v).then(h,d):p(s[0][2],g)}function h(g){l("next",g)}function d(g){l("throw",g)}function p(g,m){g(m),s.shift(),s.length&&l(s[0][0],s[0][1])}},$y=function(i){var e,t;return e={},r("next"),r("throw",function(n){throw n}),r("return"),e[Symbol.iterator]=function(){return this},e;function r(n,s){e[n]=i[n]?function(a){return(t=!t)?{value:_r(i[n](a)),done:!1}:s?s(a):a}:s}};function*lI(...i){if(i.length===0)return;if(i.length===1){for(const r of Je(i[0]))yield[r];return}const t=ya(ru(i,r=>ya(r))).reduce((r,n)=>r.flatMap(s=>n.map(a=>[...s,a])),[[]]);for(const r of t)yield r}function uI(...i){return Zh(this,arguments,function*(){var t,r,n,s;if(i.length===0)return yield _r(void 0);if(i.length===1){try{for(var a=!0,o=Qh(Ye(i[0])),l;l=yield _r(o.next()),t=l.done,!t;a=!0)s=l.value,a=!1,yield yield _r([s])}catch(d){r={error:d}}finally{try{!a&&!t&&(n=o.return)&&(yield _r(n.call(o)))}finally{if(r)throw r.error}}return yield _r(void 0)}const h=(yield _r(Bs(Fo(i,d=>oI(this,void 0,void 0,function*(){return yield Bs(d)}))))).reduce((d,p)=>d.flatMap(g=>p.map(m=>[...g,m])),[[]]);for(const d of h)yield yield _r(d)})}function*Gy(i,e){if(e<0)throw new Yt("Parameter 'length' cannot be negative");const t=ya(i);function*r(n,s){if(n.length===e)yield n.slice();else for(let a=0;a<s.length;a++){const o=[...n,s[a]],l=s.slice(0,a).concat(s.slice(a+1));yield*r(o,l)}}yield*r([],t)}function cI(i,e){return Zh(this,arguments,function*(){yield _r(yield*$y(Qh(Gy(yield _r(Bs(i)),e))))})}function*qy(i,e){if(e<0)throw new Yt("Parameter 'length' cannot be negative");const t=ya(i),r=t.length;if(e===0){yield[];return}if(e>r||e<0)return;const n=Array.from({length:e},(s,a)=>a);for(yield n.map(s=>t[s]);;){let s=e-1;for(;s>=0&&n[s]===s+r-e;)s--;if(s<0)break;n[s]++;for(let a=s+1;a<e;a++)n[a]=n[a-1]+1;yield n.map(a=>t[a])}}function hI(i,e){return Zh(this,arguments,function*(){yield _r(yield*$y(Qh(qy(yield _r(Bs(i)),e))))})}let Qr=class Ps{static of(e){return new Ps(Je(e))}static ofEmpty(){return new Ps([])}static ofCount(e=1,t=1){return new Ps(xa.count(e,t))}static ofCycle(e){return new Ps(xa.cycle(e))}static ofRepeat(e){return new Ps(xa.repeat(e))}zipWith(...e){return this.data=F0(this.data,...e),this}zipFilledWith(e,...t){return this.data=cR(e,this.data,...t),this}zipLongestWith(...e){return this.data=dR(this.data,...e),this}zipEqualWith(...e){return this.data=U0(this.data,...e),this}chainWith(...e){return this.data=gR(this.data,...e),this}chunkwiseOverlap(e,t,r=!0){return this.data=iu(this.data,e,t,r),this}chunkwise(e){return this.data=Ey(this.data,e),this}compress(e){return this.data=uy(this.data,e),this}dropWhile(e){return this.data=hy(this.data,e),this}filter(e){return this.data=yy(this.data,e),this}enumerate(){return this.data=Ea(this.data),this}keys(){return this.data=Ry(this.data),this}limit(e){return this.data=Ay(this.data,e),this}map(e){return this.data=ru(this.data,e),this}flatMap(e){return this.data=py(this.data,e),this}flatten(e=1/0){return this.data=zh(this.data,e),this}groupBy(e,t){return this.data=_y(this.data,e,t),this}pairwise(){return this.data=va(this.data),this}runningAverage(e){return this.data=JR(this.data,e),this}runningDifference(e){return this.data=ZR(this.data,e),this}runningMax(e){return this.data=tI(this.data,e),this}runningMin(e){return this.data=iI(this.data,e),this}runningProduct(e){return this.data=sI(this.data,e),this}runningTotal(e){return this.data=By(this.data,e),this}skip(e,t=0){return this.data=Ny(this.data,e,t),this}slice(e=0,t,r=1){return this.data=Ty(this.data,e,t,r),this}takeWhile(e){return this.data=fy(this.data,e),this}values(){return this.data=wy(this.data),this}sort(e){return this.data=Py(this.data,e),this}distinct(e){return this.data=Yh(this.data,e),this}intersectionWith(...e){return this.data=BR(this.data,...e),this}partialIntersectionWith(e,...t){return this.data=Xh(e,this.data,...t),this}symmetricDifferenceWith(...e){return this.data=$R(this.data,...e),this}unionWith(...e){return this.data=qR(this.data,...e),this}cartesianProductWith(...e){return this.data=lI(this.data,...e),this}permutations(e){return this.data=Gy(this.data,e),this}combinations(e){return this.data=qy(this.data,e),this}peek(e){const[t,r]=Kh(this.data,2);this.data=t;for(const n of r)e(n);return this}peekStream(e){const[t,r]=Kh(this.data,2);return this.data=t,e(Ps.of(r)),this}toValue(e,t){return Ni(this,e,t)}toAverage(){return G0(this)}toCount(){return eu(this)}toMax(e){return V0(this,e)}toMin(e){return K0(this,e)}toMinMax(e){return $h(this,e)}toFirst(){return Z0(this)}toFirstAndLast(){return iy(this)}toLast(){return ty(this)}toSum(){return j0(this)}toProduct(){return J0(this)}toRange(){return Y0(this)}allMatch(e){return mR(this,e)}allUnique(){return vR(this)}anyMatch(e){return bR(this,e)}exactlyN(e,t){return SR(this,e,t)}isSorted(){return RR(this)}isReversed(){return TR(this)}noneMatch(e){return NR(this,e)}sameWith(...e){return wR(this.data,...e)}sameCountWith(...e){return _R(this.data,...e)}tee(e){return Kh(this.data,e).map(t=>new Ps(t))}toArray(){return ya(this)}toMap(){return PR(this)}toSet(){return OR(this)}*[Symbol.iterator](){for(const e of this.data)yield e}constructor(e){this.data=e}};var Pt=function(i,e,t,r){function n(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function o(h){try{u(r.next(h))}catch(d){a(d)}}function l(h){try{u(r.throw(h))}catch(d){a(d)}}function u(h){h.done?s(h.value):n(h.value).then(o,l)}u((r=r.apply(i,e||[])).next())})},Vy=function(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=i[Symbol.asyncIterator],t;return e?e.call(i):(i=typeof __values=="function"?__values(i):i[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(s){t[s]=i[s]&&function(a){return new Promise(function(o,l){a=i[s](a),n(o,l,a.done,a.value)})}}function n(s,a,o,l){Promise.resolve(l).then(function(u){s({value:u,done:o})},a)}},Sa=function(i){return this instanceof Sa?(this.v=i,this):new Sa(i)},dI=function(i,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(i,e||[]),n,s=[];return n=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),o("next"),o("throw"),o("return",a),n[Symbol.asyncIterator]=function(){return this},n;function a(g){return function(m){return Promise.resolve(m).then(g,d)}}function o(g,m){r[g]&&(n[g]=function(v){return new Promise(function(E,A){s.push([g,v,E,A])>1||l(g,v)})},m&&(n[g]=m(n[g])))}function l(g,m){try{u(r[g](m))}catch(v){p(s[0][3],v)}}function u(g){g.value instanceof Sa?Promise.resolve(g.value.v).then(h,d):p(s[0][2],g)}function h(g){l("next",g)}function d(g){l("throw",g)}function p(g,m){g(m),s.shift(),s.length&&l(s[0][0],s[0][1])}};class En{static of(e){return new En(Ye(e))}static ofEmpty(){return new En(Ye([]))}static ofCount(e=1,t=1){return new En(Ye(xa.count(e,t)))}static ofCycle(e){return new En(xa.cycleAsync(e))}static ofRepeat(e){return new En(Ye(xa.repeat(e)))}zipWith(...e){return this.data=B0(this.data,...e),this}zipFilledWith(e,...t){return this.data=hR(e,this.data,...t),this}zipLongestWith(...e){return this.data=fR(this.data,...e),this}zipEqualWith(...e){return this.data=$0(this.data,...e),this}chainWith(...e){return this.data=pR(this.data,...e),this}chunkwiseOverlap(e,t,r=!0){return this.data=nu(this.data,e,t,r),this}chunkwise(e){return this.data=by(this.data,e),this}compress(e){return this.data=cy(this.data,e),this}dropWhile(e){return this.data=dy(this.data,e),this}filter(e){return this.data=vy(this.data,e),this}enumerate(){return this.data=xy(this.data),this}keys(){return this.data=Iy(this.data),this}limit(e){return this.data=Sy(this.data,e),this}map(e){return this.data=Fo(this.data,e),this}flatMap(e){return this.data=my(this.data,e),this}flatten(e=1/0){return this.data=Jh(this.data,e),this}groupBy(e,t){return this.data=My(this.data,e,t),this}pairwise(){return this.data=su(this.data),this}runningAverage(e){return this.data=QR(this.data,e),this}runningDifference(e){return this.data=eI(this.data,e),this}runningMax(e){return this.data=rI(this.data,e),this}runningMin(e){return this.data=nI(this.data,e),this}runningProduct(e){return this.data=aI(this.data,e),this}runningTotal(e){return this.data=Uy(this.data,e),this}skip(e,t=0){return this.data=Cy(this.data,e,t),this}slice(e=0,t,r=1){return this.data=Dy(this.data,e,t,r),this}takeWhile(e){return this.data=gy(this.data,e),this}values(){return this.data=Ly(this.data),this}sort(e){return this.data=ky(this.data,e),this}distinct(e){return this.data=ly(this.data,e),this}intersectionWith(...e){return this.data=UR(this.data,...e),this}partialIntersectionWith(e,...t){return this.data=jh(e,this.data,...t),this}symmetricDifferenceWith(...e){return this.data=GR(this.data,...e),this}unionWith(...e){return this.data=VR(this.data,...e),this}cartesianProductWith(...e){return this.data=uI(this.data,...e),this}permutations(e){return this.data=cI(this.data,e),this}combinations(e){return this.data=hI(this.data,e),this}peek(e){const[t,r]=Wh(this.data,2);return this.data=t,Pt(this,void 0,void 0,function*(){var n,s,a,o;try{for(var l=!0,u=Vy(r),h;h=yield u.next(),n=h.done,!n;l=!0)o=h.value,l=!1,e(o)}catch(d){s={error:d}}finally{try{!l&&!n&&(a=u.return)&&(yield a.call(u))}finally{if(s)throw s.error}}}),this}peekStream(e){const[t,r]=Wh(this.data,2);return this.data=t,e(En.of(r)),this}toValue(e,t){return Pt(this,void 0,void 0,function*(){return yield Ci(this,e,t)})}toAverage(){return Pt(this,void 0,void 0,function*(){return yield q0(this)})}toCount(){return Pt(this,void 0,void 0,function*(){return yield qh(this)})}toMax(e){return Pt(this,void 0,void 0,function*(){return yield H0(this,e)})}toMin(e){return Pt(this,void 0,void 0,function*(){return yield W0(this,e)})}toMinMax(e){return Pt(this,void 0,void 0,function*(){return yield Gh(this,e)})}toFirst(){return Pt(this,void 0,void 0,function*(){return yield ey(this)})}toFirstAndLast(){return Pt(this,void 0,void 0,function*(){return yield ny(this)})}toLast(){return Pt(this,void 0,void 0,function*(){return yield ry(this)})}toSum(){return Pt(this,void 0,void 0,function*(){return yield z0(this)})}toProduct(){return Pt(this,void 0,void 0,function*(){return yield Q0(this)})}toRange(){return Pt(this,void 0,void 0,function*(){return yield X0(this)})}allMatch(e){return Pt(this,void 0,void 0,function*(){return yield yR(this,e)})}allUnique(){return Pt(this,void 0,void 0,function*(){return yield ER(this)})}anyMatch(e){return Pt(this,void 0,void 0,function*(){return yield AR(this,e)})}exactlyN(e,t){return Pt(this,void 0,void 0,function*(){return xR(this,e,t)})}isSorted(){return Pt(this,void 0,void 0,function*(){return yield IR(this)})}isReversed(){return Pt(this,void 0,void 0,function*(){return yield DR(this)})}noneMatch(e){return Pt(this,void 0,void 0,function*(){return yield CR(this,e)})}sameWith(...e){return Pt(this,void 0,void 0,function*(){return yield LR(this.data,...e)})}sameCountWith(...e){return Pt(this,void 0,void 0,function*(){return yield MR(this.data,...e)})}tee(e){return Wh(this.data,e).map(t=>new En(t))}toArray(){return Pt(this,void 0,void 0,function*(){return yield Bs(this)})}toMap(){return Pt(this,void 0,void 0,function*(){return yield kR(this)})}toSet(){return Pt(this,void 0,void 0,function*(){return yield FR(this)})}[Symbol.asyncIterator](){return dI(this,arguments,function*(){var t,r,n,s;try{for(var a=!0,o=Vy(this.data),l;l=yield Sa(o.next()),t=l.done,!t;a=!0)s=l.value,a=!1,yield yield Sa(s)}catch(u){r={error:u}}finally{try{!a&&!t&&(n=o.return)&&(yield Sa(n.call(o)))}finally{if(r)throw r.error}}})}constructor(e){this.data=e}}const ed={chunkwise:Ey,chunkwiseOverlap:iu,compress:uy,dropWhile:hy,enumerate:Ea,filter:yy,flatMap:py,flatten:zh,groupBy:_y,keys:Ry,limit:Ay,map:ru,pairwise:va,repeat:HR,skip:Ny,slice:Ty,sort:Py,takeWhile:fy,values:wy,chunkwiseAsync:by,chunkwiseOverlapAsync:nu,compressAsync:cy,dropWhileAsync:dy,enumerateAsync:xy,filterAsync:vy,flatMapAsync:my,flattenAsync:Jh,groupByAsync:My,keysAsync:Iy,limitAsync:Sy,mapAsync:Fo,pairwiseAsync:su,repeatAsync:KR,skipAsync:Cy,sliceAsync:Dy,sortAsync:ky,takeWhileAsync:gy,valuesAsync:Ly},xa={count:XR,cycle:Fy,cycleAsync:jR,repeat:zR},Hy={toAverage:G0,toCount:eu,toFirst:Z0,toFirstAndLast:iy,toLast:ty,toMax:V0,toMin:K0,toMinMax:$h,toProduct:J0,toRange:Y0,toSum:j0,toValue:Ni,toAverageAsync:q0,toCountAsync:qh,toFirstAsync:ey,toFirstAndLastAsync:ny,toLastAsync:ry,toMaxAsync:H0,toMinAsync:W0,toMinMaxAsync:Gh,toProductAsync:Q0,toRangeAsync:X0,toSumAsync:z0,toValueAsync:Ci};var fI={763:()=>{}},Ky={};function Us(i){var e=Ky[i];if(e!==void 0)return e.exports;var t=Ky[i]={exports:{}};return fI[i](t,t.exports,Us),t.exports}Us.d=(i,e)=>{for(var t in e)Us.o(e,t)&&!Us.o(i,t)&&Object.defineProperty(i,t,{enumerable:!0,get:e[t]})},Us.o=(i,e)=>Object.prototype.hasOwnProperty.call(i,e);var ut={};Us.d(ut,{MG:()=>kt,fr:()=>bd,sR:()=>mv,Zo:()=>qs,iH:()=>bv,rt:()=>xn,jB:()=>Sv,M8:()=>fv,$t:()=>pu,aq:()=>pv,pG:()=>qo,eP:()=>Rd,KU:()=>Ca,zW:()=>Nd,IX:()=>dt,mY:()=>gi,a7:()=>lu,JG:()=>Ut,ay:()=>$t,X2:()=>fu,WU:()=>Dd,Uw:()=>gv,gw:()=>gu,iX:()=>Cd,re:()=>cv,Pg:()=>wd,tD:()=>hv,R$:()=>rr,Dj:()=>Tn,m7:()=>$s,NZ:()=>Bo,xo:()=>Yi,ou:()=>Ee,qC:()=>mu,mD:()=>bn,Ay:()=>GI});let Ee=class{constructor(){this.source=null,this.type=null,this.channel=null,this.start=null,this.stop=null,this.tokenIndex=null,this.line=null,this.column=null,this._text=null}getTokenSource(){return this.source[0]}getInputStream(){return this.source[1]}get text(){return this._text}set text(e){this._text=e}};function Ta(i,e){if(!Array.isArray(i)||!Array.isArray(e))return!1;if(i===e)return!0;if(i.length!==e.length)return!1;for(let t=0;t<i.length;t++)if(!(i[t]===e[t]||i[t].equals&&i[t].equals(e[t])))return!1;return!0}Ee.INVALID_TYPE=0,Ee.EPSILON=-2,Ee.MIN_USER_TOKEN_TYPE=1,Ee.EOF=-1,Ee.DEFAULT_CHANNEL=0,Ee.HIDDEN_CHANNEL=1;const gI=Math.round(Math.random()*Math.pow(2,32));function Wy(i){if(!i)return 0;const e=typeof i,t=e==="string"?i:!(e!=="object"||!i.toString)&&i.toString();if(!t)return 0;let r,n;const s=3&t.length,a=t.length-s;let o=gI;const l=3432918353,u=461845907;let h=0;for(;h<a;)n=255&t.charCodeAt(h)|(255&t.charCodeAt(++h))<<8|(255&t.charCodeAt(++h))<<16|(255&t.charCodeAt(++h))<<24,++h,n=(65535&n)*l+(((n>>>16)*l&65535)<<16)&4294967295,n=n<<15|n>>>17,n=(65535&n)*u+(((n>>>16)*u&65535)<<16)&4294967295,o^=n,o=o<<13|o>>>19,r=5*(65535&o)+((5*(o>>>16)&65535)<<16)&4294967295,o=27492+(65535&r)+((58964+(r>>>16)&65535)<<16);switch(n=0,s){case 3:n^=(255&t.charCodeAt(h+2))<<16;case 2:n^=(255&t.charCodeAt(h+1))<<8;case 1:n^=255&t.charCodeAt(h),n=(65535&n)*l+(((n>>>16)*l&65535)<<16)&4294967295,n=n<<15|n>>>17,n=(65535&n)*u+(((n>>>16)*u&65535)<<16)&4294967295,o^=n}return o^=t.length,o^=o>>>16,o=2246822507*(65535&o)+((2246822507*(o>>>16)&65535)<<16)&4294967295,o^=o>>>13,o=3266489909*(65535&o)+((3266489909*(o>>>16)&65535)<<16)&4294967295,o^=o>>>16,o>>>0}class Zr{constructor(){this.count=0,this.hash=0}update(){for(let e=0;e<arguments.length;e++){const t=arguments[e];if(t!=null)if(Array.isArray(t))this.update.apply(this,t);else{let r=0;switch(typeof t){case"undefined":case"function":continue;case"number":case"boolean":r=t;break;case"string":r=Wy(t);break;default:t.updateHashCode?t.updateHashCode(this):console.log("No updateHashCode for "+t.toString());continue}r*=3432918353,r=r<<15|r>>>17,r*=461845907,this.count=this.count+1;let n=this.hash^r;n=n<<13|n>>>19,n=5*n+3864292196,this.hash=n}}}finish(){let e=this.hash^4*this.count;return e^=e>>>16,e*=2246822507,e^=e>>>13,e*=3266489909,e^=e>>>16,e}static hashStuff(){const e=new Zr;return e.update.apply(e,arguments),e.finish()}}function Yy(i){return i?typeof i=="string"?Wy(i):i.hashCode():-1}function Xy(i,e){return i&&i.equals?i.equals(e):i===e}function pI(i){return i===null?"null":i}function bn(i){return Array.isArray(i)?"["+i.map(pI).join(", ")+"]":"null"}let ei=class{constructor(e,t){this.buckets=new Array(16),this.threshold=Math.floor(12),this.itemCount=0,this.hashFunction=e||Yy,this.equalsFunction=t||Xy}get(e){if(e==null)return e;const t=this._getBucket(e);if(!t)return null;for(const r of t)if(this.equalsFunction(r,e))return r;return null}add(e){return this.getOrAdd(e)===e}getOrAdd(e){this._expand();const t=this._getSlot(e);let r=this.buckets[t];if(!r)return r=[e],this.buckets[t]=r,this.itemCount++,e;for(const n of r)if(this.equalsFunction(n,e))return n;return r.push(e),this.itemCount++,e}has(e){return this.get(e)!=null}values(){return this.buckets.filter(e=>e!=null).flat(1)}toString(){return bn(this.values())}get length(){return this.itemCount}_getSlot(e){return this.hashFunction(e)&this.buckets.length-1}_getBucket(e){return this.buckets[this._getSlot(e)]}_expand(){if(this.itemCount<=this.threshold)return;const e=this.buckets,t=2*this.buckets.length;this.buckets=new Array(t),this.threshold=Math.floor(.75*t);for(const r of e)if(r)for(const n of r){const s=this._getSlot(n);let a=this.buckets[s];a||(a=[],this.buckets[s]=a),a.push(n)}}};class pt{hashCode(){const e=new Zr;return this.updateHashCode(e),e.finish()}evaluate(e,t){}evalPrecedence(e,t){return this}static andContext(e,t){if(e===null||e===pt.NONE)return t;if(t===null||t===pt.NONE)return e;const r=new mI(e,t);return r.opnds.length===1?r.opnds[0]:r}static orContext(e,t){if(e===null)return t;if(t===null)return e;if(e===pt.NONE||t===pt.NONE)return pt.NONE;const r=new yI(e,t);return r.opnds.length===1?r.opnds[0]:r}}let mI=class mh extends pt{constructor(e,t){super();const r=new ei;e instanceof mh?e.opnds.map(function(s){r.add(s)}):r.add(e),t instanceof mh?t.opnds.map(function(s){r.add(s)}):r.add(t);const n=jy(r);if(n.length>0){let s=null;n.map(function(a){(s===null||a.precedence<s.precedence)&&(s=a)}),r.add(s)}this.opnds=Array.from(r.values())}equals(e){return this===e||e instanceof mh&&Ta(this.opnds,e.opnds)}updateHashCode(e){e.update(this.opnds,"AND")}evaluate(e,t){for(let r=0;r<this.opnds.length;r++)if(!this.opnds[r].evaluate(e,t))return!1;return!0}evalPrecedence(e,t){let r=!1;const n=[];for(let a=0;a<this.opnds.length;a++){const o=this.opnds[a],l=o.evalPrecedence(e,t);if(r|=l!==o,l===null)return null;l!==pt.NONE&&n.push(l)}if(!r)return this;if(n.length===0)return pt.NONE;let s=null;return n.map(function(a){s=s===null?a:pt.andContext(s,a)}),s}toString(){const e=this.opnds.map(t=>t.toString());return(e.length>3?e.slice(3):e).join("&&")}},yI=class yh extends pt{constructor(e,t){super();const r=new ei;e instanceof yh?e.opnds.map(function(s){r.add(s)}):r.add(e),t instanceof yh?t.opnds.map(function(s){r.add(s)}):r.add(t);const n=jy(r);if(n.length>0){const s=n.sort(function(o,l){return o.compareTo(l)}),a=s[s.length-1];r.add(a)}this.opnds=Array.from(r.values())}equals(e){return this===e||e instanceof yh&&Ta(this.opnds,e.opnds)}updateHashCode(e){e.update(this.opnds,"OR")}evaluate(e,t){for(let r=0;r<this.opnds.length;r++)if(this.opnds[r].evaluate(e,t))return!0;return!1}evalPrecedence(e,t){let r=!1;const n=[];for(let s=0;s<this.opnds.length;s++){const a=this.opnds[s],o=a.evalPrecedence(e,t);if(r|=o!==a,o===pt.NONE)return pt.NONE;o!==null&&n.push(o)}return r?(n.length===0,null):this}toString(){const e=this.opnds.map(t=>t.toString());return(e.length>3?e.slice(3):e).join("||")}};function jy(i){const e=[];return i.values().map(function(t){t instanceof pt.PrecedencePredicate&&e.push(t)}),e}function zy(i,e){if(i===null){const t={state:null,alt:null,context:null,semanticContext:null};return e&&(t.reachesIntoOuterContext=0),t}{const t={};return t.state=i.state||null,t.alt=i.alt===void 0?null:i.alt,t.context=i.context||null,t.semanticContext=i.semanticContext||null,e&&(t.reachesIntoOuterContext=i.reachesIntoOuterContext||0,t.precedenceFilterSuppressed=i.precedenceFilterSuppressed||!1),t}}class Xt{constructor(e,t){this.checkContext(e,t),e=zy(e),t=zy(t,!0),this.state=e.state!==null?e.state:t.state,this.alt=e.alt!==null?e.alt:t.alt,this.context=e.context!==null?e.context:t.context,this.semanticContext=e.semanticContext!==null?e.semanticContext:t.semanticContext!==null?t.semanticContext:pt.NONE,this.reachesIntoOuterContext=t.reachesIntoOuterContext,this.precedenceFilterSuppressed=t.precedenceFilterSuppressed}checkContext(e,t){e.context!==null&&e.context!==void 0||t!==null&&t.context!==null&&t.context!==void 0||(this.context=null)}hashCode(){const e=new Zr;return this.updateHashCode(e),e.finish()}updateHashCode(e){e.update(this.state.stateNumber,this.alt,this.context,this.semanticContext)}equals(e){return this===e||e instanceof Xt&&this.state.stateNumber===e.state.stateNumber&&this.alt===e.alt&&(this.context===null?e.context===null:this.context.equals(e.context))&&this.semanticContext.equals(e.semanticContext)&&this.precedenceFilterSuppressed===e.precedenceFilterSuppressed}hashCodeForConfigSet(){const e=new Zr;return e.update(this.state.stateNumber,this.alt,this.semanticContext),e.finish()}equalsForConfigSet(e){return this===e||e instanceof Xt&&this.state.stateNumber===e.state.stateNumber&&this.alt===e.alt&&this.semanticContext.equals(e.semanticContext)}toString(){return"("+this.state+","+this.alt+(this.context!==null?",["+this.context.toString()+"]":"")+(this.semanticContext!==pt.NONE?","+this.semanticContext.toString():"")+(this.reachesIntoOuterContext>0?",up="+this.reachesIntoOuterContext:"")+")"}}let dt=class BT{constructor(e,t){this.start=e,this.stop=t}clone(){return new BT(this.start,this.stop)}contains(e){return e>=this.start&&e<this.stop}toString(){return this.start===this.stop-1?this.start.toString():this.start.toString()+".."+(this.stop-1).toString()}get length(){return this.stop-this.start}};dt.INVALID_INTERVAL=new dt(-1,-2);let gi=class UT{constructor(){this.intervals=null,this.readOnly=!1}first(e){return this.intervals===null||this.intervals.length===0?Ee.INVALID_TYPE:this.intervals[0].start}addOne(e){this.addInterval(new dt(e,e+1))}addRange(e,t){this.addInterval(new dt(e,t+1))}addInterval(e){if(this.intervals===null)this.intervals=[],this.intervals.push(e.clone());else{for(let t=0;t<this.intervals.length;t++){const r=this.intervals[t];if(e.stop<r.start)return void this.intervals.splice(t,0,e);if(e.stop===r.start)return void(this.intervals[t]=new dt(e.start,r.stop));if(e.start<=r.stop)return this.intervals[t]=new dt(Math.min(r.start,e.start),Math.max(r.stop,e.stop)),void this.reduce(t)}this.intervals.push(e.clone())}}addSet(e){return e.intervals!==null&&e.intervals.forEach(t=>this.addInterval(t),this),this}reduce(e){if(e<this.intervals.length-1){const t=this.intervals[e],r=this.intervals[e+1];t.stop>=r.stop?(this.intervals.splice(e+1,1),this.reduce(e)):t.stop>=r.start&&(this.intervals[e]=new dt(t.start,r.stop),this.intervals.splice(e+1,1))}}complement(e,t){const r=new UT;return r.addInterval(new dt(e,t+1)),this.intervals!==null&&this.intervals.forEach(n=>r.removeRange(n)),r}contains(e){if(this.intervals===null)return!1;for(let t=0;t<this.intervals.length;t++)if(this.intervals[t].contains(e))return!0;return!1}removeRange(e){if(e.start===e.stop-1)this.removeOne(e.start);else if(this.intervals!==null){let t=0;for(let r=0;r<this.intervals.length;r++){const n=this.intervals[t];if(e.stop<=n.start)return;if(e.start>n.start&&e.stop<n.stop){this.intervals[t]=new dt(n.start,e.start);const s=new dt(e.stop,n.stop);return void this.intervals.splice(t,0,s)}e.start<=n.start&&e.stop>=n.stop?(this.intervals.splice(t,1),t-=1):e.start<n.stop?this.intervals[t]=new dt(n.start,e.start):e.stop<n.stop&&(this.intervals[t]=new dt(e.stop,n.stop)),t+=1}}}removeOne(e){if(this.intervals!==null)for(let t=0;t<this.intervals.length;t++){const r=this.intervals[t];if(e<r.start)return;if(e===r.start&&e===r.stop-1)return void this.intervals.splice(t,1);if(e===r.start)return void(this.intervals[t]=new dt(r.start+1,r.stop));if(e===r.stop-1)return void(this.intervals[t]=new dt(r.start,r.stop-1));if(e<r.stop-1){const n=new dt(r.start,e);return r.start=e+1,void this.intervals.splice(t,0,n)}}}toString(e,t,r){return e=e||null,t=t||null,r=r||!1,this.intervals===null?"{}":e!==null||t!==null?this.toTokenString(e,t):r?this.toCharString():this.toIndexString()}toCharString(){const e=[];for(let t=0;t<this.intervals.length;t++){const r=this.intervals[t];r.stop===r.start+1?r.start===Ee.EOF?e.push("<EOF>"):e.push("'"+String.fromCharCode(r.start)+"'"):e.push("'"+String.fromCharCode(r.start)+"'..'"+String.fromCharCode(r.stop-1)+"'")}return e.length>1?"{"+e.join(", ")+"}":e[0]}toIndexString(){const e=[];for(let t=0;t<this.intervals.length;t++){const r=this.intervals[t];r.stop===r.start+1?r.start===Ee.EOF?e.push("<EOF>"):e.push(r.start.toString()):e.push(r.start.toString()+".."+(r.stop-1).toString())}return e.length>1?"{"+e.join(", ")+"}":e[0]}toTokenString(e,t){const r=[];for(let n=0;n<this.intervals.length;n++){const s=this.intervals[n];for(let a=s.start;a<s.stop;a++)r.push(this.elementName(e,t,a))}return r.length>1?"{"+r.join(", ")+"}":r[0]}elementName(e,t,r){return r===Ee.EOF?"<EOF>":r===Ee.EPSILON?"<EPSILON>":e[r]||t[r]}get length(){return this.intervals.map(e=>e.length).reduce((e,t)=>e+t)}};class Oe{constructor(){this.atn=null,this.stateNumber=Oe.INVALID_STATE_NUMBER,this.stateType=null,this.ruleIndex=0,this.epsilonOnlyTransitions=!1,this.transitions=[],this.nextTokenWithinRule=null}toString(){return this.stateNumber}equals(e){return e instanceof Oe&&this.stateNumber===e.stateNumber}isNonGreedyExitState(){return!1}addTransition(e,t){t===void 0&&(t=-1),this.transitions.length===0?this.epsilonOnlyTransitions=e.isEpsilon:this.epsilonOnlyTransitions!==e.isEpsilon&&(this.epsilonOnlyTransitions=!1),t===-1?this.transitions.push(e):this.transitions.splice(t,1,e)}}Oe.INVALID_TYPE=0,Oe.BASIC=1,Oe.RULE_START=2,Oe.BLOCK_START=3,Oe.PLUS_BLOCK_START=4,Oe.STAR_BLOCK_START=5,Oe.TOKEN_START=6,Oe.RULE_STOP=7,Oe.BLOCK_END=8,Oe.STAR_LOOP_BACK=9,Oe.STAR_LOOP_ENTRY=10,Oe.PLUS_LOOP_BACK=11,Oe.LOOP_END=12,Oe.serializationNames=["INVALID","BASIC","RULE_START","BLOCK_START","PLUS_BLOCK_START","STAR_BLOCK_START","TOKEN_START","RULE_STOP","BLOCK_END","STAR_LOOP_BACK","STAR_LOOP_ENTRY","PLUS_LOOP_BACK","LOOP_END"],Oe.INVALID_STATE_NUMBER=-1;class Mr extends Oe{constructor(){return super(),this.stateType=Oe.RULE_STOP,this}}class Me{constructor(e){if(e==null)throw"target cannot be null.";this.target=e,this.isEpsilon=!1,this.label=null}}Me.EPSILON=1,Me.RANGE=2,Me.RULE=3,Me.PREDICATE=4,Me.ATOM=5,Me.ACTION=6,Me.SET=7,Me.NOT_SET=8,Me.WILDCARD=9,Me.PRECEDENCE=10,Me.serializationNames=["INVALID","EPSILON","RANGE","RULE","PREDICATE","ATOM","ACTION","SET","NOT_SET","WILDCARD","PRECEDENCE"],Me.serializationTypes={EpsilonTransition:Me.EPSILON,RangeTransition:Me.RANGE,RuleTransition:Me.RULE,PredicateTransition:Me.PREDICATE,AtomTransition:Me.ATOM,ActionTransition:Me.ACTION,SetTransition:Me.SET,NotSetTransition:Me.NOT_SET,WildcardTransition:Me.WILDCARD,PrecedencePredicateTransition:Me.PRECEDENCE};class au extends Me{constructor(e,t,r,n){super(e),this.ruleIndex=t,this.precedence=r,this.followState=n,this.serializationType=Me.RULE,this.isEpsilon=!0}matches(e,t,r){return!1}}let td=class extends Me{constructor(e,t){super(e),this.serializationType=Me.SET,t!=null?this.label=t:(this.label=new gi,this.label.addOne(Ee.INVALID_TYPE))}matches(e,t,r){return this.label.contains(e)}toString(){return this.label.toString()}},rd=class extends td{constructor(e,t){super(e,t),this.serializationType=Me.NOT_SET}matches(e,t,r){return e>=t&&e<=r&&!super.matches(e,t,r)}toString(){return"~"+super.toString()}};class Jy extends Me{constructor(e){super(e),this.serializationType=Me.WILDCARD}matches(e,t,r){return e>=t&&e<=r}toString(){return"."}}class id extends Me{constructor(e){super(e)}}class vI{}class EI extends vI{}let Qy=class extends EI{},Bo=class extends Qy{get ruleContext(){throw new Error("missing interface implementation")}},Yi=class extends Qy{},ou=class extends Yi{};const An={toStringTree:function(i,e,t){e=e||null,(t=t||null)!==null&&(e=t.ruleNames);let r=An.getNodeText(i,e);r=function(a){return a=a.replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r")}(r);const n=i.getChildCount();if(n===0)return r;let s="("+r+" ";n>0&&(r=An.toStringTree(i.getChild(0),e),s=s.concat(r));for(let a=1;a<n;a++)r=An.toStringTree(i.getChild(a),e),s=s.concat(" "+r);return s=s.concat(")"),s},getNodeText:function(i,e,t){if(e=e||null,(t=t||null)!==null&&(e=t.ruleNames),e!==null){if(i instanceof Bo){const n=i.ruleContext.getAltNumber();return n!=0?e[i.ruleIndex]+":"+n:e[i.ruleIndex]}if(i instanceof ou)return i.toString();if(i instanceof Yi&&i.symbol!==null)return i.symbol.text}const r=i.getPayload();return r instanceof Ee?r.text:i.getPayload().toString()},getChildren:function(i){const e=[];for(let t=0;t<i.getChildCount();t++)e.push(i.getChild(t));return e},getAncestors:function(i){let e=[];for(i=i.getParent();i!==null;)e=[i].concat(e),i=i.getParent();return e},findAllTokenNodes:function(i,e){return An.findAllNodes(i,e,!0)},findAllRuleNodes:function(i,e){return An.findAllNodes(i,e,!1)},findAllNodes:function(i,e,t){const r=[];return An._findAllNodes(i,e,t,r),r},_findAllNodes:function(i,e,t,r){t&&i instanceof Yi?i.symbol.type===e&&r.push(i):!t&&i instanceof Bo&&i.ruleIndex===e&&r.push(i);for(let n=0;n<i.getChildCount();n++)An._findAllNodes(i.getChild(n),e,t,r)},descendants:function(i){let e=[i];for(let t=0;t<i.getChildCount();t++)e=e.concat(An.descendants(i.getChild(t)));return e}},Zy=An;class $s extends Bo{constructor(e,t){super(),this.parentCtx=e||null,this.invokingState=t||-1}depth(){let e=0,t=this;for(;t!==null;)t=t.parentCtx,e+=1;return e}isEmpty(){return this.invokingState===-1}getSourceInterval(){return dt.INVALID_INTERVAL}get ruleContext(){return this}getPayload(){return this}getText(){return this.getChildCount()===0?"":this.children.map(function(e){return e.getText()}).join("")}getAltNumber(){return 0}setAltNumber(e){}getChild(e){return null}getChildCount(){return 0}accept(e){return e.visitChildren(this)}toStringTree(e,t){return Zy.toStringTree(this,e,t)}toString(e,t){e=e||null,t=t||null;let r=this,n="[";for(;r!==null&&r!==t;){if(e===null)r.isEmpty()||(n+=r.invokingState);else{const s=r.ruleIndex;n+=s>=0&&s<e.length?e[s]:""+s}r.parentCtx===null||e===null&&r.parentCtx.isEmpty()||(n+=" "),r=r.parentCtx}return n+="]",n}}class We{constructor(e){this.cachedHashCode=e}isEmpty(){return this===We.EMPTY}hasEmptyPath(){return this.getReturnState(this.length-1)===We.EMPTY_RETURN_STATE}hashCode(){return this.cachedHashCode}updateHashCode(e){e.update(this.cachedHashCode)}}We.EMPTY=null,We.EMPTY_RETURN_STATE=2147483647,We.globalNodeCount=1,We.id=We.globalNodeCount,We.trace_atn_sim=!1;class Xi extends We{constructor(e,t){const r=new Zr;return r.update(e,t),super(r.finish()),this.parents=e,this.returnStates=t,this}isEmpty(){return this.returnStates[0]===We.EMPTY_RETURN_STATE}getParent(e){return this.parents[e]}getReturnState(e){return this.returnStates[e]}equals(e){return this===e||e instanceof Xi&&this.hashCode()===e.hashCode()&&Ta(this.returnStates,e.returnStates)&&Ta(this.parents,e.parents)}toString(){if(this.isEmpty())return"[]";{let e="[";for(let t=0;t<this.returnStates.length;t++)t>0&&(e+=", "),this.returnStates[t]!==We.EMPTY_RETURN_STATE?(e+=this.returnStates[t],this.parents[t]!==null?e=e+" "+this.parents[t]:e+="null"):e+="$";return e+"]"}}get length(){return this.returnStates.length}}class Pr extends We{constructor(e,t){let r=0;const n=new Zr;e!==null?n.update(e,t):n.update(1),r=n.finish(),super(r),this.parentCtx=e,this.returnState=t}getParent(e){return this.parentCtx}getReturnState(e){return this.returnState}equals(e){return this===e||e instanceof Pr&&this.hashCode()===e.hashCode()&&this.returnState===e.returnState&&(this.parentCtx==null?e.parentCtx==null:this.parentCtx.equals(e.parentCtx))}toString(){const e=this.parentCtx===null?"":this.parentCtx.toString();return e.length===0?this.returnState===We.EMPTY_RETURN_STATE?"$":""+this.returnState:this.returnState+" "+e}get length(){return 1}static create(e,t){return t===We.EMPTY_RETURN_STATE&&e===null?We.EMPTY:new Pr(e,t)}}let nd=class extends Pr{constructor(){super(null,We.EMPTY_RETURN_STATE)}isEmpty(){return!0}getParent(e){return null}getReturnState(e){return this.returnState}equals(e){return this===e}toString(){return"$"}};We.EMPTY=new nd;class Uo{constructor(e,t){this.buckets=new Array(16),this.threshold=Math.floor(12),this.itemCount=0,this.hashFunction=e||Yy,this.equalsFunction=t||Xy}set(e,t){this._expand();const r=this._getSlot(e);let n=this.buckets[r];if(!n)return n=[[e,t]],this.buckets[r]=n,this.itemCount++,t;const s=n.find(a=>this.equalsFunction(a[0],e),this);if(s){const a=s[1];return s[1]=t,a}return n.push([e,t]),this.itemCount++,t}containsKey(e){const t=this._getBucket(e);return!!t&&!!t.find(r=>this.equalsFunction(r[0],e),this)}get(e){const t=this._getBucket(e);if(!t)return null;const r=t.find(n=>this.equalsFunction(n[0],e),this);return r?r[1]:null}entries(){return this.buckets.filter(e=>e!=null).flat(1)}getKeys(){return this.entries().map(e=>e[0])}getValues(){return this.entries().map(e=>e[1])}toString(){return"["+this.entries().map(e=>"{"+e[0]+":"+e[1]+"}").join(", ")+"]"}get length(){return this.itemCount}_getSlot(e){return this.hashFunction(e)&this.buckets.length-1}_getBucket(e){return this.buckets[this._getSlot(e)]}_expand(){if(this.itemCount<=this.threshold)return;const e=this.buckets,t=2*this.buckets.length;this.buckets=new Array(t),this.threshold=Math.floor(.75*t);for(const r of e)if(r)for(const n of r){const s=this._getSlot(n[0]);let a=this.buckets[s];a||(a=[],this.buckets[s]=a),a.push(n)}}}function sd(i,e){if(e==null&&(e=$s.EMPTY),e.parentCtx===null||e===$s.EMPTY)return We.EMPTY;const t=sd(i,e.parentCtx),r=i.states[e.invokingState].transitions[0];return Pr.create(t,r.followState.stateNumber)}function ev(i,e,t){if(i.isEmpty())return i;let r=t.get(i)||null;if(r!==null)return r;if(r=e.get(i),r!==null)return t.set(i,r),r;let n=!1,s=[];for(let o=0;o<s.length;o++){const l=ev(i.getParent(o),e,t);if(n||l!==i.getParent(o)){if(!n){s=[];for(let u=0;u<i.length;u++)s[u]=i.getParent(u);n=!0}s[o]=l}}if(!n)return e.add(i),t.set(i,i),i;let a=null;return a=s.length===0?We.EMPTY:s.length===1?Pr.create(s[0],i.getReturnState(0)):new Xi(s,i.returnStates),e.add(a),t.set(a,a),t.set(i,a),a}function ad(i,e,t,r){if(i===e)return i;if(i instanceof Pr&&e instanceof Pr)return function(n,s,a,o){if(o!==null){let u=o.get(n,s);if(u!==null||(u=o.get(s,n),u!==null))return u}const l=function(u,h,d){if(d){if(u===We.EMPTY||h===We.EMPTY)return We.EMPTY}else{if(u===We.EMPTY&&h===We.EMPTY)return We.EMPTY;if(u===We.EMPTY){const p=[h.returnState,We.EMPTY_RETURN_STATE],g=[h.parentCtx,null];return new Xi(g,p)}if(h===We.EMPTY){const p=[u.returnState,We.EMPTY_RETURN_STATE],g=[u.parentCtx,null];return new Xi(g,p)}}return null}(n,s,a);if(l!==null)return o!==null&&o.set(n,s,l),l;if(n.returnState===s.returnState){const u=ad(n.parentCtx,s.parentCtx,a,o);if(u===n.parentCtx)return n;if(u===s.parentCtx)return s;const h=Pr.create(u,n.returnState);return o!==null&&o.set(n,s,h),h}{let u=null;if((n===s||n.parentCtx!==null&&n.parentCtx===s.parentCtx)&&(u=n.parentCtx),u!==null){const g=[n.returnState,s.returnState];n.returnState>s.returnState&&(g[0]=s.returnState,g[1]=n.returnState);const m=new Xi([u,u],g);return o!==null&&o.set(n,s,m),m}const h=[n.returnState,s.returnState];let d=[n.parentCtx,s.parentCtx];n.returnState>s.returnState&&(h[0]=s.returnState,h[1]=n.returnState,d=[s.parentCtx,n.parentCtx]);const p=new Xi(d,h);return o!==null&&o.set(n,s,p),p}}(i,e,t,r);if(t){if(i instanceof nd)return i;if(e instanceof nd)return e}return i instanceof Pr&&(i=new Xi([i.getParent()],[i.returnState])),e instanceof Pr&&(e=new Xi([e.getParent()],[e.returnState])),function(n,s,a,o){if(o!==null){let m=o.get(n,s);if(m!==null||(m=o.get(s,n),m!==null))return We.trace_atn_sim&&console.log("mergeArrays a="+n+",b="+s+" -> previous"),m}let l=0,u=0,h=0,d=new Array(n.returnStates.length+s.returnStates.length).fill(0),p=new Array(n.returnStates.length+s.returnStates.length).fill(null);for(;l<n.returnStates.length&&u<s.returnStates.length;){const m=n.parents[l],v=s.parents[u];if(n.returnStates[l]===s.returnStates[u]){const E=n.returnStates[l];E===We.EMPTY_RETURN_STATE&&m===null&&v===null||m!==null&&v!==null&&m===v?(p[h]=m,d[h]=E):(p[h]=ad(m,v,a,o),d[h]=E),l+=1,u+=1}else n.returnStates[l]<s.returnStates[u]?(p[h]=m,d[h]=n.returnStates[l],l+=1):(p[h]=v,d[h]=s.returnStates[u],u+=1);h+=1}if(l<n.returnStates.length)for(let m=l;m<n.returnStates.length;m++)p[h]=n.parents[m],d[h]=n.returnStates[m],h+=1;else for(let m=u;m<s.returnStates.length;m++)p[h]=s.parents[m],d[h]=s.returnStates[m],h+=1;if(h<p.length){if(h===1){const m=Pr.create(p[0],d[0]);return o!==null&&o.set(n,s,m),m}p=p.slice(0,h),d=d.slice(0,h)}const g=new Xi(p,d);return g.equals(n)?(o!==null&&o.set(n,s,n),We.trace_atn_sim&&console.log("mergeArrays a="+n+",b="+s+" -> a"),n):g.equals(s)?(o!==null&&o.set(n,s,s),We.trace_atn_sim&&console.log("mergeArrays a="+n+",b="+s+" -> b"),s):(function(m){const v=new Uo;for(let E=0;E<m.length;E++){const A=m[E];v.containsKey(A)||v.set(A,A)}for(let E=0;E<m.length;E++)m[E]=v.get(m[E])}(p),o!==null&&o.set(n,s,g),We.trace_atn_sim&&console.log("mergeArrays a="+n+",b="+s+" -> "+g),g)}(i,e,t,r)}class kr{constructor(){this.data=new Uint32Array(1)}set(e){kr._checkIndex(e),this._resize(e),this.data[e>>>5]|=1<<e%32}get(e){kr._checkIndex(e);const t=e>>>5;return!(t>=this.data.length||!(this.data[t]&1<<e%32))}clear(e){kr._checkIndex(e);const t=e>>>5;t<this.data.length&&(this.data[t]&=~(1<<e))}or(e){const t=Math.min(this.data.length,e.data.length);for(let r=0;r<t;++r)this.data[r]|=e.data[r];if(this.data.length<e.data.length){this._resize((e.data.length<<5)-1);const r=e.data.length;for(let n=t;n<r;++n)this.data[n]=e.data[n]}}values(){const e=new Array(this.length);let t=0;const r=this.data.length;for(let n=0;n<r;++n){let s=this.data[n];for(;s!==0;){const a=s&-s;e[t++]=(n<<5)+kr._bitCount(a-1),s^=a}}return e}minValue(){for(let e=0;e<this.data.length;++e){let t=this.data[e];if(t!==0){let r=0;for(;!(1&t);)r++,t>>=1;return r+32*e}}return 0}hashCode(){return Zr.hashStuff(this.values())}equals(e){return e instanceof kr&&Ta(this.data,e.data)}toString(){return"{"+this.values().join(", ")+"}"}get length(){return this.data.map(e=>kr._bitCount(e)).reduce((e,t)=>e+t,0)}_resize(e){const t=e+32>>>5;if(t<=this.data.length)return;const r=new Uint32Array(t);r.set(this.data),r.fill(0,this.data.length),this.data=r}static _checkIndex(e){if(e<0)throw new RangeError("index cannot be negative")}static _bitCount(e){return e=(e=(858993459&(e-=e>>1&1431655765))+(e>>2&858993459))+(e>>4)&252645135,e+=e>>8,0+(e+=e>>16)&63}}let lu=class zm{constructor(e){this.atn=e}getDecisionLookahead(e){if(e===null)return null;const t=e.transitions.length,r=[];for(let n=0;n<t;n++){r[n]=new gi;const s=new ei;this._LOOK(e.transition(n).target,null,We.EMPTY,r[n],s,new kr,!1,!1),(r[n].length===0||r[n].contains(zm.HIT_PRED))&&(r[n]=null)}return r}LOOK(e,t,r){const n=new gi,s=(r=r||null)!==null?sd(e.atn,r):null;return this._LOOK(e,t,s,n,new ei,new kr,!0,!0),n}_LOOK(e,t,r,n,s,a,o,l){const u=new Xt({state:e,alt:0,context:r},null);if(!s.has(u)){if(s.add(u),e===t){if(r===null)return void n.addOne(Ee.EPSILON);if(r.isEmpty()&&l)return void n.addOne(Ee.EOF)}if(e instanceof Mr){if(r===null)return void n.addOne(Ee.EPSILON);if(r.isEmpty()&&l)return void n.addOne(Ee.EOF);if(r!==We.EMPTY){const h=a.get(e.ruleIndex);try{a.clear(e.ruleIndex);for(let d=0;d<r.length;d++){const p=this.atn.states[r.getReturnState(d)];this._LOOK(p,t,r.getParent(d),n,s,a,o,l)}}finally{h&&a.set(e.ruleIndex)}return}}for(let h=0;h<e.transitions.length;h++){const d=e.transitions[h];if(d.constructor===au){if(a.get(d.target.ruleIndex))continue;const p=Pr.create(r,d.followState.stateNumber);try{a.set(d.target.ruleIndex),this._LOOK(d.target,t,p,n,s,a,o,l)}finally{a.clear(d.target.ruleIndex)}}else if(d instanceof id)o?this._LOOK(d.target,t,r,n,s,a,o,l):n.addOne(zm.HIT_PRED);else if(d.isEpsilon)this._LOOK(d.target,t,r,n,s,a,o,l);else if(d.constructor===Jy)n.addRange(Ee.MIN_USER_TOKEN_TYPE,this.atn.maxTokenType);else{let p=d.label;p!==null&&(d instanceof rd&&(p=p.complement(Ee.MIN_USER_TOKEN_TYPE,this.atn.maxTokenType)),n.addSet(p))}}}}};lu.HIT_PRED=Ee.INVALID_TYPE;let kt=class{constructor(e,t){this.grammarType=e,this.maxTokenType=t,this.states=[],this.decisionToState=[],this.ruleToStartState=[],this.ruleToStopState=null,this.modeNameToStartState={},this.ruleToTokenType=null,this.lexerActions=null,this.modeToStartState=[]}nextTokensInContext(e,t){return new lu(this).LOOK(e,null,t)}nextTokensNoContext(e){return e.nextTokenWithinRule!==null||(e.nextTokenWithinRule=this.nextTokensInContext(e,null),e.nextTokenWithinRule.readOnly=!0),e.nextTokenWithinRule}nextTokens(e,t){return t===void 0?this.nextTokensNoContext(e):this.nextTokensInContext(e,t)}addState(e){e!==null&&(e.atn=this,e.stateNumber=this.states.length),this.states.push(e)}removeState(e){this.states[e.stateNumber]=null}defineDecisionState(e){return this.decisionToState.push(e),e.decision=this.decisionToState.length-1,e.decision}getDecisionState(e){return this.decisionToState.length===0?null:this.decisionToState[e]}getExpectedTokens(e,t){if(e<0||e>=this.states.length)throw"Invalid state number.";const r=this.states[e];let n=this.nextTokens(r);if(!n.contains(Ee.EPSILON))return n;const s=new gi;for(s.addSet(n),s.removeOne(Ee.EPSILON);t!==null&&t.invokingState>=0&&n.contains(Ee.EPSILON);){const a=this.states[t.invokingState].transitions[0];n=this.nextTokens(a.followState),s.addSet(n),s.removeOne(Ee.EPSILON),t=t.parentCtx}return n.contains(Ee.EPSILON)&&s.addOne(Ee.EOF),s}};kt.INVALID_ALT_NUMBER=0;class tv extends Oe{constructor(){super(),this.stateType=Oe.BASIC}}class Da extends Oe{constructor(){return super(),this.decision=-1,this.nonGreedy=!1,this}}class Ra extends Da{constructor(){return super(),this.endState=null,this}}let od=class extends Oe{constructor(){return super(),this.stateType=Oe.BLOCK_END,this.startState=null,this}};class Ia extends Oe{constructor(){return super(),this.stateType=Oe.LOOP_END,this.loopBackState=null,this}}class rv extends Oe{constructor(){return super(),this.stateType=Oe.RULE_START,this.stopState=null,this.isPrecedenceRule=!1,this}}class bI extends Da{constructor(){return super(),this.stateType=Oe.TOKEN_START,this}}class iv extends Da{constructor(){return super(),this.stateType=Oe.PLUS_LOOP_BACK,this}}class ld extends Oe{constructor(){return super(),this.stateType=Oe.STAR_LOOP_BACK,this}}class Gs extends Da{constructor(){return super(),this.stateType=Oe.STAR_LOOP_ENTRY,this.loopBackState=null,this.isPrecedenceDecision=null,this}}class ud extends Ra{constructor(){return super(),this.stateType=Oe.PLUS_BLOCK_START,this.loopBackState=null,this}}class cd extends Ra{constructor(){return super(),this.stateType=Oe.STAR_BLOCK_START,this}}class nv extends Ra{constructor(){return super(),this.stateType=Oe.BLOCK_START,this}}class hd extends Me{constructor(e,t){super(e),this.label_=t,this.label=this.makeLabel(),this.serializationType=Me.ATOM}makeLabel(){const e=new gi;return e.addOne(this.label_),e}matches(e,t,r){return this.label_===e}toString(){return this.label_}}class AI extends Me{constructor(e,t,r){super(e),this.serializationType=Me.RANGE,this.start=t,this.stop=r,this.label=this.makeLabel()}makeLabel(){const e=new gi;return e.addRange(this.start,this.stop),e}matches(e,t,r){return e>=this.start&&e<=this.stop}toString(){return"'"+String.fromCharCode(this.start)+"'..'"+String.fromCharCode(this.stop)+"'"}}class sv extends Me{constructor(e,t,r,n){super(e),this.serializationType=Me.ACTION,this.ruleIndex=t,this.actionIndex=r===void 0?-1:r,this.isCtxDependent=n!==void 0&&n,this.isEpsilon=!0}matches(e,t,r){return!1}toString(){return"action_"+this.ruleIndex+":"+this.actionIndex}}class $o extends Me{constructor(e,t){super(e),this.serializationType=Me.EPSILON,this.isEpsilon=!0,this.outermostPrecedenceReturn=t}matches(e,t,r){return!1}toString(){return"epsilon"}}class uu extends pt{constructor(e,t,r){super(),this.ruleIndex=e===void 0?-1:e,this.predIndex=t===void 0?-1:t,this.isCtxDependent=r!==void 0&&r}evaluate(e,t){const r=this.isCtxDependent?t:null;return e.sempred(r,this.ruleIndex,this.predIndex)}updateHashCode(e){e.update(this.ruleIndex,this.predIndex,this.isCtxDependent)}equals(e){return this===e||e instanceof uu&&this.ruleIndex===e.ruleIndex&&this.predIndex===e.predIndex&&this.isCtxDependent===e.isCtxDependent}toString(){return"{"+this.ruleIndex+":"+this.predIndex+"}?"}}pt.NONE=new uu;class av extends id{constructor(e,t,r,n){super(e),this.serializationType=Me.PREDICATE,this.ruleIndex=t,this.predIndex=r,this.isCtxDependent=n,this.isEpsilon=!0}matches(e,t,r){return!1}getPredicate(){return new uu(this.ruleIndex,this.predIndex,this.isCtxDependent)}toString(){return"pred_"+this.ruleIndex+":"+this.predIndex}}class cu extends pt{constructor(e){super(),this.precedence=e===void 0?0:e}evaluate(e,t){return e.precpred(t,this.precedence)}evalPrecedence(e,t){return e.precpred(t,this.precedence)?pt.NONE:null}compareTo(e){return this.precedence-e.precedence}updateHashCode(e){e.update(this.precedence)}equals(e){return this===e||e instanceof cu&&this.precedence===e.precedence}toString(){return"{"+this.precedence+">=prec}?"}}pt.PrecedencePredicate=cu;class SI extends id{constructor(e,t){super(e),this.serializationType=Me.PRECEDENCE,this.precedence=t,this.isEpsilon=!0}matches(e,t,r){return!1}getPredicate(){return new cu(this.precedence)}toString(){return this.precedence+" >= _p"}}class Go{constructor(e){e===void 0&&(e=null),this.readOnly=!1,this.verifyATN=e===null||e.verifyATN,this.generateRuleBypassTransitions=e!==null&&e.generateRuleBypassTransitions}}Go.defaultOptions=new Go,Go.defaultOptions.readOnly=!0;class Sn{constructor(e){this.actionType=e,this.isPositionDependent=!1}hashCode(){const e=new Zr;return this.updateHashCode(e),e.finish()}updateHashCode(e){e.update(this.actionType)}equals(e){return this===e}}class dd extends Sn{constructor(){super(6)}execute(e){e.skip()}toString(){return"skip"}}dd.INSTANCE=new dd;class fd extends Sn{constructor(e){super(0),this.channel=e}execute(e){e._channel=this.channel}updateHashCode(e){e.update(this.actionType,this.channel)}equals(e){return this===e||e instanceof fd&&this.channel===e.channel}toString(){return"channel("+this.channel+")"}}class gd extends Sn{constructor(e,t){super(1),this.ruleIndex=e,this.actionIndex=t,this.isPositionDependent=!0}execute(e){e.action(null,this.ruleIndex,this.actionIndex)}updateHashCode(e){e.update(this.actionType,this.ruleIndex,this.actionIndex)}equals(e){return this===e||e instanceof gd&&this.ruleIndex===e.ruleIndex&&this.actionIndex===e.actionIndex}}class pd extends Sn{constructor(){super(3)}execute(e){e.more()}toString(){return"more"}}pd.INSTANCE=new pd;class md extends Sn{constructor(e){super(7),this.type=e}execute(e){e.type=this.type}updateHashCode(e){e.update(this.actionType,this.type)}equals(e){return this===e||e instanceof md&&this.type===e.type}toString(){return"type("+this.type+")"}}class yd extends Sn{constructor(e){super(5),this.mode=e}execute(e){e.pushMode(this.mode)}updateHashCode(e){e.update(this.actionType,this.mode)}equals(e){return this===e||e instanceof yd&&this.mode===e.mode}toString(){return"pushMode("+this.mode+")"}}class vd extends Sn{constructor(){super(4)}execute(e){e.popMode()}toString(){return"popMode"}}vd.INSTANCE=new vd;class Ed extends Sn{constructor(e){super(2),this.mode=e}execute(e){e.setMode(this.mode)}updateHashCode(e){e.update(this.actionType,this.mode)}equals(e){return this===e||e instanceof Ed&&this.mode===e.mode}toString(){return"mode("+this.mode+")"}}function hu(i,e){const t=[];return t[i-1]=e,t.map(function(r){return e})}class bd{constructor(e){e==null&&(e=Go.defaultOptions),this.deserializationOptions=e,this.stateFactories=null,this.actionFactories=null}deserialize(e){const t=this.reset(e);this.checkVersion(t),t&&this.skipUUID();const r=this.readATN();this.readStates(r,t),this.readRules(r,t),this.readModes(r);const n=[];return this.readSets(r,n,this.readInt.bind(this)),t&&this.readSets(r,n,this.readInt32.bind(this)),this.readEdges(r,n),this.readDecisions(r),this.readLexerActions(r,t),this.markPrecedenceDecisions(r),this.verifyATN(r),this.deserializationOptions.generateRuleBypassTransitions&&r.grammarType===1&&(this.generateRuleBypassTransitions(r),this.verifyATN(r)),r}reset(e){if((e.charCodeAt?e.charCodeAt(0):e[0])===3){const t=function(n){const s=n.charCodeAt(0);return s>1?s-2:s+65534},r=e.split("").map(t);return r[0]=e.charCodeAt(0),this.data=r,this.pos=0,!0}return this.data=e,this.pos=0,!1}skipUUID(){let e=0;for(;e++<8;)this.readInt()}checkVersion(e){const t=this.readInt();if(!e&&t!==4)throw"Could not deserialize ATN with version "+t+" (expected 4)."}readATN(){const e=this.readInt(),t=this.readInt();return new kt(e,t)}readStates(e,t){let r,n,s;const a=[],o=[],l=this.readInt();for(let d=0;d<l;d++){const p=this.readInt();if(p===Oe.INVALID_TYPE){e.addState(null);continue}let g=this.readInt();t&&g===65535&&(g=-1);const m=this.stateFactory(p,g);if(p===Oe.LOOP_END){const v=this.readInt();a.push([m,v])}else if(m instanceof Ra){const v=this.readInt();o.push([m,v])}e.addState(m)}for(r=0;r<a.length;r++)n=a[r],n[0].loopBackState=e.states[n[1]];for(r=0;r<o.length;r++)n=o[r],n[0].endState=e.states[n[1]];let u=this.readInt();for(r=0;r<u;r++)s=this.readInt(),e.states[s].nonGreedy=!0;let h=this.readInt();for(r=0;r<h;r++)s=this.readInt(),e.states[s].isPrecedenceRule=!0}readRules(e,t){let r;const n=this.readInt();for(e.grammarType===0&&(e.ruleToTokenType=hu(n,0)),e.ruleToStartState=hu(n,0),r=0;r<n;r++){const s=this.readInt();if(e.ruleToStartState[r]=e.states[s],e.grammarType===0){let a=this.readInt();t&&a===65535&&(a=Ee.EOF),e.ruleToTokenType[r]=a}}for(e.ruleToStopState=hu(n,0),r=0;r<e.states.length;r++){const s=e.states[r];s instanceof Mr&&(e.ruleToStopState[s.ruleIndex]=s,e.ruleToStartState[s.ruleIndex].stopState=s)}}readModes(e){const t=this.readInt();for(let r=0;r<t;r++){let n=this.readInt();e.modeToStartState.push(e.states[n])}}readSets(e,t,r){const n=this.readInt();for(let s=0;s<n;s++){const a=new gi;t.push(a);const o=this.readInt();this.readInt()!==0&&a.addOne(-1);for(let l=0;l<o;l++){const u=r(),h=r();a.addRange(u,h)}}}readEdges(e,t){let r,n,s,a,o;const l=this.readInt();for(r=0;r<l;r++){const u=this.readInt(),h=this.readInt(),d=this.readInt(),p=this.readInt(),g=this.readInt(),m=this.readInt();a=this.edgeFactory(e,d,u,h,p,g,m,t),e.states[u].addTransition(a)}for(r=0;r<e.states.length;r++)for(s=e.states[r],n=0;n<s.transitions.length;n++){const u=s.transitions[n];if(!(u instanceof au))continue;let h=-1;e.ruleToStartState[u.target.ruleIndex].isPrecedenceRule&&u.precedence===0&&(h=u.target.ruleIndex),a=new $o(u.followState,h),e.ruleToStopState[u.target.ruleIndex].addTransition(a)}for(r=0;r<e.states.length;r++){if(s=e.states[r],s instanceof Ra){if(s.endState===null||s.endState.startState!==null)throw"IllegalState";s.endState.startState=s}if(s instanceof iv)for(n=0;n<s.transitions.length;n++)o=s.transitions[n].target,o instanceof ud&&(o.loopBackState=s);else if(s instanceof ld)for(n=0;n<s.transitions.length;n++)o=s.transitions[n].target,o instanceof Gs&&(o.loopBackState=s)}}readDecisions(e){const t=this.readInt();for(let r=0;r<t;r++){const n=this.readInt(),s=e.states[n];e.decisionToState.push(s),s.decision=r}}readLexerActions(e,t){if(e.grammarType===0){const r=this.readInt();e.lexerActions=hu(r,null);for(let n=0;n<r;n++){const s=this.readInt();let a=this.readInt();t&&a===65535&&(a=-1);let o=this.readInt();t&&o===65535&&(o=-1),e.lexerActions[n]=this.lexerActionFactory(s,a,o)}}}generateRuleBypassTransitions(e){let t;const r=e.ruleToStartState.length;for(t=0;t<r;t++)e.ruleToTokenType[t]=e.maxTokenType+t+1;for(t=0;t<r;t++)this.generateRuleBypassTransition(e,t)}generateRuleBypassTransition(e,t){let r,n;const s=new nv;s.ruleIndex=t,e.addState(s);const a=new od;a.ruleIndex=t,e.addState(a),s.endState=a,e.defineDecisionState(s),a.startState=s;let o=null,l=null;if(e.ruleToStartState[t].isPrecedenceRule){for(l=null,r=0;r<e.states.length;r++)if(n=e.states[r],this.stateIsEndStateFor(n,t)){l=n,o=n.loopBackState.transitions[0];break}if(o===null)throw"Couldn't identify final state of the precedence rule prefix section."}else l=e.ruleToStopState[t];for(r=0;r<e.states.length;r++){n=e.states[r];for(let p=0;p<n.transitions.length;p++){const g=n.transitions[p];g!==o&&g.target===l&&(g.target=a)}}const u=e.ruleToStartState[t],h=u.transitions.length;for(;h>0;)s.addTransition(u.transitions[h-1]),u.transitions=u.transitions.slice(-1);e.ruleToStartState[t].addTransition(new $o(s)),a.addTransition(new $o(l));const d=new tv;e.addState(d),d.addTransition(new hd(a,e.ruleToTokenType[t])),s.addTransition(new $o(d))}stateIsEndStateFor(e,t){if(e.ruleIndex!==t||!(e instanceof Gs))return null;const r=e.transitions[e.transitions.length-1].target;return r instanceof Ia&&r.epsilonOnlyTransitions&&r.transitions[0].target instanceof Mr?e:null}markPrecedenceDecisions(e){for(let t=0;t<e.states.length;t++){const r=e.states[t];if(r instanceof Gs&&e.ruleToStartState[r.ruleIndex].isPrecedenceRule){const n=r.transitions[r.transitions.length-1].target;n instanceof Ia&&n.epsilonOnlyTransitions&&n.transitions[0].target instanceof Mr&&(r.isPrecedenceDecision=!0)}}}verifyATN(e){if(this.deserializationOptions.verifyATN)for(let t=0;t<e.states.length;t++){const r=e.states[t];if(r!==null)if(this.checkCondition(r.epsilonOnlyTransitions||r.transitions.length<=1),r instanceof ud)this.checkCondition(r.loopBackState!==null);else if(r instanceof Gs)if(this.checkCondition(r.loopBackState!==null),this.checkCondition(r.transitions.length===2),r.transitions[0].target instanceof cd)this.checkCondition(r.transitions[1].target instanceof Ia),this.checkCondition(!r.nonGreedy);else{if(!(r.transitions[0].target instanceof Ia))throw"IllegalState";this.checkCondition(r.transitions[1].target instanceof cd),this.checkCondition(r.nonGreedy)}else r instanceof ld?(this.checkCondition(r.transitions.length===1),this.checkCondition(r.transitions[0].target instanceof Gs)):r instanceof Ia?this.checkCondition(r.loopBackState!==null):r instanceof rv?this.checkCondition(r.stopState!==null):r instanceof Ra?this.checkCondition(r.endState!==null):r instanceof od?this.checkCondition(r.startState!==null):r instanceof Da?this.checkCondition(r.transitions.length<=1||r.decision>=0):this.checkCondition(r.transitions.length<=1||r instanceof Mr)}}checkCondition(e,t){if(!e)throw t==null&&(t="IllegalState"),t}readInt(){return this.data[this.pos++]}readInt32(){return this.readInt()|this.readInt()<<16}edgeFactory(e,t,r,n,s,a,o,l){const u=e.states[n];switch(t){case Me.EPSILON:return new $o(u);case Me.RANGE:return new AI(u,o!==0?Ee.EOF:s,a);case Me.RULE:return new au(e.states[s],a,o,u);case Me.PREDICATE:return new av(u,s,a,o!==0);case Me.PRECEDENCE:return new SI(u,s);case Me.ATOM:return new hd(u,o!==0?Ee.EOF:s);case Me.ACTION:return new sv(u,s,a,o!==0);case Me.SET:return new td(u,l[s]);case Me.NOT_SET:return new rd(u,l[s]);case Me.WILDCARD:return new Jy(u);default:throw"The specified transition type: "+t+" is not valid."}}stateFactory(e,t){if(this.stateFactories===null){const r=[];r[Oe.INVALID_TYPE]=null,r[Oe.BASIC]=()=>new tv,r[Oe.RULE_START]=()=>new rv,r[Oe.BLOCK_START]=()=>new nv,r[Oe.PLUS_BLOCK_START]=()=>new ud,r[Oe.STAR_BLOCK_START]=()=>new cd,r[Oe.TOKEN_START]=()=>new bI,r[Oe.RULE_STOP]=()=>new Mr,r[Oe.BLOCK_END]=()=>new od,r[Oe.STAR_LOOP_BACK]=()=>new ld,r[Oe.STAR_LOOP_ENTRY]=()=>new Gs,r[Oe.PLUS_LOOP_BACK]=()=>new iv,r[Oe.LOOP_END]=()=>new Ia,this.stateFactories=r}if(e>this.stateFactories.length||this.stateFactories[e]===null)throw"The specified state type "+e+" is not valid.";{const r=this.stateFactories[e]();if(r!==null)return r.ruleIndex=t,r}}lexerActionFactory(e,t,r){if(this.actionFactories===null){const n=[];n[0]=(s,a)=>new fd(s),n[1]=(s,a)=>new gd(s,a),n[2]=(s,a)=>new Ed(s),n[3]=(s,a)=>pd.INSTANCE,n[4]=(s,a)=>vd.INSTANCE,n[5]=(s,a)=>new yd(s),n[6]=(s,a)=>dd.INSTANCE,n[7]=(s,a)=>new md(s),this.actionFactories=n}if(e>this.actionFactories.length||this.actionFactories[e]===null)throw"The specified lexer action type "+e+" is not valid.";return this.actionFactories[e](t,r)}}class qo{syntaxError(e,t,r,n,s,a){}reportAmbiguity(e,t,r,n,s,a,o){}reportAttemptingFullContext(e,t,r,n,s,a){}reportContextSensitivity(e,t,r,n,s,a){}}class Ad extends qo{constructor(){super()}syntaxError(e,t,r,n,s,a){console.error("line "+r+":"+n+" "+s)}}Ad.INSTANCE=new Ad;class xI extends qo{constructor(e){if(super(),e===null)throw"delegates";return this.delegates=e,this}syntaxError(e,t,r,n,s,a){this.delegates.map(o=>o.syntaxError(e,t,r,n,s,a))}reportAmbiguity(e,t,r,n,s,a,o){this.delegates.map(l=>l.reportAmbiguity(e,t,r,n,s,a,o))}reportAttemptingFullContext(e,t,r,n,s,a){this.delegates.map(o=>o.reportAttemptingFullContext(e,t,r,n,s,a))}reportContextSensitivity(e,t,r,n,s,a){this.delegates.map(o=>o.reportContextSensitivity(e,t,r,n,s,a))}}class du{constructor(){this._listeners=[Ad.INSTANCE],this._interp=null,this._stateNumber=-1}checkVersion(e){const t="4.13.2";t!==e&&console.log("ANTLR runtime and generated code versions disagree: "+t+"!="+e)}addErrorListener(e){this._listeners.push(e)}removeErrorListeners(){this._listeners=[]}getLiteralNames(){return Object.getPrototypeOf(this).constructor.literalNames||[]}getSymbolicNames(){return Object.getPrototypeOf(this).constructor.symbolicNames||[]}getTokenNames(){if(!this.tokenNames){const e=this.getLiteralNames(),t=this.getSymbolicNames(),r=e.length>t.length?e.length:t.length;this.tokenNames=[];for(let n=0;n<r;n++)this.tokenNames[n]=e[n]||t[n]||"<INVALID"}return this.tokenNames}getTokenTypeMap(){const e=this.getTokenNames();if(e===null)throw"The current recognizer does not provide a list of token names.";let t=this.tokenTypeMapCache[e];return t===void 0&&(t=e.reduce(function(r,n,s){r[n]=s}),t.EOF=Ee.EOF,this.tokenTypeMapCache[e]=t),t}getRuleIndexMap(){const e=this.ruleNames;if(e===null)throw"The current recognizer does not provide a list of rule names.";let t=this.ruleIndexMapCache[e];return t===void 0&&(t=e.reduce(function(r,n,s){r[n]=s}),this.ruleIndexMapCache[e]=t),t}getTokenType(e){const t=this.getTokenTypeMap()[e];return t!==void 0?t:Ee.INVALID_TYPE}getErrorHeader(e){return"line "+e.getOffendingToken().line+":"+e.getOffendingToken().column}getTokenErrorDisplay(e){if(e===null)return"<no token>";let t=e.text;return t===null&&(t=e.type===Ee.EOF?"<EOF>":"<"+e.type+">"),t=t.replace(`
`,"\\n").replace("\r","\\r").replace("	","\\t"),"'"+t+"'"}getErrorListenerDispatch(){return console.warn("Calling deprecated method in Recognizer class: getErrorListenerDispatch()"),this.getErrorListener()}getErrorListener(){return new xI(this._listeners)}sempred(e,t,r){return!0}precpred(e,t){return!0}get atn(){return this._interp.atn}get state(){return this._stateNumber}set state(e){this._stateNumber=e}}du.tokenTypeMapCache={},du.ruleIndexMapCache={};class xn extends Ee{constructor(e,t,r,n,s){super(),this.source=e!==void 0?e:xn.EMPTY_SOURCE,this.type=t!==void 0?t:null,this.channel=r!==void 0?r:Ee.DEFAULT_CHANNEL,this.start=n!==void 0?n:-1,this.stop=s!==void 0?s:-1,this.tokenIndex=-1,this.source[0]!==null?(this.line=e[0].line,this.column=e[0].column):this.column=-1}clone(){const e=new xn(this.source,this.type,this.channel,this.start,this.stop);return e.tokenIndex=this.tokenIndex,e.line=this.line,e.column=this.column,e.text=this.text,e}cloneWithType(e){const t=new xn(this.source,e,this.channel,this.start,this.stop);return t.tokenIndex=this.tokenIndex,t.line=this.line,t.column=this.column,e===Ee.EOF&&(t.text=""),t}toString(){let e=this.text;return e=e!==null?e.replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\t/g,"\\t"):"<no text>","[@"+this.tokenIndex+","+this.start+":"+this.stop+"='"+e+"',<"+this.type+">"+(this.channel>0?",channel="+this.channel:"")+","+this.line+":"+this.column+"]"}get text(){if(this._text!==null)return this._text;const e=this.getInputStream();if(e===null)return null;const t=e.size;return this.start<t&&this.stop<t?e.getText(this.start,this.stop):"<EOF>"}set text(e){this._text=e}}xn.EMPTY_SOURCE=[null,null];class TI{}class Sd extends TI{constructor(e){super(),this.copyText=e!==void 0&&e}create(e,t,r,n,s,a,o,l){const u=new xn(e,t,n,s,a);return u.line=o,u.column=l,r!==null?u.text=r:this.copyText&&e[1]!==null&&(u.text=e[1].getText(s,a)),u}createThin(e,t){const r=new xn(null,e);return r.text=t,r}}Sd.DEFAULT=new Sd;class Tn extends Error{constructor(e){super(e.message),Error.captureStackTrace&&Error.captureStackTrace(this,Tn),this.message=e.message,this.recognizer=e.recognizer,this.input=e.input,this.ctx=e.ctx,this.offendingToken=null,this.offendingState=-1,this.recognizer!==null&&(this.offendingState=this.recognizer.state)}getExpectedTokens(){return this.recognizer!==null?this.recognizer.atn.getExpectedTokens(this.offendingState,this.ctx):null}toString(){return this.message}}class xd extends Tn{constructor(e,t,r,n){super({message:"",recognizer:e,input:t,ctx:null}),this.startIndex=r,this.deadEndConfigs=n}toString(){let e="";return this.startIndex>=0&&this.startIndex<this.input.size&&(e=this.input.getText(new dt(this.startIndex,this.startIndex))),"LexerNoViableAltException"+e}}class Ut extends du{constructor(e){super(),this._input=e,this._factory=Sd.DEFAULT,this._tokenFactorySourcePair=[this,e],this._interp=null,this._token=null,this._tokenStartCharIndex=-1,this._tokenStartLine=-1,this._tokenStartColumn=-1,this._hitEOF=!1,this._channel=Ee.DEFAULT_CHANNEL,this._type=Ee.INVALID_TYPE,this._modeStack=[],this._mode=Ut.DEFAULT_MODE,this._text=null}reset(){this._input!==null&&this._input.seek(0),this._token=null,this._type=Ee.INVALID_TYPE,this._channel=Ee.DEFAULT_CHANNEL,this._tokenStartCharIndex=-1,this._tokenStartColumn=-1,this._tokenStartLine=-1,this._text=null,this._hitEOF=!1,this._mode=Ut.DEFAULT_MODE,this._modeStack=[],this._interp.reset()}nextToken(){if(this._input===null)throw"nextToken requires a non-null input stream.";const e=this._input.mark();try{for(;;){if(this._hitEOF)return this.emitEOF(),this._token;this._token=null,this._channel=Ee.DEFAULT_CHANNEL,this._tokenStartCharIndex=this._input.index,this._tokenStartColumn=this._interp.column,this._tokenStartLine=this._interp.line,this._text=null;let t=!1;for(;;){this._type=Ee.INVALID_TYPE;let r=Ut.SKIP;try{r=this._interp.match(this._input,this._mode)}catch(n){if(!(n instanceof Tn))throw console.log(n.stack),n;this.notifyListeners(n),this.recover(n)}if(this._input.LA(1)===Ee.EOF&&(this._hitEOF=!0),this._type===Ee.INVALID_TYPE&&(this._type=r),this._type===Ut.SKIP){t=!0;break}if(this._type!==Ut.MORE)break}if(!t)return this._token===null&&this.emit(),this._token}}finally{this._input.release(e)}}skip(){this._type=Ut.SKIP}more(){this._type=Ut.MORE}mode(e){console.warn("Calling deprecated method in Lexer class: mode(...)"),this.setMode(e)}setMode(e){this._mode=e}getMode(){return this._mode}getModeStack(){return this._modeStack}pushMode(e){this._interp.debug&&console.log("pushMode "+e),this._modeStack.push(this._mode),this.setMode(e)}popMode(){if(this._modeStack.length===0)throw"Empty Stack";return this._interp.debug&&console.log("popMode back to "+this._modeStack.slice(0,-1)),this.setMode(this._modeStack.pop()),this._mode}emitToken(e){this._token=e}emit(){const e=this._factory.create(this._tokenFactorySourcePair,this._type,this._text,this._channel,this._tokenStartCharIndex,this.getCharIndex()-1,this._tokenStartLine,this._tokenStartColumn);return this.emitToken(e),e}emitEOF(){const e=this.column,t=this.line,r=this._factory.create(this._tokenFactorySourcePair,Ee.EOF,null,Ee.DEFAULT_CHANNEL,this._input.index,this._input.index-1,t,e);return this.emitToken(r),r}getCharIndex(){return this._input.index}getAllTokens(){const e=[];let t=this.nextToken();for(;t.type!==Ee.EOF;)e.push(t),t=this.nextToken();return e}notifyListeners(e){const t=this._tokenStartCharIndex,r=this._input.index,n=this._input.getText(t,r),s="token recognition error at: '"+this.getErrorDisplay(n)+"'";this.getErrorListener().syntaxError(this,null,this._tokenStartLine,this._tokenStartColumn,s,e)}getErrorDisplay(e){const t=[];for(let r=0;r<e.length;r++)t.push(e[r]);return t.join("")}getErrorDisplayForChar(e){return e.charCodeAt(0)===Ee.EOF?"<EOF>":e===`
`?"\\n":e==="	"?"\\t":e==="\r"?"\\r":e}getCharErrorDisplay(e){return"'"+this.getErrorDisplayForChar(e)+"'"}recover(e){this._input.LA(1)!==Ee.EOF&&(e instanceof xd?this._interp.consume(this._input):this._input.consume())}get inputStream(){return this._input}set inputStream(e){this._input=null,this._tokenFactorySourcePair=[this,this._input],this.reset(),this._input=e,this._tokenFactorySourcePair=[this,this._input]}get sourceName(){return this._input.sourceName}get type(){return this._type}set type(e){this._type=e}get line(){return this._interp.line}set line(e){this._interp.line=e}get column(){return this._interp.column}set column(e){this._interp.column=e}get text(){return this._text!==null?this._text:this._interp.getText(this._input)}set text(e){this._text=e}}function DI(i){return i.hashCodeForConfigSet()}function RI(i,e){return i===e||i!==null&&e!==null&&i.equalsForConfigSet(e)}Ut.DEFAULT_MODE=0,Ut.MORE=-2,Ut.SKIP=-3,Ut.DEFAULT_TOKEN_CHANNEL=Ee.DEFAULT_CHANNEL,Ut.HIDDEN=Ee.HIDDEN_CHANNEL,Ut.MIN_CHAR_VALUE=0,Ut.MAX_CHAR_VALUE=1114111;class Or{constructor(e){this.configLookup=new ei(DI,RI),this.fullCtx=e===void 0||e,this.readOnly=!1,this.configs=[],this.uniqueAlt=0,this.conflictingAlts=null,this.hasSemanticContext=!1,this.dipsIntoOuterContext=!1,this.cachedHashCode=-1}add(e,t){if(t===void 0&&(t=null),this.readOnly)throw"This set is readonly";e.semanticContext!==pt.NONE&&(this.hasSemanticContext=!0),e.reachesIntoOuterContext>0&&(this.dipsIntoOuterContext=!0);const r=this.configLookup.getOrAdd(e);if(r===e)return this.cachedHashCode=-1,this.configs.push(e),!0;const n=!this.fullCtx,s=ad(r.context,e.context,n,t);return r.reachesIntoOuterContext=Math.max(r.reachesIntoOuterContext,e.reachesIntoOuterContext),e.precedenceFilterSuppressed&&(r.precedenceFilterSuppressed=!0),r.context=s,!0}getStates(){const e=new ei;for(let t=0;t<this.configs.length;t++)e.add(this.configs[t].state);return e}getPredicates(){const e=[];for(let t=0;t<this.configs.length;t++){const r=this.configs[t].semanticContext;r!==pt.NONE&&e.push(r.semanticContext)}return e}optimizeConfigs(e){if(this.readOnly)throw"This set is readonly";if(this.configLookup.length!==0)for(let t=0;t<this.configs.length;t++){const r=this.configs[t];r.context=e.getCachedContext(r.context)}}addAll(e){for(let t=0;t<e.length;t++)this.add(e[t]);return!1}equals(e){return this===e||e instanceof Or&&Ta(this.configs,e.configs)&&this.fullCtx===e.fullCtx&&this.uniqueAlt===e.uniqueAlt&&this.conflictingAlts===e.conflictingAlts&&this.hasSemanticContext===e.hasSemanticContext&&this.dipsIntoOuterContext===e.dipsIntoOuterContext}hashCode(){const e=new Zr;return e.update(this.configs),e.finish()}updateHashCode(e){this.readOnly?(this.cachedHashCode===-1&&(this.cachedHashCode=this.hashCode()),e.update(this.cachedHashCode)):e.update(this.hashCode())}isEmpty(){return this.configs.length===0}contains(e){if(this.configLookup===null)throw"This method is not implemented for readonly sets.";return this.configLookup.contains(e)}containsFast(e){if(this.configLookup===null)throw"This method is not implemented for readonly sets.";return this.configLookup.containsFast(e)}clear(){if(this.readOnly)throw"This set is readonly";this.configs=[],this.cachedHashCode=-1,this.configLookup=new ei}setReadonly(e){this.readOnly=e,e&&(this.configLookup=null)}toString(){return bn(this.configs)+(this.hasSemanticContext?",hasSemanticContext="+this.hasSemanticContext:"")+(this.uniqueAlt!==kt.INVALID_ALT_NUMBER?",uniqueAlt="+this.uniqueAlt:"")+(this.conflictingAlts!==null?",conflictingAlts="+this.conflictingAlts:"")+(this.dipsIntoOuterContext?",dipsIntoOuterContext":"")}get items(){return this.configs}get length(){return this.configs.length}}class Dn{constructor(e,t){return e===null&&(e=-1),t===null&&(t=new Or),this.stateNumber=e,this.configs=t,this.edges=null,this.isAcceptState=!1,this.prediction=0,this.lexerActionExecutor=null,this.requiresFullContext=!1,this.predicates=null,this}getAltSet(){const e=new ei;if(this.configs!==null)for(let t=0;t<this.configs.length;t++){const r=this.configs[t];e.add(r.alt)}return e.length===0?null:e}equals(e){return this===e||e instanceof Dn&&this.configs.equals(e.configs)}toString(){let e=this.stateNumber+":"+this.configs;return this.isAcceptState&&(e+="=>",this.predicates!==null?e+=this.predicates:e+=this.prediction),e}hashCode(){const e=new Zr;return e.update(this.configs),e.finish()}}class ji{constructor(e,t){return this.atn=e,this.sharedContextCache=t,this}getCachedContext(e){if(this.sharedContextCache===null)return e;const t=new Uo;return ev(e,this.sharedContextCache,t)}}ji.ERROR=new Dn(2147483647,new Or);class ov extends Or{constructor(){super(),this.configLookup=new ei}}class Hr extends Xt{constructor(e,t){super(e,t);const r=e.lexerActionExecutor||null;return this.lexerActionExecutor=r||(t!==null?t.lexerActionExecutor:null),this.passedThroughNonGreedyDecision=t!==null&&this.checkNonGreedyDecision(t,this.state),this.hashCodeForConfigSet=Hr.prototype.hashCode,this.equalsForConfigSet=Hr.prototype.equals,this}updateHashCode(e){e.update(this.state.stateNumber,this.alt,this.context,this.semanticContext,this.passedThroughNonGreedyDecision,this.lexerActionExecutor)}equals(e){return this===e||e instanceof Hr&&this.passedThroughNonGreedyDecision===e.passedThroughNonGreedyDecision&&(this.lexerActionExecutor?this.lexerActionExecutor.equals(e.lexerActionExecutor):!e.lexerActionExecutor)&&super.equals(e)}checkNonGreedyDecision(e,t){return e.passedThroughNonGreedyDecision||t instanceof Da&&t.nonGreedy}}class Vo extends Sn{constructor(e,t){super(t.actionType),this.offset=e,this.action=t,this.isPositionDependent=!0}execute(e){this.action.execute(e)}updateHashCode(e){e.update(this.actionType,this.offset,this.action)}equals(e){return this===e||e instanceof Vo&&this.offset===e.offset&&this.action===e.action}}class Na{constructor(e){return this.lexerActions=e===null?[]:e,this.cachedHashCode=Zr.hashStuff(e),this}fixOffsetBeforeMatch(e){let t=null;for(let r=0;r<this.lexerActions.length;r++)!this.lexerActions[r].isPositionDependent||this.lexerActions[r]instanceof Vo||(t===null&&(t=this.lexerActions.concat([])),t[r]=new Vo(e,this.lexerActions[r]));return t===null?this:new Na(t)}execute(e,t,r){let n=!1;const s=t.index;try{for(let a=0;a<this.lexerActions.length;a++){let o=this.lexerActions[a];if(o instanceof Vo){const l=o.offset;t.seek(r+l),o=o.action,n=r+l!==s}else o.isPositionDependent&&(t.seek(s),n=!1);o.execute(e)}}finally{n&&t.seek(s)}}hashCode(){return this.cachedHashCode}updateHashCode(e){e.update(this.cachedHashCode)}equals(e){if(this===e)return!0;if(e instanceof Na){if(this.cachedHashCode!=e.cachedHashCode||this.lexerActions.length!=e.lexerActions.length)return!1;{const t=this.lexerActions.length;for(let r=0;r<t;++r)if(!this.lexerActions[r].equals(e.lexerActions[r]))return!1;return!0}}return!1}static append(e,t){if(e===null)return new Na([t]);const r=e.lexerActions.concat([t]);return new Na(r)}}function lv(i){i.index=-1,i.line=0,i.column=-1,i.dfaState=null}class II{constructor(){lv(this)}reset(){lv(this)}}class $t extends ji{constructor(e,t,r,n){super(t,n),this.decisionToDFA=r,this.recog=e,this.startIndex=-1,this.line=1,this.column=0,this.mode=Ut.DEFAULT_MODE,this.prevAccept=new II}copyState(e){this.column=e.column,this.line=e.line,this.mode=e.mode,this.startIndex=e.startIndex}match(e,t){this.mode=t;const r=e.mark();try{this.startIndex=e.index,this.prevAccept.reset();const n=this.decisionToDFA[t];return n.s0===null?this.matchATN(e):this.execATN(e,n.s0)}finally{e.release(r)}}reset(){this.prevAccept.reset(),this.startIndex=-1,this.line=1,this.column=0,this.mode=Ut.DEFAULT_MODE}matchATN(e){const t=this.atn.modeToStartState[this.mode];$t.debug&&console.log("matchATN mode "+this.mode+" start: "+t);const r=this.mode,n=this.computeStartState(e,t),s=n.hasSemanticContext;n.hasSemanticContext=!1;const a=this.addDFAState(n);s||(this.decisionToDFA[this.mode].s0=a);const o=this.execATN(e,a);return $t.debug&&console.log("DFA after matchATN: "+this.decisionToDFA[r].toLexerString()),o}execATN(e,t){$t.debug&&console.log("start state closure="+t.configs),t.isAcceptState&&this.captureSimState(this.prevAccept,e,t);let r=e.LA(1),n=t;for(;;){$t.debug&&console.log("execATN loop starting closure: "+n.configs);let s=this.getExistingTargetState(n,r);if(s===null&&(s=this.computeTargetState(e,n,r)),s===ji.ERROR||(r!==Ee.EOF&&this.consume(e),s.isAcceptState&&(this.captureSimState(this.prevAccept,e,s),r===Ee.EOF)))break;r=e.LA(1),n=s}return this.failOrAccept(this.prevAccept,e,n.configs,r)}getExistingTargetState(e,t){if(e.edges===null||t<$t.MIN_DFA_EDGE||t>$t.MAX_DFA_EDGE)return null;let r=e.edges[t-$t.MIN_DFA_EDGE];return r===void 0&&(r=null),$t.debug&&r!==null&&console.log("reuse state "+e.stateNumber+" edge to "+r.stateNumber),r}computeTargetState(e,t,r){const n=new ov;return this.getReachableConfigSet(e,t.configs,n,r),n.items.length===0?(n.hasSemanticContext||this.addDFAEdge(t,r,ji.ERROR),ji.ERROR):this.addDFAEdge(t,r,null,n)}failOrAccept(e,t,r,n){if(this.prevAccept.dfaState!==null){const s=e.dfaState.lexerActionExecutor;return this.accept(t,s,this.startIndex,e.index,e.line,e.column),e.dfaState.prediction}if(n===Ee.EOF&&t.index===this.startIndex)return Ee.EOF;throw new xd(this.recog,t,this.startIndex,r)}getReachableConfigSet(e,t,r,n){let s=kt.INVALID_ALT_NUMBER;for(let a=0;a<t.items.length;a++){const o=t.items[a],l=o.alt===s;if(!l||!o.passedThroughNonGreedyDecision){$t.debug&&console.log(`testing %s at %s
`,this.getTokenName(n),o.toString(this.recog,!0));for(let u=0;u<o.state.transitions.length;u++){const h=o.state.transitions[u],d=this.getReachableTarget(h,n);if(d!==null){let p=o.lexerActionExecutor;p!==null&&(p=p.fixOffsetBeforeMatch(e.index-this.startIndex));const g=n===Ee.EOF,m=new Hr({state:d,lexerActionExecutor:p},o);this.closure(e,m,r,l,!0,g)&&(s=o.alt)}}}}}accept(e,t,r,n,s,a){$t.debug&&console.log(`ACTION %s
`,t),e.seek(n),this.line=s,this.column=a,t!==null&&this.recog!==null&&t.execute(this.recog,e,r)}getReachableTarget(e,t){return e.matches(t,0,Ut.MAX_CHAR_VALUE)?e.target:null}computeStartState(e,t){const r=We.EMPTY,n=new ov;for(let s=0;s<t.transitions.length;s++){const a=t.transitions[s].target,o=new Hr({state:a,alt:s+1,context:r},null);this.closure(e,o,n,!1,!1,!1)}return n}closure(e,t,r,n,s,a){let o=null;if($t.debug&&console.log("closure("+t.toString(this.recog,!0)+")"),t.state instanceof Mr){if($t.debug&&(this.recog!==null?console.log(`closure at %s rule stop %s
`,this.recog.ruleNames[t.state.ruleIndex],t):console.log(`closure at rule stop %s
`,t)),t.context===null||t.context.hasEmptyPath()){if(t.context===null||t.context.isEmpty())return r.add(t),!0;r.add(new Hr({state:t.state,context:We.EMPTY},t)),n=!0}if(t.context!==null&&!t.context.isEmpty()){for(let l=0;l<t.context.length;l++)if(t.context.getReturnState(l)!==We.EMPTY_RETURN_STATE){const u=t.context.getParent(l),h=this.atn.states[t.context.getReturnState(l)];o=new Hr({state:h,context:u},t),n=this.closure(e,o,r,n,s,a)}}return n}t.state.epsilonOnlyTransitions||n&&t.passedThroughNonGreedyDecision||r.add(t);for(let l=0;l<t.state.transitions.length;l++){const u=t.state.transitions[l];o=this.getEpsilonTarget(e,t,u,r,s,a),o!==null&&(n=this.closure(e,o,r,n,s,a))}return n}getEpsilonTarget(e,t,r,n,s,a){let o=null;if(r.serializationType===Me.RULE){const l=Pr.create(t.context,r.followState.stateNumber);o=new Hr({state:r.target,context:l},t)}else{if(r.serializationType===Me.PRECEDENCE)throw"Precedence predicates are not supported in lexers.";if(r.serializationType===Me.PREDICATE)$t.debug&&console.log("EVAL rule "+r.ruleIndex+":"+r.predIndex),n.hasSemanticContext=!0,this.evaluatePredicate(e,r.ruleIndex,r.predIndex,s)&&(o=new Hr({state:r.target},t));else if(r.serializationType===Me.ACTION)if(t.context===null||t.context.hasEmptyPath()){const l=Na.append(t.lexerActionExecutor,this.atn.lexerActions[r.actionIndex]);o=new Hr({state:r.target,lexerActionExecutor:l},t)}else o=new Hr({state:r.target},t);else r.serializationType===Me.EPSILON?o=new Hr({state:r.target},t):r.serializationType!==Me.ATOM&&r.serializationType!==Me.RANGE&&r.serializationType!==Me.SET||a&&r.matches(Ee.EOF,0,Ut.MAX_CHAR_VALUE)&&(o=new Hr({state:r.target},t))}return o}evaluatePredicate(e,t,r,n){if(this.recog===null)return!0;if(!n)return this.recog.sempred(null,t,r);const s=this.column,a=this.line,o=e.index,l=e.mark();try{return this.consume(e),this.recog.sempred(null,t,r)}finally{this.column=s,this.line=a,e.seek(o),e.release(l)}}captureSimState(e,t,r){e.index=t.index,e.line=this.line,e.column=this.column,e.dfaState=r}addDFAEdge(e,t,r,n){if(r===void 0&&(r=null),n===void 0&&(n=null),r===null&&n!==null){const s=n.hasSemanticContext;if(n.hasSemanticContext=!1,r=this.addDFAState(n),s)return r}return t<$t.MIN_DFA_EDGE||t>$t.MAX_DFA_EDGE||($t.debug&&console.log("EDGE "+e+" -> "+r+" upon "+t),e.edges===null&&(e.edges=[]),e.edges[t-$t.MIN_DFA_EDGE]=r),r}addDFAState(e){const t=new Dn(null,e);let r=null;for(let o=0;o<e.items.length;o++){const l=e.items[o];if(l.state instanceof Mr){r=l;break}}r!==null&&(t.isAcceptState=!0,t.lexerActionExecutor=r.lexerActionExecutor,t.prediction=this.atn.ruleToTokenType[r.state.ruleIndex]);const n=this.decisionToDFA[this.mode],s=n.states.get(t);if(s!==null)return s;const a=t;return a.stateNumber=n.states.length,e.setReadonly(!0),a.configs=e,n.states.add(a),a}getDFA(e){return this.decisionToDFA[e]}getText(e){return e.getText(this.startIndex,e.index-1)}consume(e){e.LA(1)===10?(this.line+=1,this.column=0):this.column+=1,e.consume()}getTokenName(e){return e===-1?"EOF":"'"+String.fromCharCode(e)+"'"}}$t.debug=!1,$t.dfa_debug=!1,$t.MIN_DFA_EDGE=0,$t.MAX_DFA_EDGE=127;class uv{constructor(e,t){this.alt=t,this.pred=e}toString(){return"("+this.pred+", "+this.alt+")"}}class NI{constructor(){this.data={}}get(e){return this.data["k-"+e]||null}set(e,t){this.data["k-"+e]=t}values(){return Object.keys(this.data).filter(e=>e.startsWith("k-")).map(e=>this.data[e],this)}}const zi={SLL:0,LL:1,LL_EXACT_AMBIG_DETECTION:2,hasSLLConflictTerminatingPrediction:function(i,e){if(zi.allConfigsInRuleStopStates(e))return!0;if(i===zi.SLL&&e.hasSemanticContext){const r=new Or;for(let n=0;n<e.items.length;n++){let s=e.items[n];s=new Xt({semanticContext:pt.NONE},s),r.add(s)}e=r}const t=zi.getConflictingAltSubsets(e);return zi.hasConflictingAltSet(t)&&!zi.hasStateAssociatedWithOneAlt(e)},hasConfigInRuleStopState:function(i){for(let e=0;e<i.items.length;e++)if(i.items[e].state instanceof Mr)return!0;return!1},allConfigsInRuleStopStates:function(i){for(let e=0;e<i.items.length;e++)if(!(i.items[e].state instanceof Mr))return!1;return!0},resolvesToJustOneViableAlt:function(i){return zi.getSingleViableAlt(i)},allSubsetsConflict:function(i){return!zi.hasNonConflictingAltSet(i)},hasNonConflictingAltSet:function(i){for(let e=0;e<i.length;e++)if(i[e].length===1)return!0;return!1},hasConflictingAltSet:function(i){for(let e=0;e<i.length;e++)if(i[e].length>1)return!0;return!1},allSubsetsEqual:function(i){let e=null;for(let t=0;t<i.length;t++){const r=i[t];if(e===null)e=r;else if(r!==e)return!1}return!0},getUniqueAlt:function(i){const e=zi.getAlts(i);return e.length===1?e.minValue():kt.INVALID_ALT_NUMBER},getAlts:function(i){const e=new kr;return i.map(function(t){e.or(t)}),e},getConflictingAltSubsets:function(i){const e=new Uo;return e.hashFunction=function(t){Zr.hashStuff(t.state.stateNumber,t.context)},e.equalsFunction=function(t,r){return t.state.stateNumber===r.state.stateNumber&&t.context.equals(r.context)},i.items.map(function(t){let r=e.get(t);r===null&&(r=new kr,e.set(t,r)),r.set(t.alt)}),e.getValues()},getStateToAltMap:function(i){const e=new NI;return i.items.map(function(t){let r=e.get(t.state);r===null&&(r=new kr,e.set(t.state,r)),r.set(t.alt)}),e},hasStateAssociatedWithOneAlt:function(i){const e=zi.getStateToAltMap(i).values();for(let t=0;t<e.length;t++)if(e[t].length===1)return!0;return!1},getSingleViableAlt:function(i){let e=null;for(let t=0;t<i.length;t++){const r=i[t].minValue();if(e===null)e=r;else if(e!==r)return kt.INVALID_ALT_NUMBER}return e}},rr=zi;let fu=class extends Tn{constructor(e,t,r,n,s,a){a=a||e._ctx,n=n||e.getCurrentToken(),r=r||e.getCurrentToken(),t=t||e.getInputStream(),super({message:"",recognizer:e,input:t,ctx:a}),this.deadEndConfigs=s,this.startToken=r,this.offendingToken=n}},CI=class{constructor(e){this.defaultMapCtor=e||Uo,this.cacheMap=new this.defaultMapCtor}get(e,t){const r=this.cacheMap.get(e)||null;return r===null?null:r.get(t)||null}set(e,t,r){let n=this.cacheMap.get(e)||null;n===null&&(n=new this.defaultMapCtor,this.cacheMap.set(e,n)),n.set(t,r)}};class cv extends ji{constructor(e,t,r,n){super(t,n),this.parser=e,this.decisionToDFA=r,this.predictionMode=rr.LL,this._input=null,this._startIndex=0,this._outerContext=null,this._dfa=null,this.mergeCache=null,this.debug=!1,this.debug_closure=!1,this.debug_add=!1,this.trace_atn_sim=!1,this.dfa_debug=!1,this.retry_debug=!1}reset(){}adaptivePredict(e,t,r){(this.debug||this.trace_atn_sim)&&console.log("adaptivePredict decision "+t+" exec LA(1)=="+this.getLookaheadName(e)+" line "+e.LT(1).line+":"+e.LT(1).column),this._input=e,this._startIndex=e.index,this._outerContext=r;const n=this.decisionToDFA[t];this._dfa=n;const s=e.mark(),a=e.index;try{let o;if(o=n.precedenceDfa?n.getPrecedenceStartState(this.parser.getPrecedence()):n.s0,o===null){r===null&&(r=$s.EMPTY),this.debug&&console.log("predictATN decision "+n.decision+" exec LA(1)=="+this.getLookaheadName(e)+", outerContext="+r.toString(this.parser.ruleNames));let h=this.computeStartState(n.atnStartState,$s.EMPTY,!1);n.precedenceDfa?(n.s0.configs=h,h=this.applyPrecedenceFilter(h),o=this.addDFAState(n,new Dn(null,h)),n.setPrecedenceStartState(this.parser.getPrecedence(),o)):(o=this.addDFAState(n,new Dn(null,h)),n.s0=o)}const l=this.execATN(n,o,e,a,r);return this.debug&&console.log("DFA after predictATN: "+n.toString(this.parser.literalNames,this.parser.symbolicNames)),l}finally{this._dfa=null,this.mergeCache=null,e.seek(a),e.release(s)}}execATN(e,t,r,n,s){let a;(this.debug||this.trace_atn_sim)&&console.log("execATN decision "+e.decision+", DFA state "+t+", LA(1)=="+this.getLookaheadName(r)+" line "+r.LT(1).line+":"+r.LT(1).column);let o=t;this.debug&&console.log("s0 = "+t);let l=r.LA(1);for(;;){let u=this.getExistingTargetState(o,l);if(u===null&&(u=this.computeTargetState(e,o,l)),u===ji.ERROR){const h=this.noViableAlt(r,s,o.configs,n);if(r.seek(n),a=this.getSynValidOrSemInvalidAltThatFinishedDecisionEntryRule(o.configs,s),a!==kt.INVALID_ALT_NUMBER)return a;throw h}if(u.requiresFullContext&&this.predictionMode!==rr.SLL){let h=null;if(u.predicates!==null){this.debug&&console.log("DFA state has preds in DFA sim LL failover");const g=r.index;if(g!==n&&r.seek(n),h=this.evalSemanticContext(u.predicates,s,!0),h.length===1)return this.debug&&console.log("Full LL avoided"),h.minValue();g!==n&&r.seek(g)}this.dfa_debug&&console.log("ctx sensitive state "+s+" in "+u);const d=!0,p=this.computeStartState(e.atnStartState,s,d);return this.reportAttemptingFullContext(e,h,u.configs,n,r.index),a=this.execATNWithFullContext(e,u,p,r,n,s),a}if(u.isAcceptState){if(u.predicates===null)return u.prediction;const h=r.index;r.seek(n);const d=this.evalSemanticContext(u.predicates,s,!0);if(d.length===0)throw this.noViableAlt(r,s,u.configs,n);return d.length===1||this.reportAmbiguity(e,u,n,h,!1,d,u.configs),d.minValue()}o=u,l!==Ee.EOF&&(r.consume(),l=r.LA(1))}}getExistingTargetState(e,t){const r=e.edges;return r===null?null:r[t+1]||null}computeTargetState(e,t,r){const n=this.computeReachSet(t.configs,r,!1);if(n===null)return this.addDFAEdge(e,t,r,ji.ERROR),ji.ERROR;let s=new Dn(null,n);const a=this.getUniqueAlt(n);if(this.debug){const o=rr.getConflictingAltSubsets(n);console.log("SLL altSubSets="+bn(o)+", configs="+n+", predict="+a+", allSubsetsConflict="+rr.allSubsetsConflict(o)+", conflictingAlts="+this.getConflictingAlts(n))}return a!==kt.INVALID_ALT_NUMBER?(s.isAcceptState=!0,s.configs.uniqueAlt=a,s.prediction=a):rr.hasSLLConflictTerminatingPrediction(this.predictionMode,n)&&(s.configs.conflictingAlts=this.getConflictingAlts(n),s.requiresFullContext=!0,s.isAcceptState=!0,s.prediction=s.configs.conflictingAlts.minValue()),s.isAcceptState&&s.configs.hasSemanticContext&&(this.predicateDFAState(s,this.atn.getDecisionState(e.decision)),s.predicates!==null&&(s.prediction=kt.INVALID_ALT_NUMBER)),s=this.addDFAEdge(e,t,r,s),s}predicateDFAState(e,t){const r=t.transitions.length,n=this.getConflictingAltsOrUniqueAlt(e.configs),s=this.getPredsForAmbigAlts(n,e.configs,r);s!==null?(e.predicates=this.getPredicatePredictions(n,s),e.prediction=kt.INVALID_ALT_NUMBER):e.prediction=n.minValue()}execATNWithFullContext(e,t,r,n,s,a){(this.debug||this.trace_atn_sim)&&console.log("execATNWithFullContext "+r);let o,l=!1,u=r;n.seek(s);let h=n.LA(1),d=-1;for(;;){if(o=this.computeReachSet(u,h,!0),o===null){const g=this.noViableAlt(n,a,u,s);n.seek(s);const m=this.getSynValidOrSemInvalidAltThatFinishedDecisionEntryRule(u,a);if(m!==kt.INVALID_ALT_NUMBER)return m;throw g}const p=rr.getConflictingAltSubsets(o);if(this.debug&&console.log("LL altSubSets="+p+", predict="+rr.getUniqueAlt(p)+", resolvesToJustOneViableAlt="+rr.resolvesToJustOneViableAlt(p)),o.uniqueAlt=this.getUniqueAlt(o),o.uniqueAlt!==kt.INVALID_ALT_NUMBER){d=o.uniqueAlt;break}if(this.predictionMode!==rr.LL_EXACT_AMBIG_DETECTION){if(d=rr.resolvesToJustOneViableAlt(p),d!==kt.INVALID_ALT_NUMBER)break}else if(rr.allSubsetsConflict(p)&&rr.allSubsetsEqual(p)){l=!0,d=rr.getSingleViableAlt(p);break}u=o,h!==Ee.EOF&&(n.consume(),h=n.LA(1))}return o.uniqueAlt!==kt.INVALID_ALT_NUMBER?(this.reportContextSensitivity(e,d,o,s,n.index),d):(this.reportAmbiguity(e,t,s,n.index,l,null,o),d)}computeReachSet(e,t,r){this.debug&&console.log("in computeReachSet, starting closure: "+e),this.mergeCache===null&&(this.mergeCache=new CI);const n=new Or(r);let s=null;for(let o=0;o<e.items.length;o++){const l=e.items[o];if(this.debug&&console.log("testing "+this.getTokenName(t)+" at "+l),l.state instanceof Mr)(r||t===Ee.EOF)&&(s===null&&(s=[]),s.push(l),this.debug_add&&console.log("added "+l+" to skippedStopStates"));else for(let u=0;u<l.state.transitions.length;u++){const h=l.state.transitions[u],d=this.getReachableTarget(h,t);if(d!==null){const p=new Xt({state:d},l);n.add(p,this.mergeCache),this.debug_add&&console.log("added "+p+" to intermediate")}}}let a=null;if(s===null&&t!==Ee.EOF&&(n.items.length===1||this.getUniqueAlt(n)!==kt.INVALID_ALT_NUMBER)&&(a=n),a===null){a=new Or(r);const o=new ei,l=t===Ee.EOF;for(let u=0;u<n.items.length;u++)this.closure(n.items[u],a,o,!1,r,l)}if(t===Ee.EOF&&(a=this.removeAllConfigsNotInRuleStopState(a,a===n)),!(s===null||r&&rr.hasConfigInRuleStopState(a)))for(let o=0;o<s.length;o++)a.add(s[o],this.mergeCache);return this.trace_atn_sim&&console.log("computeReachSet "+e+" -> "+a),a.items.length===0?null:a}removeAllConfigsNotInRuleStopState(e,t){if(rr.allConfigsInRuleStopStates(e))return e;const r=new Or(e.fullCtx);for(let n=0;n<e.items.length;n++){const s=e.items[n];if(s.state instanceof Mr)r.add(s,this.mergeCache);else if(t&&s.state.epsilonOnlyTransitions&&this.atn.nextTokens(s.state).contains(Ee.EPSILON)){const a=this.atn.ruleToStopState[s.state.ruleIndex];r.add(new Xt({state:a},s),this.mergeCache)}}return r}computeStartState(e,t,r){const n=sd(this.atn,t),s=new Or(r);this.trace_atn_sim&&console.log("computeStartState from ATN state "+e+" initialContext="+n.toString(this.parser));for(let a=0;a<e.transitions.length;a++){const o=e.transitions[a].target,l=new Xt({state:o,alt:a+1,context:n},null),u=new ei;this.closure(l,s,u,!0,r,!1)}return s}applyPrecedenceFilter(e){let t;const r=[],n=new Or(e.fullCtx);for(let s=0;s<e.items.length;s++){if(t=e.items[s],t.alt!==1)continue;const a=t.semanticContext.evalPrecedence(this.parser,this._outerContext);a!==null&&(r[t.state.stateNumber]=t.context,a!==t.semanticContext?n.add(new Xt({semanticContext:a},t),this.mergeCache):n.add(t,this.mergeCache))}for(let s=0;s<e.items.length;s++)if(t=e.items[s],t.alt!==1){if(!t.precedenceFilterSuppressed){const a=r[t.state.stateNumber]||null;if(a!==null&&a.equals(t.context))continue}n.add(t,this.mergeCache)}return n}getReachableTarget(e,t){return e.matches(t,0,this.atn.maxTokenType)?e.target:null}getPredsForAmbigAlts(e,t,r){let n=[];for(let a=0;a<t.items.length;a++){const o=t.items[a];e.get(o.alt)&&(n[o.alt]=pt.orContext(n[o.alt]||null,o.semanticContext))}let s=0;for(let a=1;a<r+1;a++){const o=n[a]||null;o===null?n[a]=pt.NONE:o!==pt.NONE&&(s+=1)}return s===0&&(n=null),this.debug&&console.log("getPredsForAmbigAlts result "+bn(n)),n}getPredicatePredictions(e,t){const r=[];let n=!1;for(let s=1;s<t.length;s++){const a=t[s];e!==null&&e.get(s)&&r.push(new uv(a,s)),a!==pt.NONE&&(n=!0)}return n?r:null}getSynValidOrSemInvalidAltThatFinishedDecisionEntryRule(e,t){const r=this.splitAccordingToSemanticValidity(e,t),n=r[0],s=r[1];let a=this.getAltThatFinishedDecisionEntryRule(n);return a!==kt.INVALID_ALT_NUMBER||s.items.length>0&&(a=this.getAltThatFinishedDecisionEntryRule(s),a!==kt.INVALID_ALT_NUMBER)?a:kt.INVALID_ALT_NUMBER}getAltThatFinishedDecisionEntryRule(e){const t=[];for(let r=0;r<e.items.length;r++){const n=e.items[r];(n.reachesIntoOuterContext>0||n.state instanceof Mr&&n.context.hasEmptyPath())&&t.indexOf(n.alt)<0&&t.push(n.alt)}return t.length===0?kt.INVALID_ALT_NUMBER:Math.min.apply(null,t)}splitAccordingToSemanticValidity(e,t){const r=new Or(e.fullCtx),n=new Or(e.fullCtx);for(let s=0;s<e.items.length;s++){const a=e.items[s];a.semanticContext!==pt.NONE?a.semanticContext.evaluate(this.parser,t)?r.add(a):n.add(a):r.add(a)}return[r,n]}evalSemanticContext(e,t,r){const n=new kr;for(let s=0;s<e.length;s++){const a=e[s];if(a.pred===pt.NONE){if(n.set(a.alt),!r)break;continue}const o=a.pred.evaluate(this.parser,t);if((this.debug||this.dfa_debug)&&console.log("eval pred "+a+"="+o),o&&((this.debug||this.dfa_debug)&&console.log("PREDICT "+a.alt),n.set(a.alt),!r))break}return n}closure(e,t,r,n,s,a){this.closureCheckingStopState(e,t,r,n,s,0,a)}closureCheckingStopState(e,t,r,n,s,a,o){if((this.trace_atn_sim||this.debug_closure)&&console.log("closure("+e.toString(this.parser,!0)+")"),e.state instanceof Mr){if(!e.context.isEmpty()){for(let l=0;l<e.context.length;l++){if(e.context.getReturnState(l)===We.EMPTY_RETURN_STATE){if(s){t.add(new Xt({state:e.state,context:We.EMPTY},e),this.mergeCache);continue}this.debug&&console.log("FALLING off rule "+this.getRuleName(e.state.ruleIndex)),this.closure_(e,t,r,n,s,a,o);continue}const u=this.atn.states[e.context.getReturnState(l)],h=e.context.getParent(l),d={state:u,alt:e.alt,context:h,semanticContext:e.semanticContext},p=new Xt(d,null);p.reachesIntoOuterContext=e.reachesIntoOuterContext,this.closureCheckingStopState(p,t,r,n,s,a-1,o)}return}if(s)return void t.add(e,this.mergeCache);this.debug&&console.log("FALLING off rule "+this.getRuleName(e.state.ruleIndex))}this.closure_(e,t,r,n,s,a,o)}closure_(e,t,r,n,s,a,o){const l=e.state;l.epsilonOnlyTransitions||t.add(e,this.mergeCache);for(let u=0;u<l.transitions.length;u++){if(u===0&&this.canDropLoopEntryEdgeInLeftRecursiveRule(e))continue;const h=l.transitions[u],d=n&&!(h instanceof sv),p=this.getEpsilonTarget(e,h,d,a===0,s,o);if(p!==null){let g=a;if(e.state instanceof Mr){if(this._dfa!==null&&this._dfa.precedenceDfa&&h.outermostPrecedenceReturn===this._dfa.atnStartState.ruleIndex&&(p.precedenceFilterSuppressed=!0),p.reachesIntoOuterContext+=1,r.getOrAdd(p)!==p)continue;t.dipsIntoOuterContext=!0,g-=1,this.debug&&console.log("dips into outer ctx: "+p)}else{if(!h.isEpsilon&&r.getOrAdd(p)!==p)continue;h instanceof au&&g>=0&&(g+=1)}this.closureCheckingStopState(p,t,r,d,s,g,o)}}}canDropLoopEntryEdgeInLeftRecursiveRule(e){const t=e.state;if(t.stateType!==Oe.STAR_LOOP_ENTRY||t.stateType!==Oe.STAR_LOOP_ENTRY||!t.isPrecedenceDecision||e.context.isEmpty()||e.context.hasEmptyPath())return!1;const r=e.context.length;for(let a=0;a<r;a++)if(this.atn.states[e.context.getReturnState(a)].ruleIndex!==t.ruleIndex)return!1;const n=t.transitions[0].target.endState.stateNumber,s=this.atn.states[n];for(let a=0;a<r;a++){const o=e.context.getReturnState(a),l=this.atn.states[o];if(l.transitions.length!==1||!l.transitions[0].isEpsilon)return!1;const u=l.transitions[0].target;if(!(l.stateType===Oe.BLOCK_END&&u===t||l===s||u===s||u.stateType===Oe.BLOCK_END&&u.transitions.length===1&&u.transitions[0].isEpsilon&&u.transitions[0].target===t))return!1}return!0}getRuleName(e){return this.parser!==null&&e>=0?this.parser.ruleNames[e]:"<rule "+e+">"}getEpsilonTarget(e,t,r,n,s,a){switch(t.serializationType){case Me.RULE:return this.ruleTransition(e,t);case Me.PRECEDENCE:return this.precedenceTransition(e,t,r,n,s);case Me.PREDICATE:return this.predTransition(e,t,r,n,s);case Me.ACTION:return this.actionTransition(e,t);case Me.EPSILON:return new Xt({state:t.target},e);case Me.ATOM:case Me.RANGE:case Me.SET:return a&&t.matches(Ee.EOF,0,1)?new Xt({state:t.target},e):null;default:return null}}actionTransition(e,t){if(this.debug){const r=t.actionIndex===-1?65535:t.actionIndex;console.log("ACTION edge "+t.ruleIndex+":"+r)}return new Xt({state:t.target},e)}precedenceTransition(e,t,r,n,s){this.debug&&(console.log("PRED (collectPredicates="+r+") "+t.precedence+">=_p, ctx dependent=true"),this.parser!==null&&console.log("context surrounding pred is "+bn(this.parser.getRuleInvocationStack())));let a=null;if(r&&n)if(s){const o=this._input.index;this._input.seek(this._startIndex);const l=t.getPredicate().evaluate(this.parser,this._outerContext);this._input.seek(o),l&&(a=new Xt({state:t.target},e))}else{const o=pt.andContext(e.semanticContext,t.getPredicate());a=new Xt({state:t.target,semanticContext:o},e)}else a=new Xt({state:t.target},e);return this.debug&&console.log("config from pred transition="+a),a}predTransition(e,t,r,n,s){this.debug&&(console.log("PRED (collectPredicates="+r+") "+t.ruleIndex+":"+t.predIndex+", ctx dependent="+t.isCtxDependent),this.parser!==null&&console.log("context surrounding pred is "+bn(this.parser.getRuleInvocationStack())));let a=null;if(r&&(t.isCtxDependent&&n||!t.isCtxDependent))if(s){const o=this._input.index;this._input.seek(this._startIndex);const l=t.getPredicate().evaluate(this.parser,this._outerContext);this._input.seek(o),l&&(a=new Xt({state:t.target},e))}else{const o=pt.andContext(e.semanticContext,t.getPredicate());a=new Xt({state:t.target,semanticContext:o},e)}else a=new Xt({state:t.target},e);return this.debug&&console.log("config from pred transition="+a),a}ruleTransition(e,t){this.debug&&console.log("CALL rule "+this.getRuleName(t.target.ruleIndex)+", ctx="+e.context);const r=t.followState,n=Pr.create(e.context,r.stateNumber);return new Xt({state:t.target,context:n},e)}getConflictingAlts(e){const t=rr.getConflictingAltSubsets(e);return rr.getAlts(t)}getConflictingAltsOrUniqueAlt(e){let t=null;return e.uniqueAlt!==kt.INVALID_ALT_NUMBER?(t=new kr,t.set(e.uniqueAlt)):t=e.conflictingAlts,t}getTokenName(e){if(e===Ee.EOF)return"EOF";if(this.parser!==null&&this.parser.literalNames!==null){if(!(e>=this.parser.literalNames.length&&e>=this.parser.symbolicNames.length))return(this.parser.literalNames[e]||this.parser.symbolicNames[e])+"<"+e+">";console.log(e+" ttype out of range: "+this.parser.literalNames),console.log(""+this.parser.getInputStream().getTokens())}return""+e}getLookaheadName(e){return this.getTokenName(e.LA(1))}dumpDeadEndConfigs(e){console.log("dead end configs: ");const t=e.getDeadEndConfigs();for(let r=0;r<t.length;r++){const n=t[r];let s="no edges";if(n.state.transitions.length>0){const a=n.state.transitions[0];a instanceof hd?s="Atom "+this.getTokenName(a.label):a instanceof td&&(s=(a instanceof rd?"~":"")+"Set "+a.set)}console.error(n.toString(this.parser,!0)+":"+s)}}noViableAlt(e,t,r,n){return new fu(this.parser,e,e.get(n),e.LT(1),r,t)}getUniqueAlt(e){let t=kt.INVALID_ALT_NUMBER;for(let r=0;r<e.items.length;r++){const n=e.items[r];if(t===kt.INVALID_ALT_NUMBER)t=n.alt;else if(n.alt!==t)return kt.INVALID_ALT_NUMBER}return t}addDFAEdge(e,t,r,n){if(this.debug&&console.log("EDGE "+t+" -> "+n+" upon "+this.getTokenName(r)),n===null)return null;if(n=this.addDFAState(e,n),t===null||r<-1||r>this.atn.maxTokenType)return n;if(t.edges===null&&(t.edges=[]),t.edges[r+1]=n,this.debug){const s=this.parser===null?null:this.parser.literalNames,a=this.parser===null?null:this.parser.symbolicNames;console.log(`DFA=
`+e.toString(s,a))}return n}addDFAState(e,t){if(t===ji.ERROR)return t;const r=e.states.get(t);return r!==null?(this.trace_atn_sim&&console.log("addDFAState "+t+" exists"),r):(t.stateNumber=e.states.length,t.configs.readOnly||(t.configs.optimizeConfigs(this),t.configs.setReadonly(!0)),this.trace_atn_sim&&console.log("addDFAState new "+t),e.states.add(t),this.debug&&console.log("adding new DFA state: "+t),t)}reportAttemptingFullContext(e,t,r,n,s){if(this.debug||this.retry_debug){const a=new dt(n,s+1);console.log("reportAttemptingFullContext decision="+e.decision+":"+r+", input="+this.parser.getTokenStream().getText(a))}this.parser!==null&&this.parser.getErrorListener().reportAttemptingFullContext(this.parser,e,n,s,t,r)}reportContextSensitivity(e,t,r,n,s){if(this.debug||this.retry_debug){const a=new dt(n,s+1);console.log("reportContextSensitivity decision="+e.decision+":"+r+", input="+this.parser.getTokenStream().getText(a))}this.parser!==null&&this.parser.getErrorListener().reportContextSensitivity(this.parser,e,n,s,t,r)}reportAmbiguity(e,t,r,n,s,a,o){if(this.debug||this.retry_debug){const l=new dt(r,n+1);console.log("reportAmbiguity "+a+":"+o+", input="+this.parser.getTokenStream().getText(l))}this.parser!==null&&this.parser.getErrorListener().reportAmbiguity(this.parser,e,r,n,s,a,o)}}class hv{constructor(){this.cache=new Uo}add(e){if(e===We.EMPTY)return We.EMPTY;const t=this.cache.get(e)||null;return t!==null?t:(this.cache.set(e,e),e)}get(e){return this.cache.get(e)||null}get length(){return this.cache.length}}const wI={ATN:kt,ATNDeserializer:bd,LexerATNSimulator:$t,ParserATNSimulator:cv,PredictionMode:rr,PredictionContextCache:hv};class Td{constructor(e,t,r){this.dfa=e,this.literalNames=t||[],this.symbolicNames=r||[]}toString(){if(this.dfa.s0===null)return null;let e="";const t=this.dfa.sortedStates();for(let r=0;r<t.length;r++){const n=t[r];if(n.edges!==null){const s=n.edges.length;for(let a=0;a<s;a++){const o=n.edges[a]||null;o!==null&&o.stateNumber!==2147483647&&(e=e.concat(this.getStateString(n)),e=e.concat("-"),e=e.concat(this.getEdgeLabel(a)),e=e.concat("->"),e=e.concat(this.getStateString(o)),e=e.concat(`
`))}}}return e.length===0?null:e}getEdgeLabel(e){return e===0?"EOF":this.literalNames!==null||this.symbolicNames!==null?this.literalNames[e-1]||this.symbolicNames[e-1]:String.fromCharCode(e-1)}getStateString(e){const t=(e.isAcceptState?":":"")+"s"+e.stateNumber+(e.requiresFullContext?"^":"");return e.isAcceptState?e.predicates!==null?t+"=>"+bn(e.predicates):t+"=>"+e.prediction.toString():t}}let dv=class extends Td{constructor(e){super(e,null)}getEdgeLabel(e){return"'"+String.fromCharCode(e)+"'"}};class fv{constructor(e,t){if(t===void 0&&(t=0),this.atnStartState=e,this.decision=t,this._states=new ei,this.s0=null,this.precedenceDfa=!1,e instanceof Gs&&e.isPrecedenceDecision){this.precedenceDfa=!0;const r=new Dn(null,new Or);r.edges=[],r.isAcceptState=!1,r.requiresFullContext=!1,this.s0=r}}getPrecedenceStartState(e){if(!this.precedenceDfa)throw"Only precedence DFAs may contain a precedence start state.";return e<0||e>=this.s0.edges.length?null:this.s0.edges[e]||null}setPrecedenceStartState(e,t){if(!this.precedenceDfa)throw"Only precedence DFAs may contain a precedence start state.";e<0||(this.s0.edges[e]=t)}setPrecedenceDfa(e){if(this.precedenceDfa!==e){if(this._states=new ei,e){const t=new Dn(null,new Or);t.edges=[],t.isAcceptState=!1,t.requiresFullContext=!1,this.s0=t}else this.s0=null;this.precedenceDfa=e}}sortedStates(){return this._states.values().sort(function(e,t){return e.stateNumber-t.stateNumber})}toString(e,t){return e=e||null,t=t||null,this.s0===null?"":new Td(this,e,t).toString()}toLexerString(){return this.s0===null?"":new dv(this).toString()}get states(){return this._states}}const LI={DFA:fv,DFASerializer:Td,LexerDFASerializer:dv,PredPrediction:uv},_I={PredictionContext:We},MI={Interval:dt,IntervalSet:gi};class Dd{visitTerminal(e){}visitErrorNode(e){}enterEveryRule(e){}exitEveryRule(e){}}class gv{visit(e){return Array.isArray(e)?e.map(function(t){return t.accept(this)},this):e.accept(this)}visitChildren(e){return e.children?this.visit(e.children):null}visitTerminal(e){}visitErrorNode(e){}}class gu{walk(e,t){if(t instanceof ou||t.isErrorNode!==void 0&&t.isErrorNode())e.visitErrorNode(t);else if(t instanceof Yi)e.visitTerminal(t);else{this.enterRule(e,t);for(let r=0;r<t.getChildCount();r++){const n=t.getChild(r);this.walk(e,n)}this.exitRule(e,t)}}enterRule(e,t){const r=t.ruleContext;e.enterEveryRule(r),r.enterRule(e)}exitRule(e,t){const r=t.ruleContext;r.exitRule(e),e.exitEveryRule(r)}}gu.DEFAULT=new gu;const PI={Trees:Zy,RuleNode:Bo,ErrorNode:ou,TerminalNode:Yi,ParseTreeListener:Dd,ParseTreeVisitor:gv,ParseTreeWalker:gu};class Ca extends Tn{constructor(e){super({message:"",recognizer:e,input:e.getInputStream(),ctx:e._ctx}),this.offendingToken=e.getCurrentToken()}}class Rd extends Tn{constructor(e,t,r){super({message:kI(t,r||null),recognizer:e,input:e.getInputStream(),ctx:e._ctx});const n=e._interp.atn.states[e.state].transitions[0];n instanceof av?(this.ruleIndex=n.ruleIndex,this.predicateIndex=n.predIndex):(this.ruleIndex=0,this.predicateIndex=0),this.predicate=t,this.offendingToken=e.getCurrentToken()}}function kI(i,e){return e!==null?e:"failed predicate: {"+i+"}?"}class pv extends qo{constructor(e){super(),e=e||!0,this.exactOnly=e}reportAmbiguity(e,t,r,n,s,a,o){if(this.exactOnly&&!s)return;const l="reportAmbiguity d="+this.getDecisionDescription(e,t)+": ambigAlts="+this.getConflictingAlts(a,o)+", input='"+e.getTokenStream().getText(new dt(r,n))+"'";e.notifyErrorListeners(l)}reportAttemptingFullContext(e,t,r,n,s,a){const o="reportAttemptingFullContext d="+this.getDecisionDescription(e,t)+", input='"+e.getTokenStream().getText(new dt(r,n))+"'";e.notifyErrorListeners(o)}reportContextSensitivity(e,t,r,n,s,a){const o="reportContextSensitivity d="+this.getDecisionDescription(e,t)+", input='"+e.getTokenStream().getText(new dt(r,n))+"'";e.notifyErrorListeners(o)}getDecisionDescription(e,t){const r=t.decision,n=t.atnStartState.ruleIndex,s=e.ruleNames;if(n<0||n>=s.length)return""+r;const a=s[n]||null;return a===null||a.length===0?""+r:`${r} (${a})`}getConflictingAlts(e,t){if(e!==null)return e;const r=new kr;for(let n=0;n<t.items.length;n++)r.set(t.items[n].alt);return`{${r.values().join(", ")}}`}}class Id extends Error{constructor(){super(),Error.captureStackTrace(this,Id)}}class OI{reset(e){}recoverInline(e){}recover(e,t){}sync(e){}inErrorRecoveryMode(e){}reportError(e){}}class pu extends OI{constructor(){super(),this.errorRecoveryMode=!1,this.lastErrorIndex=-1,this.lastErrorStates=null,this.nextTokensContext=null,this.nextTokenState=0}reset(e){this.endErrorCondition(e)}beginErrorCondition(e){this.errorRecoveryMode=!0}inErrorRecoveryMode(e){return this.errorRecoveryMode}endErrorCondition(e){this.errorRecoveryMode=!1,this.lastErrorStates=null,this.lastErrorIndex=-1}reportMatch(e){this.endErrorCondition(e)}reportError(e,t){this.inErrorRecoveryMode(e)||(this.beginErrorCondition(e),t instanceof fu?this.reportNoViableAlternative(e,t):t instanceof Ca?this.reportInputMismatch(e,t):t instanceof Rd?this.reportFailedPredicate(e,t):(console.log("unknown recognition error type: "+t.constructor.name),console.log(t.stack),e.notifyErrorListeners(t.getOffendingToken(),t.getMessage(),t)))}recover(e,t){this.lastErrorIndex===e.getInputStream().index&&this.lastErrorStates!==null&&this.lastErrorStates.indexOf(e.state)>=0&&e.consume(),this.lastErrorIndex=e._input.index,this.lastErrorStates===null&&(this.lastErrorStates=[]),this.lastErrorStates.push(e.state);const r=this.getErrorRecoverySet(e);this.consumeUntil(e,r)}sync(e){if(this.inErrorRecoveryMode(e))return;const t=e._interp.atn.states[e.state],r=e.getTokenStream().LA(1),n=e.atn.nextTokens(t);if(n.contains(r))return this.nextTokensContext=null,void(this.nextTokenState=Oe.INVALID_STATE_NUMBER);if(n.contains(Ee.EPSILON))this.nextTokensContext===null&&(this.nextTokensContext=e._ctx,this.nextTokensState=e._stateNumber);else switch(t.stateType){case Oe.BLOCK_START:case Oe.STAR_BLOCK_START:case Oe.PLUS_BLOCK_START:case Oe.STAR_LOOP_ENTRY:if(this.singleTokenDeletion(e)!==null)return;throw new Ca(e);case Oe.PLUS_LOOP_BACK:case Oe.STAR_LOOP_BACK:{this.reportUnwantedToken(e);const s=new gi;s.addSet(e.getExpectedTokens());const a=s.addSet(this.getErrorRecoverySet(e));this.consumeUntil(e,a)}}}reportNoViableAlternative(e,t){const r=e.getTokenStream();let n;n=r!==null?t.startToken.type===Ee.EOF?"<EOF>":r.getText(new dt(t.startToken.tokenIndex,t.offendingToken.tokenIndex)):"<unknown input>";const s="no viable alternative at input "+this.escapeWSAndQuote(n);e.notifyErrorListeners(s,t.offendingToken,t)}reportInputMismatch(e,t){const r="mismatched input "+this.getTokenErrorDisplay(t.offendingToken)+" expecting "+t.getExpectedTokens().toString(e.literalNames,e.symbolicNames);e.notifyErrorListeners(r,t.offendingToken,t)}reportFailedPredicate(e,t){const r="rule "+e.ruleNames[e._ctx.ruleIndex]+" "+t.message;e.notifyErrorListeners(r,t.offendingToken,t)}reportUnwantedToken(e){if(this.inErrorRecoveryMode(e))return;this.beginErrorCondition(e);const t=e.getCurrentToken(),r="extraneous input "+this.getTokenErrorDisplay(t)+" expecting "+this.getExpectedTokens(e).toString(e.literalNames,e.symbolicNames);e.notifyErrorListeners(r,t,null)}reportMissingToken(e){if(this.inErrorRecoveryMode(e))return;this.beginErrorCondition(e);const t=e.getCurrentToken(),r="missing "+this.getExpectedTokens(e).toString(e.literalNames,e.symbolicNames)+" at "+this.getTokenErrorDisplay(t);e.notifyErrorListeners(r,t,null)}recoverInline(e){const t=this.singleTokenDeletion(e);if(t!==null)return e.consume(),t;if(this.singleTokenInsertion(e))return this.getMissingSymbol(e);throw new Ca(e)}singleTokenInsertion(e){const t=e.getTokenStream().LA(1),r=e._interp.atn,n=r.states[e.state].transitions[0].target;return!!r.nextTokens(n,e._ctx).contains(t)&&(this.reportMissingToken(e),!0)}singleTokenDeletion(e){const t=e.getTokenStream().LA(2);if(this.getExpectedTokens(e).contains(t)){this.reportUnwantedToken(e),e.consume();const r=e.getCurrentToken();return this.reportMatch(e),r}return null}getMissingSymbol(e){const t=e.getCurrentToken(),r=this.getExpectedTokens(e).first();let n;n=r===Ee.EOF?"<missing EOF>":"<missing "+e.literalNames[r]+">";let s=t;const a=e.getTokenStream().LT(-1);return s.type===Ee.EOF&&a!==null&&(s=a),e.getTokenFactory().create(s.source,r,n,Ee.DEFAULT_CHANNEL,-1,-1,s.line,s.column)}getExpectedTokens(e){return e.getExpectedTokens()}getTokenErrorDisplay(e){if(e===null)return"<no token>";let t=e.text;return t===null&&(t=e.type===Ee.EOF?"<EOF>":"<"+e.type+">"),this.escapeWSAndQuote(t)}escapeWSAndQuote(e){return"'"+(e=(e=(e=e.replace(/\n/g,"\\n")).replace(/\r/g,"\\r")).replace(/\t/g,"\\t"))+"'"}getErrorRecoverySet(e){const t=e._interp.atn;let r=e._ctx;const n=new gi;for(;r!==null&&r.invokingState>=0;){const s=t.states[r.invokingState].transitions[0],a=t.nextTokens(s.followState);n.addSet(a),r=r.parentCtx}return n.removeOne(Ee.EPSILON),n}consumeUntil(e,t){let r=e.getTokenStream().LA(1);for(;r!==Ee.EOF&&!t.contains(r);)e.consume(),r=e.getTokenStream().LA(1)}}class mv extends pu{constructor(){super()}recover(e,t){let r=e._ctx;for(;r!==null;)r.exception=t,r=r.parentCtx;throw new Id(t)}recoverInline(e){this.recover(e,new Ca(e))}sync(e){}}const FI={RecognitionException:Tn,NoViableAltException:fu,LexerNoViableAltException:xd,InputMismatchException:Ca,FailedPredicateException:Rd,DiagnosticErrorListener:pv,BailErrorStrategy:mv,DefaultErrorStrategy:pu,ErrorListener:qo};class qs{constructor(e,t){if(this.name="<empty>",this.strdata=e,this.decodeToUnicodeCodePoints=t||!1,this._index=0,this.data=[],this.decodeToUnicodeCodePoints)for(let r=0;r<this.strdata.length;){const n=this.strdata.codePointAt(r);this.data.push(n),r+=n<=65535?1:2}else{this.data=new Array(this.strdata.length);for(let r=0;r<this.strdata.length;r++)this.data[r]=this.strdata.charCodeAt(r)}this._size=this.data.length}reset(){this._index=0}consume(){if(this._index>=this._size)throw"cannot consume EOF";this._index+=1}LA(e){if(e===0)return 0;e<0&&(e+=1);const t=this._index+e-1;return t<0||t>=this._size?Ee.EOF:this.data[t]}LT(e){return this.LA(e)}mark(){return-1}release(e){}seek(e){e<=this._index?this._index=e:this._index=Math.min(e,this._size)}getText(e,t){if(t>=this._size&&(t=this._size-1),e>=this._size)return"";if(this.decodeToUnicodeCodePoints){let r="";for(let n=e;n<=t;n++)r+=String.fromCodePoint(this.data[n]);return r}return this.strdata.slice(e,t+1)}toString(){return this.strdata}get index(){return this._index}get size(){return this._size}}class Nd extends qs{constructor(e,t){super(e,t)}}var yv=Us(763);const vv=typeof process<"u"&&process.versions!=null&&process.versions.node!=null;class Ev extends Nd{static fromPath(e,t,r){if(!vv)throw new Error("FileStream is only available when running in Node!");yv.readFile(e,t,function(n,s){let a=null;s!==null&&(a=new qs(s,!0)),r(n,a)})}constructor(e,t,r){if(!vv)throw new Error("FileStream is only available when running in Node!");super(yv.readFileSync(e,t||"utf-8"),r),this.fileName=e}}const bv={fromString:function(i){return new qs(i,!0)},fromBlob:function(i,e,t,r){const n=new window.FileReader;n.onload=function(s){const a=new qs(s.target.result,!0);t(a)},n.onerror=r,n.readAsText(i,e)},fromBuffer:function(i,e){return new qs(i.toString(e),!0)},fromPath:function(i,e,t){Ev.fromPath(i,e,t)},fromPathSync:function(i,e){return new Ev(i,e)}},BI={arrayToString:bn,stringToCharArray:function(i){let e=new Uint16Array(i.length);for(let t=0;t<i.length;t++)e[t]=i.charCodeAt(t);return e}};class UI{}class Av extends UI{constructor(e){super(),this.tokenSource=e,this.tokens=[],this.index=-1,this.fetchedEOF=!1}mark(){return 0}release(e){}reset(){this.seek(0)}seek(e){this.lazyInit(),this.index=this.adjustSeekIndex(e)}get size(){return this.tokens.length}get(e){return this.lazyInit(),this.tokens[e]}consume(){let e=!1;if(e=this.index>=0&&(this.fetchedEOF?this.index<this.tokens.length-1:this.index<this.tokens.length),!e&&this.LA(1)===Ee.EOF)throw"cannot consume EOF";this.sync(this.index+1)&&(this.index=this.adjustSeekIndex(this.index+1))}sync(e){const t=e-this.tokens.length+1;return!(t>0)||this.fetch(t)>=t}fetch(e){if(this.fetchedEOF)return 0;for(let t=0;t<e;t++){const r=this.tokenSource.nextToken();if(r.tokenIndex=this.tokens.length,this.tokens.push(r),r.type===Ee.EOF)return this.fetchedEOF=!0,t+1}return e}getTokens(e,t,r){if(r===void 0&&(r=null),e<0||t<0)return null;this.lazyInit();const n=[];t>=this.tokens.length&&(t=this.tokens.length-1);for(let s=e;s<t;s++){const a=this.tokens[s];if(a.type===Ee.EOF)break;(r===null||r.contains(a.type))&&n.push(a)}return n}LA(e){return this.LT(e).type}LB(e){return this.index-e<0?null:this.tokens[this.index-e]}LT(e){if(this.lazyInit(),e===0)return null;if(e<0)return this.LB(-e);const t=this.index+e-1;return this.sync(t),t>=this.tokens.length?this.tokens[this.tokens.length-1]:this.tokens[t]}adjustSeekIndex(e){return e}lazyInit(){this.index===-1&&this.setup()}setup(){this.sync(0),this.index=this.adjustSeekIndex(0)}setTokenSource(e){this.tokenSource=e,this.tokens=[],this.index=-1,this.fetchedEOF=!1}nextTokenOnChannel(e,t){if(this.sync(e),e>=this.tokens.length)return-1;let r=this.tokens[e];for(;r.channel!==t;){if(r.type===Ee.EOF)return-1;e+=1,this.sync(e),r=this.tokens[e]}return e}previousTokenOnChannel(e,t){for(;e>=0&&this.tokens[e].channel!==t;)e-=1;return e}getHiddenTokensToRight(e,t){if(t===void 0&&(t=-1),this.lazyInit(),e<0||e>=this.tokens.length)throw e+" not in 0.."+this.tokens.length-1;const r=this.nextTokenOnChannel(e+1,Ut.DEFAULT_TOKEN_CHANNEL),n=e+1,s=r===-1?this.tokens.length-1:r;return this.filterForChannel(n,s,t)}getHiddenTokensToLeft(e,t){if(t===void 0&&(t=-1),this.lazyInit(),e<0||e>=this.tokens.length)throw e+" not in 0.."+this.tokens.length-1;const r=this.previousTokenOnChannel(e-1,Ut.DEFAULT_TOKEN_CHANNEL);if(r===e-1)return null;const n=r+1,s=e-1;return this.filterForChannel(n,s,t)}filterForChannel(e,t,r){const n=[];for(let s=e;s<t+1;s++){const a=this.tokens[s];r===-1?a.channel!==Ut.DEFAULT_TOKEN_CHANNEL&&n.push(a):a.channel===r&&n.push(a)}return n.length===0?null:n}getSourceName(){return this.tokenSource.getSourceName()}getText(e){this.lazyInit(),this.fill(),e||(e=new dt(0,this.tokens.length-1));let t=e.start;t instanceof Ee&&(t=t.tokenIndex);let r=e.stop;if(r instanceof Ee&&(r=r.tokenIndex),t===null||r===null||t<0||r<0)return"";r>=this.tokens.length&&(r=this.tokens.length-1);let n="";for(let s=t;s<r+1;s++){const a=this.tokens[s];if(a.type===Ee.EOF)break;n+=a.text}return n}fill(){for(this.lazyInit();this.fetch(1e3)===1e3;);}}Object.defineProperty(Av,"size",{get:function(){return this.tokens.length}});class Sv extends Av{constructor(e,t){super(e),this.channel=t===void 0?Ee.DEFAULT_CHANNEL:t}adjustSeekIndex(e){return this.nextTokenOnChannel(e,this.channel)}LB(e){if(e===0||this.index-e<0)return null;let t=this.index,r=1;for(;r<=e;)t=this.previousTokenOnChannel(t-1,this.channel),r+=1;return t<0?null:this.tokens[t]}LT(e){if(this.lazyInit(),e===0)return null;if(e<0)return this.LB(-e);let t=this.index,r=1;for(;r<e;)this.sync(t+1)&&(t=this.nextTokenOnChannel(t+1,this.channel)),r+=1;return this.tokens[t]}getNumberOfOnChannelTokens(){let e=0;this.fill();for(let t=0;t<this.tokens.length;t++){const r=this.tokens[t];if(r.channel===this.channel&&(e+=1),r.type===Ee.EOF)break}return e}}class $I extends Dd{constructor(e){super(),this.parser=e}enterEveryRule(e){console.log("enter   "+this.parser.ruleNames[e.ruleIndex]+", LT(1)="+this.parser._input.LT(1).text)}visitTerminal(e){console.log("consume "+e.symbol+" rule "+this.parser.ruleNames[this.parser._ctx.ruleIndex])}exitEveryRule(e){console.log("exit    "+this.parser.ruleNames[e.ruleIndex]+", LT(1)="+this.parser._input.LT(1).text)}}class Cd extends du{constructor(e){super(),this._input=null,this._errHandler=new pu,this._precedenceStack=[],this._precedenceStack.push(0),this._ctx=null,this.buildParseTrees=!0,this._tracer=null,this._parseListeners=null,this._syntaxErrors=0,this.setInputStream(e)}reset(){this._input!==null&&this._input.seek(0),this._errHandler.reset(this),this._ctx=null,this._syntaxErrors=0,this.setTrace(!1),this._precedenceStack=[],this._precedenceStack.push(0),this._interp!==null&&this._interp.reset()}match(e){let t=this.getCurrentToken();return t.type===e?(this._errHandler.reportMatch(this),this.consume()):(t=this._errHandler.recoverInline(this),this.buildParseTrees&&t.tokenIndex===-1&&this._ctx.addErrorNode(t)),t}matchWildcard(){let e=this.getCurrentToken();return e.type>0?(this._errHandler.reportMatch(this),this.consume()):(e=this._errHandler.recoverInline(this),this.buildParseTrees&&e.tokenIndex===-1&&this._ctx.addErrorNode(e)),e}getParseListeners(){return this._parseListeners||[]}addParseListener(e){if(e===null)throw"listener";this._parseListeners===null&&(this._parseListeners=[]),this._parseListeners.push(e)}removeParseListener(e){if(this._parseListeners!==null){const t=this._parseListeners.indexOf(e);t>=0&&this._parseListeners.splice(t,1),this._parseListeners.length===0&&(this._parseListeners=null)}}removeParseListeners(){this._parseListeners=null}triggerEnterRuleEvent(){if(this._parseListeners!==null){const e=this._ctx;this._parseListeners.forEach(function(t){t.enterEveryRule(e),e.enterRule(t)})}}triggerExitRuleEvent(){if(this._parseListeners!==null){const e=this._ctx;this._parseListeners.slice(0).reverse().forEach(function(t){e.exitRule(t),t.exitEveryRule(e)})}}getTokenFactory(){return this._input.tokenSource._factory}setTokenFactory(e){this._input.tokenSource._factory=e}getATNWithBypassAlts(){const e=this.getSerializedATN();if(e===null)throw"The current parser does not support an ATN with bypass alternatives.";let t=this.bypassAltsAtnCache[e];if(t===null){const r=new Go;r.generateRuleBypassTransitions=!0,t=new bd(r).deserialize(e),this.bypassAltsAtnCache[e]=t}return t}getInputStream(){return this.getTokenStream()}setInputStream(e){this.setTokenStream(e)}getTokenStream(){return this._input}setTokenStream(e){this._input=null,this.reset(),this._input=e}get syntaxErrorsCount(){return this._syntaxErrors}getCurrentToken(){return this._input.LT(1)}notifyErrorListeners(e,t,r){r=r||null,(t=t||null)===null&&(t=this.getCurrentToken()),this._syntaxErrors+=1;const n=t.line,s=t.column;this.getErrorListener().syntaxError(this,t,n,s,e,r)}consume(){const e=this.getCurrentToken();e.type!==Ee.EOF&&this.getInputStream().consume();const t=this._parseListeners!==null&&this._parseListeners.length>0;if(this.buildParseTrees||t){let r;r=this._errHandler.inErrorRecoveryMode(this)?this._ctx.addErrorNode(e):this._ctx.addTokenNode(e),r.invokingState=this.state,t&&this._parseListeners.forEach(function(n){r instanceof ou||r.isErrorNode!==void 0&&r.isErrorNode()?n.visitErrorNode(r):r instanceof Yi&&n.visitTerminal(r)})}return e}addContextToParseTree(){this._ctx.parentCtx!==null&&this._ctx.parentCtx.addChild(this._ctx)}enterRule(e,t,r){this.state=t,this._ctx=e,this._ctx.start=this._input.LT(1),this.buildParseTrees&&this.addContextToParseTree(),this.triggerEnterRuleEvent()}exitRule(){this._ctx.stop=this._input.LT(-1),this.triggerExitRuleEvent(),this.state=this._ctx.invokingState,this._ctx=this._ctx.parentCtx}enterOuterAlt(e,t){e.setAltNumber(t),this.buildParseTrees&&this._ctx!==e&&this._ctx.parentCtx!==null&&(this._ctx.parentCtx.removeLastChild(),this._ctx.parentCtx.addChild(e)),this._ctx=e}getPrecedence(){return this._precedenceStack.length===0?-1:this._precedenceStack[this._precedenceStack.length-1]}enterRecursionRule(e,t,r,n){this.state=t,this._precedenceStack.push(n),this._ctx=e,this._ctx.start=this._input.LT(1),this.triggerEnterRuleEvent()}pushNewRecursionContext(e,t,r){const n=this._ctx;n.parentCtx=e,n.invokingState=t,n.stop=this._input.LT(-1),this._ctx=e,this._ctx.start=n.start,this.buildParseTrees&&this._ctx.addChild(n),this.triggerEnterRuleEvent()}unrollRecursionContexts(e){this._precedenceStack.pop(),this._ctx.stop=this._input.LT(-1);const t=this._ctx,r=this.getParseListeners();if(r!==null&&r.length>0)for(;this._ctx!==e;)this.triggerExitRuleEvent(),this._ctx=this._ctx.parentCtx;else this._ctx=e;t.parentCtx=e,this.buildParseTrees&&e!==null&&e.addChild(t)}getInvokingContext(e){let t=this._ctx;for(;t!==null;){if(t.ruleIndex===e)return t;t=t.parentCtx}return null}precpred(e,t){return t>=this._precedenceStack[this._precedenceStack.length-1]}inContext(e){return!1}isExpectedToken(e){const t=this._interp.atn;let r=this._ctx;const n=t.states[this.state];let s=t.nextTokens(n);if(s.contains(e))return!0;if(!s.contains(Ee.EPSILON))return!1;for(;r!==null&&r.invokingState>=0&&s.contains(Ee.EPSILON);){const a=t.states[r.invokingState].transitions[0];if(s=t.nextTokens(a.followState),s.contains(e))return!0;r=r.parentCtx}return!(!s.contains(Ee.EPSILON)||e!==Ee.EOF)}getExpectedTokens(){return this._interp.atn.getExpectedTokens(this.state,this._ctx)}getExpectedTokensWithinCurrentRule(){const e=this._interp.atn,t=e.states[this.state];return e.nextTokens(t)}getRuleIndex(e){const t=this.getRuleIndexMap()[e];return t!==null?t:-1}getRuleInvocationStack(e){(e=e||null)===null&&(e=this._ctx);const t=[];for(;e!==null;){const r=e.ruleIndex;r<0?t.push("n/a"):t.push(this.ruleNames[r]),e=e.parentCtx}return t}getDFAStrings(){return this._interp.decisionToDFA.toString()}dumpDFA(){let e=!1;for(let t=0;t<this._interp.decisionToDFA.length;t++){const r=this._interp.decisionToDFA[t];r.states.length>0&&(e&&console.log(),this.printer.println("Decision "+r.decision+":"),this.printer.print(r.toString(this.literalNames,this.symbolicNames)),e=!0)}}getSourceName(){return this._input.getSourceName()}setTrace(e){e?(this._tracer!==null&&this.removeParseListener(this._tracer),this._tracer=new $I(this),this.addParseListener(this._tracer)):(this.removeParseListener(this._tracer),this._tracer=null)}}Cd.bypassAltsAtnCache={};class xv extends Yi{constructor(e){super(),this.parentCtx=null,this.symbol=e}getChild(e){return null}getSymbol(){return this.symbol}getParent(){return this.parentCtx}getPayload(){return this.symbol}getSourceInterval(){if(this.symbol===null)return dt.INVALID_INTERVAL;const e=this.symbol.tokenIndex;return new dt(e,e)}getChildCount(){return 0}accept(e){return e.visitTerminal(this)}getText(){return this.symbol.text}toString(){return this.symbol.type===Ee.EOF?"<EOF>":this.symbol.text}}class Tv extends xv{constructor(e){super(e)}isErrorNode(){return!0}accept(e){return e.visitErrorNode(this)}}class wd extends $s{constructor(e,t){super(e,t),this.children=null,this.start=null,this.stop=null,this.exception=null}copyFrom(e){this.parentCtx=e.parentCtx,this.invokingState=e.invokingState,this.children=null,this.start=e.start,this.stop=e.stop,e.children&&(this.children=[],e.children.map(function(t){t instanceof Tv&&(this.children.push(t),t.parentCtx=this)},this))}enterRule(e){}exitRule(e){}addChild(e){return this.children===null&&(this.children=[]),this.children.push(e),e}removeLastChild(){this.children!==null&&this.children.pop()}addTokenNode(e){const t=new xv(e);return this.addChild(t),t.parentCtx=this,t}addErrorNode(e){const t=new Tv(e);return this.addChild(t),t.parentCtx=this,t}getChild(e,t){if(t=t||null,this.children===null||e<0||e>=this.children.length)return null;if(t===null)return this.children[e];for(let r=0;r<this.children.length;r++){const n=this.children[r];if(n instanceof t){if(e===0)return n;e-=1}}return null}getToken(e,t){if(this.children===null||t<0||t>=this.children.length)return null;for(let r=0;r<this.children.length;r++){const n=this.children[r];if(n instanceof Yi&&n.symbol.type===e){if(t===0)return n;t-=1}}return null}getTokens(e){if(this.children===null)return[];{const t=[];for(let r=0;r<this.children.length;r++){const n=this.children[r];n instanceof Yi&&n.symbol.type===e&&t.push(n)}return t}}getTypedRuleContext(e,t){return this.getChild(t,e)}getTypedRuleContexts(e){if(this.children===null)return[];{const t=[];for(let r=0;r<this.children.length;r++){const n=this.children[r];n instanceof e&&t.push(n)}return t}}getChildCount(){return this.children===null?0:this.children.length}getSourceInterval(){return this.start===null||this.stop===null?dt.INVALID_INTERVAL:new dt(this.start.tokenIndex,this.stop.tokenIndex)}}$s.EMPTY=new wd;const On=class On{constructor(e){this.tokens=e,this.programs=new Map}getTokenStream(){return this.tokens}insertAfter(e,t){let r,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:On.DEFAULT_PROGRAM_NAME;r=typeof e=="number"?e:e.tokenIndex;let s=this.getProgram(n),a=new Rv(this.tokens,r,s.length,t);s.push(a)}insertBefore(e,t){let r,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:On.DEFAULT_PROGRAM_NAME;r=typeof e=="number"?e:e.tokenIndex;const s=this.getProgram(n),a=new wa(this.tokens,r,s.length,t);s.push(a)}replaceSingle(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:On.DEFAULT_PROGRAM_NAME;this.replace(e,e,t,r)}replace(e,t,r){let n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:On.DEFAULT_PROGRAM_NAME;if(typeof e!="number"&&(e=e.tokenIndex),typeof t!="number"&&(t=t.tokenIndex),e>t||e<0||t<0||t>=this.tokens.size)throw new RangeError(`replace: range invalid: ${e}..${t}(size=${this.tokens.size})`);let s=this.getProgram(n),a=new yu(this.tokens,e,t,s.length,r);s.push(a)}delete(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:On.DEFAULT_PROGRAM_NAME;t===void 0&&(t=e),this.replace(e,t,null,r)}getProgram(e){let t=this.programs.get(e);return t==null&&(t=this.initializeProgram(e)),t}initializeProgram(e){const t=[];return this.programs.set(e,t),t}getText(e){let t,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:On.DEFAULT_PROGRAM_NAME;t=e instanceof dt?e:new dt(0,this.tokens.size-1),typeof e=="string"&&(r=e);const n=this.programs.get(r);let s=t.start,a=t.stop;if(a>this.tokens.size-1&&(a=this.tokens.size-1),s<0&&(s=0),n==null||n.length===0)return this.tokens.getText(new dt(s,a));let o=[],l=this.reduceToSingleOperationPerIndex(n),u=s;for(;u<=a&&u<this.tokens.size;){let h=l.get(u);l.delete(u);let d=this.tokens.get(u);h==null?(d.type!==Ee.EOF&&o.push(String(d.text)),u++):u=h.execute(o)}if(a===this.tokens.size-1)for(const h of l.values())h.index>=this.tokens.size-1&&o.push(h.text.toString());return o.join("")}reduceToSingleOperationPerIndex(e){for(let r=0;r<e.length;r++){let n=e[r];if(n==null||!(n instanceof yu))continue;let s=n,a=this.getKindOfOps(e,wa,r);for(let l of a)l.index===s.index?(e[l.instructionIndex]=void 0,s.text=l.text.toString()+(s.text!=null?s.text.toString():"")):l.index>s.index&&l.index<=s.lastIndex&&(e[l.instructionIndex]=void 0);let o=this.getKindOfOps(e,yu,r);for(let l of o){if(l.index>=s.index&&l.lastIndex<=s.lastIndex){e[l.instructionIndex]=void 0;continue}let u=l.lastIndex<s.index||l.index>s.lastIndex;if(l.text!=null||s.text!=null||u){if(!u)throw new Error(`replace op boundaries of ${s} overlap with previous ${l}`)}else e[l.instructionIndex]=void 0,s.index=Math.min(l.index,s.index),s.lastIndex=Math.max(l.lastIndex,s.lastIndex)}}for(let r=0;r<e.length;r++){let n=e[r];if(n==null||!(n instanceof wa))continue;let s=n,a=this.getKindOfOps(e,wa,r);for(let l of a)l.index===s.index&&(l instanceof Rv?(s.text=this.catOpText(l.text,s.text),e[l.instructionIndex]=void 0):l instanceof wa&&(s.text=this.catOpText(s.text,l.text),e[l.instructionIndex]=void 0));let o=this.getKindOfOps(e,yu,r);for(let l of o)if(s.index!==l.index){if(s.index>=l.index&&s.index<=l.lastIndex)throw new Error(`insert op ${s} within boundaries of previous ${l}`)}else l.text=this.catOpText(s.text,l.text),e[r]=void 0}let t=new Map;for(let r of e)if(r!=null){if(t.get(r.index)!=null)throw new Error("should only be one op per index");t.set(r.index,r)}return t}catOpText(e,t){let r="",n="";return e!=null&&(r=e.toString()),t!=null&&(n=t.toString()),r+n}getKindOfOps(e,t,r){return e.slice(0,r).filter(n=>n&&n instanceof t)}};re(On,"DEFAULT_PROGRAM_NAME","default");let mu=On;class Dv{constructor(e,t,r,n){this.tokens=e,this.instructionIndex=r,this.index=t,this.text=n===void 0?"":n}toString(){let e=this.constructor.name;const t=e.indexOf("$");return e=e.substring(t+1,e.length),"<"+e+"@"+this.tokens.get(this.index)+':"'+this.text+'">'}}class wa extends Dv{constructor(e,t,r,n){super(e,t,r,n)}execute(e){return this.text&&e.push(this.text.toString()),this.tokens.get(this.index).type!==Ee.EOF&&e.push(String(this.tokens.get(this.index).text)),this.index+1}}class Rv extends wa{constructor(e,t,r,n){super(e,t+1,r,n)}}class yu extends Dv{constructor(e,t,r,n,s){super(e,t,n,s),this.lastIndex=r}execute(e){return this.text&&e.push(this.text.toString()),this.lastIndex+1}toString(){return this.text==null?"<DeleteOp@"+this.tokens.get(this.index)+".."+this.tokens.get(this.lastIndex)+">":"<ReplaceOp@"+this.tokens.get(this.index)+".."+this.tokens.get(this.lastIndex)+':"'+this.text+'">'}}const GI={atn:wI,dfa:LI,context:_I,misc:MI,tree:PI,error:FI,Token:Ee,CommonToken:xn,CharStreams:bv,CharStream:qs,InputStream:Nd,CommonTokenStream:Sv,Lexer:Ut,Parser:Cd,ParserRuleContext:wd,Interval:dt,IntervalSet:gi,LL1Analyzer:lu,Utils:BI,TokenStreamRewriter:mu};ut.MG,ut.fr,ut.sR,ut.Zo,ut.iH,ut.rt,ut.jB,ut.M8,ut.$t,ut.aq,ut.pG,ut.eP,ut.KU,ut.zW,ut.IX,ut.mY,ut.a7,ut.JG,ut.ay,ut.X2,ut.WU,ut.Uw,ut.gw,ut.iX,ut.re,ut.Pg,ut.tD,ut.R$,ut.Dj,ut.m7,ut.NZ,ut.xo,ut.ou,ut.qC,ut.mD;var qI=ut.Ay,VI={63:i=>{i.exports=function e(t,r){if(t===r)return!0;if(t&&r&&typeof t=="object"&&typeof r=="object"){if(t.constructor!==r.constructor)return!1;var n,s,a;if(Array.isArray(t)){if((n=t.length)!=r.length)return!1;for(s=n;s--!=0;)if(!e(t[s],r[s]))return!1;return!0}if(t.constructor===RegExp)return t.source===r.source&&t.flags===r.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===r.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===r.toString();if((n=(a=Object.keys(t)).length)!==Object.keys(r).length)return!1;for(s=n;s--!=0;)if(!Object.prototype.hasOwnProperty.call(r,a[s]))return!1;for(s=n;s--!=0;){var o=a[s];if(!e(t[o],r[o]))return!1}return!0}return t!=t&&r!=r}}},Iv={};function as(i){var e=Iv[i];if(e!==void 0)return e.exports;var t=Iv[i]={exports:{}};return VI[i](t,t.exports,as),t.exports}as.d=(i,e)=>{for(var t in e)as.o(e,t)&&!as.o(i,t)&&Object.defineProperty(i,t,{enumerable:!0,get:e[t]})},as.o=(i,e)=>Object.prototype.hasOwnProperty.call(i,e);var La={};(()=>{as.d(La,{yS:()=>r,Qc:()=>H,Hb:()=>B,IO:()=>Ae,Pz:()=>Pe});const i=(e={default:()=>qI},t={},as.d(t,e),t);var e,t;class r extends Error{constructor(T,S,k){super(k),this.line=T,this.charPositionInLine=S,this.msg=k}}const n=new i.default.atn.ATNDeserializer().deserialize([4,0,45,356,6,-1,2,0,7,0,2,1,7,1,2,2,7,2,2,3,7,3,2,4,7,4,2,5,7,5,2,6,7,6,2,7,7,7,2,8,7,8,2,9,7,9,2,10,7,10,2,11,7,11,2,12,7,12,2,13,7,13,2,14,7,14,2,15,7,15,2,16,7,16,2,17,7,17,2,18,7,18,2,19,7,19,2,20,7,20,2,21,7,21,2,22,7,22,2,23,7,23,2,24,7,24,2,25,7,25,2,26,7,26,2,27,7,27,2,28,7,28,2,29,7,29,2,30,7,30,2,31,7,31,2,32,7,32,2,33,7,33,2,34,7,34,2,35,7,35,2,36,7,36,2,37,7,37,2,38,7,38,2,39,7,39,2,40,7,40,2,41,7,41,2,42,7,42,2,43,7,43,2,44,7,44,2,45,7,45,2,46,7,46,2,47,7,47,2,48,7,48,2,49,7,49,2,50,7,50,2,51,7,51,2,52,7,52,1,0,1,0,1,1,1,1,1,1,1,2,1,2,1,3,1,3,1,4,1,4,1,5,1,5,1,5,1,6,1,6,1,6,1,7,1,7,1,7,1,8,1,8,1,9,1,9,1,9,1,10,1,10,1,11,1,11,1,11,1,12,1,12,1,12,1,13,1,13,1,13,1,13,1,13,1,14,1,14,1,14,1,14,1,14,1,14,1,15,1,15,1,15,1,15,1,15,1,15,1,15,1,15,1,15,1,15,1,15,1,16,1,16,1,16,1,16,1,16,1,16,1,16,1,16,1,17,1,17,1,17,1,17,1,17,1,17,1,17,1,17,1,17,1,18,1,18,1,18,1,18,1,18,1,18,1,18,1,18,1,18,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,20,1,20,1,20,1,20,1,20,1,20,1,20,1,21,1,21,1,22,1,22,1,22,1,23,1,23,1,23,1,23,1,23,1,24,1,24,1,24,1,24,1,24,1,24,1,25,1,25,1,25,1,25,1,25,1,26,1,26,1,27,1,27,1,28,1,28,1,29,1,29,1,30,1,30,1,31,1,31,1,32,1,32,1,33,1,33,1,34,1,34,1,35,1,35,1,35,1,36,1,36,1,37,1,37,1,38,5,38,250,8,38,10,38,12,38,253,9,38,1,39,1,39,5,39,257,8,39,10,39,12,39,260,9,39,1,39,1,39,1,40,5,40,265,8,40,10,40,12,40,268,9,40,1,40,1,40,5,40,272,8,40,10,40,12,40,275,9,40,1,41,4,41,278,8,41,11,41,12,41,279,1,42,4,42,283,8,42,11,42,12,42,284,1,42,1,42,1,43,3,43,290,8,43,1,43,1,43,1,43,4,43,295,8,43,11,43,12,43,296,3,43,299,8,43,1,43,3,43,302,8,43,1,44,1,44,1,44,5,44,307,8,44,10,44,12,44,310,9,44,1,44,1,44,1,44,1,44,5,44,316,8,44,10,44,12,44,319,9,44,1,44,3,44,322,8,44,1,45,1,45,1,45,3,45,327,8,45,1,46,1,46,1,46,3,46,332,8,46,1,47,1,47,1,47,1,47,1,47,1,47,1,48,1,48,1,49,1,49,1,50,1,50,1,51,4,51,347,8,51,11,51,12,51,348,1,52,1,52,3,52,353,8,52,1,52,1,52,1,258,0,53,1,1,3,2,5,3,7,4,9,5,11,6,13,7,15,8,17,9,19,10,21,11,23,12,25,13,27,14,29,15,31,16,33,17,35,18,37,19,39,20,41,21,43,22,45,23,47,24,49,25,51,26,53,27,55,28,57,29,59,30,61,31,63,32,65,33,67,34,69,35,71,36,73,37,75,38,77,39,79,40,81,41,83,42,85,43,87,44,89,45,91,0,93,0,95,0,97,0,99,0,101,0,103,0,105,0,1,0,14,6,0,103,103,105,105,109,109,115,115,117,117,121,121,4,0,45,45,65,90,95,95,97,122,3,0,65,90,95,95,97,122,4,0,48,57,65,90,95,95,97,122,2,0,95,95,128,65535,3,0,9,10,13,13,32,32,1,0,48,57,8,0,39,39,47,47,92,92,98,98,102,102,110,110,114,114,116,116,8,0,34,34,47,47,92,92,98,98,102,102,110,110,114,114,116,116,3,0,48,57,65,70,97,102,3,0,0,31,39,39,92,92,3,0,0,31,34,34,92,92,2,0,69,69,101,101,2,0,43,43,45,45,366,0,1,1,0,0,0,0,3,1,0,0,0,0,5,1,0,0,0,0,7,1,0,0,0,0,9,1,0,0,0,0,11,1,0,0,0,0,13,1,0,0,0,0,15,1,0,0,0,0,17,1,0,0,0,0,19,1,0,0,0,0,21,1,0,0,0,0,23,1,0,0,0,0,25,1,0,0,0,0,27,1,0,0,0,0,29,1,0,0,0,0,31,1,0,0,0,0,33,1,0,0,0,0,35,1,0,0,0,0,37,1,0,0,0,0,39,1,0,0,0,0,41,1,0,0,0,0,43,1,0,0,0,0,45,1,0,0,0,0,47,1,0,0,0,0,49,1,0,0,0,0,51,1,0,0,0,0,53,1,0,0,0,0,55,1,0,0,0,0,57,1,0,0,0,0,59,1,0,0,0,0,61,1,0,0,0,0,63,1,0,0,0,0,65,1,0,0,0,0,67,1,0,0,0,0,69,1,0,0,0,0,71,1,0,0,0,0,73,1,0,0,0,0,75,1,0,0,0,0,77,1,0,0,0,0,79,1,0,0,0,0,81,1,0,0,0,0,83,1,0,0,0,0,85,1,0,0,0,0,87,1,0,0,0,0,89,1,0,0,0,1,107,1,0,0,0,3,109,1,0,0,0,5,112,1,0,0,0,7,114,1,0,0,0,9,116,1,0,0,0,11,118,1,0,0,0,13,121,1,0,0,0,15,124,1,0,0,0,17,127,1,0,0,0,19,129,1,0,0,0,21,132,1,0,0,0,23,134,1,0,0,0,25,137,1,0,0,0,27,140,1,0,0,0,29,145,1,0,0,0,31,151,1,0,0,0,33,162,1,0,0,0,35,170,1,0,0,0,37,179,1,0,0,0,39,188,1,0,0,0,41,195,1,0,0,0,43,202,1,0,0,0,45,204,1,0,0,0,47,207,1,0,0,0,49,212,1,0,0,0,51,218,1,0,0,0,53,223,1,0,0,0,55,225,1,0,0,0,57,227,1,0,0,0,59,229,1,0,0,0,61,231,1,0,0,0,63,233,1,0,0,0,65,235,1,0,0,0,67,237,1,0,0,0,69,239,1,0,0,0,71,241,1,0,0,0,73,244,1,0,0,0,75,246,1,0,0,0,77,251,1,0,0,0,79,254,1,0,0,0,81,266,1,0,0,0,83,277,1,0,0,0,85,282,1,0,0,0,87,289,1,0,0,0,89,321,1,0,0,0,91,323,1,0,0,0,93,328,1,0,0,0,95,333,1,0,0,0,97,339,1,0,0,0,99,341,1,0,0,0,101,343,1,0,0,0,103,346,1,0,0,0,105,350,1,0,0,0,107,108,5,64,0,0,108,2,1,0,0,0,109,110,5,46,0,0,110,111,5,46,0,0,111,4,1,0,0,0,112,113,5,36,0,0,113,6,1,0,0,0,114,115,5,46,0,0,115,8,1,0,0,0,116,117,5,42,0,0,117,10,1,0,0,0,118,119,5,38,0,0,119,120,5,38,0,0,120,12,1,0,0,0,121,122,5,61,0,0,122,123,5,61,0,0,123,14,1,0,0,0,124,125,5,62,0,0,125,126,5,61,0,0,126,16,1,0,0,0,127,128,5,62,0,0,128,18,1,0,0,0,129,130,5,60,0,0,130,131,5,61,0,0,131,20,1,0,0,0,132,133,5,60,0,0,133,22,1,0,0,0,134,135,5,33,0,0,135,136,5,61,0,0,136,24,1,0,0,0,137,138,5,61,0,0,138,139,5,126,0,0,139,26,1,0,0,0,140,141,5,32,0,0,141,142,5,105,0,0,142,143,5,110,0,0,143,144,5,32,0,0,144,28,1,0,0,0,145,146,5,32,0,0,146,147,5,110,0,0,147,148,5,105,0,0,148,149,5,110,0,0,149,150,5,32,0,0,150,30,1,0,0,0,151,152,5,32,0,0,152,153,5,115,0,0,153,154,5,117,0,0,154,155,5,98,0,0,155,156,5,115,0,0,156,157,5,101,0,0,157,158,5,116,0,0,158,159,5,111,0,0,159,160,5,102,0,0,160,161,5,32,0,0,161,32,1,0,0,0,162,163,5,32,0,0,163,164,5,97,0,0,164,165,5,110,0,0,165,166,5,121,0,0,166,167,5,111,0,0,167,168,5,102,0,0,168,169,5,32,0,0,169,34,1,0,0,0,170,171,5,32,0,0,171,172,5,110,0,0,172,173,5,111,0,0,173,174,5,110,0,0,174,175,5,101,0,0,175,176,5,111,0,0,176,177,5,102,0,0,177,178,5,32,0,0,178,36,1,0,0,0,179,180,5,32,0,0,180,181,5,115,0,0,181,182,5,105,0,0,182,183,5,122,0,0,183,184,5,101,0,0,184,185,5,111,0,0,185,186,5,102,0,0,186,187,5,32,0,0,187,38,1,0,0,0,188,189,5,32,0,0,189,190,5,115,0,0,190,191,5,105,0,0,191,192,5,122,0,0,192,193,5,101,0,0,193,194,5,32,0,0,194,40,1,0,0,0,195,196,5,32,0,0,196,197,5,101,0,0,197,198,5,109,0,0,198,199,5,112,0,0,199,200,5,116,0,0,200,201,5,121,0,0,201,42,1,0,0,0,202,203,5,33,0,0,203,44,1,0,0,0,204,205,5,124,0,0,205,206,5,124,0,0,206,46,1,0,0,0,207,208,5,116,0,0,208,209,5,114,0,0,209,210,5,117,0,0,210,211,5,101,0,0,211,48,1,0,0,0,212,213,5,102,0,0,213,214,5,97,0,0,214,215,5,108,0,0,215,216,5,115,0,0,216,217,5,101,0,0,217,50,1,0,0,0,218,219,5,110,0,0,219,220,5,117,0,0,220,221,5,108,0,0,221,222,5,108,0,0,222,52,1,0,0,0,223,224,5,123,0,0,224,54,1,0,0,0,225,226,5,125,0,0,226,56,1,0,0,0,227,228,5,91,0,0,228,58,1,0,0,0,229,230,5,93,0,0,230,60,1,0,0,0,231,232,5,58,0,0,232,62,1,0,0,0,233,234,5,44,0,0,234,64,1,0,0,0,235,236,5,40,0,0,236,66,1,0,0,0,237,238,5,41,0,0,238,68,1,0,0,0,239,240,5,63,0,0,240,70,1,0,0,0,241,242,5,45,0,0,242,243,5,32,0,0,243,72,1,0,0,0,244,245,5,43,0,0,245,74,1,0,0,0,246,247,5,47,0,0,247,76,1,0,0,0,248,250,7,0,0,0,249,248,1,0,0,0,250,253,1,0,0,0,251,249,1,0,0,0,251,252,1,0,0,0,252,78,1,0,0,0,253,251,1,0,0,0,254,258,5,47,0,0,255,257,9,0,0,0,256,255,1,0,0,0,257,260,1,0,0,0,258,259,1,0,0,0,258,256,1,0,0,0,259,261,1,0,0,0,260,258,1,0,0,0,261,262,5,47,0,0,262,80,1,0,0,0,263,265,7,1,0,0,264,263,1,0,0,0,265,268,1,0,0,0,266,264,1,0,0,0,266,267,1,0,0,0,267,269,1,0,0,0,268,266,1,0,0,0,269,273,7,2,0,0,270,272,7,3,0,0,271,270,1,0,0,0,272,275,1,0,0,0,273,271,1,0,0,0,273,274,1,0,0,0,274,82,1,0,0,0,275,273,1,0,0,0,276,278,7,4,0,0,277,276,1,0,0,0,278,279,1,0,0,0,279,277,1,0,0,0,279,280,1,0,0,0,280,84,1,0,0,0,281,283,7,5,0,0,282,281,1,0,0,0,283,284,1,0,0,0,284,282,1,0,0,0,284,285,1,0,0,0,285,286,1,0,0,0,286,287,6,42,0,0,287,86,1,0,0,0,288,290,5,45,0,0,289,288,1,0,0,0,289,290,1,0,0,0,290,291,1,0,0,0,291,298,3,103,51,0,292,294,5,46,0,0,293,295,7,6,0,0,294,293,1,0,0,0,295,296,1,0,0,0,296,294,1,0,0,0,296,297,1,0,0,0,297,299,1,0,0,0,298,292,1,0,0,0,298,299,1,0,0,0,299,301,1,0,0,0,300,302,3,105,52,0,301,300,1,0,0,0,301,302,1,0,0,0,302,88,1,0,0,0,303,308,5,34,0,0,304,307,3,93,46,0,305,307,3,101,50,0,306,304,1,0,0,0,306,305,1,0,0,0,307,310,1,0,0,0,308,306,1,0,0,0,308,309,1,0,0,0,309,311,1,0,0,0,310,308,1,0,0,0,311,322,5,34,0,0,312,317,5,39,0,0,313,316,3,91,45,0,314,316,3,99,49,0,315,313,1,0,0,0,315,314,1,0,0,0,316,319,1,0,0,0,317,315,1,0,0,0,317,318,1,0,0,0,318,320,1,0,0,0,319,317,1,0,0,0,320,322,5,39,0,0,321,303,1,0,0,0,321,312,1,0,0,0,322,90,1,0,0,0,323,326,5,92,0,0,324,327,7,7,0,0,325,327,3,95,47,0,326,324,1,0,0,0,326,325,1,0,0,0,327,92,1,0,0,0,328,331,5,92,0,0,329,332,7,8,0,0,330,332,3,95,47,0,331,329,1,0,0,0,331,330,1,0,0,0,332,94,1,0,0,0,333,334,5,117,0,0,334,335,3,97,48,0,335,336,3,97,48,0,336,337,3,97,48,0,337,338,3,97,48,0,338,96,1,0,0,0,339,340,7,9,0,0,340,98,1,0,0,0,341,342,8,10,0,0,342,100,1,0,0,0,343,344,8,11,0,0,344,102,1,0,0,0,345,347,7,6,0,0,346,345,1,0,0,0,347,348,1,0,0,0,348,346,1,0,0,0,348,349,1,0,0,0,349,104,1,0,0,0,350,352,7,12,0,0,351,353,7,13,0,0,352,351,1,0,0,0,352,353,1,0,0,0,353,354,1,0,0,0,354,355,3,103,51,0,355,106,1,0,0,0,20,0,251,258,266,273,279,284,289,296,298,301,306,308,315,317,321,326,331,348,352,1,6,0,0]),s=n.decisionToState.map((K,T)=>new i.default.dfa.DFA(K,T));class a extends i.default.Lexer{constructor(T){super(T),this._interp=new i.default.atn.LexerATNSimulator(this,n,s,new i.default.atn.PredictionContextCache)}}re(a,"grammarFileName","JSONPath.g4"),re(a,"channelNames",["DEFAULT_TOKEN_CHANNEL","HIDDEN"]),re(a,"modeNames",["DEFAULT_MODE"]),re(a,"literalNames",[null,"'@'","'..'","'$'","'.'","'*'","'&&'","'=='","'>='","'>'","'<='","'<'","'!='","'=~'","' in '","' nin '","' subsetof '","' anyof '","' noneof '","' sizeof '","' size '","' empty'","'!'","'||'","'true'","'false'","'null'","'{'","'}'","'['","']'","':'","','","'('","')'","'?'","'- '","'+'","'/'"]),re(a,"symbolicNames",[null,"CURRENT_VALUE","DOTDOT","ROOT_VALUE","DOT","STAR","AND","EQ","GE","GT","LE","LT","NE","REG","IN","NIN","SUB","ANY","NON","SIZO","SIZ","EMPT","NOT","OR","TRUE","FALSE","NULL","BRACE_LEFT","BRACE_RIGHT","BRACKET_LEFT","BRACKET_RIGHT","COLON","COMMA","PAREN_LEFT","PAREN_RIGHT","QUESTION","MINUS_SP","PLUS","DIV","REGEX_OPT","REGEX_EXPR","KEY","SPECIAL_KEY","WS","NUMBER","STRING"]),re(a,"ruleNames",["CURRENT_VALUE","DOTDOT","ROOT_VALUE","DOT","STAR","AND","EQ","GE","GT","LE","LT","NE","REG","IN","NIN","SUB","ANY","NON","SIZO","SIZ","EMPT","NOT","OR","TRUE","FALSE","NULL","BRACE_LEFT","BRACE_RIGHT","BRACKET_LEFT","BRACKET_RIGHT","COLON","COMMA","PAREN_LEFT","PAREN_RIGHT","QUESTION","MINUS_SP","PLUS","DIV","REGEX_OPT","REGEX_EXPR","KEY","SPECIAL_KEY","WS","NUMBER","STRING","ESC_SINGLE","ESC_DOUBLE","UNICODE","HEX","SAFECODEPOINT_SINGLE","SAFECODEPOINT_DOUBLE","INT","EXP"]),a.EOF=i.default.Token.EOF,a.CURRENT_VALUE=1,a.DOTDOT=2,a.ROOT_VALUE=3,a.DOT=4,a.STAR=5,a.AND=6,a.EQ=7,a.GE=8,a.GT=9,a.LE=10,a.LT=11,a.NE=12,a.REG=13,a.IN=14,a.NIN=15,a.SUB=16,a.ANY=17,a.NON=18,a.SIZO=19,a.SIZ=20,a.EMPT=21,a.NOT=22,a.OR=23,a.TRUE=24,a.FALSE=25,a.NULL=26,a.BRACE_LEFT=27,a.BRACE_RIGHT=28,a.BRACKET_LEFT=29,a.BRACKET_RIGHT=30,a.COLON=31,a.COMMA=32,a.PAREN_LEFT=33,a.PAREN_RIGHT=34,a.QUESTION=35,a.MINUS_SP=36,a.PLUS=37,a.DIV=38,a.REGEX_OPT=39,a.REGEX_EXPR=40,a.KEY=41,a.SPECIAL_KEY=42,a.WS=43,a.NUMBER=44,a.STRING=45;class o extends i.default.tree.ParseTreeListener{enterJsonpath(T){}exitJsonpath(T){}enterFilterarg(T){}exitFilterarg(T){}enterSubscript(T){}exitSubscript(T){}enterDotdotContent(T){}exitDotdotContent(T){}enterDotContent(T){}exitDotContent(T){}enterBracket(T){}exitBracket(T){}enterBracketContent(T){}exitBracketContent(T){}enterFilterExpression(T){}exitFilterExpression(T){}enterIndexes(T){}exitIndexes(T){}enterUnions(T){}exitUnions(T){}enterSlices(T){}exitSlices(T){}enterRegex(T){}exitRegex(T){}enterExpression(T){}exitExpression(T){}enterFilterpath(T){}exitFilterpath(T){}enterIdentifier(T){}exitIdentifier(T){}enterObj(T){}exitObj(T){}enterPair(T){}exitPair(T){}enterArray(T){}exitArray(T){}enterValue(T){}exitValue(T){}}const l=new i.default.atn.ATNDeserializer().deserialize([4,1,45,236,2,0,7,0,2,1,7,1,2,2,7,2,2,3,7,3,2,4,7,4,2,5,7,5,2,6,7,6,2,7,7,7,2,8,7,8,2,9,7,9,2,10,7,10,2,11,7,11,2,12,7,12,2,13,7,13,2,14,7,14,2,15,7,15,2,16,7,16,2,17,7,17,2,18,7,18,1,0,1,0,3,0,41,8,0,1,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3,1,52,8,1,1,1,1,1,1,1,1,1,1,1,3,1,59,8,1,1,1,5,1,62,8,1,10,1,12,1,65,9,1,1,2,1,2,1,2,3,2,70,8,2,1,2,1,2,1,2,3,2,75,8,2,1,2,1,2,3,2,79,8,2,3,2,81,8,2,1,3,1,3,1,3,3,3,86,8,3,1,4,1,4,1,4,3,4,91,8,4,1,5,1,5,1,5,1,5,1,6,1,6,1,6,1,6,1,6,1,6,1,6,1,6,3,6,105,8,6,1,7,1,7,1,7,1,7,1,7,1,8,1,8,1,8,4,8,115,8,8,11,8,12,8,116,1,9,1,9,1,9,4,9,122,8,9,11,9,12,9,123,1,9,1,9,1,9,4,9,129,8,9,11,9,12,9,130,3,9,133,8,9,1,10,3,10,136,8,10,1,10,1,10,3,10,140,8,10,1,10,1,10,3,10,144,8,10,3,10,146,8,10,1,11,1,11,3,11,150,8,11,1,12,1,12,1,12,1,12,1,12,1,12,1,12,1,12,1,12,1,12,1,12,1,12,1,12,1,12,1,12,1,12,1,12,1,12,1,12,1,12,1,12,1,12,1,12,1,12,1,12,3,12,177,8,12,1,12,1,12,1,12,5,12,182,8,12,10,12,12,12,185,9,12,1,13,1,13,3,13,189,8,13,1,14,1,14,1,15,1,15,1,15,1,15,5,15,197,8,15,10,15,12,15,200,9,15,1,15,1,15,1,15,1,15,3,15,206,8,15,1,16,1,16,1,16,1,16,1,17,1,17,1,17,1,17,5,17,216,8,17,10,17,12,17,219,9,17,1,17,1,17,1,17,1,17,3,17,225,8,17,1,18,1,18,1,18,1,18,1,18,1,18,1,18,3,18,234,8,18,1,18,0,2,2,24,19,0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,0,6,2,0,5,5,38,38,1,0,36,37,2,0,7,12,14,20,2,0,6,6,23,23,2,0,1,1,3,3,2,0,24,26,41,42,267,0,38,1,0,0,0,2,51,1,0,0,0,4,80,1,0,0,0,6,85,1,0,0,0,8,90,1,0,0,0,10,92,1,0,0,0,12,104,1,0,0,0,14,106,1,0,0,0,16,111,1,0,0,0,18,132,1,0,0,0,20,135,1,0,0,0,22,147,1,0,0,0,24,176,1,0,0,0,26,186,1,0,0,0,28,190,1,0,0,0,30,205,1,0,0,0,32,207,1,0,0,0,34,224,1,0,0,0,36,233,1,0,0,0,38,40,5,3,0,0,39,41,3,4,2,0,40,39,1,0,0,0,40,41,1,0,0,0,41,42,1,0,0,0,42,43,5,0,0,1,43,1,1,0,0,0,44,45,6,1,-1,0,45,46,5,33,0,0,46,47,3,2,1,0,47,48,5,34,0,0,48,52,1,0,0,0,49,52,3,36,18,0,50,52,3,26,13,0,51,44,1,0,0,0,51,49,1,0,0,0,51,50,1,0,0,0,52,63,1,0,0,0,53,54,10,4,0,0,54,55,7,0,0,0,55,62,3,2,1,5,56,58,10,3,0,0,57,59,7,1,0,0,58,57,1,0,0,0,58,59,1,0,0,0,59,60,1,0,0,0,60,62,3,2,1,4,61,53,1,0,0,0,61,56,1,0,0,0,62,65,1,0,0,0,63,61,1,0,0,0,63,64,1,0,0,0,64,3,1,0,0,0,65,63,1,0,0,0,66,67,5,2,0,0,67,69,3,6,3,0,68,70,3,4,2,0,69,68,1,0,0,0,69,70,1,0,0,0,70,81,1,0,0,0,71,72,5,4,0,0,72,74,3,8,4,0,73,75,3,4,2,0,74,73,1,0,0,0,74,75,1,0,0,0,75,81,1,0,0,0,76,78,3,10,5,0,77,79,3,4,2,0,78,77,1,0,0,0,78,79,1,0,0,0,79,81,1,0,0,0,80,66,1,0,0,0,80,71,1,0,0,0,80,76,1,0,0,0,81,5,1,0,0,0,82,86,5,5,0,0,83,86,3,28,14,0,84,86,3,10,5,0,85,82,1,0,0,0,85,83,1,0,0,0,85,84,1,0,0,0,86,7,1,0,0,0,87,91,5,5,0,0,88,91,5,44,0,0,89,91,3,28,14,0,90,87,1,0,0,0,90,88,1,0,0,0,90,89,1,0,0,0,91,9,1,0,0,0,92,93,5,29,0,0,93,94,3,12,6,0,94,95,5,30,0,0,95,11,1,0,0,0,96,105,3,18,9,0,97,105,3,16,8,0,98,105,3,20,10,0,99,105,5,5,0,0,100,105,5,44,0,0,101,105,5,45,0,0,102,105,3,28,14,0,103,105,3,14,7,0,104,96,1,0,0,0,104,97,1,0,0,0,104,98,1,0,0,0,104,99,1,0,0,0,104,100,1,0,0,0,104,101,1,0,0,0,104,102,1,0,0,0,104,103,1,0,0,0,105,13,1,0,0,0,106,107,5,35,0,0,107,108,5,33,0,0,108,109,3,24,12,0,109,110,5,34,0,0,110,15,1,0,0,0,111,114,5,44,0,0,112,113,5,32,0,0,113,115,5,44,0,0,114,112,1,0,0,0,115,116,1,0,0,0,116,114,1,0,0,0,116,117,1,0,0,0,117,17,1,0,0,0,118,121,5,45,0,0,119,120,5,32,0,0,120,122,5,45,0,0,121,119,1,0,0,0,122,123,1,0,0,0,123,121,1,0,0,0,123,124,1,0,0,0,124,133,1,0,0,0,125,128,3,28,14,0,126,127,5,32,0,0,127,129,3,28,14,0,128,126,1,0,0,0,129,130,1,0,0,0,130,128,1,0,0,0,130,131,1,0,0,0,131,133,1,0,0,0,132,118,1,0,0,0,132,125,1,0,0,0,133,19,1,0,0,0,134,136,5,44,0,0,135,134,1,0,0,0,135,136,1,0,0,0,136,137,1,0,0,0,137,139,5,31,0,0,138,140,5,44,0,0,139,138,1,0,0,0,139,140,1,0,0,0,140,145,1,0,0,0,141,143,5,31,0,0,142,144,5,44,0,0,143,142,1,0,0,0,143,144,1,0,0,0,144,146,1,0,0,0,145,141,1,0,0,0,145,146,1,0,0,0,146,21,1,0,0,0,147,149,5,40,0,0,148,150,5,39,0,0,149,148,1,0,0,0,149,150,1,0,0,0,150,23,1,0,0,0,151,152,6,12,-1,0,152,153,5,22,0,0,153,154,5,33,0,0,154,155,3,24,12,0,155,156,5,34,0,0,156,177,1,0,0,0,157,158,5,33,0,0,158,159,3,24,12,0,159,160,5,34,0,0,160,177,1,0,0,0,161,162,3,2,1,0,162,163,7,2,0,0,163,164,3,2,1,0,164,177,1,0,0,0,165,166,3,2,1,0,166,167,5,13,0,0,167,168,3,22,11,0,168,177,1,0,0,0,169,170,3,2,1,0,170,171,5,21,0,0,171,177,1,0,0,0,172,177,3,26,13,0,173,177,5,24,0,0,174,177,5,25,0,0,175,177,5,26,0,0,176,151,1,0,0,0,176,157,1,0,0,0,176,161,1,0,0,0,176,165,1,0,0,0,176,169,1,0,0,0,176,172,1,0,0,0,176,173,1,0,0,0,176,174,1,0,0,0,176,175,1,0,0,0,177,183,1,0,0,0,178,179,10,8,0,0,179,180,7,3,0,0,180,182,3,24,12,9,181,178,1,0,0,0,182,185,1,0,0,0,183,181,1,0,0,0,183,184,1,0,0,0,184,25,1,0,0,0,185,183,1,0,0,0,186,188,7,4,0,0,187,189,3,4,2,0,188,187,1,0,0,0,188,189,1,0,0,0,189,27,1,0,0,0,190,191,7,5,0,0,191,29,1,0,0,0,192,193,5,27,0,0,193,198,3,32,16,0,194,195,5,32,0,0,195,197,3,32,16,0,196,194,1,0,0,0,197,200,1,0,0,0,198,196,1,0,0,0,198,199,1,0,0,0,199,201,1,0,0,0,200,198,1,0,0,0,201,202,5,28,0,0,202,206,1,0,0,0,203,204,5,27,0,0,204,206,5,28,0,0,205,192,1,0,0,0,205,203,1,0,0,0,206,31,1,0,0,0,207,208,5,45,0,0,208,209,5,31,0,0,209,210,3,36,18,0,210,33,1,0,0,0,211,212,5,29,0,0,212,217,3,36,18,0,213,214,5,32,0,0,214,216,3,36,18,0,215,213,1,0,0,0,216,219,1,0,0,0,217,215,1,0,0,0,217,218,1,0,0,0,218,220,1,0,0,0,219,217,1,0,0,0,220,221,5,30,0,0,221,225,1,0,0,0,222,223,5,29,0,0,223,225,5,30,0,0,224,211,1,0,0,0,224,222,1,0,0,0,225,35,1,0,0,0,226,234,5,45,0,0,227,234,5,44,0,0,228,234,3,30,15,0,229,234,3,34,17,0,230,234,5,24,0,0,231,234,5,25,0,0,232,234,5,26,0,0,233,226,1,0,0,0,233,227,1,0,0,0,233,228,1,0,0,0,233,229,1,0,0,0,233,230,1,0,0,0,233,231,1,0,0,0,233,232,1,0,0,0,234,37,1,0,0,0,29,40,51,58,61,63,69,74,78,80,85,90,104,116,123,130,132,135,139,143,145,149,176,183,188,198,205,217,224,233]),u=l.decisionToState.map((K,T)=>new i.default.dfa.DFA(K,T)),h=new i.default.atn.PredictionContextCache,ue=class ue extends i.default.Parser{constructor(T){super(T),this._interp=new i.default.atn.ParserATNSimulator(this,l,u,h),this.ruleNames=ue.ruleNames,this.literalNames=ue.literalNames,this.symbolicNames=ue.symbolicNames}sempred(T,S,k){switch(S){case 1:return this.filterarg_sempred(T,k);case 12:return this.expression_sempred(T,k);default:throw"No predicate with index:"+S}}filterarg_sempred(T,S){switch(S){case 0:return this.precpred(this._ctx,4);case 1:return this.precpred(this._ctx,3);default:throw"No predicate with index:"+S}}expression_sempred(T,S){if(S===2)return this.precpred(this._ctx,8);throw"No predicate with index:"+S}jsonpath(){let T=new p(this,this._ctx,this.state);this.enterRule(T,0,ue.RULE_jsonpath);var S=0;try{this.enterOuterAlt(T,1),this.state=38,this.match(ue.ROOT_VALUE),this.state=40,this._errHandler.sync(this),(-32&(S=this._input.LA(1)))==0&&(1<<S&536870932)!=0&&(this.state=39,this.subscript()),this.state=42,this.match(ue.EOF)}catch(k){if(!(k instanceof i.default.error.RecognitionException))throw k;T.exception=k,this._errHandler.reportError(this,k),this._errHandler.recover(this,k)}finally{this.exitRule()}return T}filterarg(T){T===void 0&&(T=0);const S=this._ctx,k=this.state;let j=new g(this,this._ctx,k),Te=j;this.enterRecursionRule(j,2,ue.RULE_filterarg,T);var me=0;try{switch(this.enterOuterAlt(j,1),this.state=51,this._errHandler.sync(this),this._input.LA(1)){case 33:this.state=45,this.match(ue.PAREN_LEFT),this.state=46,this.filterarg(0),this.state=47,this.match(ue.PAREN_RIGHT);break;case 24:case 25:case 26:case 27:case 29:case 44:case 45:this.state=49,this.value();break;case 1:case 3:this.state=50,this.filterpath();break;default:throw new i.default.error.NoViableAltException(this)}this._ctx.stop=this._input.LT(-1),this.state=63,this._errHandler.sync(this);for(var ye=this._interp.adaptivePredict(this._input,4,this._ctx);ye!=2&&ye!=i.default.atn.ATN.INVALID_ALT_NUMBER;){if(ye===1)switch(this._parseListeners!==null&&this.triggerExitRuleEvent(),Te=j,this.state=61,this._errHandler.sync(this),this._interp.adaptivePredict(this._input,3,this._ctx)){case 1:if(j=new g(this,S,k),this.pushNewRecursionContext(j,2,ue.RULE_filterarg),this.state=53,!this.precpred(this._ctx,4))throw new i.default.error.FailedPredicateException(this,"this.precpred(this._ctx, 4)");this.state=54,(me=this._input.LA(1))!==5&&me!==38?this._errHandler.recoverInline(this):(this._errHandler.reportMatch(this),this.consume()),this.state=55,this.filterarg(5);break;case 2:if(j=new g(this,S,k),this.pushNewRecursionContext(j,2,ue.RULE_filterarg),this.state=56,!this.precpred(this._ctx,3))throw new i.default.error.FailedPredicateException(this,"this.precpred(this._ctx, 3)");this.state=58,this._errHandler.sync(this),(me=this._input.LA(1))!==36&&me!==37||(this.state=57,(me=this._input.LA(1))!==36&&me!==37?this._errHandler.recoverInline(this):(this._errHandler.reportMatch(this),this.consume())),this.state=60,this.filterarg(4)}this.state=65,this._errHandler.sync(this),ye=this._interp.adaptivePredict(this._input,4,this._ctx)}}catch(at){if(!(at instanceof i.default.error.RecognitionException))throw at;j.exception=at,this._errHandler.reportError(this,at),this._errHandler.recover(this,at)}finally{this.unrollRecursionContexts(S)}return j}subscript(){let T=new m(this,this._ctx,this.state);this.enterRule(T,4,ue.RULE_subscript);try{switch(this.state=80,this._errHandler.sync(this),this._input.LA(1)){case 2:this.enterOuterAlt(T,1),this.state=66,this.match(ue.DOTDOT),this.state=67,this.dotdotContent(),this.state=69,this._errHandler.sync(this),this._interp.adaptivePredict(this._input,5,this._ctx)===1&&(this.state=68,this.subscript());break;case 4:this.enterOuterAlt(T,2),this.state=71,this.match(ue.DOT),this.state=72,this.dotContent(),this.state=74,this._errHandler.sync(this),this._interp.adaptivePredict(this._input,6,this._ctx)===1&&(this.state=73,this.subscript());break;case 29:this.enterOuterAlt(T,3),this.state=76,this.bracket(),this.state=78,this._errHandler.sync(this),this._interp.adaptivePredict(this._input,7,this._ctx)===1&&(this.state=77,this.subscript());break;default:throw new i.default.error.NoViableAltException(this)}}catch(S){if(!(S instanceof i.default.error.RecognitionException))throw S;T.exception=S,this._errHandler.reportError(this,S),this._errHandler.recover(this,S)}finally{this.exitRule()}return T}dotdotContent(){let T=new v(this,this._ctx,this.state);this.enterRule(T,6,ue.RULE_dotdotContent);try{switch(this.state=85,this._errHandler.sync(this),this._input.LA(1)){case 5:this.enterOuterAlt(T,1),this.state=82,this.match(ue.STAR);break;case 24:case 25:case 26:case 41:case 42:this.enterOuterAlt(T,2),this.state=83,this.identifier();break;case 29:this.enterOuterAlt(T,3),this.state=84,this.bracket();break;default:throw new i.default.error.NoViableAltException(this)}}catch(S){if(!(S instanceof i.default.error.RecognitionException))throw S;T.exception=S,this._errHandler.reportError(this,S),this._errHandler.recover(this,S)}finally{this.exitRule()}return T}dotContent(){let T=new E(this,this._ctx,this.state);this.enterRule(T,8,ue.RULE_dotContent);try{switch(this.state=90,this._errHandler.sync(this),this._input.LA(1)){case 5:this.enterOuterAlt(T,1),this.state=87,this.match(ue.STAR);break;case 44:this.enterOuterAlt(T,2),this.state=88,this.match(ue.NUMBER);break;case 24:case 25:case 26:case 41:case 42:this.enterOuterAlt(T,3),this.state=89,this.identifier();break;default:throw new i.default.error.NoViableAltException(this)}}catch(S){if(!(S instanceof i.default.error.RecognitionException))throw S;T.exception=S,this._errHandler.reportError(this,S),this._errHandler.recover(this,S)}finally{this.exitRule()}return T}bracket(){let T=new A(this,this._ctx,this.state);this.enterRule(T,10,ue.RULE_bracket);try{this.enterOuterAlt(T,1),this.state=92,this.match(ue.BRACKET_LEFT),this.state=93,this.bracketContent(),this.state=94,this.match(ue.BRACKET_RIGHT)}catch(S){if(!(S instanceof i.default.error.RecognitionException))throw S;T.exception=S,this._errHandler.reportError(this,S),this._errHandler.recover(this,S)}finally{this.exitRule()}return T}bracketContent(){let T=new D(this,this._ctx,this.state);this.enterRule(T,12,ue.RULE_bracketContent);try{switch(this.state=104,this._errHandler.sync(this),this._interp.adaptivePredict(this._input,11,this._ctx)){case 1:this.enterOuterAlt(T,1),this.state=96,this.unions();break;case 2:this.enterOuterAlt(T,2),this.state=97,this.indexes();break;case 3:this.enterOuterAlt(T,3),this.state=98,this.slices();break;case 4:this.enterOuterAlt(T,4),this.state=99,this.match(ue.STAR);break;case 5:this.enterOuterAlt(T,5),this.state=100,this.match(ue.NUMBER);break;case 6:this.enterOuterAlt(T,6),this.state=101,this.match(ue.STRING);break;case 7:this.enterOuterAlt(T,7),this.state=102,this.identifier();break;case 8:this.enterOuterAlt(T,8),this.state=103,this.filterExpression()}}catch(S){if(!(S instanceof i.default.error.RecognitionException))throw S;T.exception=S,this._errHandler.reportError(this,S),this._errHandler.recover(this,S)}finally{this.exitRule()}return T}filterExpression(){let T=new R(this,this._ctx,this.state);this.enterRule(T,14,ue.RULE_filterExpression);try{this.enterOuterAlt(T,1),this.state=106,this.match(ue.QUESTION),this.state=107,this.match(ue.PAREN_LEFT),this.state=108,this.expression(0),this.state=109,this.match(ue.PAREN_RIGHT)}catch(S){if(!(S instanceof i.default.error.RecognitionException))throw S;T.exception=S,this._errHandler.reportError(this,S),this._errHandler.recover(this,S)}finally{this.exitRule()}return T}indexes(){let T=new _(this,this._ctx,this.state);this.enterRule(T,16,ue.RULE_indexes);var S=0;try{this.enterOuterAlt(T,1),this.state=111,this.match(ue.NUMBER),this.state=114,this._errHandler.sync(this),S=this._input.LA(1);do this.state=112,this.match(ue.COMMA),this.state=113,this.match(ue.NUMBER),this.state=116,this._errHandler.sync(this),S=this._input.LA(1);while(S===32)}catch(k){if(!(k instanceof i.default.error.RecognitionException))throw k;T.exception=k,this._errHandler.reportError(this,k),this._errHandler.recover(this,k)}finally{this.exitRule()}return T}unions(){let T=new F(this,this._ctx,this.state);this.enterRule(T,18,ue.RULE_unions);var S=0;try{switch(this.state=132,this._errHandler.sync(this),this._input.LA(1)){case 45:this.enterOuterAlt(T,1),this.state=118,this.match(ue.STRING),this.state=121,this._errHandler.sync(this),S=this._input.LA(1);do this.state=119,this.match(ue.COMMA),this.state=120,this.match(ue.STRING),this.state=123,this._errHandler.sync(this),S=this._input.LA(1);while(S===32);break;case 24:case 25:case 26:case 41:case 42:this.enterOuterAlt(T,2),this.state=125,this.identifier(),this.state=128,this._errHandler.sync(this),S=this._input.LA(1);do this.state=126,this.match(ue.COMMA),this.state=127,this.identifier(),this.state=130,this._errHandler.sync(this),S=this._input.LA(1);while(S===32);break;default:throw new i.default.error.NoViableAltException(this)}}catch(k){if(!(k instanceof i.default.error.RecognitionException))throw k;T.exception=k,this._errHandler.reportError(this,k),this._errHandler.recover(this,k)}finally{this.exitRule()}return T}slices(){let T=new w(this,this._ctx,this.state);this.enterRule(T,20,ue.RULE_slices);try{this.enterOuterAlt(T,1),this.state=135,this._errHandler.sync(this),this._input.LA(1)===44&&(this.state=134,this.match(ue.NUMBER)),this.state=137,this.match(ue.COLON),this.state=139,this._errHandler.sync(this),this._input.LA(1)===44&&(this.state=138,this.match(ue.NUMBER)),this.state=145,this._errHandler.sync(this),this._input.LA(1)===31&&(this.state=141,this.match(ue.COLON),this.state=143,this._errHandler.sync(this),this._input.LA(1)===44&&(this.state=142,this.match(ue.NUMBER)))}catch(S){if(!(S instanceof i.default.error.RecognitionException))throw S;T.exception=S,this._errHandler.reportError(this,S),this._errHandler.recover(this,S)}finally{this.exitRule()}return T}regex(){let T=new C(this,this._ctx,this.state);this.enterRule(T,22,ue.RULE_regex);try{this.enterOuterAlt(T,1),this.state=147,this.match(ue.REGEX_EXPR),this.state=149,this._errHandler.sync(this),this._interp.adaptivePredict(this._input,20,this._ctx)===1&&(this.state=148,this.match(ue.REGEX_OPT))}catch(S){if(!(S instanceof i.default.error.RecognitionException))throw S;T.exception=S,this._errHandler.reportError(this,S),this._errHandler.recover(this,S)}finally{this.exitRule()}return T}expression(T){T===void 0&&(T=0);const S=this._ctx,k=this.state;let j=new M(this,this._ctx,k),Te=j;this.enterRecursionRule(j,24,ue.RULE_expression,T);var me=0;try{switch(this.enterOuterAlt(j,1),this.state=176,this._errHandler.sync(this),this._interp.adaptivePredict(this._input,21,this._ctx)){case 1:this.state=152,this.match(ue.NOT),this.state=153,this.match(ue.PAREN_LEFT),this.state=154,this.expression(0),this.state=155,this.match(ue.PAREN_RIGHT);break;case 2:this.state=157,this.match(ue.PAREN_LEFT),this.state=158,this.expression(0),this.state=159,this.match(ue.PAREN_RIGHT);break;case 3:this.state=161,this.filterarg(0),this.state=162,(-32&(me=this._input.LA(1)))!=0||(1<<me&2088832)==0?this._errHandler.recoverInline(this):(this._errHandler.reportMatch(this),this.consume()),this.state=163,this.filterarg(0);break;case 4:this.state=165,this.filterarg(0),this.state=166,this.match(ue.REG),this.state=167,this.regex();break;case 5:this.state=169,this.filterarg(0),this.state=170,this.match(ue.EMPT);break;case 6:this.state=172,this.filterpath();break;case 7:this.state=173,this.match(ue.TRUE);break;case 8:this.state=174,this.match(ue.FALSE);break;case 9:this.state=175,this.match(ue.NULL)}this._ctx.stop=this._input.LT(-1),this.state=183,this._errHandler.sync(this);for(var ye=this._interp.adaptivePredict(this._input,22,this._ctx);ye!=2&&ye!=i.default.atn.ATN.INVALID_ALT_NUMBER;){if(ye===1){if(this._parseListeners!==null&&this.triggerExitRuleEvent(),Te=j,j=new M(this,S,k),this.pushNewRecursionContext(j,24,ue.RULE_expression),this.state=178,!this.precpred(this._ctx,8))throw new i.default.error.FailedPredicateException(this,"this.precpred(this._ctx, 8)");this.state=179,(me=this._input.LA(1))!==6&&me!==23?this._errHandler.recoverInline(this):(this._errHandler.reportMatch(this),this.consume()),this.state=180,this.expression(9)}this.state=185,this._errHandler.sync(this),ye=this._interp.adaptivePredict(this._input,22,this._ctx)}}catch(at){if(!(at instanceof i.default.error.RecognitionException))throw at;j.exception=at,this._errHandler.reportError(this,at),this._errHandler.recover(this,at)}finally{this.unrollRecursionContexts(S)}return j}filterpath(){let T=new L(this,this._ctx,this.state);this.enterRule(T,26,ue.RULE_filterpath);var S=0;try{this.enterOuterAlt(T,1),this.state=186,(S=this._input.LA(1))!==1&&S!==3?this._errHandler.recoverInline(this):(this._errHandler.reportMatch(this),this.consume()),this.state=188,this._errHandler.sync(this),this._interp.adaptivePredict(this._input,23,this._ctx)===1&&(this.state=187,this.subscript())}catch(k){if(!(k instanceof i.default.error.RecognitionException))throw k;T.exception=k,this._errHandler.reportError(this,k),this._errHandler.recover(this,k)}finally{this.exitRule()}return T}identifier(){let T=new I(this,this._ctx,this.state);this.enterRule(T,28,ue.RULE_identifier);var S=0;try{this.enterOuterAlt(T,1),this.state=190,((S=this._input.LA(1))-24&-32)!=0||(1<<S-24&393223)==0?this._errHandler.recoverInline(this):(this._errHandler.reportMatch(this),this.consume())}catch(k){if(!(k instanceof i.default.error.RecognitionException))throw k;T.exception=k,this._errHandler.reportError(this,k),this._errHandler.recover(this,k)}finally{this.exitRule()}return T}obj(){let T=new U(this,this._ctx,this.state);this.enterRule(T,30,ue.RULE_obj);var S=0;try{switch(this.state=205,this._errHandler.sync(this),this._interp.adaptivePredict(this._input,25,this._ctx)){case 1:for(this.enterOuterAlt(T,1),this.state=192,this.match(ue.BRACE_LEFT),this.state=193,this.pair(),this.state=198,this._errHandler.sync(this),S=this._input.LA(1);S===32;)this.state=194,this.match(ue.COMMA),this.state=195,this.pair(),this.state=200,this._errHandler.sync(this),S=this._input.LA(1);this.state=201,this.match(ue.BRACE_RIGHT);break;case 2:this.enterOuterAlt(T,2),this.state=203,this.match(ue.BRACE_LEFT),this.state=204,this.match(ue.BRACE_RIGHT)}}catch(k){if(!(k instanceof i.default.error.RecognitionException))throw k;T.exception=k,this._errHandler.reportError(this,k),this._errHandler.recover(this,k)}finally{this.exitRule()}return T}pair(){let T=new q(this,this._ctx,this.state);this.enterRule(T,32,ue.RULE_pair);try{this.enterOuterAlt(T,1),this.state=207,this.match(ue.STRING),this.state=208,this.match(ue.COLON),this.state=209,this.value()}catch(S){if(!(S instanceof i.default.error.RecognitionException))throw S;T.exception=S,this._errHandler.reportError(this,S),this._errHandler.recover(this,S)}finally{this.exitRule()}return T}array(){let T=new $(this,this._ctx,this.state);this.enterRule(T,34,ue.RULE_array);var S=0;try{switch(this.state=224,this._errHandler.sync(this),this._interp.adaptivePredict(this._input,27,this._ctx)){case 1:for(this.enterOuterAlt(T,1),this.state=211,this.match(ue.BRACKET_LEFT),this.state=212,this.value(),this.state=217,this._errHandler.sync(this),S=this._input.LA(1);S===32;)this.state=213,this.match(ue.COMMA),this.state=214,this.value(),this.state=219,this._errHandler.sync(this),S=this._input.LA(1);this.state=220,this.match(ue.BRACKET_RIGHT);break;case 2:this.enterOuterAlt(T,2),this.state=222,this.match(ue.BRACKET_LEFT),this.state=223,this.match(ue.BRACKET_RIGHT)}}catch(k){if(!(k instanceof i.default.error.RecognitionException))throw k;T.exception=k,this._errHandler.reportError(this,k),this._errHandler.recover(this,k)}finally{this.exitRule()}return T}value(){let T=new X(this,this._ctx,this.state);this.enterRule(T,36,ue.RULE_value);try{switch(this.state=233,this._errHandler.sync(this),this._input.LA(1)){case 45:this.enterOuterAlt(T,1),this.state=226,this.match(ue.STRING);break;case 44:this.enterOuterAlt(T,2),this.state=227,this.match(ue.NUMBER);break;case 27:this.enterOuterAlt(T,3),this.state=228,this.obj();break;case 29:this.enterOuterAlt(T,4),this.state=229,this.array();break;case 24:this.enterOuterAlt(T,5),this.state=230,this.match(ue.TRUE);break;case 25:this.enterOuterAlt(T,6),this.state=231,this.match(ue.FALSE);break;case 26:this.enterOuterAlt(T,7),this.state=232,this.match(ue.NULL);break;default:throw new i.default.error.NoViableAltException(this)}}catch(S){if(!(S instanceof i.default.error.RecognitionException))throw S;T.exception=S,this._errHandler.reportError(this,S),this._errHandler.recover(this,S)}finally{this.exitRule()}return T}};re(ue,"grammarFileName","JSONPath.g4"),re(ue,"literalNames",[null,"'@'","'..'","'$'","'.'","'*'","'&&'","'=='","'>='","'>'","'<='","'<'","'!='","'=~'","' in '","' nin '","' subsetof '","' anyof '","' noneof '","' sizeof '","' size '","' empty'","'!'","'||'","'true'","'false'","'null'","'{'","'}'","'['","']'","':'","','","'('","')'","'?'","'- '","'+'","'/'"]),re(ue,"symbolicNames",[null,"CURRENT_VALUE","DOTDOT","ROOT_VALUE","DOT","STAR","AND","EQ","GE","GT","LE","LT","NE","REG","IN","NIN","SUB","ANY","NON","SIZO","SIZ","EMPT","NOT","OR","TRUE","FALSE","NULL","BRACE_LEFT","BRACE_RIGHT","BRACKET_LEFT","BRACKET_RIGHT","COLON","COMMA","PAREN_LEFT","PAREN_RIGHT","QUESTION","MINUS_SP","PLUS","DIV","REGEX_OPT","REGEX_EXPR","KEY","SPECIAL_KEY","WS","NUMBER","STRING"]),re(ue,"ruleNames",["jsonpath","filterarg","subscript","dotdotContent","dotContent","bracket","bracketContent","filterExpression","indexes","unions","slices","regex","expression","filterpath","identifier","obj","pair","array","value"]);let d=ue;d.EOF=i.default.Token.EOF,d.CURRENT_VALUE=1,d.DOTDOT=2,d.ROOT_VALUE=3,d.DOT=4,d.STAR=5,d.AND=6,d.EQ=7,d.GE=8,d.GT=9,d.LE=10,d.LT=11,d.NE=12,d.REG=13,d.IN=14,d.NIN=15,d.SUB=16,d.ANY=17,d.NON=18,d.SIZO=19,d.SIZ=20,d.EMPT=21,d.NOT=22,d.OR=23,d.TRUE=24,d.FALSE=25,d.NULL=26,d.BRACE_LEFT=27,d.BRACE_RIGHT=28,d.BRACKET_LEFT=29,d.BRACKET_RIGHT=30,d.COLON=31,d.COMMA=32,d.PAREN_LEFT=33,d.PAREN_RIGHT=34,d.QUESTION=35,d.MINUS_SP=36,d.PLUS=37,d.DIV=38,d.REGEX_OPT=39,d.REGEX_EXPR=40,d.KEY=41,d.SPECIAL_KEY=42,d.WS=43,d.NUMBER=44,d.STRING=45,d.RULE_jsonpath=0,d.RULE_filterarg=1,d.RULE_subscript=2,d.RULE_dotdotContent=3,d.RULE_dotContent=4,d.RULE_bracket=5,d.RULE_bracketContent=6,d.RULE_filterExpression=7,d.RULE_indexes=8,d.RULE_unions=9,d.RULE_slices=10,d.RULE_regex=11,d.RULE_expression=12,d.RULE_filterpath=13,d.RULE_identifier=14,d.RULE_obj=15,d.RULE_pair=16,d.RULE_array=17,d.RULE_value=18;class p extends i.default.ParserRuleContext{constructor(T,S,k){S===void 0&&(S=null),k==null&&(k=-1),super(S,k),this.parser=T,this.ruleIndex=d.RULE_jsonpath}ROOT_VALUE(){return this.getToken(d.ROOT_VALUE,0)}EOF(){return this.getToken(d.EOF,0)}subscript(){return this.getTypedRuleContext(m,0)}enterRule(T){T instanceof o&&T.enterJsonpath(this)}exitRule(T){T instanceof o&&T.exitJsonpath(this)}}class g extends i.default.ParserRuleContext{constructor(S,k,j){k===void 0&&(k=null),j==null&&(j=-1);super(k,j);re(this,"filterarg",function(S){return S===void 0&&(S=null),S===null?this.getTypedRuleContexts(g):this.getTypedRuleContext(g,S)});this.parser=S,this.ruleIndex=d.RULE_filterarg}PAREN_LEFT(){return this.getToken(d.PAREN_LEFT,0)}PAREN_RIGHT(){return this.getToken(d.PAREN_RIGHT,0)}value(){return this.getTypedRuleContext(X,0)}filterpath(){return this.getTypedRuleContext(L,0)}STAR(){return this.getToken(d.STAR,0)}DIV(){return this.getToken(d.DIV,0)}PLUS(){return this.getToken(d.PLUS,0)}MINUS_SP(){return this.getToken(d.MINUS_SP,0)}enterRule(S){S instanceof o&&S.enterFilterarg(this)}exitRule(S){S instanceof o&&S.exitFilterarg(this)}}class m extends i.default.ParserRuleContext{constructor(T,S,k){S===void 0&&(S=null),k==null&&(k=-1),super(S,k),this.parser=T,this.ruleIndex=d.RULE_subscript}DOTDOT(){return this.getToken(d.DOTDOT,0)}dotdotContent(){return this.getTypedRuleContext(v,0)}subscript(){return this.getTypedRuleContext(m,0)}DOT(){return this.getToken(d.DOT,0)}dotContent(){return this.getTypedRuleContext(E,0)}bracket(){return this.getTypedRuleContext(A,0)}enterRule(T){T instanceof o&&T.enterSubscript(this)}exitRule(T){T instanceof o&&T.exitSubscript(this)}}class v extends i.default.ParserRuleContext{constructor(T,S,k){S===void 0&&(S=null),k==null&&(k=-1),super(S,k),this.parser=T,this.ruleIndex=d.RULE_dotdotContent}STAR(){return this.getToken(d.STAR,0)}identifier(){return this.getTypedRuleContext(I,0)}bracket(){return this.getTypedRuleContext(A,0)}enterRule(T){T instanceof o&&T.enterDotdotContent(this)}exitRule(T){T instanceof o&&T.exitDotdotContent(this)}}class E extends i.default.ParserRuleContext{constructor(T,S,k){S===void 0&&(S=null),k==null&&(k=-1),super(S,k),this.parser=T,this.ruleIndex=d.RULE_dotContent}STAR(){return this.getToken(d.STAR,0)}NUMBER(){return this.getToken(d.NUMBER,0)}identifier(){return this.getTypedRuleContext(I,0)}enterRule(T){T instanceof o&&T.enterDotContent(this)}exitRule(T){T instanceof o&&T.exitDotContent(this)}}class A extends i.default.ParserRuleContext{constructor(T,S,k){S===void 0&&(S=null),k==null&&(k=-1),super(S,k),this.parser=T,this.ruleIndex=d.RULE_bracket}BRACKET_LEFT(){return this.getToken(d.BRACKET_LEFT,0)}bracketContent(){return this.getTypedRuleContext(D,0)}BRACKET_RIGHT(){return this.getToken(d.BRACKET_RIGHT,0)}enterRule(T){T instanceof o&&T.enterBracket(this)}exitRule(T){T instanceof o&&T.exitBracket(this)}}class D extends i.default.ParserRuleContext{constructor(T,S,k){S===void 0&&(S=null),k==null&&(k=-1),super(S,k),this.parser=T,this.ruleIndex=d.RULE_bracketContent}unions(){return this.getTypedRuleContext(F,0)}indexes(){return this.getTypedRuleContext(_,0)}slices(){return this.getTypedRuleContext(w,0)}STAR(){return this.getToken(d.STAR,0)}NUMBER(){return this.getToken(d.NUMBER,0)}STRING(){return this.getToken(d.STRING,0)}identifier(){return this.getTypedRuleContext(I,0)}filterExpression(){return this.getTypedRuleContext(R,0)}enterRule(T){T instanceof o&&T.enterBracketContent(this)}exitRule(T){T instanceof o&&T.exitBracketContent(this)}}class R extends i.default.ParserRuleContext{constructor(T,S,k){S===void 0&&(S=null),k==null&&(k=-1),super(S,k),this.parser=T,this.ruleIndex=d.RULE_filterExpression}QUESTION(){return this.getToken(d.QUESTION,0)}PAREN_LEFT(){return this.getToken(d.PAREN_LEFT,0)}expression(){return this.getTypedRuleContext(M,0)}PAREN_RIGHT(){return this.getToken(d.PAREN_RIGHT,0)}enterRule(T){T instanceof o&&T.enterFilterExpression(this)}exitRule(T){T instanceof o&&T.exitFilterExpression(this)}}class _ extends i.default.ParserRuleContext{constructor(S,k,j){k===void 0&&(k=null),j==null&&(j=-1);super(k,j);re(this,"NUMBER",function(S){return S===void 0&&(S=null),S===null?this.getTokens(d.NUMBER):this.getToken(d.NUMBER,S)});re(this,"COMMA",function(S){return S===void 0&&(S=null),S===null?this.getTokens(d.COMMA):this.getToken(d.COMMA,S)});this.parser=S,this.ruleIndex=d.RULE_indexes}enterRule(S){S instanceof o&&S.enterIndexes(this)}exitRule(S){S instanceof o&&S.exitIndexes(this)}}class F extends i.default.ParserRuleContext{constructor(S,k,j){k===void 0&&(k=null),j==null&&(j=-1);super(k,j);re(this,"STRING",function(S){return S===void 0&&(S=null),S===null?this.getTokens(d.STRING):this.getToken(d.STRING,S)});re(this,"COMMA",function(S){return S===void 0&&(S=null),S===null?this.getTokens(d.COMMA):this.getToken(d.COMMA,S)});re(this,"identifier",function(S){return S===void 0&&(S=null),S===null?this.getTypedRuleContexts(I):this.getTypedRuleContext(I,S)});this.parser=S,this.ruleIndex=d.RULE_unions}enterRule(S){S instanceof o&&S.enterUnions(this)}exitRule(S){S instanceof o&&S.exitUnions(this)}}class w extends i.default.ParserRuleContext{constructor(S,k,j){k===void 0&&(k=null),j==null&&(j=-1);super(k,j);re(this,"COLON",function(S){return S===void 0&&(S=null),S===null?this.getTokens(d.COLON):this.getToken(d.COLON,S)});re(this,"NUMBER",function(S){return S===void 0&&(S=null),S===null?this.getTokens(d.NUMBER):this.getToken(d.NUMBER,S)});this.parser=S,this.ruleIndex=d.RULE_slices}enterRule(S){S instanceof o&&S.enterSlices(this)}exitRule(S){S instanceof o&&S.exitSlices(this)}}class C extends i.default.ParserRuleContext{constructor(T,S,k){S===void 0&&(S=null),k==null&&(k=-1),super(S,k),this.parser=T,this.ruleIndex=d.RULE_regex}REGEX_EXPR(){return this.getToken(d.REGEX_EXPR,0)}REGEX_OPT(){return this.getToken(d.REGEX_OPT,0)}enterRule(T){T instanceof o&&T.enterRegex(this)}exitRule(T){T instanceof o&&T.exitRegex(this)}}class M extends i.default.ParserRuleContext{constructor(S,k,j){k===void 0&&(k=null),j==null&&(j=-1);super(k,j);re(this,"expression",function(S){return S===void 0&&(S=null),S===null?this.getTypedRuleContexts(M):this.getTypedRuleContext(M,S)});re(this,"filterarg",function(S){return S===void 0&&(S=null),S===null?this.getTypedRuleContexts(g):this.getTypedRuleContext(g,S)});this.parser=S,this.ruleIndex=d.RULE_expression}NOT(){return this.getToken(d.NOT,0)}PAREN_LEFT(){return this.getToken(d.PAREN_LEFT,0)}PAREN_RIGHT(){return this.getToken(d.PAREN_RIGHT,0)}EQ(){return this.getToken(d.EQ,0)}NE(){return this.getToken(d.NE,0)}LT(){return this.getToken(d.LT,0)}LE(){return this.getToken(d.LE,0)}GT(){return this.getToken(d.GT,0)}GE(){return this.getToken(d.GE,0)}IN(){return this.getToken(d.IN,0)}NIN(){return this.getToken(d.NIN,0)}SUB(){return this.getToken(d.SUB,0)}ANY(){return this.getToken(d.ANY,0)}SIZO(){return this.getToken(d.SIZO,0)}NON(){return this.getToken(d.NON,0)}SIZ(){return this.getToken(d.SIZ,0)}REG(){return this.getToken(d.REG,0)}regex(){return this.getTypedRuleContext(C,0)}EMPT(){return this.getToken(d.EMPT,0)}filterpath(){return this.getTypedRuleContext(L,0)}TRUE(){return this.getToken(d.TRUE,0)}FALSE(){return this.getToken(d.FALSE,0)}NULL(){return this.getToken(d.NULL,0)}AND(){return this.getToken(d.AND,0)}OR(){return this.getToken(d.OR,0)}enterRule(S){S instanceof o&&S.enterExpression(this)}exitRule(S){S instanceof o&&S.exitExpression(this)}}class L extends i.default.ParserRuleContext{constructor(T,S,k){S===void 0&&(S=null),k==null&&(k=-1),super(S,k),this.parser=T,this.ruleIndex=d.RULE_filterpath}ROOT_VALUE(){return this.getToken(d.ROOT_VALUE,0)}CURRENT_VALUE(){return this.getToken(d.CURRENT_VALUE,0)}subscript(){return this.getTypedRuleContext(m,0)}enterRule(T){T instanceof o&&T.enterFilterpath(this)}exitRule(T){T instanceof o&&T.exitFilterpath(this)}}class I extends i.default.ParserRuleContext{constructor(T,S,k){S===void 0&&(S=null),k==null&&(k=-1),super(S,k),this.parser=T,this.ruleIndex=d.RULE_identifier}KEY(){return this.getToken(d.KEY,0)}SPECIAL_KEY(){return this.getToken(d.SPECIAL_KEY,0)}TRUE(){return this.getToken(d.TRUE,0)}FALSE(){return this.getToken(d.FALSE,0)}NULL(){return this.getToken(d.NULL,0)}enterRule(T){T instanceof o&&T.enterIdentifier(this)}exitRule(T){T instanceof o&&T.exitIdentifier(this)}}class U extends i.default.ParserRuleContext{constructor(S,k,j){k===void 0&&(k=null),j==null&&(j=-1);super(k,j);re(this,"pair",function(S){return S===void 0&&(S=null),S===null?this.getTypedRuleContexts(q):this.getTypedRuleContext(q,S)});re(this,"COMMA",function(S){return S===void 0&&(S=null),S===null?this.getTokens(d.COMMA):this.getToken(d.COMMA,S)});this.parser=S,this.ruleIndex=d.RULE_obj}BRACE_LEFT(){return this.getToken(d.BRACE_LEFT,0)}BRACE_RIGHT(){return this.getToken(d.BRACE_RIGHT,0)}enterRule(S){S instanceof o&&S.enterObj(this)}exitRule(S){S instanceof o&&S.exitObj(this)}}class q extends i.default.ParserRuleContext{constructor(T,S,k){S===void 0&&(S=null),k==null&&(k=-1),super(S,k),this.parser=T,this.ruleIndex=d.RULE_pair}STRING(){return this.getToken(d.STRING,0)}COLON(){return this.getToken(d.COLON,0)}value(){return this.getTypedRuleContext(X,0)}enterRule(T){T instanceof o&&T.enterPair(this)}exitRule(T){T instanceof o&&T.exitPair(this)}}class $ extends i.default.ParserRuleContext{constructor(S,k,j){k===void 0&&(k=null),j==null&&(j=-1);super(k,j);re(this,"value",function(S){return S===void 0&&(S=null),S===null?this.getTypedRuleContexts(X):this.getTypedRuleContext(X,S)});re(this,"COMMA",function(S){return S===void 0&&(S=null),S===null?this.getTokens(d.COMMA):this.getToken(d.COMMA,S)});this.parser=S,this.ruleIndex=d.RULE_array}BRACKET_LEFT(){return this.getToken(d.BRACKET_LEFT,0)}BRACKET_RIGHT(){return this.getToken(d.BRACKET_RIGHT,0)}enterRule(S){S instanceof o&&S.enterArray(this)}exitRule(S){S instanceof o&&S.exitArray(this)}}class X extends i.default.ParserRuleContext{constructor(T,S,k){S===void 0&&(S=null),k==null&&(k=-1),super(S,k),this.parser=T,this.ruleIndex=d.RULE_value}STRING(){return this.getToken(d.STRING,0)}NUMBER(){return this.getToken(d.NUMBER,0)}obj(){return this.getTypedRuleContext(U,0)}array(){return this.getTypedRuleContext($,0)}TRUE(){return this.getToken(d.TRUE,0)}FALSE(){return this.getToken(d.FALSE,0)}NULL(){return this.getToken(d.NULL,0)}enterRule(T){T instanceof o&&T.enterValue(this)}exitRule(T){T instanceof o&&T.exitValue(this)}}d.JsonpathContext=p,d.FilterargContext=g,d.SubscriptContext=m,d.DotdotContentContext=v,d.DotContentContext=E,d.BracketContext=A,d.BracketContentContext=D,d.FilterExpressionContext=R,d.IndexesContext=_,d.UnionsContext=F,d.SlicesContext=w,d.RegexContext=C,d.ExpressionContext=M,d.FilterpathContext=L,d.IdentifierContext=I,d.ObjContext=U,d.PairContext=q,d.ArrayContext=$,d.ValueContext=X;const ne={root:K=>"type"in K&&K.type==="root",value:K=>"type"in K&&K.type==="value",regex:K=>"type"in K&&K.type==="value"&&K.subtype==="regex",operationContent:K=>"type"in K&&typeof K.type=="string"&&["value","current","root","groupOperation","operation"].includes(K.type),subscript:K=>"type"in K&&K.type==="subscript",bracket:K=>"type"in K&&["bracketMember","bracketExpression"].includes(K.type),unions:K=>"type"in K&&K.type==="unions",indexes:K=>"type"in K&&K.type==="indexes",slices:K=>"type"in K&&K.type==="slices",filterExpression:K=>"type"in K&&K.type==="filterExpression",dotContent:K=>"type"in K&&["identifier","numericLiteral","wildcard"].includes(K.type),dotdotContent:K=>"type"in K&&["identifier","wildcard","bracketMember","bracketExpression"].includes(K.type),bracketContent:K=>"type"in K&&["identifier","wildcard","numericLiteral","stringLiteral","filterExpression","slices","unions","indexes"].includes(K.type),expressionContent:K=>"type"in K&&["value","comparator","groupExpression","logicalExpression","notExpression","current","root"].includes(K.type)};class se extends o{constructor(){super(...arguments),this._stack=[]}getTree(){return this.popWithCheck("root",null)}popWithCheck(T,S){const k=this._stack.pop();if(k!==void 0&&ne[T](k))return k;throw new Error(`bad type (${JSON.stringify(k)}) returned for ${T} with token: ${S==null?void 0:S.getText()}`)}push(T){this._stack.push(T)}exitJsonpath(T){if(T.ROOT_VALUE()){const S=T.subscript()?this.popWithCheck("subscript",T):null;this.push({type:"root",next:S})}}exitBracketContent(T){switch(!0){case!!T.identifier():{const S=T.identifier().getText();this.push({type:"identifier",value:S});break}case!!T.STAR():this.push({type:"wildcard"});break;case!!T.unions():{const S=this.popWithCheck("unions",T);this.push(S);break}case!!T.indexes():{const S=this.popWithCheck("indexes",T);this.push(S);break}case!!T.slices():{const S=this.popWithCheck("slices",T);this.push(S);break}case!!T.STRING():{const S=T.STRING().getText().slice(1,-1);this.push({type:"stringLiteral",value:S});break}case!!T.NUMBER():{const S=Number.parseInt(T.NUMBER().getText());this.push({type:"numericLiteral",value:S});break}case!!T.filterExpression():{const S=this.popWithCheck("filterExpression",T);this.push(S);break}}}exitBracket(T){const S=this.popWithCheck("bracketContent",T);["identifier","numericLiteral","stringLiteral"].includes(S.type)?this.push({type:"bracketMember",value:S}):this.push({type:"bracketExpression",value:S})}exitDotdotContent(T){switch(!0){case!!T.STAR():this.push({type:"wildcard"});break;case!!T.identifier():{const S=T.identifier().getText();this.push({type:"identifier",value:S});break}case!!T.bracket():{const S=this.popWithCheck("bracket",T);this.push(S);break}}}exitDotContent(T){switch(!0){case!!T.STAR():this.push({type:"wildcard"});break;case!!T.identifier():{const S=T.identifier().getText();this.push({type:"identifier",value:S});break}case!!T.NUMBER():{const S=Number.parseInt(T.NUMBER().getText());this.push({type:"numericLiteral",value:S});break}}}exitSubscript(T){switch(!0){case!!T.DOT():{const S=T.subscript()?this.popWithCheck("subscript",T):null,k=this.popWithCheck("dotContent",T);this.push({type:"subscript",value:{type:"dot",value:k},next:S});break}case!!T.DOTDOT():{const S=T.subscript()?this.popWithCheck("subscript",T):null,k=this.popWithCheck("dotdotContent",T);this.push({type:"subscript",value:{type:"dotdot",value:k},next:S});break}case!!T.bracket():{const S=T.subscript()?this.popWithCheck("subscript",T):null,k=this.popWithCheck("bracket",T);this.push({type:"subscript",next:S,value:k});break}}}exitFilterpath(T){switch(!0){case!!T.ROOT_VALUE():{const S=T.subscript()?this.popWithCheck("subscript",T):null;this.push({type:"root",next:S});break}case!!T.CURRENT_VALUE():{const S=T.subscript()?this.popWithCheck("subscript",T):null;this.push({type:"current",next:S});break}}}exitUnions(T){const S=[];for(let k=0;k<T.identifier().length;k+=1){const j=T.identifier(k).getText();S.push({type:"identifier",value:j})}for(let k=0;k<T.STRING().length;k+=1){const j=T.STRING(k).getText().slice(1,-1);S.push({type:"stringLiteral",value:j})}this.push({type:"unions",values:S})}exitIndexes(T){const S=[];for(let k=0;k<T.NUMBER().length;k+=1){const j=Number.parseInt(T.NUMBER(k).getText());S.push({type:"numericLiteral",value:j})}this.push({type:"indexes",values:S})}exitSlices(T){const S=[0,1,2].map(ye=>T.getToken(d.NUMBER,ye)),k=[0,1].map(ye=>T.getToken(d.COLON,ye));let j=null,Te=null,me=null;k[0]&&S[0]&&S[0].getSourceInterval().start<k[0].getSourceInterval().start&&(j=Number.parseInt(S[0].getText())),!k[1]&&k[0]&&S[1]&&S[1].getSourceInterval().start>k[0].getSourceInterval().start||k[1]&&S[1]&&S[1].getSourceInterval().start<k[1].getSourceInterval().start?Te=Number.parseInt(S[1].getText()):k[0]&&S[0]&&S[0].getSourceInterval().start>k[0].getSourceInterval().start&&(!k[1]||S[0].getSourceInterval().start<k[1].getSourceInterval().start)&&(Te=Number.parseInt(S[0].getText())),k[1]&&S[2]?me=Number.parseInt(S[2].getText()):k[1]&&S[1]&&S[1].getSourceInterval().start>k[1].getSourceInterval().start?me=Number.parseInt(S[1].getText()):k[1]&&S[0]&&S[0].getSourceInterval().start>k[1].getSourceInterval().start&&(me=Number.parseInt(S[0].getText())),this.push({type:"slices",start:j,end:Te,step:me})}exitFilterExpression(T){const S=this.popWithCheck("expressionContent",T);this.push({type:"filterExpression",value:S})}exitRegex(T){var S;const k=T.REGEX_EXPR().getText(),j=((S=T.REGEX_OPT())===null||S===void 0?void 0:S.getText())||"";this.push({type:"value",subtype:"regex",value:k,opts:j})}exitExpression(T){switch(!0){case!!T.NOT():{const S=this.popWithCheck("expressionContent",T);this.push({type:"notExpression",value:S});break}case!!T.NULL():this.push({type:"value",value:null,subtype:"null"});break;case!!T.FALSE():this.push({type:"value",value:!1,subtype:"boolean"});break;case!!T.TRUE():this.push({type:"value",value:!0,subtype:"boolean"});break;case!!T.AND():{const S=this.popWithCheck("expressionContent",T),k=this.popWithCheck("expressionContent",T);this.push({type:"logicalExpression",operator:"and",left:k,right:S});break}case!!T.OR():{const S=this.popWithCheck("expressionContent",T),k=this.popWithCheck("expressionContent",T);this.push({type:"logicalExpression",operator:"or",left:k,right:S});break}case!!T.PAREN_LEFT():{const S=this.popWithCheck("expressionContent",T);this.push({type:"groupExpression",value:S});break}case!!T.regex():{const S=this.popWithCheck("regex",T),k=this.popWithCheck("operationContent",T);this.push({type:"comparator",operator:"reg",left:k,right:S});break}case!!T.EMPT():{const S=this.popWithCheck("operationContent",T);this.push({type:"comparator",operator:"empty",left:S,right:null});break}case!!T.getTypedRuleContext(d.FilterargContext,1):{const S=this.popWithCheck("operationContent",T),k=this.popWithCheck("operationContent",T);switch(!0){case!!T.EQ():this.push({type:"comparator",operator:"eq",left:k,right:S});break;case!!T.NE():this.push({type:"comparator",operator:"ne",left:k,right:S});break;case!!T.LT():this.push({type:"comparator",operator:"lt",left:k,right:S});break;case!!T.LE():this.push({type:"comparator",operator:"le",left:k,right:S});break;case!!T.GT():this.push({type:"comparator",operator:"gt",left:k,right:S});break;case!!T.GE():this.push({type:"comparator",operator:"ge",left:k,right:S});break;case!!T.IN():this.push({type:"comparator",operator:"in",left:k,right:S});break;case!!T.NIN():this.push({type:"comparator",operator:"nin",left:k,right:S});break;case!!T.SUB():this.push({type:"comparator",operator:"subsetof",left:k,right:S});break;case!!T.ANY():this.push({type:"comparator",operator:"anyof",left:k,right:S});break;case!!T.NON():this.push({type:"comparator",operator:"noneof",left:k,right:S});break;case!!T.SIZ():this.push({type:"comparator",operator:"size",left:k,right:S});break;case!!T.SIZO():this.push({type:"comparator",operator:"sizeof",left:k,right:S})}break}}}exitObj(T){const S={};for(const k of T.pair()){const j=this.popWithCheck("value",T);S[k.STRING().getText().slice(1,-1)]=j.value}this.push({type:"value",subtype:"object",value:S})}exitArray(T){const S=[];for(let k=0;k<T.value().length;k+=1){const j=this.popWithCheck("value",T);S.unshift(j.value)}this.push({type:"value",subtype:"array",value:S})}exitFilterarg(T){switch(!0){case!!T.getTypedRuleContext(d.FilterargContext,1):switch(!0){case!!T.STAR():{const S=this.popWithCheck("operationContent",T),k=this.popWithCheck("operationContent",T);this.push({type:"operation",operator:"multi",left:k,right:S});break}case!!T.DIV():{const S=this.popWithCheck("operationContent",T),k=this.popWithCheck("operationContent",T);this.push({type:"operation",operator:"div",left:k,right:S});break}case!!T.PLUS():{const S=this.popWithCheck("operationContent",T),k=this.popWithCheck("operationContent",T);this.push({type:"operation",operator:"plus",left:k,right:S});break}case!!T.MINUS_SP():{const S=this.popWithCheck("operationContent",T),k=this.popWithCheck("operationContent",T);this.push({type:"operation",operator:"minus",left:k,right:S});break}default:{const S=this.popWithCheck("operationContent",T),k=this.popWithCheck("operationContent",T);this.push({type:"operation",operator:"",left:k,right:S});break}}break;case!!T.PAREN_LEFT():{const S=this.popWithCheck("operationContent",T);this.push({type:"groupOperation",value:S});break}case!!T.value():{const S=this.popWithCheck("operationContent",T);this.push(S);break}case!!T.filterpath():{const S=this.popWithCheck("operationContent",T);this.push(S);break}}}exitValue(T){switch(!0){case!!T.STRING():{const k=T.STRING().getText().slice(1,-1);this.push({type:"value",subtype:"string",value:k});break}case!!T.NUMBER():{const k=T.NUMBER().getText();k!==`${Number.parseInt(k)}`?this.push({type:"value",subtype:"number",value:Number.parseFloat(k)}):this.push({type:"value",subtype:"number",value:Number.parseInt(k)});break}case!!T.array():const S=this.popWithCheck("value",T);this.push(S);break;case!!T.obj():{const k=this.popWithCheck("value",T);this.push(k);break}case!!T.TRUE():this.push({type:"value",value:!0,subtype:"boolean"});break;case!!T.FALSE():this.push({type:"value",value:!1,subtype:"boolean"});break;case!!T.NULL():this.push({type:"value",value:null,subtype:"null"})}}}const ce={syntaxError:(K,T,S,k,j,Te)=>{throw new r(S,k,j)},reportAmbiguity:function(K,T,S,k,j,Te,me){},reportAttemptingFullContext:function(K,T,S,k,j,Te){},reportContextSensitivity:function(K,T,S,k,j,Te){}};function ie(K){const T=new i.default.InputStream(K),S=new a(T),k=new i.default.CommonTokenStream(S),j=new d(k);j.removeErrorListeners(),j.addErrorListener(ce);const Te=new se;j.buildParseTrees=!0;const me=j.jsonpath();return i.default.tree.ParseTreeWalker.DEFAULT.walk(Te,me),Te.getTree()}function H(K,T={}){try{return ie(K)}catch(S){if(!T.hideExceptions)throw S;return null}}var J=as(63);const ve=(K,T)=>J(K,T),fe=K=>Array.isArray(K),De=K=>{if(typeof K!="object"||K===null)return!1;let T=K;for(;Object.getPrototypeOf(T)!==null;)T=Object.getPrototypeOf(T);return Object.getPrototypeOf(K)===T},Ie=K=>typeof K=="number",we=K=>typeof K=="string",Ue=K=>K===void 0,$e=K=>K!==void 0,et=(K,T)=>K<0?T+K:K,it=(K,T)=>K.concat(`["${T}"]`),Ge=(K,T)=>K.concat(`[${T}]`);class st{constructor(T){this.handleIdentifier=(S,k)=>{if(De(S.value)&&k.value in S.value)return{value:S.value[k.value],paths:it(S.paths,k.value)}},this.handleWildcard=({value:S,paths:k})=>De(S)||fe(S)?fe(S)?S.map((j,Te)=>({value:j,paths:Ge(k,Te)})):Object.keys(S).map(j=>({value:S[j],paths:it(k,j)})):[],this.handleOperationContent=(S,k)=>{var j,Te;switch(k.type){case"root":return this.handleSubscript(this.rootPayload,k.next);case"current":return this.handleSubscript(S,k.next);case"value":return{value:k.value,paths:S.paths};case"groupOperation":return this.handleOperationContent(S,k.value);case"operation":{const me=(j=this.handleOperationContent(S,k.left))===null||j===void 0?void 0:j.value,ye=(Te=this.handleOperationContent(S,k.right))===null||Te===void 0?void 0:Te.value;if(!Ie(me)||!Ie(ye))return;switch(k.operator){case"plus":return{value:me+ye,paths:S.paths};case"minus":return{value:me-ye,paths:S.paths};case"div":return ye===0?void 0:{value:me/ye,paths:S.paths};case"multi":return{value:me*ye,paths:S.paths};case"":if(ye>0)throw new r(0,0,"Missing operator in operation");return{value:me+ye,paths:S.paths}}}}},this.handleComparator=(S,k)=>{var j,Te;const me=(j=this.handleOperationContent(S,k.left))===null||j===void 0?void 0:j.value;if(k.operator==="empty")return!(!fe(me)&&!we(me))&&me.length===0;const ye=(Te=this.handleOperationContent(S,k.right))===null||Te===void 0?void 0:Te.value;switch(k.operator){case"subsetof":{if(!fe(me)||!fe(ye))return!1;const at=new Set(ye);return me.every(Kt=>at.has(Kt))}case"anyof":{if(!fe(me)||!fe(ye))return!1;const at=new Set(ye);return me.some(Kt=>at.has(Kt))}case"noneof":{if(!fe(me)||!fe(ye))return!1;const at=new Set(ye);return!me.some(Kt=>at.has(Kt))}case"sizeof":return!(!fe(me)&&!we(me)||!fe(ye)&&!we(ye))&&me.length===ye.length;case"size":return!(!fe(me)&&!we(me)||!Ie(ye))&&me.length===ye;case"eq":return ve(me,ye);case"ne":return!ve(me,ye);case"lt":return(Ie(me)&&Ie(ye)||!(!we(me)||!we(ye)))&&me<ye;case"le":return(Ie(me)&&Ie(ye)||!(!we(me)||!we(ye)))&&me<=ye;case"gt":return(Ie(me)&&Ie(ye)||!(!we(me)||!we(ye)))&&me>ye;case"ge":return(Ie(me)&&Ie(ye)||!(!we(me)||!we(ye)))&&me>=ye;case"in":return!!fe(ye)&&ye.includes(me);case"nin":return!!fe(ye)&&!ye.includes(me);case"reg":{if(!we(me)||!we(ye))return!1;const at=ye.slice(1,-1);return!!me.match(new RegExp(at,k.right.opts))}}},this.handleLogicalExpression=(S,k)=>{const j=this.handleFilterExpressionContent(S,k.left),Te=this.handleFilterExpressionContent(S,k.right);switch(k.operator){case"and":return j&&Te;case"or":return j||Te}},this.handleFilterExpressionContent=(S,k)=>{switch(k.type){case"logicalExpression":return this.handleLogicalExpression(S,k);case"comparator":return this.handleComparator(S,k);case"groupExpression":return this.handleFilterExpressionContent(S,k.value);case"notExpression":return!this.handleFilterExpressionContent(S,k.value);case"root":return $e(this.handleSubscript(this.rootPayload,k.next));case"current":return $e(this.handleSubscript(S,k.next));case"value":return!!k.value}},this.handleNumericLiteral=({value:S,paths:k},j)=>{if(!fe(S)&&!De(S))return;if(De(S))return this.handleStringLiteral({value:S,paths:k},{type:"stringLiteral",value:`${j.value}`});const Te=et(j.value,S.length);return Te<S.length&&Te>=0?{value:S[Te],paths:Ge(k,Te)}:void 0},this.handleSlices=({value:S,paths:k},j)=>{const Te=[];if(!fe(S))return[];const me=j.start!==null?et(j.start,S.length):0,ye=j.end!==null?et(j.end,S.length):S.length,at=j.step===null||j.step<=0?1:j.step;let Kt=0;return S.forEach((Ei,Ir)=>{Ir>=me&&Ir<ye&&(Kt%at==0&&Te.push({value:Ei,paths:Ge(k,Ir)}),Kt+=1)}),Te},this.handleStringLiteral=({value:S,paths:k},j)=>{if(De(S)&&j.value in S)return{value:S[j.value],paths:it(k,j.value)}},this.handleUnions=(S,k)=>De(S.value)?k.values.map(j=>{switch(j.type){case"identifier":return this.handleIdentifier(S,j);case"stringLiteral":return this.handleStringLiteral(S,j)}}).filter($e):[],this.handleIndexes=({value:S,paths:k},j)=>fe(S)?j.values.map(Te=>this.handleNumericLiteral({value:S,paths:k},Te)).filter($e):[],this.handleDotdot=(S,k)=>{const j=k.value,Te=S.value;let me=[];switch(j.type){case"bracketMember":{const ye=this.handleBracketMemberContent(S,j.value);$e(ye)&&(me=me.concat(ye));break}case"bracketExpression":if(De(Te)||fe(Te)&&j.value.type==="wildcard"){const ye=this.handleBracketExpressionContent(S,j.value);me=me.concat(ye)}break;case"wildcard":{const ye=this.handleWildcard(S);me=me.concat(ye);break}case"identifier":{const ye=this.handleIdentifier(S,j);$e(ye)&&(me=me.concat(ye));break}}return De(Te)?Object.keys(Te).forEach(ye=>{const at=this.handleDotdot({value:Te[ye],paths:it(S.paths,ye)},k);me=me.concat(at)}):fe(Te)&&Te.forEach((ye,at)=>{const Kt=this.handleDotdot({value:ye,paths:Ge(S.paths,at)},k);me=me.concat(Kt)}),me},this.handleBracketMemberContent=(S,k)=>{switch(k.type){case"identifier":return this.handleIdentifier(S,k);case"numericLiteral":return this.handleNumericLiteral(S,k);case"stringLiteral":return this.handleStringLiteral(S,k)}},this.handleBracketExpressionContent=(S,k)=>{const j=S.value;switch(k.type){case"filterExpression":{let Te=[];return fe(j)?j.forEach((me,ye)=>{const at={value:me,paths:Ge(S.paths,ye)};this.handleFilterExpressionContent(at,k.value)&&(Te=Te.concat(at))}):De(j)&&this.handleFilterExpressionContent(S,k.value)&&(Te=Te.concat(S)),Te}case"indexes":return this.handleIndexes(S,k);case"unions":return this.handleUnions(S,k);case"wildcard":return this.handleWildcard(S);case"slices":return this.handleSlices(S,k)}},this.concatIndefiniteValuePaths=(S,k)=>{if(!k)return S.reduce((me,ye)=>({isIndefinite:!0,value:[...me.value,ye.value],paths:[...me.paths,ye.paths]}),{value:[],paths:[],isIndefinite:!0});let j=[],Te=[];return S.forEach(me=>{const ye=this.handleSubscript(me,k);Ue(ye)||(j=ye.isIndefinite?j.concat(ye.value):[...j,ye.value],Te=Te.concat(ye.paths))}),{value:j,paths:Te,isIndefinite:!0}},this.handleSubscript=(S,k)=>{if(k===null)return S;const j=k.value;switch(j.type){case"bracketExpression":{const Te=this.handleBracketExpressionContent(S,j.value);return this.concatIndefiniteValuePaths(Te,k.next)}case"bracketMember":{const Te=this.handleBracketMemberContent(S,j.value);return Ue(Te)?void 0:this.handleSubscript(Te,k.next)}case"dot":switch(j.value.type){case"identifier":{const Te=this.handleIdentifier(S,j.value);return Ue(Te)?void 0:this.handleSubscript(Te,k.next)}case"numericLiteral":{const Te=this.handleNumericLiteral(S,j.value);return Ue(Te)?void 0:this.handleSubscript(Te,k.next)}case"wildcard":{const Te=this.handleWildcard(S);return this.concatIndefiniteValuePaths(Te,k.next)}}case"dotdot":{const Te=this.handleDotdot(S,j);return this.concatIndefiniteValuePaths(Te,k.next)}}},this.handleRoot=S=>this.handleSubscript(this.rootPayload,S.next),this.rootPayload={value:T,paths:"$"}}}const B=(K,T,S={})=>{try{const k=ie(T),j=new st(K).handleRoot(k);return Ue(j)?[]:fe(j.paths)?j.paths:[j.paths]}catch(k){if(!S.hideExceptions)throw k;return[]}},ae=(K,T,S)=>{const k=ie(T),j=new st(K).handleRoot(k);return!(j!=null&&j.isIndefinite)&&S.returnArray?Ue(j)?[]:[j.value]:j==null?void 0:j.value},Ae=(K,T,S={})=>{try{return fe(T)?((k,j,Te)=>{const me=[];for(const ye of j){const at=ae(k,ye,Te);$e(at)&&me.push(at)}return me})(K,T,S):ae(K,T,S)}catch(k){if(!S.hideExceptions)throw k;return S.returnArray?[]:void 0}},be={eq:"==",ne:"!=",lt:"<",le:"<=",gt:">",ge:">=",in:"in",reg:"=~",nin:"nin",subsetof:"subsetof",anyof:"anyof",noneof:"noneof",empty:"empty",sizeof:"sizeof",size:"size"},ge={plus:"+",minus:"-",multi:"*",div:"/","":""},Ne={and:"&&",or:"||"};function Pe(K){if(K===null)return"";switch(K.type){case"root":return"$"+Pe(K.next);case"current":return"@"+Pe(K.next);case"dot":return"."+Pe(K.value);case"dotdot":return".."+Pe(K.value);case"bracketExpression":case"bracketMember":return"["+Pe(K.value)+"]";case"subscript":return Pe(K.value)+Pe(K.next);case"identifier":return K.value;case"wildcard":return"*";case"indexes":case"unions":return K.values.map(Pe).join(", ");case"stringLiteral":return`"${K.value}"`;case"numericLiteral":return`${K.value}`;case"notExpression":return"!("+Pe(K.value)+")";case"value":return K.subtype==="regex"?`${K.value}${K.opts}`:JSON.stringify(K.value);case"filterExpression":return"?("+Pe(K.value)+")";case"groupOperation":case"groupExpression":return"("+Pe(K.value)+")";case"operation":return Pe(K.left)+" "+ge[K.operator]+" "+Pe(K.right);case"comparator":return Pe(K.left)+` ${be[K.operator]} `+Pe(K.right);case"logicalExpression":return Pe(K.left)+` ${Ne[K.operator]} `+Pe(K.right);case"slices":return`${K.start!==null?K.start:""}:${K.end!==null?K.end:""}${K.step!==null?":"+K.step:""}`}}})(),La.yS,La.Qc,La.Hb;var Ji=La.IO;La.Pz;var wi=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Vs(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}function HI(i){if(Object.prototype.hasOwnProperty.call(i,"__esModule"))return i;var e=i.default;if(typeof e=="function"){var t=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(i).forEach(function(r){var n=Object.getOwnPropertyDescriptor(i,r);Object.defineProperty(t,r,n.get?n:{enumerable:!0,get:function(){return i[r]}})}),t}var Ho={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */var KI=Ho.exports,Nv;function WI(){return Nv||(Nv=1,function(i,e){(function(){var t,r="4.17.20",n=200,s="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",a="Expected a function",o="__lodash_hash_undefined__",l=500,u="__lodash_placeholder__",h=1,d=2,p=4,g=1,m=2,v=1,E=2,A=4,D=8,R=16,_=32,F=64,w=128,C=256,M=512,L=30,I="...",U=800,q=16,$=1,X=2,ne=3,se=1/0,ce=9007199254740991,ie=17976931348623157e292,H=NaN,J=4294967295,ve=J-1,fe=J>>>1,De=[["ary",w],["bind",v],["bindKey",E],["curry",D],["curryRight",R],["flip",M],["partial",_],["partialRight",F],["rearg",C]],Ie="[object Arguments]",we="[object Array]",Ue="[object AsyncFunction]",$e="[object Boolean]",et="[object Date]",it="[object DOMException]",Ge="[object Error]",st="[object Function]",B="[object GeneratorFunction]",ae="[object Map]",Ae="[object Number]",be="[object Null]",ge="[object Object]",Ne="[object Promise]",Pe="[object Proxy]",ue="[object RegExp]",K="[object Set]",T="[object String]",S="[object Symbol]",k="[object Undefined]",j="[object WeakMap]",Te="[object WeakSet]",me="[object ArrayBuffer]",ye="[object DataView]",at="[object Float32Array]",Kt="[object Float64Array]",Ei="[object Int8Array]",Ir="[object Int16Array]",bl="[object Int32Array]",Al="[object Uint8Array]",Zs="[object Uint8ClampedArray]",As="[object Uint16Array]",Z="[object Uint32Array]",ee=/\b__p \+= '';/g,gt=/\b(__p \+=) '' \+/g,Dt=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Rt=/&(?:amp|lt|gt|quot|#39);/g,Ze=/[&<>"']/g,dn=RegExp(Rt.source),Bn=RegExp(Ze.source),Ur=/<%-([\s\S]+?)%>/g,fn=/<%([\s\S]+?)%>/g,so=/<%=([\s\S]+?)%>/g,Ss=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,ai=/^\w*$/,xc=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,ao=/[\\^$.*+?()[\]{}|]/g,Tc=RegExp(ao.source),xs=/^\s+|\s+$/g,oo=/^\s+/,lo=/\s+$/,Sl=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,xl=/\{\n\/\* \[wrapped with (.+)\] \*/,Dc=/,? & /,Rc=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Tl=/\\(\\)?/g,Ic=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,uo=/\w*$/,Nc=/^[-+]0x[0-9a-f]+$/i,Fp=/^0b[01]+$/i,Dl=/^\[object .+?Constructor\]$/,Ts=/^0o[0-7]+$/i,co=/^(?:0|[1-9]\d*)$/,Bp=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,ea=/($^)/,H3=/['\n\r\u2028\u2029\\]/g,Cc="\\ud800-\\udfff",K3="\\u0300-\\u036f",W3="\\ufe20-\\ufe2f",Y3="\\u20d0-\\u20ff",pS=K3+W3+Y3,mS="\\u2700-\\u27bf",yS="a-z\\xdf-\\xf6\\xf8-\\xff",X3="\\xac\\xb1\\xd7\\xf7",j3="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",z3="\\u2000-\\u206f",J3=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",vS="A-Z\\xc0-\\xd6\\xd8-\\xde",ES="\\ufe0e\\ufe0f",bS=X3+j3+z3+J3,Up="['’]",Q3="["+Cc+"]",AS="["+bS+"]",wc="["+pS+"]",SS="\\d+",Z3="["+mS+"]",xS="["+yS+"]",TS="[^"+Cc+bS+SS+mS+yS+vS+"]",$p="\\ud83c[\\udffb-\\udfff]",eB="(?:"+wc+"|"+$p+")",DS="[^"+Cc+"]",Gp="(?:\\ud83c[\\udde6-\\uddff]){2}",qp="[\\ud800-\\udbff][\\udc00-\\udfff]",ho="["+vS+"]",RS="\\u200d",IS="(?:"+xS+"|"+TS+")",tB="(?:"+ho+"|"+TS+")",NS="(?:"+Up+"(?:d|ll|m|re|s|t|ve))?",CS="(?:"+Up+"(?:D|LL|M|RE|S|T|VE))?",wS=eB+"?",LS="["+ES+"]?",rB="(?:"+RS+"(?:"+[DS,Gp,qp].join("|")+")"+LS+wS+")*",iB="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",nB="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",_S=LS+wS+rB,sB="(?:"+[Z3,Gp,qp].join("|")+")"+_S,aB="(?:"+[DS+wc+"?",wc,Gp,qp,Q3].join("|")+")",oB=RegExp(Up,"g"),lB=RegExp(wc,"g"),Vp=RegExp($p+"(?="+$p+")|"+aB+_S,"g"),uB=RegExp([ho+"?"+xS+"+"+NS+"(?="+[AS,ho,"$"].join("|")+")",tB+"+"+CS+"(?="+[AS,ho+IS,"$"].join("|")+")",ho+"?"+IS+"+"+NS,ho+"+"+CS,nB,iB,SS,sB].join("|"),"g"),cB=RegExp("["+RS+Cc+pS+ES+"]"),hB=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,dB=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],fB=-1,Ft={};Ft[at]=Ft[Kt]=Ft[Ei]=Ft[Ir]=Ft[bl]=Ft[Al]=Ft[Zs]=Ft[As]=Ft[Z]=!0,Ft[Ie]=Ft[we]=Ft[me]=Ft[$e]=Ft[ye]=Ft[et]=Ft[Ge]=Ft[st]=Ft[ae]=Ft[Ae]=Ft[ge]=Ft[ue]=Ft[K]=Ft[T]=Ft[j]=!1;var _t={};_t[Ie]=_t[we]=_t[me]=_t[ye]=_t[$e]=_t[et]=_t[at]=_t[Kt]=_t[Ei]=_t[Ir]=_t[bl]=_t[ae]=_t[Ae]=_t[ge]=_t[ue]=_t[K]=_t[T]=_t[S]=_t[Al]=_t[Zs]=_t[As]=_t[Z]=!0,_t[Ge]=_t[st]=_t[j]=!1;var gB={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},pB={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},mB={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},yB={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},vB=parseFloat,EB=parseInt,MS=typeof wi=="object"&&wi&&wi.Object===Object&&wi,bB=typeof self=="object"&&self&&self.Object===Object&&self,Ar=MS||bB||Function("return this")(),Hp=e&&!e.nodeType&&e,ta=Hp&&!0&&i&&!i.nodeType&&i,PS=ta&&ta.exports===Hp,Kp=PS&&MS.process,bi=function(){try{var Y=ta&&ta.require&&ta.require("util").types;return Y||Kp&&Kp.binding&&Kp.binding("util")}catch{}}(),kS=bi&&bi.isArrayBuffer,OS=bi&&bi.isDate,FS=bi&&bi.isMap,BS=bi&&bi.isRegExp,US=bi&&bi.isSet,$S=bi&&bi.isTypedArray;function oi(Y,oe,te){switch(te.length){case 0:return Y.call(oe);case 1:return Y.call(oe,te[0]);case 2:return Y.call(oe,te[0],te[1]);case 3:return Y.call(oe,te[0],te[1],te[2])}return Y.apply(oe,te)}function AB(Y,oe,te,_e){for(var je=-1,vt=Y==null?0:Y.length;++je<vt;){var sr=Y[je];oe(_e,sr,te(sr),Y)}return _e}function Ai(Y,oe){for(var te=-1,_e=Y==null?0:Y.length;++te<_e&&oe(Y[te],te,Y)!==!1;);return Y}function SB(Y,oe){for(var te=Y==null?0:Y.length;te--&&oe(Y[te],te,Y)!==!1;);return Y}function GS(Y,oe){for(var te=-1,_e=Y==null?0:Y.length;++te<_e;)if(!oe(Y[te],te,Y))return!1;return!0}function Ds(Y,oe){for(var te=-1,_e=Y==null?0:Y.length,je=0,vt=[];++te<_e;){var sr=Y[te];oe(sr,te,Y)&&(vt[je++]=sr)}return vt}function Lc(Y,oe){var te=Y==null?0:Y.length;return!!te&&fo(Y,oe,0)>-1}function Wp(Y,oe,te){for(var _e=-1,je=Y==null?0:Y.length;++_e<je;)if(te(oe,Y[_e]))return!0;return!1}function qt(Y,oe){for(var te=-1,_e=Y==null?0:Y.length,je=Array(_e);++te<_e;)je[te]=oe(Y[te],te,Y);return je}function Rs(Y,oe){for(var te=-1,_e=oe.length,je=Y.length;++te<_e;)Y[je+te]=oe[te];return Y}function Yp(Y,oe,te,_e){var je=-1,vt=Y==null?0:Y.length;for(_e&&vt&&(te=Y[++je]);++je<vt;)te=oe(te,Y[je],je,Y);return te}function xB(Y,oe,te,_e){var je=Y==null?0:Y.length;for(_e&&je&&(te=Y[--je]);je--;)te=oe(te,Y[je],je,Y);return te}function Xp(Y,oe){for(var te=-1,_e=Y==null?0:Y.length;++te<_e;)if(oe(Y[te],te,Y))return!0;return!1}var TB=jp("length");function DB(Y){return Y.split("")}function RB(Y){return Y.match(Rc)||[]}function qS(Y,oe,te){var _e;return te(Y,function(je,vt,sr){if(oe(je,vt,sr))return _e=vt,!1}),_e}function _c(Y,oe,te,_e){for(var je=Y.length,vt=te+(_e?1:-1);_e?vt--:++vt<je;)if(oe(Y[vt],vt,Y))return vt;return-1}function fo(Y,oe,te){return oe===oe?BB(Y,oe,te):_c(Y,VS,te)}function IB(Y,oe,te,_e){for(var je=te-1,vt=Y.length;++je<vt;)if(_e(Y[je],oe))return je;return-1}function VS(Y){return Y!==Y}function HS(Y,oe){var te=Y==null?0:Y.length;return te?Jp(Y,oe)/te:H}function jp(Y){return function(oe){return oe==null?t:oe[Y]}}function zp(Y){return function(oe){return Y==null?t:Y[oe]}}function KS(Y,oe,te,_e,je){return je(Y,function(vt,sr,wt){te=_e?(_e=!1,vt):oe(te,vt,sr,wt)}),te}function NB(Y,oe){var te=Y.length;for(Y.sort(oe);te--;)Y[te]=Y[te].value;return Y}function Jp(Y,oe){for(var te,_e=-1,je=Y.length;++_e<je;){var vt=oe(Y[_e]);vt!==t&&(te=te===t?vt:te+vt)}return te}function Qp(Y,oe){for(var te=-1,_e=Array(Y);++te<Y;)_e[te]=oe(te);return _e}function CB(Y,oe){return qt(oe,function(te){return[te,Y[te]]})}function li(Y){return function(oe){return Y(oe)}}function Zp(Y,oe){return qt(oe,function(te){return Y[te]})}function Rl(Y,oe){return Y.has(oe)}function WS(Y,oe){for(var te=-1,_e=Y.length;++te<_e&&fo(oe,Y[te],0)>-1;);return te}function YS(Y,oe){for(var te=Y.length;te--&&fo(oe,Y[te],0)>-1;);return te}function wB(Y,oe){for(var te=Y.length,_e=0;te--;)Y[te]===oe&&++_e;return _e}var LB=zp(gB),_B=zp(pB);function MB(Y){return"\\"+yB[Y]}function PB(Y,oe){return Y==null?t:Y[oe]}function go(Y){return cB.test(Y)}function kB(Y){return hB.test(Y)}function OB(Y){for(var oe,te=[];!(oe=Y.next()).done;)te.push(oe.value);return te}function em(Y){var oe=-1,te=Array(Y.size);return Y.forEach(function(_e,je){te[++oe]=[je,_e]}),te}function XS(Y,oe){return function(te){return Y(oe(te))}}function Is(Y,oe){for(var te=-1,_e=Y.length,je=0,vt=[];++te<_e;){var sr=Y[te];(sr===oe||sr===u)&&(Y[te]=u,vt[je++]=te)}return vt}function Mc(Y){var oe=-1,te=Array(Y.size);return Y.forEach(function(_e){te[++oe]=_e}),te}function FB(Y){var oe=-1,te=Array(Y.size);return Y.forEach(function(_e){te[++oe]=[_e,_e]}),te}function BB(Y,oe,te){for(var _e=te-1,je=Y.length;++_e<je;)if(Y[_e]===oe)return _e;return-1}function UB(Y,oe,te){for(var _e=te+1;_e--;)if(Y[_e]===oe)return _e;return _e}function po(Y){return go(Y)?GB(Y):TB(Y)}function Pi(Y){return go(Y)?qB(Y):DB(Y)}var $B=zp(mB);function GB(Y){for(var oe=Vp.lastIndex=0;Vp.test(Y);)++oe;return oe}function qB(Y){return Y.match(Vp)||[]}function VB(Y){return Y.match(uB)||[]}var HB=function Y(oe){oe=oe==null?Ar:mo.defaults(Ar.Object(),oe,mo.pick(Ar,dB));var te=oe.Array,_e=oe.Date,je=oe.Error,vt=oe.Function,sr=oe.Math,wt=oe.Object,tm=oe.RegExp,KB=oe.String,Si=oe.TypeError,Pc=te.prototype,WB=vt.prototype,yo=wt.prototype,kc=oe["__core-js_shared__"],Oc=WB.toString,Tt=yo.hasOwnProperty,YB=0,jS=function(){var c=/[^.]+$/.exec(kc&&kc.keys&&kc.keys.IE_PROTO||"");return c?"Symbol(src)_1."+c:""}(),Fc=yo.toString,XB=Oc.call(wt),jB=Ar._,zB=tm("^"+Oc.call(Tt).replace(ao,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Bc=PS?oe.Buffer:t,Ns=oe.Symbol,Uc=oe.Uint8Array,zS=Bc?Bc.allocUnsafe:t,$c=XS(wt.getPrototypeOf,wt),JS=wt.create,QS=yo.propertyIsEnumerable,Gc=Pc.splice,ZS=Ns?Ns.isConcatSpreadable:t,Il=Ns?Ns.iterator:t,ra=Ns?Ns.toStringTag:t,qc=function(){try{var c=oa(wt,"defineProperty");return c({},"",{}),c}catch{}}(),JB=oe.clearTimeout!==Ar.clearTimeout&&oe.clearTimeout,QB=_e&&_e.now!==Ar.Date.now&&_e.now,ZB=oe.setTimeout!==Ar.setTimeout&&oe.setTimeout,Vc=sr.ceil,Hc=sr.floor,rm=wt.getOwnPropertySymbols,e5=Bc?Bc.isBuffer:t,ex=oe.isFinite,t5=Pc.join,r5=XS(wt.keys,wt),ar=sr.max,Nr=sr.min,i5=_e.now,n5=oe.parseInt,tx=sr.random,s5=Pc.reverse,im=oa(oe,"DataView"),Nl=oa(oe,"Map"),nm=oa(oe,"Promise"),vo=oa(oe,"Set"),Cl=oa(oe,"WeakMap"),wl=oa(wt,"create"),Kc=Cl&&new Cl,Eo={},a5=la(im),o5=la(Nl),l5=la(nm),u5=la(vo),c5=la(Cl),Wc=Ns?Ns.prototype:t,Ll=Wc?Wc.valueOf:t,rx=Wc?Wc.toString:t;function P(c){if(zt(c)&&!ze(c)&&!(c instanceof ht)){if(c instanceof xi)return c;if(Tt.call(c,"__wrapped__"))return iT(c)}return new xi(c)}var bo=function(){function c(){}return function(f){if(!Wt(f))return{};if(JS)return JS(f);c.prototype=f;var y=new c;return c.prototype=t,y}}();function Yc(){}function xi(c,f){this.__wrapped__=c,this.__actions__=[],this.__chain__=!!f,this.__index__=0,this.__values__=t}P.templateSettings={escape:Ur,evaluate:fn,interpolate:so,variable:"",imports:{_:P}},P.prototype=Yc.prototype,P.prototype.constructor=P,xi.prototype=bo(Yc.prototype),xi.prototype.constructor=xi;function ht(c){this.__wrapped__=c,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=J,this.__views__=[]}function h5(){var c=new ht(this.__wrapped__);return c.__actions__=Xr(this.__actions__),c.__dir__=this.__dir__,c.__filtered__=this.__filtered__,c.__iteratees__=Xr(this.__iteratees__),c.__takeCount__=this.__takeCount__,c.__views__=Xr(this.__views__),c}function d5(){if(this.__filtered__){var c=new ht(this);c.__dir__=-1,c.__filtered__=!0}else c=this.clone(),c.__dir__*=-1;return c}function f5(){var c=this.__wrapped__.value(),f=this.__dir__,y=ze(c),b=f<0,N=y?c.length:0,O=DU(0,N,this.__views__),G=O.start,V=O.end,W=V-G,he=b?V:G-1,de=this.__iteratees__,pe=de.length,Re=0,Be=Nr(W,this.__takeCount__);if(!y||!b&&N==W&&Be==W)return Rx(c,this.__actions__);var Ke=[];e:for(;W--&&Re<Be;){he+=f;for(var nt=-1,He=c[he];++nt<pe;){var ct=de[nt],ft=ct.iteratee,hi=ct.type,qr=ft(He);if(hi==X)He=qr;else if(!qr){if(hi==$)continue e;break e}}Ke[Re++]=He}return Ke}ht.prototype=bo(Yc.prototype),ht.prototype.constructor=ht;function ia(c){var f=-1,y=c==null?0:c.length;for(this.clear();++f<y;){var b=c[f];this.set(b[0],b[1])}}function g5(){this.__data__=wl?wl(null):{},this.size=0}function p5(c){var f=this.has(c)&&delete this.__data__[c];return this.size-=f?1:0,f}function m5(c){var f=this.__data__;if(wl){var y=f[c];return y===o?t:y}return Tt.call(f,c)?f[c]:t}function y5(c){var f=this.__data__;return wl?f[c]!==t:Tt.call(f,c)}function v5(c,f){var y=this.__data__;return this.size+=this.has(c)?0:1,y[c]=wl&&f===t?o:f,this}ia.prototype.clear=g5,ia.prototype.delete=p5,ia.prototype.get=m5,ia.prototype.has=y5,ia.prototype.set=v5;function Un(c){var f=-1,y=c==null?0:c.length;for(this.clear();++f<y;){var b=c[f];this.set(b[0],b[1])}}function E5(){this.__data__=[],this.size=0}function b5(c){var f=this.__data__,y=Xc(f,c);if(y<0)return!1;var b=f.length-1;return y==b?f.pop():Gc.call(f,y,1),--this.size,!0}function A5(c){var f=this.__data__,y=Xc(f,c);return y<0?t:f[y][1]}function S5(c){return Xc(this.__data__,c)>-1}function x5(c,f){var y=this.__data__,b=Xc(y,c);return b<0?(++this.size,y.push([c,f])):y[b][1]=f,this}Un.prototype.clear=E5,Un.prototype.delete=b5,Un.prototype.get=A5,Un.prototype.has=S5,Un.prototype.set=x5;function $n(c){var f=-1,y=c==null?0:c.length;for(this.clear();++f<y;){var b=c[f];this.set(b[0],b[1])}}function T5(){this.size=0,this.__data__={hash:new ia,map:new(Nl||Un),string:new ia}}function D5(c){var f=ah(this,c).delete(c);return this.size-=f?1:0,f}function R5(c){return ah(this,c).get(c)}function I5(c){return ah(this,c).has(c)}function N5(c,f){var y=ah(this,c),b=y.size;return y.set(c,f),this.size+=y.size==b?0:1,this}$n.prototype.clear=T5,$n.prototype.delete=D5,$n.prototype.get=R5,$n.prototype.has=I5,$n.prototype.set=N5;function na(c){var f=-1,y=c==null?0:c.length;for(this.__data__=new $n;++f<y;)this.add(c[f])}function C5(c){return this.__data__.set(c,o),this}function w5(c){return this.__data__.has(c)}na.prototype.add=na.prototype.push=C5,na.prototype.has=w5;function ki(c){var f=this.__data__=new Un(c);this.size=f.size}function L5(){this.__data__=new Un,this.size=0}function _5(c){var f=this.__data__,y=f.delete(c);return this.size=f.size,y}function M5(c){return this.__data__.get(c)}function P5(c){return this.__data__.has(c)}function k5(c,f){var y=this.__data__;if(y instanceof Un){var b=y.__data__;if(!Nl||b.length<n-1)return b.push([c,f]),this.size=++y.size,this;y=this.__data__=new $n(b)}return y.set(c,f),this.size=y.size,this}ki.prototype.clear=L5,ki.prototype.delete=_5,ki.prototype.get=M5,ki.prototype.has=P5,ki.prototype.set=k5;function ix(c,f){var y=ze(c),b=!y&&ua(c),N=!y&&!b&&Ms(c),O=!y&&!b&&!N&&To(c),G=y||b||N||O,V=G?Qp(c.length,KB):[],W=V.length;for(var he in c)(f||Tt.call(c,he))&&!(G&&(he=="length"||N&&(he=="offset"||he=="parent")||O&&(he=="buffer"||he=="byteLength"||he=="byteOffset")||Hn(he,W)))&&V.push(he);return V}function nx(c){var f=c.length;return f?c[pm(0,f-1)]:t}function O5(c,f){return oh(Xr(c),sa(f,0,c.length))}function F5(c){return oh(Xr(c))}function sm(c,f,y){(y!==t&&!Oi(c[f],y)||y===t&&!(f in c))&&Gn(c,f,y)}function _l(c,f,y){var b=c[f];(!(Tt.call(c,f)&&Oi(b,y))||y===t&&!(f in c))&&Gn(c,f,y)}function Xc(c,f){for(var y=c.length;y--;)if(Oi(c[y][0],f))return y;return-1}function B5(c,f,y,b){return Cs(c,function(N,O,G){f(b,N,y(N),G)}),b}function sx(c,f){return c&&pn(f,yr(f),c)}function U5(c,f){return c&&pn(f,zr(f),c)}function Gn(c,f,y){f=="__proto__"&&qc?qc(c,f,{configurable:!0,enumerable:!0,value:y,writable:!0}):c[f]=y}function am(c,f){for(var y=-1,b=f.length,N=te(b),O=c==null;++y<b;)N[y]=O?t:$m(c,f[y]);return N}function sa(c,f,y){return c===c&&(y!==t&&(c=c<=y?c:y),f!==t&&(c=c>=f?c:f)),c}function Ti(c,f,y,b,N,O){var G,V=f&h,W=f&d,he=f&p;if(y&&(G=N?y(c,b,N,O):y(c)),G!==t)return G;if(!Wt(c))return c;var de=ze(c);if(de){if(G=IU(c),!V)return Xr(c,G)}else{var pe=Cr(c),Re=pe==st||pe==B;if(Ms(c))return Cx(c,V);if(pe==ge||pe==Ie||Re&&!N){if(G=W||Re?{}:Xx(c),!V)return W?mU(c,U5(G,c)):pU(c,sx(G,c))}else{if(!_t[pe])return N?c:{};G=NU(c,pe,V)}}O||(O=new ki);var Be=O.get(c);if(Be)return Be;O.set(c,G),xT(c)?c.forEach(function(He){G.add(Ti(He,f,y,He,c,O))}):AT(c)&&c.forEach(function(He,ct){G.set(ct,Ti(He,f,y,ct,c,O))});var Ke=he?W?Rm:Dm:W?zr:yr,nt=de?t:Ke(c);return Ai(nt||c,function(He,ct){nt&&(ct=He,He=c[ct]),_l(G,ct,Ti(He,f,y,ct,c,O))}),G}function $5(c){var f=yr(c);return function(y){return ax(y,c,f)}}function ax(c,f,y){var b=y.length;if(c==null)return!b;for(c=wt(c);b--;){var N=y[b],O=f[N],G=c[N];if(G===t&&!(N in c)||!O(G))return!1}return!0}function ox(c,f,y){if(typeof c!="function")throw new Si(a);return Ul(function(){c.apply(t,y)},f)}function Ml(c,f,y,b){var N=-1,O=Lc,G=!0,V=c.length,W=[],he=f.length;if(!V)return W;y&&(f=qt(f,li(y))),b?(O=Wp,G=!1):f.length>=n&&(O=Rl,G=!1,f=new na(f));e:for(;++N<V;){var de=c[N],pe=y==null?de:y(de);if(de=b||de!==0?de:0,G&&pe===pe){for(var Re=he;Re--;)if(f[Re]===pe)continue e;W.push(de)}else O(f,pe,b)||W.push(de)}return W}var Cs=Px(gn),lx=Px(lm,!0);function G5(c,f){var y=!0;return Cs(c,function(b,N,O){return y=!!f(b,N,O),y}),y}function jc(c,f,y){for(var b=-1,N=c.length;++b<N;){var O=c[b],G=f(O);if(G!=null&&(V===t?G===G&&!ci(G):y(G,V)))var V=G,W=O}return W}function q5(c,f,y,b){var N=c.length;for(y=tt(y),y<0&&(y=-y>N?0:N+y),b=b===t||b>N?N:tt(b),b<0&&(b+=N),b=y>b?0:DT(b);y<b;)c[y++]=f;return c}function ux(c,f){var y=[];return Cs(c,function(b,N,O){f(b,N,O)&&y.push(b)}),y}function Sr(c,f,y,b,N){var O=-1,G=c.length;for(y||(y=wU),N||(N=[]);++O<G;){var V=c[O];f>0&&y(V)?f>1?Sr(V,f-1,y,b,N):Rs(N,V):b||(N[N.length]=V)}return N}var om=kx(),cx=kx(!0);function gn(c,f){return c&&om(c,f,yr)}function lm(c,f){return c&&cx(c,f,yr)}function zc(c,f){return Ds(f,function(y){return Kn(c[y])})}function aa(c,f){f=Ls(f,c);for(var y=0,b=f.length;c!=null&&y<b;)c=c[mn(f[y++])];return y&&y==b?c:t}function hx(c,f,y){var b=f(c);return ze(c)?b:Rs(b,y(c))}function $r(c){return c==null?c===t?k:be:ra&&ra in wt(c)?TU(c):FU(c)}function um(c,f){return c>f}function V5(c,f){return c!=null&&Tt.call(c,f)}function H5(c,f){return c!=null&&f in wt(c)}function K5(c,f,y){return c>=Nr(f,y)&&c<ar(f,y)}function cm(c,f,y){for(var b=y?Wp:Lc,N=c[0].length,O=c.length,G=O,V=te(O),W=1/0,he=[];G--;){var de=c[G];G&&f&&(de=qt(de,li(f))),W=Nr(de.length,W),V[G]=!y&&(f||N>=120&&de.length>=120)?new na(G&&de):t}de=c[0];var pe=-1,Re=V[0];e:for(;++pe<N&&he.length<W;){var Be=de[pe],Ke=f?f(Be):Be;if(Be=y||Be!==0?Be:0,!(Re?Rl(Re,Ke):b(he,Ke,y))){for(G=O;--G;){var nt=V[G];if(!(nt?Rl(nt,Ke):b(c[G],Ke,y)))continue e}Re&&Re.push(Ke),he.push(Be)}}return he}function W5(c,f,y,b){return gn(c,function(N,O,G){f(b,y(N),O,G)}),b}function Pl(c,f,y){f=Ls(f,c),c=Qx(c,f);var b=c==null?c:c[mn(Ri(f))];return b==null?t:oi(b,c,y)}function dx(c){return zt(c)&&$r(c)==Ie}function Y5(c){return zt(c)&&$r(c)==me}function X5(c){return zt(c)&&$r(c)==et}function kl(c,f,y,b,N){return c===f?!0:c==null||f==null||!zt(c)&&!zt(f)?c!==c&&f!==f:j5(c,f,y,b,kl,N)}function j5(c,f,y,b,N,O){var G=ze(c),V=ze(f),W=G?we:Cr(c),he=V?we:Cr(f);W=W==Ie?ge:W,he=he==Ie?ge:he;var de=W==ge,pe=he==ge,Re=W==he;if(Re&&Ms(c)){if(!Ms(f))return!1;G=!0,de=!1}if(Re&&!de)return O||(O=new ki),G||To(c)?Kx(c,f,y,b,N,O):SU(c,f,W,y,b,N,O);if(!(y&g)){var Be=de&&Tt.call(c,"__wrapped__"),Ke=pe&&Tt.call(f,"__wrapped__");if(Be||Ke){var nt=Be?c.value():c,He=Ke?f.value():f;return O||(O=new ki),N(nt,He,y,b,O)}}return Re?(O||(O=new ki),xU(c,f,y,b,N,O)):!1}function z5(c){return zt(c)&&Cr(c)==ae}function hm(c,f,y,b){var N=y.length,O=N,G=!b;if(c==null)return!O;for(c=wt(c);N--;){var V=y[N];if(G&&V[2]?V[1]!==c[V[0]]:!(V[0]in c))return!1}for(;++N<O;){V=y[N];var W=V[0],he=c[W],de=V[1];if(G&&V[2]){if(he===t&&!(W in c))return!1}else{var pe=new ki;if(b)var Re=b(he,de,W,c,f,pe);if(!(Re===t?kl(de,he,g|m,b,pe):Re))return!1}}return!0}function fx(c){if(!Wt(c)||_U(c))return!1;var f=Kn(c)?zB:Dl;return f.test(la(c))}function J5(c){return zt(c)&&$r(c)==ue}function Q5(c){return zt(c)&&Cr(c)==K}function Z5(c){return zt(c)&&fh(c.length)&&!!Ft[$r(c)]}function gx(c){return typeof c=="function"?c:c==null?Jr:typeof c=="object"?ze(c)?yx(c[0],c[1]):mx(c):OT(c)}function dm(c){if(!Bl(c))return r5(c);var f=[];for(var y in wt(c))Tt.call(c,y)&&y!="constructor"&&f.push(y);return f}function eU(c){if(!Wt(c))return OU(c);var f=Bl(c),y=[];for(var b in c)b=="constructor"&&(f||!Tt.call(c,b))||y.push(b);return y}function fm(c,f){return c<f}function px(c,f){var y=-1,b=jr(c)?te(c.length):[];return Cs(c,function(N,O,G){b[++y]=f(N,O,G)}),b}function mx(c){var f=Nm(c);return f.length==1&&f[0][2]?zx(f[0][0],f[0][1]):function(y){return y===c||hm(y,c,f)}}function yx(c,f){return wm(c)&&jx(f)?zx(mn(c),f):function(y){var b=$m(y,c);return b===t&&b===f?Gm(y,c):kl(f,b,g|m)}}function Jc(c,f,y,b,N){c!==f&&om(f,function(O,G){if(N||(N=new ki),Wt(O))tU(c,f,G,y,Jc,b,N);else{var V=b?b(_m(c,G),O,G+"",c,f,N):t;V===t&&(V=O),sm(c,G,V)}},zr)}function tU(c,f,y,b,N,O,G){var V=_m(c,y),W=_m(f,y),he=G.get(W);if(he){sm(c,y,he);return}var de=O?O(V,W,y+"",c,f,G):t,pe=de===t;if(pe){var Re=ze(W),Be=!Re&&Ms(W),Ke=!Re&&!Be&&To(W);de=W,Re||Be||Ke?ze(V)?de=V:Qt(V)?de=Xr(V):Be?(pe=!1,de=Cx(W,!0)):Ke?(pe=!1,de=wx(W,!0)):de=[]:$l(W)||ua(W)?(de=V,ua(V)?de=RT(V):(!Wt(V)||Kn(V))&&(de=Xx(W))):pe=!1}pe&&(G.set(W,de),N(de,W,b,O,G),G.delete(W)),sm(c,y,de)}function vx(c,f){var y=c.length;if(y)return f+=f<0?y:0,Hn(f,y)?c[f]:t}function Ex(c,f,y){f.length?f=qt(f,function(O){return ze(O)?function(G){return aa(G,O.length===1?O[0]:O)}:O}):f=[Jr];var b=-1;f=qt(f,li(qe()));var N=px(c,function(O,G,V){var W=qt(f,function(he){return he(O)});return{criteria:W,index:++b,value:O}});return NB(N,function(O,G){return gU(O,G,y)})}function rU(c,f){return bx(c,f,function(y,b){return Gm(c,b)})}function bx(c,f,y){for(var b=-1,N=f.length,O={};++b<N;){var G=f[b],V=aa(c,G);y(V,G)&&Ol(O,Ls(G,c),V)}return O}function iU(c){return function(f){return aa(f,c)}}function gm(c,f,y,b){var N=b?IB:fo,O=-1,G=f.length,V=c;for(c===f&&(f=Xr(f)),y&&(V=qt(c,li(y)));++O<G;)for(var W=0,he=f[O],de=y?y(he):he;(W=N(V,de,W,b))>-1;)V!==c&&Gc.call(V,W,1),Gc.call(c,W,1);return c}function Ax(c,f){for(var y=c?f.length:0,b=y-1;y--;){var N=f[y];if(y==b||N!==O){var O=N;Hn(N)?Gc.call(c,N,1):vm(c,N)}}return c}function pm(c,f){return c+Hc(tx()*(f-c+1))}function nU(c,f,y,b){for(var N=-1,O=ar(Vc((f-c)/(y||1)),0),G=te(O);O--;)G[b?O:++N]=c,c+=y;return G}function mm(c,f){var y="";if(!c||f<1||f>ce)return y;do f%2&&(y+=c),f=Hc(f/2),f&&(c+=c);while(f);return y}function ot(c,f){return Mm(Jx(c,f,Jr),c+"")}function sU(c){return nx(Do(c))}function aU(c,f){var y=Do(c);return oh(y,sa(f,0,y.length))}function Ol(c,f,y,b){if(!Wt(c))return c;f=Ls(f,c);for(var N=-1,O=f.length,G=O-1,V=c;V!=null&&++N<O;){var W=mn(f[N]),he=y;if(W==="__proto__"||W==="constructor"||W==="prototype")return c;if(N!=G){var de=V[W];he=b?b(de,W,V):t,he===t&&(he=Wt(de)?de:Hn(f[N+1])?[]:{})}_l(V,W,he),V=V[W]}return c}var Sx=Kc?function(c,f){return Kc.set(c,f),c}:Jr,oU=qc?function(c,f){return qc(c,"toString",{configurable:!0,enumerable:!1,value:Vm(f),writable:!0})}:Jr;function lU(c){return oh(Do(c))}function Di(c,f,y){var b=-1,N=c.length;f<0&&(f=-f>N?0:N+f),y=y>N?N:y,y<0&&(y+=N),N=f>y?0:y-f>>>0,f>>>=0;for(var O=te(N);++b<N;)O[b]=c[b+f];return O}function uU(c,f){var y;return Cs(c,function(b,N,O){return y=f(b,N,O),!y}),!!y}function Qc(c,f,y){var b=0,N=c==null?b:c.length;if(typeof f=="number"&&f===f&&N<=fe){for(;b<N;){var O=b+N>>>1,G=c[O];G!==null&&!ci(G)&&(y?G<=f:G<f)?b=O+1:N=O}return N}return ym(c,f,Jr,y)}function ym(c,f,y,b){var N=0,O=c==null?0:c.length;if(O===0)return 0;f=y(f);for(var G=f!==f,V=f===null,W=ci(f),he=f===t;N<O;){var de=Hc((N+O)/2),pe=y(c[de]),Re=pe!==t,Be=pe===null,Ke=pe===pe,nt=ci(pe);if(G)var He=b||Ke;else he?He=Ke&&(b||Re):V?He=Ke&&Re&&(b||!Be):W?He=Ke&&Re&&!Be&&(b||!nt):Be||nt?He=!1:He=b?pe<=f:pe<f;He?N=de+1:O=de}return Nr(O,ve)}function xx(c,f){for(var y=-1,b=c.length,N=0,O=[];++y<b;){var G=c[y],V=f?f(G):G;if(!y||!Oi(V,W)){var W=V;O[N++]=G===0?0:G}}return O}function Tx(c){return typeof c=="number"?c:ci(c)?H:+c}function ui(c){if(typeof c=="string")return c;if(ze(c))return qt(c,ui)+"";if(ci(c))return rx?rx.call(c):"";var f=c+"";return f=="0"&&1/c==-se?"-0":f}function ws(c,f,y){var b=-1,N=Lc,O=c.length,G=!0,V=[],W=V;if(y)G=!1,N=Wp;else if(O>=n){var he=f?null:bU(c);if(he)return Mc(he);G=!1,N=Rl,W=new na}else W=f?[]:V;e:for(;++b<O;){var de=c[b],pe=f?f(de):de;if(de=y||de!==0?de:0,G&&pe===pe){for(var Re=W.length;Re--;)if(W[Re]===pe)continue e;f&&W.push(pe),V.push(de)}else N(W,pe,y)||(W!==V&&W.push(pe),V.push(de))}return V}function vm(c,f){return f=Ls(f,c),c=Qx(c,f),c==null||delete c[mn(Ri(f))]}function Dx(c,f,y,b){return Ol(c,f,y(aa(c,f)),b)}function Zc(c,f,y,b){for(var N=c.length,O=b?N:-1;(b?O--:++O<N)&&f(c[O],O,c););return y?Di(c,b?0:O,b?O+1:N):Di(c,b?O+1:0,b?N:O)}function Rx(c,f){var y=c;return y instanceof ht&&(y=y.value()),Yp(f,function(b,N){return N.func.apply(N.thisArg,Rs([b],N.args))},y)}function Em(c,f,y){var b=c.length;if(b<2)return b?ws(c[0]):[];for(var N=-1,O=te(b);++N<b;)for(var G=c[N],V=-1;++V<b;)V!=N&&(O[N]=Ml(O[N]||G,c[V],f,y));return ws(Sr(O,1),f,y)}function Ix(c,f,y){for(var b=-1,N=c.length,O=f.length,G={};++b<N;){var V=b<O?f[b]:t;y(G,c[b],V)}return G}function bm(c){return Qt(c)?c:[]}function Am(c){return typeof c=="function"?c:Jr}function Ls(c,f){return ze(c)?c:wm(c,f)?[c]:rT(At(c))}var cU=ot;function _s(c,f,y){var b=c.length;return y=y===t?b:y,!f&&y>=b?c:Di(c,f,y)}var Nx=JB||function(c){return Ar.clearTimeout(c)};function Cx(c,f){if(f)return c.slice();var y=c.length,b=zS?zS(y):new c.constructor(y);return c.copy(b),b}function Sm(c){var f=new c.constructor(c.byteLength);return new Uc(f).set(new Uc(c)),f}function hU(c,f){var y=f?Sm(c.buffer):c.buffer;return new c.constructor(y,c.byteOffset,c.byteLength)}function dU(c){var f=new c.constructor(c.source,uo.exec(c));return f.lastIndex=c.lastIndex,f}function fU(c){return Ll?wt(Ll.call(c)):{}}function wx(c,f){var y=f?Sm(c.buffer):c.buffer;return new c.constructor(y,c.byteOffset,c.length)}function Lx(c,f){if(c!==f){var y=c!==t,b=c===null,N=c===c,O=ci(c),G=f!==t,V=f===null,W=f===f,he=ci(f);if(!V&&!he&&!O&&c>f||O&&G&&W&&!V&&!he||b&&G&&W||!y&&W||!N)return 1;if(!b&&!O&&!he&&c<f||he&&y&&N&&!b&&!O||V&&y&&N||!G&&N||!W)return-1}return 0}function gU(c,f,y){for(var b=-1,N=c.criteria,O=f.criteria,G=N.length,V=y.length;++b<G;){var W=Lx(N[b],O[b]);if(W){if(b>=V)return W;var he=y[b];return W*(he=="desc"?-1:1)}}return c.index-f.index}function _x(c,f,y,b){for(var N=-1,O=c.length,G=y.length,V=-1,W=f.length,he=ar(O-G,0),de=te(W+he),pe=!b;++V<W;)de[V]=f[V];for(;++N<G;)(pe||N<O)&&(de[y[N]]=c[N]);for(;he--;)de[V++]=c[N++];return de}function Mx(c,f,y,b){for(var N=-1,O=c.length,G=-1,V=y.length,W=-1,he=f.length,de=ar(O-V,0),pe=te(de+he),Re=!b;++N<de;)pe[N]=c[N];for(var Be=N;++W<he;)pe[Be+W]=f[W];for(;++G<V;)(Re||N<O)&&(pe[Be+y[G]]=c[N++]);return pe}function Xr(c,f){var y=-1,b=c.length;for(f||(f=te(b));++y<b;)f[y]=c[y];return f}function pn(c,f,y,b){var N=!y;y||(y={});for(var O=-1,G=f.length;++O<G;){var V=f[O],W=b?b(y[V],c[V],V,y,c):t;W===t&&(W=c[V]),N?Gn(y,V,W):_l(y,V,W)}return y}function pU(c,f){return pn(c,Cm(c),f)}function mU(c,f){return pn(c,Wx(c),f)}function eh(c,f){return function(y,b){var N=ze(y)?AB:B5,O=f?f():{};return N(y,c,qe(b,2),O)}}function Ao(c){return ot(function(f,y){var b=-1,N=y.length,O=N>1?y[N-1]:t,G=N>2?y[2]:t;for(O=c.length>3&&typeof O=="function"?(N--,O):t,G&&Gr(y[0],y[1],G)&&(O=N<3?t:O,N=1),f=wt(f);++b<N;){var V=y[b];V&&c(f,V,b,O)}return f})}function Px(c,f){return function(y,b){if(y==null)return y;if(!jr(y))return c(y,b);for(var N=y.length,O=f?N:-1,G=wt(y);(f?O--:++O<N)&&b(G[O],O,G)!==!1;);return y}}function kx(c){return function(f,y,b){for(var N=-1,O=wt(f),G=b(f),V=G.length;V--;){var W=G[c?V:++N];if(y(O[W],W,O)===!1)break}return f}}function yU(c,f,y){var b=f&v,N=Fl(c);function O(){var G=this&&this!==Ar&&this instanceof O?N:c;return G.apply(b?y:this,arguments)}return O}function Ox(c){return function(f){f=At(f);var y=go(f)?Pi(f):t,b=y?y[0]:f.charAt(0),N=y?_s(y,1).join(""):f.slice(1);return b[c]()+N}}function So(c){return function(f){return Yp(PT(MT(f).replace(oB,"")),c,"")}}function Fl(c){return function(){var f=arguments;switch(f.length){case 0:return new c;case 1:return new c(f[0]);case 2:return new c(f[0],f[1]);case 3:return new c(f[0],f[1],f[2]);case 4:return new c(f[0],f[1],f[2],f[3]);case 5:return new c(f[0],f[1],f[2],f[3],f[4]);case 6:return new c(f[0],f[1],f[2],f[3],f[4],f[5]);case 7:return new c(f[0],f[1],f[2],f[3],f[4],f[5],f[6])}var y=bo(c.prototype),b=c.apply(y,f);return Wt(b)?b:y}}function vU(c,f,y){var b=Fl(c);function N(){for(var O=arguments.length,G=te(O),V=O,W=xo(N);V--;)G[V]=arguments[V];var he=O<3&&G[0]!==W&&G[O-1]!==W?[]:Is(G,W);if(O-=he.length,O<y)return Gx(c,f,th,N.placeholder,t,G,he,t,t,y-O);var de=this&&this!==Ar&&this instanceof N?b:c;return oi(de,this,G)}return N}function Fx(c){return function(f,y,b){var N=wt(f);if(!jr(f)){var O=qe(y,3);f=yr(f),y=function(V){return O(N[V],V,N)}}var G=c(f,y,b);return G>-1?N[O?f[G]:G]:t}}function Bx(c){return Vn(function(f){var y=f.length,b=y,N=xi.prototype.thru;for(c&&f.reverse();b--;){var O=f[b];if(typeof O!="function")throw new Si(a);if(N&&!G&&sh(O)=="wrapper")var G=new xi([],!0)}for(b=G?b:y;++b<y;){O=f[b];var V=sh(O),W=V=="wrapper"?Im(O):t;W&&Lm(W[0])&&W[1]==(w|D|_|C)&&!W[4].length&&W[9]==1?G=G[sh(W[0])].apply(G,W[3]):G=O.length==1&&Lm(O)?G[V]():G.thru(O)}return function(){var he=arguments,de=he[0];if(G&&he.length==1&&ze(de))return G.plant(de).value();for(var pe=0,Re=y?f[pe].apply(this,he):de;++pe<y;)Re=f[pe].call(this,Re);return Re}})}function th(c,f,y,b,N,O,G,V,W,he){var de=f&w,pe=f&v,Re=f&E,Be=f&(D|R),Ke=f&M,nt=Re?t:Fl(c);function He(){for(var ct=arguments.length,ft=te(ct),hi=ct;hi--;)ft[hi]=arguments[hi];if(Be)var qr=xo(He),di=wB(ft,qr);if(b&&(ft=_x(ft,b,N,Be)),O&&(ft=Mx(ft,O,G,Be)),ct-=di,Be&&ct<he){var Zt=Is(ft,qr);return Gx(c,f,th,He.placeholder,y,ft,Zt,V,W,he-ct)}var Fi=pe?y:this,Yn=Re?Fi[c]:c;return ct=ft.length,V?ft=BU(ft,V):Ke&&ct>1&&ft.reverse(),de&&W<ct&&(ft.length=W),this&&this!==Ar&&this instanceof He&&(Yn=nt||Fl(Yn)),Yn.apply(Fi,ft)}return He}function Ux(c,f){return function(y,b){return W5(y,c,f(b),{})}}function rh(c,f){return function(y,b){var N;if(y===t&&b===t)return f;if(y!==t&&(N=y),b!==t){if(N===t)return b;typeof y=="string"||typeof b=="string"?(y=ui(y),b=ui(b)):(y=Tx(y),b=Tx(b)),N=c(y,b)}return N}}function xm(c){return Vn(function(f){return f=qt(f,li(qe())),ot(function(y){var b=this;return c(f,function(N){return oi(N,b,y)})})})}function ih(c,f){f=f===t?" ":ui(f);var y=f.length;if(y<2)return y?mm(f,c):f;var b=mm(f,Vc(c/po(f)));return go(f)?_s(Pi(b),0,c).join(""):b.slice(0,c)}function EU(c,f,y,b){var N=f&v,O=Fl(c);function G(){for(var V=-1,W=arguments.length,he=-1,de=b.length,pe=te(de+W),Re=this&&this!==Ar&&this instanceof G?O:c;++he<de;)pe[he]=b[he];for(;W--;)pe[he++]=arguments[++V];return oi(Re,N?y:this,pe)}return G}function $x(c){return function(f,y,b){return b&&typeof b!="number"&&Gr(f,y,b)&&(y=b=t),f=Wn(f),y===t?(y=f,f=0):y=Wn(y),b=b===t?f<y?1:-1:Wn(b),nU(f,y,b,c)}}function nh(c){return function(f,y){return typeof f=="string"&&typeof y=="string"||(f=Ii(f),y=Ii(y)),c(f,y)}}function Gx(c,f,y,b,N,O,G,V,W,he){var de=f&D,pe=de?G:t,Re=de?t:G,Be=de?O:t,Ke=de?t:O;f|=de?_:F,f&=~(de?F:_),f&A||(f&=-4);var nt=[c,f,N,Be,pe,Ke,Re,V,W,he],He=y.apply(t,nt);return Lm(c)&&Zx(He,nt),He.placeholder=b,eT(He,c,f)}function Tm(c){var f=sr[c];return function(y,b){if(y=Ii(y),b=b==null?0:Nr(tt(b),292),b&&ex(y)){var N=(At(y)+"e").split("e"),O=f(N[0]+"e"+(+N[1]+b));return N=(At(O)+"e").split("e"),+(N[0]+"e"+(+N[1]-b))}return f(y)}}var bU=vo&&1/Mc(new vo([,-0]))[1]==se?function(c){return new vo(c)}:Wm;function qx(c){return function(f){var y=Cr(f);return y==ae?em(f):y==K?FB(f):CB(f,c(f))}}function qn(c,f,y,b,N,O,G,V){var W=f&E;if(!W&&typeof c!="function")throw new Si(a);var he=b?b.length:0;if(he||(f&=-97,b=N=t),G=G===t?G:ar(tt(G),0),V=V===t?V:tt(V),he-=N?N.length:0,f&F){var de=b,pe=N;b=N=t}var Re=W?t:Im(c),Be=[c,f,y,b,N,de,pe,O,G,V];if(Re&&kU(Be,Re),c=Be[0],f=Be[1],y=Be[2],b=Be[3],N=Be[4],V=Be[9]=Be[9]===t?W?0:c.length:ar(Be[9]-he,0),!V&&f&(D|R)&&(f&=-25),!f||f==v)var Ke=yU(c,f,y);else f==D||f==R?Ke=vU(c,f,V):(f==_||f==(v|_))&&!N.length?Ke=EU(c,f,y,b):Ke=th.apply(t,Be);var nt=Re?Sx:Zx;return eT(nt(Ke,Be),c,f)}function Vx(c,f,y,b){return c===t||Oi(c,yo[y])&&!Tt.call(b,y)?f:c}function Hx(c,f,y,b,N,O){return Wt(c)&&Wt(f)&&(O.set(f,c),Jc(c,f,t,Hx,O),O.delete(f)),c}function AU(c){return $l(c)?t:c}function Kx(c,f,y,b,N,O){var G=y&g,V=c.length,W=f.length;if(V!=W&&!(G&&W>V))return!1;var he=O.get(c),de=O.get(f);if(he&&de)return he==f&&de==c;var pe=-1,Re=!0,Be=y&m?new na:t;for(O.set(c,f),O.set(f,c);++pe<V;){var Ke=c[pe],nt=f[pe];if(b)var He=G?b(nt,Ke,pe,f,c,O):b(Ke,nt,pe,c,f,O);if(He!==t){if(He)continue;Re=!1;break}if(Be){if(!Xp(f,function(ct,ft){if(!Rl(Be,ft)&&(Ke===ct||N(Ke,ct,y,b,O)))return Be.push(ft)})){Re=!1;break}}else if(!(Ke===nt||N(Ke,nt,y,b,O))){Re=!1;break}}return O.delete(c),O.delete(f),Re}function SU(c,f,y,b,N,O,G){switch(y){case ye:if(c.byteLength!=f.byteLength||c.byteOffset!=f.byteOffset)return!1;c=c.buffer,f=f.buffer;case me:return!(c.byteLength!=f.byteLength||!O(new Uc(c),new Uc(f)));case $e:case et:case Ae:return Oi(+c,+f);case Ge:return c.name==f.name&&c.message==f.message;case ue:case T:return c==f+"";case ae:var V=em;case K:var W=b&g;if(V||(V=Mc),c.size!=f.size&&!W)return!1;var he=G.get(c);if(he)return he==f;b|=m,G.set(c,f);var de=Kx(V(c),V(f),b,N,O,G);return G.delete(c),de;case S:if(Ll)return Ll.call(c)==Ll.call(f)}return!1}function xU(c,f,y,b,N,O){var G=y&g,V=Dm(c),W=V.length,he=Dm(f),de=he.length;if(W!=de&&!G)return!1;for(var pe=W;pe--;){var Re=V[pe];if(!(G?Re in f:Tt.call(f,Re)))return!1}var Be=O.get(c),Ke=O.get(f);if(Be&&Ke)return Be==f&&Ke==c;var nt=!0;O.set(c,f),O.set(f,c);for(var He=G;++pe<W;){Re=V[pe];var ct=c[Re],ft=f[Re];if(b)var hi=G?b(ft,ct,Re,f,c,O):b(ct,ft,Re,c,f,O);if(!(hi===t?ct===ft||N(ct,ft,y,b,O):hi)){nt=!1;break}He||(He=Re=="constructor")}if(nt&&!He){var qr=c.constructor,di=f.constructor;qr!=di&&"constructor"in c&&"constructor"in f&&!(typeof qr=="function"&&qr instanceof qr&&typeof di=="function"&&di instanceof di)&&(nt=!1)}return O.delete(c),O.delete(f),nt}function Vn(c){return Mm(Jx(c,t,aT),c+"")}function Dm(c){return hx(c,yr,Cm)}function Rm(c){return hx(c,zr,Wx)}var Im=Kc?function(c){return Kc.get(c)}:Wm;function sh(c){for(var f=c.name+"",y=Eo[f],b=Tt.call(Eo,f)?y.length:0;b--;){var N=y[b],O=N.func;if(O==null||O==c)return N.name}return f}function xo(c){var f=Tt.call(P,"placeholder")?P:c;return f.placeholder}function qe(){var c=P.iteratee||Hm;return c=c===Hm?gx:c,arguments.length?c(arguments[0],arguments[1]):c}function ah(c,f){var y=c.__data__;return LU(f)?y[typeof f=="string"?"string":"hash"]:y.map}function Nm(c){for(var f=yr(c),y=f.length;y--;){var b=f[y],N=c[b];f[y]=[b,N,jx(N)]}return f}function oa(c,f){var y=PB(c,f);return fx(y)?y:t}function TU(c){var f=Tt.call(c,ra),y=c[ra];try{c[ra]=t;var b=!0}catch{}var N=Fc.call(c);return b&&(f?c[ra]=y:delete c[ra]),N}var Cm=rm?function(c){return c==null?[]:(c=wt(c),Ds(rm(c),function(f){return QS.call(c,f)}))}:Ym,Wx=rm?function(c){for(var f=[];c;)Rs(f,Cm(c)),c=$c(c);return f}:Ym,Cr=$r;(im&&Cr(new im(new ArrayBuffer(1)))!=ye||Nl&&Cr(new Nl)!=ae||nm&&Cr(nm.resolve())!=Ne||vo&&Cr(new vo)!=K||Cl&&Cr(new Cl)!=j)&&(Cr=function(c){var f=$r(c),y=f==ge?c.constructor:t,b=y?la(y):"";if(b)switch(b){case a5:return ye;case o5:return ae;case l5:return Ne;case u5:return K;case c5:return j}return f});function DU(c,f,y){for(var b=-1,N=y.length;++b<N;){var O=y[b],G=O.size;switch(O.type){case"drop":c+=G;break;case"dropRight":f-=G;break;case"take":f=Nr(f,c+G);break;case"takeRight":c=ar(c,f-G);break}}return{start:c,end:f}}function RU(c){var f=c.match(xl);return f?f[1].split(Dc):[]}function Yx(c,f,y){f=Ls(f,c);for(var b=-1,N=f.length,O=!1;++b<N;){var G=mn(f[b]);if(!(O=c!=null&&y(c,G)))break;c=c[G]}return O||++b!=N?O:(N=c==null?0:c.length,!!N&&fh(N)&&Hn(G,N)&&(ze(c)||ua(c)))}function IU(c){var f=c.length,y=new c.constructor(f);return f&&typeof c[0]=="string"&&Tt.call(c,"index")&&(y.index=c.index,y.input=c.input),y}function Xx(c){return typeof c.constructor=="function"&&!Bl(c)?bo($c(c)):{}}function NU(c,f,y){var b=c.constructor;switch(f){case me:return Sm(c);case $e:case et:return new b(+c);case ye:return hU(c,y);case at:case Kt:case Ei:case Ir:case bl:case Al:case Zs:case As:case Z:return wx(c,y);case ae:return new b;case Ae:case T:return new b(c);case ue:return dU(c);case K:return new b;case S:return fU(c)}}function CU(c,f){var y=f.length;if(!y)return c;var b=y-1;return f[b]=(y>1?"& ":"")+f[b],f=f.join(y>2?", ":" "),c.replace(Sl,`{
/* [wrapped with `+f+`] */
`)}function wU(c){return ze(c)||ua(c)||!!(ZS&&c&&c[ZS])}function Hn(c,f){var y=typeof c;return f=f??ce,!!f&&(y=="number"||y!="symbol"&&co.test(c))&&c>-1&&c%1==0&&c<f}function Gr(c,f,y){if(!Wt(y))return!1;var b=typeof f;return(b=="number"?jr(y)&&Hn(f,y.length):b=="string"&&f in y)?Oi(y[f],c):!1}function wm(c,f){if(ze(c))return!1;var y=typeof c;return y=="number"||y=="symbol"||y=="boolean"||c==null||ci(c)?!0:ai.test(c)||!Ss.test(c)||f!=null&&c in wt(f)}function LU(c){var f=typeof c;return f=="string"||f=="number"||f=="symbol"||f=="boolean"?c!=="__proto__":c===null}function Lm(c){var f=sh(c),y=P[f];if(typeof y!="function"||!(f in ht.prototype))return!1;if(c===y)return!0;var b=Im(y);return!!b&&c===b[0]}function _U(c){return!!jS&&jS in c}var MU=kc?Kn:Xm;function Bl(c){var f=c&&c.constructor,y=typeof f=="function"&&f.prototype||yo;return c===y}function jx(c){return c===c&&!Wt(c)}function zx(c,f){return function(y){return y==null?!1:y[c]===f&&(f!==t||c in wt(y))}}function PU(c){var f=hh(c,function(b){return y.size===l&&y.clear(),b}),y=f.cache;return f}function kU(c,f){var y=c[1],b=f[1],N=y|b,O=N<(v|E|w),G=b==w&&y==D||b==w&&y==C&&c[7].length<=f[8]||b==(w|C)&&f[7].length<=f[8]&&y==D;if(!(O||G))return c;b&v&&(c[2]=f[2],N|=y&v?0:A);var V=f[3];if(V){var W=c[3];c[3]=W?_x(W,V,f[4]):V,c[4]=W?Is(c[3],u):f[4]}return V=f[5],V&&(W=c[5],c[5]=W?Mx(W,V,f[6]):V,c[6]=W?Is(c[5],u):f[6]),V=f[7],V&&(c[7]=V),b&w&&(c[8]=c[8]==null?f[8]:Nr(c[8],f[8])),c[9]==null&&(c[9]=f[9]),c[0]=f[0],c[1]=N,c}function OU(c){var f=[];if(c!=null)for(var y in wt(c))f.push(y);return f}function FU(c){return Fc.call(c)}function Jx(c,f,y){return f=ar(f===t?c.length-1:f,0),function(){for(var b=arguments,N=-1,O=ar(b.length-f,0),G=te(O);++N<O;)G[N]=b[f+N];N=-1;for(var V=te(f+1);++N<f;)V[N]=b[N];return V[f]=y(G),oi(c,this,V)}}function Qx(c,f){return f.length<2?c:aa(c,Di(f,0,-1))}function BU(c,f){for(var y=c.length,b=Nr(f.length,y),N=Xr(c);b--;){var O=f[b];c[b]=Hn(O,y)?N[O]:t}return c}function _m(c,f){if(!(f==="constructor"&&typeof c[f]=="function")&&f!="__proto__")return c[f]}var Zx=tT(Sx),Ul=ZB||function(c,f){return Ar.setTimeout(c,f)},Mm=tT(oU);function eT(c,f,y){var b=f+"";return Mm(c,CU(b,UU(RU(b),y)))}function tT(c){var f=0,y=0;return function(){var b=i5(),N=q-(b-y);if(y=b,N>0){if(++f>=U)return arguments[0]}else f=0;return c.apply(t,arguments)}}function oh(c,f){var y=-1,b=c.length,N=b-1;for(f=f===t?b:f;++y<f;){var O=pm(y,N),G=c[O];c[O]=c[y],c[y]=G}return c.length=f,c}var rT=PU(function(c){var f=[];return c.charCodeAt(0)===46&&f.push(""),c.replace(xc,function(y,b,N,O){f.push(N?O.replace(Tl,"$1"):b||y)}),f});function mn(c){if(typeof c=="string"||ci(c))return c;var f=c+"";return f=="0"&&1/c==-se?"-0":f}function la(c){if(c!=null){try{return Oc.call(c)}catch{}try{return c+""}catch{}}return""}function UU(c,f){return Ai(De,function(y){var b="_."+y[0];f&y[1]&&!Lc(c,b)&&c.push(b)}),c.sort()}function iT(c){if(c instanceof ht)return c.clone();var f=new xi(c.__wrapped__,c.__chain__);return f.__actions__=Xr(c.__actions__),f.__index__=c.__index__,f.__values__=c.__values__,f}function $U(c,f,y){(y?Gr(c,f,y):f===t)?f=1:f=ar(tt(f),0);var b=c==null?0:c.length;if(!b||f<1)return[];for(var N=0,O=0,G=te(Vc(b/f));N<b;)G[O++]=Di(c,N,N+=f);return G}function GU(c){for(var f=-1,y=c==null?0:c.length,b=0,N=[];++f<y;){var O=c[f];O&&(N[b++]=O)}return N}function qU(){var c=arguments.length;if(!c)return[];for(var f=te(c-1),y=arguments[0],b=c;b--;)f[b-1]=arguments[b];return Rs(ze(y)?Xr(y):[y],Sr(f,1))}var VU=ot(function(c,f){return Qt(c)?Ml(c,Sr(f,1,Qt,!0)):[]}),HU=ot(function(c,f){var y=Ri(f);return Qt(y)&&(y=t),Qt(c)?Ml(c,Sr(f,1,Qt,!0),qe(y,2)):[]}),KU=ot(function(c,f){var y=Ri(f);return Qt(y)&&(y=t),Qt(c)?Ml(c,Sr(f,1,Qt,!0),t,y):[]});function WU(c,f,y){var b=c==null?0:c.length;return b?(f=y||f===t?1:tt(f),Di(c,f<0?0:f,b)):[]}function YU(c,f,y){var b=c==null?0:c.length;return b?(f=y||f===t?1:tt(f),f=b-f,Di(c,0,f<0?0:f)):[]}function XU(c,f){return c&&c.length?Zc(c,qe(f,3),!0,!0):[]}function jU(c,f){return c&&c.length?Zc(c,qe(f,3),!0):[]}function zU(c,f,y,b){var N=c==null?0:c.length;return N?(y&&typeof y!="number"&&Gr(c,f,y)&&(y=0,b=N),q5(c,f,y,b)):[]}function nT(c,f,y){var b=c==null?0:c.length;if(!b)return-1;var N=y==null?0:tt(y);return N<0&&(N=ar(b+N,0)),_c(c,qe(f,3),N)}function sT(c,f,y){var b=c==null?0:c.length;if(!b)return-1;var N=b-1;return y!==t&&(N=tt(y),N=y<0?ar(b+N,0):Nr(N,b-1)),_c(c,qe(f,3),N,!0)}function aT(c){var f=c==null?0:c.length;return f?Sr(c,1):[]}function JU(c){var f=c==null?0:c.length;return f?Sr(c,se):[]}function QU(c,f){var y=c==null?0:c.length;return y?(f=f===t?1:tt(f),Sr(c,f)):[]}function ZU(c){for(var f=-1,y=c==null?0:c.length,b={};++f<y;){var N=c[f];b[N[0]]=N[1]}return b}function oT(c){return c&&c.length?c[0]:t}function e4(c,f,y){var b=c==null?0:c.length;if(!b)return-1;var N=y==null?0:tt(y);return N<0&&(N=ar(b+N,0)),fo(c,f,N)}function t4(c){var f=c==null?0:c.length;return f?Di(c,0,-1):[]}var r4=ot(function(c){var f=qt(c,bm);return f.length&&f[0]===c[0]?cm(f):[]}),i4=ot(function(c){var f=Ri(c),y=qt(c,bm);return f===Ri(y)?f=t:y.pop(),y.length&&y[0]===c[0]?cm(y,qe(f,2)):[]}),n4=ot(function(c){var f=Ri(c),y=qt(c,bm);return f=typeof f=="function"?f:t,f&&y.pop(),y.length&&y[0]===c[0]?cm(y,t,f):[]});function s4(c,f){return c==null?"":t5.call(c,f)}function Ri(c){var f=c==null?0:c.length;return f?c[f-1]:t}function a4(c,f,y){var b=c==null?0:c.length;if(!b)return-1;var N=b;return y!==t&&(N=tt(y),N=N<0?ar(b+N,0):Nr(N,b-1)),f===f?UB(c,f,N):_c(c,VS,N,!0)}function o4(c,f){return c&&c.length?vx(c,tt(f)):t}var l4=ot(lT);function lT(c,f){return c&&c.length&&f&&f.length?gm(c,f):c}function u4(c,f,y){return c&&c.length&&f&&f.length?gm(c,f,qe(y,2)):c}function c4(c,f,y){return c&&c.length&&f&&f.length?gm(c,f,t,y):c}var h4=Vn(function(c,f){var y=c==null?0:c.length,b=am(c,f);return Ax(c,qt(f,function(N){return Hn(N,y)?+N:N}).sort(Lx)),b});function d4(c,f){var y=[];if(!(c&&c.length))return y;var b=-1,N=[],O=c.length;for(f=qe(f,3);++b<O;){var G=c[b];f(G,b,c)&&(y.push(G),N.push(b))}return Ax(c,N),y}function Pm(c){return c==null?c:s5.call(c)}function f4(c,f,y){var b=c==null?0:c.length;return b?(y&&typeof y!="number"&&Gr(c,f,y)?(f=0,y=b):(f=f==null?0:tt(f),y=y===t?b:tt(y)),Di(c,f,y)):[]}function g4(c,f){return Qc(c,f)}function p4(c,f,y){return ym(c,f,qe(y,2))}function m4(c,f){var y=c==null?0:c.length;if(y){var b=Qc(c,f);if(b<y&&Oi(c[b],f))return b}return-1}function y4(c,f){return Qc(c,f,!0)}function v4(c,f,y){return ym(c,f,qe(y,2),!0)}function E4(c,f){var y=c==null?0:c.length;if(y){var b=Qc(c,f,!0)-1;if(Oi(c[b],f))return b}return-1}function b4(c){return c&&c.length?xx(c):[]}function A4(c,f){return c&&c.length?xx(c,qe(f,2)):[]}function S4(c){var f=c==null?0:c.length;return f?Di(c,1,f):[]}function x4(c,f,y){return c&&c.length?(f=y||f===t?1:tt(f),Di(c,0,f<0?0:f)):[]}function T4(c,f,y){var b=c==null?0:c.length;return b?(f=y||f===t?1:tt(f),f=b-f,Di(c,f<0?0:f,b)):[]}function D4(c,f){return c&&c.length?Zc(c,qe(f,3),!1,!0):[]}function R4(c,f){return c&&c.length?Zc(c,qe(f,3)):[]}var I4=ot(function(c){return ws(Sr(c,1,Qt,!0))}),N4=ot(function(c){var f=Ri(c);return Qt(f)&&(f=t),ws(Sr(c,1,Qt,!0),qe(f,2))}),C4=ot(function(c){var f=Ri(c);return f=typeof f=="function"?f:t,ws(Sr(c,1,Qt,!0),t,f)});function w4(c){return c&&c.length?ws(c):[]}function L4(c,f){return c&&c.length?ws(c,qe(f,2)):[]}function _4(c,f){return f=typeof f=="function"?f:t,c&&c.length?ws(c,t,f):[]}function km(c){if(!(c&&c.length))return[];var f=0;return c=Ds(c,function(y){if(Qt(y))return f=ar(y.length,f),!0}),Qp(f,function(y){return qt(c,jp(y))})}function uT(c,f){if(!(c&&c.length))return[];var y=km(c);return f==null?y:qt(y,function(b){return oi(f,t,b)})}var M4=ot(function(c,f){return Qt(c)?Ml(c,f):[]}),P4=ot(function(c){return Em(Ds(c,Qt))}),k4=ot(function(c){var f=Ri(c);return Qt(f)&&(f=t),Em(Ds(c,Qt),qe(f,2))}),O4=ot(function(c){var f=Ri(c);return f=typeof f=="function"?f:t,Em(Ds(c,Qt),t,f)}),F4=ot(km);function B4(c,f){return Ix(c||[],f||[],_l)}function U4(c,f){return Ix(c||[],f||[],Ol)}var $4=ot(function(c){var f=c.length,y=f>1?c[f-1]:t;return y=typeof y=="function"?(c.pop(),y):t,uT(c,y)});function cT(c){var f=P(c);return f.__chain__=!0,f}function G4(c,f){return f(c),c}function lh(c,f){return f(c)}var q4=Vn(function(c){var f=c.length,y=f?c[0]:0,b=this.__wrapped__,N=function(O){return am(O,c)};return f>1||this.__actions__.length||!(b instanceof ht)||!Hn(y)?this.thru(N):(b=b.slice(y,+y+(f?1:0)),b.__actions__.push({func:lh,args:[N],thisArg:t}),new xi(b,this.__chain__).thru(function(O){return f&&!O.length&&O.push(t),O}))});function V4(){return cT(this)}function H4(){return new xi(this.value(),this.__chain__)}function K4(){this.__values__===t&&(this.__values__=TT(this.value()));var c=this.__index__>=this.__values__.length,f=c?t:this.__values__[this.__index__++];return{done:c,value:f}}function W4(){return this}function Y4(c){for(var f,y=this;y instanceof Yc;){var b=iT(y);b.__index__=0,b.__values__=t,f?N.__wrapped__=b:f=b;var N=b;y=y.__wrapped__}return N.__wrapped__=c,f}function X4(){var c=this.__wrapped__;if(c instanceof ht){var f=c;return this.__actions__.length&&(f=new ht(this)),f=f.reverse(),f.__actions__.push({func:lh,args:[Pm],thisArg:t}),new xi(f,this.__chain__)}return this.thru(Pm)}function j4(){return Rx(this.__wrapped__,this.__actions__)}var z4=eh(function(c,f,y){Tt.call(c,y)?++c[y]:Gn(c,y,1)});function J4(c,f,y){var b=ze(c)?GS:G5;return y&&Gr(c,f,y)&&(f=t),b(c,qe(f,3))}function Q4(c,f){var y=ze(c)?Ds:ux;return y(c,qe(f,3))}var Z4=Fx(nT),e8=Fx(sT);function t8(c,f){return Sr(uh(c,f),1)}function r8(c,f){return Sr(uh(c,f),se)}function i8(c,f,y){return y=y===t?1:tt(y),Sr(uh(c,f),y)}function hT(c,f){var y=ze(c)?Ai:Cs;return y(c,qe(f,3))}function dT(c,f){var y=ze(c)?SB:lx;return y(c,qe(f,3))}var n8=eh(function(c,f,y){Tt.call(c,y)?c[y].push(f):Gn(c,y,[f])});function s8(c,f,y,b){c=jr(c)?c:Do(c),y=y&&!b?tt(y):0;var N=c.length;return y<0&&(y=ar(N+y,0)),gh(c)?y<=N&&c.indexOf(f,y)>-1:!!N&&fo(c,f,y)>-1}var a8=ot(function(c,f,y){var b=-1,N=typeof f=="function",O=jr(c)?te(c.length):[];return Cs(c,function(G){O[++b]=N?oi(f,G,y):Pl(G,f,y)}),O}),o8=eh(function(c,f,y){Gn(c,y,f)});function uh(c,f){var y=ze(c)?qt:px;return y(c,qe(f,3))}function l8(c,f,y,b){return c==null?[]:(ze(f)||(f=f==null?[]:[f]),y=b?t:y,ze(y)||(y=y==null?[]:[y]),Ex(c,f,y))}var u8=eh(function(c,f,y){c[y?0:1].push(f)},function(){return[[],[]]});function c8(c,f,y){var b=ze(c)?Yp:KS,N=arguments.length<3;return b(c,qe(f,4),y,N,Cs)}function h8(c,f,y){var b=ze(c)?xB:KS,N=arguments.length<3;return b(c,qe(f,4),y,N,lx)}function d8(c,f){var y=ze(c)?Ds:ux;return y(c,dh(qe(f,3)))}function f8(c){var f=ze(c)?nx:sU;return f(c)}function g8(c,f,y){(y?Gr(c,f,y):f===t)?f=1:f=tt(f);var b=ze(c)?O5:aU;return b(c,f)}function p8(c){var f=ze(c)?F5:lU;return f(c)}function m8(c){if(c==null)return 0;if(jr(c))return gh(c)?po(c):c.length;var f=Cr(c);return f==ae||f==K?c.size:dm(c).length}function y8(c,f,y){var b=ze(c)?Xp:uU;return y&&Gr(c,f,y)&&(f=t),b(c,qe(f,3))}var v8=ot(function(c,f){if(c==null)return[];var y=f.length;return y>1&&Gr(c,f[0],f[1])?f=[]:y>2&&Gr(f[0],f[1],f[2])&&(f=[f[0]]),Ex(c,Sr(f,1),[])}),ch=QB||function(){return Ar.Date.now()};function E8(c,f){if(typeof f!="function")throw new Si(a);return c=tt(c),function(){if(--c<1)return f.apply(this,arguments)}}function fT(c,f,y){return f=y?t:f,f=c&&f==null?c.length:f,qn(c,w,t,t,t,t,f)}function gT(c,f){var y;if(typeof f!="function")throw new Si(a);return c=tt(c),function(){return--c>0&&(y=f.apply(this,arguments)),c<=1&&(f=t),y}}var Om=ot(function(c,f,y){var b=v;if(y.length){var N=Is(y,xo(Om));b|=_}return qn(c,b,f,y,N)}),pT=ot(function(c,f,y){var b=v|E;if(y.length){var N=Is(y,xo(pT));b|=_}return qn(f,b,c,y,N)});function mT(c,f,y){f=y?t:f;var b=qn(c,D,t,t,t,t,t,f);return b.placeholder=mT.placeholder,b}function yT(c,f,y){f=y?t:f;var b=qn(c,R,t,t,t,t,t,f);return b.placeholder=yT.placeholder,b}function vT(c,f,y){var b,N,O,G,V,W,he=0,de=!1,pe=!1,Re=!0;if(typeof c!="function")throw new Si(a);f=Ii(f)||0,Wt(y)&&(de=!!y.leading,pe="maxWait"in y,O=pe?ar(Ii(y.maxWait)||0,f):O,Re="trailing"in y?!!y.trailing:Re);function Be(Zt){var Fi=b,Yn=N;return b=N=t,he=Zt,G=c.apply(Yn,Fi),G}function Ke(Zt){return he=Zt,V=Ul(ct,f),de?Be(Zt):G}function nt(Zt){var Fi=Zt-W,Yn=Zt-he,FT=f-Fi;return pe?Nr(FT,O-Yn):FT}function He(Zt){var Fi=Zt-W,Yn=Zt-he;return W===t||Fi>=f||Fi<0||pe&&Yn>=O}function ct(){var Zt=ch();if(He(Zt))return ft(Zt);V=Ul(ct,nt(Zt))}function ft(Zt){return V=t,Re&&b?Be(Zt):(b=N=t,G)}function hi(){V!==t&&Nx(V),he=0,b=W=N=V=t}function qr(){return V===t?G:ft(ch())}function di(){var Zt=ch(),Fi=He(Zt);if(b=arguments,N=this,W=Zt,Fi){if(V===t)return Ke(W);if(pe)return Nx(V),V=Ul(ct,f),Be(W)}return V===t&&(V=Ul(ct,f)),G}return di.cancel=hi,di.flush=qr,di}var b8=ot(function(c,f){return ox(c,1,f)}),A8=ot(function(c,f,y){return ox(c,Ii(f)||0,y)});function S8(c){return qn(c,M)}function hh(c,f){if(typeof c!="function"||f!=null&&typeof f!="function")throw new Si(a);var y=function(){var b=arguments,N=f?f.apply(this,b):b[0],O=y.cache;if(O.has(N))return O.get(N);var G=c.apply(this,b);return y.cache=O.set(N,G)||O,G};return y.cache=new(hh.Cache||$n),y}hh.Cache=$n;function dh(c){if(typeof c!="function")throw new Si(a);return function(){var f=arguments;switch(f.length){case 0:return!c.call(this);case 1:return!c.call(this,f[0]);case 2:return!c.call(this,f[0],f[1]);case 3:return!c.call(this,f[0],f[1],f[2])}return!c.apply(this,f)}}function x8(c){return gT(2,c)}var T8=cU(function(c,f){f=f.length==1&&ze(f[0])?qt(f[0],li(qe())):qt(Sr(f,1),li(qe()));var y=f.length;return ot(function(b){for(var N=-1,O=Nr(b.length,y);++N<O;)b[N]=f[N].call(this,b[N]);return oi(c,this,b)})}),Fm=ot(function(c,f){var y=Is(f,xo(Fm));return qn(c,_,t,f,y)}),ET=ot(function(c,f){var y=Is(f,xo(ET));return qn(c,F,t,f,y)}),D8=Vn(function(c,f){return qn(c,C,t,t,t,f)});function R8(c,f){if(typeof c!="function")throw new Si(a);return f=f===t?f:tt(f),ot(c,f)}function I8(c,f){if(typeof c!="function")throw new Si(a);return f=f==null?0:ar(tt(f),0),ot(function(y){var b=y[f],N=_s(y,0,f);return b&&Rs(N,b),oi(c,this,N)})}function N8(c,f,y){var b=!0,N=!0;if(typeof c!="function")throw new Si(a);return Wt(y)&&(b="leading"in y?!!y.leading:b,N="trailing"in y?!!y.trailing:N),vT(c,f,{leading:b,maxWait:f,trailing:N})}function C8(c){return fT(c,1)}function w8(c,f){return Fm(Am(f),c)}function L8(){if(!arguments.length)return[];var c=arguments[0];return ze(c)?c:[c]}function _8(c){return Ti(c,p)}function M8(c,f){return f=typeof f=="function"?f:t,Ti(c,p,f)}function P8(c){return Ti(c,h|p)}function k8(c,f){return f=typeof f=="function"?f:t,Ti(c,h|p,f)}function O8(c,f){return f==null||ax(c,f,yr(f))}function Oi(c,f){return c===f||c!==c&&f!==f}var F8=nh(um),B8=nh(function(c,f){return c>=f}),ua=dx(function(){return arguments}())?dx:function(c){return zt(c)&&Tt.call(c,"callee")&&!QS.call(c,"callee")},ze=te.isArray,U8=kS?li(kS):Y5;function jr(c){return c!=null&&fh(c.length)&&!Kn(c)}function Qt(c){return zt(c)&&jr(c)}function $8(c){return c===!0||c===!1||zt(c)&&$r(c)==$e}var Ms=e5||Xm,G8=OS?li(OS):X5;function q8(c){return zt(c)&&c.nodeType===1&&!$l(c)}function V8(c){if(c==null)return!0;if(jr(c)&&(ze(c)||typeof c=="string"||typeof c.splice=="function"||Ms(c)||To(c)||ua(c)))return!c.length;var f=Cr(c);if(f==ae||f==K)return!c.size;if(Bl(c))return!dm(c).length;for(var y in c)if(Tt.call(c,y))return!1;return!0}function H8(c,f){return kl(c,f)}function K8(c,f,y){y=typeof y=="function"?y:t;var b=y?y(c,f):t;return b===t?kl(c,f,t,y):!!b}function Bm(c){if(!zt(c))return!1;var f=$r(c);return f==Ge||f==it||typeof c.message=="string"&&typeof c.name=="string"&&!$l(c)}function W8(c){return typeof c=="number"&&ex(c)}function Kn(c){if(!Wt(c))return!1;var f=$r(c);return f==st||f==B||f==Ue||f==Pe}function bT(c){return typeof c=="number"&&c==tt(c)}function fh(c){return typeof c=="number"&&c>-1&&c%1==0&&c<=ce}function Wt(c){var f=typeof c;return c!=null&&(f=="object"||f=="function")}function zt(c){return c!=null&&typeof c=="object"}var AT=FS?li(FS):z5;function Y8(c,f){return c===f||hm(c,f,Nm(f))}function X8(c,f,y){return y=typeof y=="function"?y:t,hm(c,f,Nm(f),y)}function j8(c){return ST(c)&&c!=+c}function z8(c){if(MU(c))throw new je(s);return fx(c)}function J8(c){return c===null}function Q8(c){return c==null}function ST(c){return typeof c=="number"||zt(c)&&$r(c)==Ae}function $l(c){if(!zt(c)||$r(c)!=ge)return!1;var f=$c(c);if(f===null)return!0;var y=Tt.call(f,"constructor")&&f.constructor;return typeof y=="function"&&y instanceof y&&Oc.call(y)==XB}var Um=BS?li(BS):J5;function Z8(c){return bT(c)&&c>=-ce&&c<=ce}var xT=US?li(US):Q5;function gh(c){return typeof c=="string"||!ze(c)&&zt(c)&&$r(c)==T}function ci(c){return typeof c=="symbol"||zt(c)&&$r(c)==S}var To=$S?li($S):Z5;function e6(c){return c===t}function t6(c){return zt(c)&&Cr(c)==j}function r6(c){return zt(c)&&$r(c)==Te}var i6=nh(fm),n6=nh(function(c,f){return c<=f});function TT(c){if(!c)return[];if(jr(c))return gh(c)?Pi(c):Xr(c);if(Il&&c[Il])return OB(c[Il]());var f=Cr(c),y=f==ae?em:f==K?Mc:Do;return y(c)}function Wn(c){if(!c)return c===0?c:0;if(c=Ii(c),c===se||c===-se){var f=c<0?-1:1;return f*ie}return c===c?c:0}function tt(c){var f=Wn(c),y=f%1;return f===f?y?f-y:f:0}function DT(c){return c?sa(tt(c),0,J):0}function Ii(c){if(typeof c=="number")return c;if(ci(c))return H;if(Wt(c)){var f=typeof c.valueOf=="function"?c.valueOf():c;c=Wt(f)?f+"":f}if(typeof c!="string")return c===0?c:+c;c=c.replace(xs,"");var y=Fp.test(c);return y||Ts.test(c)?EB(c.slice(2),y?2:8):Nc.test(c)?H:+c}function RT(c){return pn(c,zr(c))}function s6(c){return c?sa(tt(c),-ce,ce):c===0?c:0}function At(c){return c==null?"":ui(c)}var a6=Ao(function(c,f){if(Bl(f)||jr(f)){pn(f,yr(f),c);return}for(var y in f)Tt.call(f,y)&&_l(c,y,f[y])}),IT=Ao(function(c,f){pn(f,zr(f),c)}),ph=Ao(function(c,f,y,b){pn(f,zr(f),c,b)}),o6=Ao(function(c,f,y,b){pn(f,yr(f),c,b)}),l6=Vn(am);function u6(c,f){var y=bo(c);return f==null?y:sx(y,f)}var c6=ot(function(c,f){c=wt(c);var y=-1,b=f.length,N=b>2?f[2]:t;for(N&&Gr(f[0],f[1],N)&&(b=1);++y<b;)for(var O=f[y],G=zr(O),V=-1,W=G.length;++V<W;){var he=G[V],de=c[he];(de===t||Oi(de,yo[he])&&!Tt.call(c,he))&&(c[he]=O[he])}return c}),h6=ot(function(c){return c.push(t,Hx),oi(NT,t,c)});function d6(c,f){return qS(c,qe(f,3),gn)}function f6(c,f){return qS(c,qe(f,3),lm)}function g6(c,f){return c==null?c:om(c,qe(f,3),zr)}function p6(c,f){return c==null?c:cx(c,qe(f,3),zr)}function m6(c,f){return c&&gn(c,qe(f,3))}function y6(c,f){return c&&lm(c,qe(f,3))}function v6(c){return c==null?[]:zc(c,yr(c))}function E6(c){return c==null?[]:zc(c,zr(c))}function $m(c,f,y){var b=c==null?t:aa(c,f);return b===t?y:b}function b6(c,f){return c!=null&&Yx(c,f,V5)}function Gm(c,f){return c!=null&&Yx(c,f,H5)}var A6=Ux(function(c,f,y){f!=null&&typeof f.toString!="function"&&(f=Fc.call(f)),c[f]=y},Vm(Jr)),S6=Ux(function(c,f,y){f!=null&&typeof f.toString!="function"&&(f=Fc.call(f)),Tt.call(c,f)?c[f].push(y):c[f]=[y]},qe),x6=ot(Pl);function yr(c){return jr(c)?ix(c):dm(c)}function zr(c){return jr(c)?ix(c,!0):eU(c)}function T6(c,f){var y={};return f=qe(f,3),gn(c,function(b,N,O){Gn(y,f(b,N,O),b)}),y}function D6(c,f){var y={};return f=qe(f,3),gn(c,function(b,N,O){Gn(y,N,f(b,N,O))}),y}var R6=Ao(function(c,f,y){Jc(c,f,y)}),NT=Ao(function(c,f,y,b){Jc(c,f,y,b)}),I6=Vn(function(c,f){var y={};if(c==null)return y;var b=!1;f=qt(f,function(O){return O=Ls(O,c),b||(b=O.length>1),O}),pn(c,Rm(c),y),b&&(y=Ti(y,h|d|p,AU));for(var N=f.length;N--;)vm(y,f[N]);return y});function N6(c,f){return CT(c,dh(qe(f)))}var C6=Vn(function(c,f){return c==null?{}:rU(c,f)});function CT(c,f){if(c==null)return{};var y=qt(Rm(c),function(b){return[b]});return f=qe(f),bx(c,y,function(b,N){return f(b,N[0])})}function w6(c,f,y){f=Ls(f,c);var b=-1,N=f.length;for(N||(N=1,c=t);++b<N;){var O=c==null?t:c[mn(f[b])];O===t&&(b=N,O=y),c=Kn(O)?O.call(c):O}return c}function L6(c,f,y){return c==null?c:Ol(c,f,y)}function _6(c,f,y,b){return b=typeof b=="function"?b:t,c==null?c:Ol(c,f,y,b)}var wT=qx(yr),LT=qx(zr);function M6(c,f,y){var b=ze(c),N=b||Ms(c)||To(c);if(f=qe(f,4),y==null){var O=c&&c.constructor;N?y=b?new O:[]:Wt(c)?y=Kn(O)?bo($c(c)):{}:y={}}return(N?Ai:gn)(c,function(G,V,W){return f(y,G,V,W)}),y}function P6(c,f){return c==null?!0:vm(c,f)}function k6(c,f,y){return c==null?c:Dx(c,f,Am(y))}function O6(c,f,y,b){return b=typeof b=="function"?b:t,c==null?c:Dx(c,f,Am(y),b)}function Do(c){return c==null?[]:Zp(c,yr(c))}function F6(c){return c==null?[]:Zp(c,zr(c))}function B6(c,f,y){return y===t&&(y=f,f=t),y!==t&&(y=Ii(y),y=y===y?y:0),f!==t&&(f=Ii(f),f=f===f?f:0),sa(Ii(c),f,y)}function U6(c,f,y){return f=Wn(f),y===t?(y=f,f=0):y=Wn(y),c=Ii(c),K5(c,f,y)}function $6(c,f,y){if(y&&typeof y!="boolean"&&Gr(c,f,y)&&(f=y=t),y===t&&(typeof f=="boolean"?(y=f,f=t):typeof c=="boolean"&&(y=c,c=t)),c===t&&f===t?(c=0,f=1):(c=Wn(c),f===t?(f=c,c=0):f=Wn(f)),c>f){var b=c;c=f,f=b}if(y||c%1||f%1){var N=tx();return Nr(c+N*(f-c+vB("1e-"+((N+"").length-1))),f)}return pm(c,f)}var G6=So(function(c,f,y){return f=f.toLowerCase(),c+(y?_T(f):f)});function _T(c){return qm(At(c).toLowerCase())}function MT(c){return c=At(c),c&&c.replace(Bp,LB).replace(lB,"")}function q6(c,f,y){c=At(c),f=ui(f);var b=c.length;y=y===t?b:sa(tt(y),0,b);var N=y;return y-=f.length,y>=0&&c.slice(y,N)==f}function V6(c){return c=At(c),c&&Bn.test(c)?c.replace(Ze,_B):c}function H6(c){return c=At(c),c&&Tc.test(c)?c.replace(ao,"\\$&"):c}var K6=So(function(c,f,y){return c+(y?"-":"")+f.toLowerCase()}),W6=So(function(c,f,y){return c+(y?" ":"")+f.toLowerCase()}),Y6=Ox("toLowerCase");function X6(c,f,y){c=At(c),f=tt(f);var b=f?po(c):0;if(!f||b>=f)return c;var N=(f-b)/2;return ih(Hc(N),y)+c+ih(Vc(N),y)}function j6(c,f,y){c=At(c),f=tt(f);var b=f?po(c):0;return f&&b<f?c+ih(f-b,y):c}function z6(c,f,y){c=At(c),f=tt(f);var b=f?po(c):0;return f&&b<f?ih(f-b,y)+c:c}function J6(c,f,y){return y||f==null?f=0:f&&(f=+f),n5(At(c).replace(oo,""),f||0)}function Q6(c,f,y){return(y?Gr(c,f,y):f===t)?f=1:f=tt(f),mm(At(c),f)}function Z6(){var c=arguments,f=At(c[0]);return c.length<3?f:f.replace(c[1],c[2])}var e$=So(function(c,f,y){return c+(y?"_":"")+f.toLowerCase()});function t$(c,f,y){return y&&typeof y!="number"&&Gr(c,f,y)&&(f=y=t),y=y===t?J:y>>>0,y?(c=At(c),c&&(typeof f=="string"||f!=null&&!Um(f))&&(f=ui(f),!f&&go(c))?_s(Pi(c),0,y):c.split(f,y)):[]}var r$=So(function(c,f,y){return c+(y?" ":"")+qm(f)});function i$(c,f,y){return c=At(c),y=y==null?0:sa(tt(y),0,c.length),f=ui(f),c.slice(y,y+f.length)==f}function n$(c,f,y){var b=P.templateSettings;y&&Gr(c,f,y)&&(f=t),c=At(c),f=ph({},f,b,Vx);var N=ph({},f.imports,b.imports,Vx),O=yr(N),G=Zp(N,O),V,W,he=0,de=f.interpolate||ea,pe="__p += '",Re=tm((f.escape||ea).source+"|"+de.source+"|"+(de===so?Ic:ea).source+"|"+(f.evaluate||ea).source+"|$","g"),Be="//# sourceURL="+(Tt.call(f,"sourceURL")?(f.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++fB+"]")+`
`;c.replace(Re,function(He,ct,ft,hi,qr,di){return ft||(ft=hi),pe+=c.slice(he,di).replace(H3,MB),ct&&(V=!0,pe+=`' +
__e(`+ct+`) +
'`),qr&&(W=!0,pe+=`';
`+qr+`;
__p += '`),ft&&(pe+=`' +
((__t = (`+ft+`)) == null ? '' : __t) +
'`),he=di+He.length,He}),pe+=`';
`;var Ke=Tt.call(f,"variable")&&f.variable;Ke||(pe=`with (obj) {
`+pe+`
}
`),pe=(W?pe.replace(ee,""):pe).replace(gt,"$1").replace(Dt,"$1;"),pe="function("+(Ke||"obj")+`) {
`+(Ke?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(V?", __e = _.escape":"")+(W?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+pe+`return __p
}`;var nt=kT(function(){return vt(O,Be+"return "+pe).apply(t,G)});if(nt.source=pe,Bm(nt))throw nt;return nt}function s$(c){return At(c).toLowerCase()}function a$(c){return At(c).toUpperCase()}function o$(c,f,y){if(c=At(c),c&&(y||f===t))return c.replace(xs,"");if(!c||!(f=ui(f)))return c;var b=Pi(c),N=Pi(f),O=WS(b,N),G=YS(b,N)+1;return _s(b,O,G).join("")}function l$(c,f,y){if(c=At(c),c&&(y||f===t))return c.replace(lo,"");if(!c||!(f=ui(f)))return c;var b=Pi(c),N=YS(b,Pi(f))+1;return _s(b,0,N).join("")}function u$(c,f,y){if(c=At(c),c&&(y||f===t))return c.replace(oo,"");if(!c||!(f=ui(f)))return c;var b=Pi(c),N=WS(b,Pi(f));return _s(b,N).join("")}function c$(c,f){var y=L,b=I;if(Wt(f)){var N="separator"in f?f.separator:N;y="length"in f?tt(f.length):y,b="omission"in f?ui(f.omission):b}c=At(c);var O=c.length;if(go(c)){var G=Pi(c);O=G.length}if(y>=O)return c;var V=y-po(b);if(V<1)return b;var W=G?_s(G,0,V).join(""):c.slice(0,V);if(N===t)return W+b;if(G&&(V+=W.length-V),Um(N)){if(c.slice(V).search(N)){var he,de=W;for(N.global||(N=tm(N.source,At(uo.exec(N))+"g")),N.lastIndex=0;he=N.exec(de);)var pe=he.index;W=W.slice(0,pe===t?V:pe)}}else if(c.indexOf(ui(N),V)!=V){var Re=W.lastIndexOf(N);Re>-1&&(W=W.slice(0,Re))}return W+b}function h$(c){return c=At(c),c&&dn.test(c)?c.replace(Rt,$B):c}var d$=So(function(c,f,y){return c+(y?" ":"")+f.toUpperCase()}),qm=Ox("toUpperCase");function PT(c,f,y){return c=At(c),f=y?t:f,f===t?kB(c)?VB(c):RB(c):c.match(f)||[]}var kT=ot(function(c,f){try{return oi(c,t,f)}catch(y){return Bm(y)?y:new je(y)}}),f$=Vn(function(c,f){return Ai(f,function(y){y=mn(y),Gn(c,y,Om(c[y],c))}),c});function g$(c){var f=c==null?0:c.length,y=qe();return c=f?qt(c,function(b){if(typeof b[1]!="function")throw new Si(a);return[y(b[0]),b[1]]}):[],ot(function(b){for(var N=-1;++N<f;){var O=c[N];if(oi(O[0],this,b))return oi(O[1],this,b)}})}function p$(c){return $5(Ti(c,h))}function Vm(c){return function(){return c}}function m$(c,f){return c==null||c!==c?f:c}var y$=Bx(),v$=Bx(!0);function Jr(c){return c}function Hm(c){return gx(typeof c=="function"?c:Ti(c,h))}function E$(c){return mx(Ti(c,h))}function b$(c,f){return yx(c,Ti(f,h))}var A$=ot(function(c,f){return function(y){return Pl(y,c,f)}}),S$=ot(function(c,f){return function(y){return Pl(c,y,f)}});function Km(c,f,y){var b=yr(f),N=zc(f,b);y==null&&!(Wt(f)&&(N.length||!b.length))&&(y=f,f=c,c=this,N=zc(f,yr(f)));var O=!(Wt(y)&&"chain"in y)||!!y.chain,G=Kn(c);return Ai(N,function(V){var W=f[V];c[V]=W,G&&(c.prototype[V]=function(){var he=this.__chain__;if(O||he){var de=c(this.__wrapped__),pe=de.__actions__=Xr(this.__actions__);return pe.push({func:W,args:arguments,thisArg:c}),de.__chain__=he,de}return W.apply(c,Rs([this.value()],arguments))})}),c}function x$(){return Ar._===this&&(Ar._=jB),this}function Wm(){}function T$(c){return c=tt(c),ot(function(f){return vx(f,c)})}var D$=xm(qt),R$=xm(GS),I$=xm(Xp);function OT(c){return wm(c)?jp(mn(c)):iU(c)}function N$(c){return function(f){return c==null?t:aa(c,f)}}var C$=$x(),w$=$x(!0);function Ym(){return[]}function Xm(){return!1}function L$(){return{}}function _$(){return""}function M$(){return!0}function P$(c,f){if(c=tt(c),c<1||c>ce)return[];var y=J,b=Nr(c,J);f=qe(f),c-=J;for(var N=Qp(b,f);++y<c;)f(y);return N}function k$(c){return ze(c)?qt(c,mn):ci(c)?[c]:Xr(rT(At(c)))}function O$(c){var f=++YB;return At(c)+f}var F$=rh(function(c,f){return c+f},0),B$=Tm("ceil"),U$=rh(function(c,f){return c/f},1),$$=Tm("floor");function G$(c){return c&&c.length?jc(c,Jr,um):t}function q$(c,f){return c&&c.length?jc(c,qe(f,2),um):t}function V$(c){return HS(c,Jr)}function H$(c,f){return HS(c,qe(f,2))}function K$(c){return c&&c.length?jc(c,Jr,fm):t}function W$(c,f){return c&&c.length?jc(c,qe(f,2),fm):t}var Y$=rh(function(c,f){return c*f},1),X$=Tm("round"),j$=rh(function(c,f){return c-f},0);function z$(c){return c&&c.length?Jp(c,Jr):0}function J$(c,f){return c&&c.length?Jp(c,qe(f,2)):0}return P.after=E8,P.ary=fT,P.assign=a6,P.assignIn=IT,P.assignInWith=ph,P.assignWith=o6,P.at=l6,P.before=gT,P.bind=Om,P.bindAll=f$,P.bindKey=pT,P.castArray=L8,P.chain=cT,P.chunk=$U,P.compact=GU,P.concat=qU,P.cond=g$,P.conforms=p$,P.constant=Vm,P.countBy=z4,P.create=u6,P.curry=mT,P.curryRight=yT,P.debounce=vT,P.defaults=c6,P.defaultsDeep=h6,P.defer=b8,P.delay=A8,P.difference=VU,P.differenceBy=HU,P.differenceWith=KU,P.drop=WU,P.dropRight=YU,P.dropRightWhile=XU,P.dropWhile=jU,P.fill=zU,P.filter=Q4,P.flatMap=t8,P.flatMapDeep=r8,P.flatMapDepth=i8,P.flatten=aT,P.flattenDeep=JU,P.flattenDepth=QU,P.flip=S8,P.flow=y$,P.flowRight=v$,P.fromPairs=ZU,P.functions=v6,P.functionsIn=E6,P.groupBy=n8,P.initial=t4,P.intersection=r4,P.intersectionBy=i4,P.intersectionWith=n4,P.invert=A6,P.invertBy=S6,P.invokeMap=a8,P.iteratee=Hm,P.keyBy=o8,P.keys=yr,P.keysIn=zr,P.map=uh,P.mapKeys=T6,P.mapValues=D6,P.matches=E$,P.matchesProperty=b$,P.memoize=hh,P.merge=R6,P.mergeWith=NT,P.method=A$,P.methodOf=S$,P.mixin=Km,P.negate=dh,P.nthArg=T$,P.omit=I6,P.omitBy=N6,P.once=x8,P.orderBy=l8,P.over=D$,P.overArgs=T8,P.overEvery=R$,P.overSome=I$,P.partial=Fm,P.partialRight=ET,P.partition=u8,P.pick=C6,P.pickBy=CT,P.property=OT,P.propertyOf=N$,P.pull=l4,P.pullAll=lT,P.pullAllBy=u4,P.pullAllWith=c4,P.pullAt=h4,P.range=C$,P.rangeRight=w$,P.rearg=D8,P.reject=d8,P.remove=d4,P.rest=R8,P.reverse=Pm,P.sampleSize=g8,P.set=L6,P.setWith=_6,P.shuffle=p8,P.slice=f4,P.sortBy=v8,P.sortedUniq=b4,P.sortedUniqBy=A4,P.split=t$,P.spread=I8,P.tail=S4,P.take=x4,P.takeRight=T4,P.takeRightWhile=D4,P.takeWhile=R4,P.tap=G4,P.throttle=N8,P.thru=lh,P.toArray=TT,P.toPairs=wT,P.toPairsIn=LT,P.toPath=k$,P.toPlainObject=RT,P.transform=M6,P.unary=C8,P.union=I4,P.unionBy=N4,P.unionWith=C4,P.uniq=w4,P.uniqBy=L4,P.uniqWith=_4,P.unset=P6,P.unzip=km,P.unzipWith=uT,P.update=k6,P.updateWith=O6,P.values=Do,P.valuesIn=F6,P.without=M4,P.words=PT,P.wrap=w8,P.xor=P4,P.xorBy=k4,P.xorWith=O4,P.zip=F4,P.zipObject=B4,P.zipObjectDeep=U4,P.zipWith=$4,P.entries=wT,P.entriesIn=LT,P.extend=IT,P.extendWith=ph,Km(P,P),P.add=F$,P.attempt=kT,P.camelCase=G6,P.capitalize=_T,P.ceil=B$,P.clamp=B6,P.clone=_8,P.cloneDeep=P8,P.cloneDeepWith=k8,P.cloneWith=M8,P.conformsTo=O8,P.deburr=MT,P.defaultTo=m$,P.divide=U$,P.endsWith=q6,P.eq=Oi,P.escape=V6,P.escapeRegExp=H6,P.every=J4,P.find=Z4,P.findIndex=nT,P.findKey=d6,P.findLast=e8,P.findLastIndex=sT,P.findLastKey=f6,P.floor=$$,P.forEach=hT,P.forEachRight=dT,P.forIn=g6,P.forInRight=p6,P.forOwn=m6,P.forOwnRight=y6,P.get=$m,P.gt=F8,P.gte=B8,P.has=b6,P.hasIn=Gm,P.head=oT,P.identity=Jr,P.includes=s8,P.indexOf=e4,P.inRange=U6,P.invoke=x6,P.isArguments=ua,P.isArray=ze,P.isArrayBuffer=U8,P.isArrayLike=jr,P.isArrayLikeObject=Qt,P.isBoolean=$8,P.isBuffer=Ms,P.isDate=G8,P.isElement=q8,P.isEmpty=V8,P.isEqual=H8,P.isEqualWith=K8,P.isError=Bm,P.isFinite=W8,P.isFunction=Kn,P.isInteger=bT,P.isLength=fh,P.isMap=AT,P.isMatch=Y8,P.isMatchWith=X8,P.isNaN=j8,P.isNative=z8,P.isNil=Q8,P.isNull=J8,P.isNumber=ST,P.isObject=Wt,P.isObjectLike=zt,P.isPlainObject=$l,P.isRegExp=Um,P.isSafeInteger=Z8,P.isSet=xT,P.isString=gh,P.isSymbol=ci,P.isTypedArray=To,P.isUndefined=e6,P.isWeakMap=t6,P.isWeakSet=r6,P.join=s4,P.kebabCase=K6,P.last=Ri,P.lastIndexOf=a4,P.lowerCase=W6,P.lowerFirst=Y6,P.lt=i6,P.lte=n6,P.max=G$,P.maxBy=q$,P.mean=V$,P.meanBy=H$,P.min=K$,P.minBy=W$,P.stubArray=Ym,P.stubFalse=Xm,P.stubObject=L$,P.stubString=_$,P.stubTrue=M$,P.multiply=Y$,P.nth=o4,P.noConflict=x$,P.noop=Wm,P.now=ch,P.pad=X6,P.padEnd=j6,P.padStart=z6,P.parseInt=J6,P.random=$6,P.reduce=c8,P.reduceRight=h8,P.repeat=Q6,P.replace=Z6,P.result=w6,P.round=X$,P.runInContext=Y,P.sample=f8,P.size=m8,P.snakeCase=e$,P.some=y8,P.sortedIndex=g4,P.sortedIndexBy=p4,P.sortedIndexOf=m4,P.sortedLastIndex=y4,P.sortedLastIndexBy=v4,P.sortedLastIndexOf=E4,P.startCase=r$,P.startsWith=i$,P.subtract=j$,P.sum=z$,P.sumBy=J$,P.template=n$,P.times=P$,P.toFinite=Wn,P.toInteger=tt,P.toLength=DT,P.toLower=s$,P.toNumber=Ii,P.toSafeInteger=s6,P.toString=At,P.toUpper=a$,P.trim=o$,P.trimEnd=l$,P.trimStart=u$,P.truncate=c$,P.unescape=h$,P.uniqueId=O$,P.upperCase=d$,P.upperFirst=qm,P.each=hT,P.eachRight=dT,P.first=oT,Km(P,function(){var c={};return gn(P,function(f,y){Tt.call(P.prototype,y)||(c[y]=f)}),c}(),{chain:!1}),P.VERSION=r,Ai(["bind","bindKey","curry","curryRight","partial","partialRight"],function(c){P[c].placeholder=P}),Ai(["drop","take"],function(c,f){ht.prototype[c]=function(y){y=y===t?1:ar(tt(y),0);var b=this.__filtered__&&!f?new ht(this):this.clone();return b.__filtered__?b.__takeCount__=Nr(y,b.__takeCount__):b.__views__.push({size:Nr(y,J),type:c+(b.__dir__<0?"Right":"")}),b},ht.prototype[c+"Right"]=function(y){return this.reverse()[c](y).reverse()}}),Ai(["filter","map","takeWhile"],function(c,f){var y=f+1,b=y==$||y==ne;ht.prototype[c]=function(N){var O=this.clone();return O.__iteratees__.push({iteratee:qe(N,3),type:y}),O.__filtered__=O.__filtered__||b,O}}),Ai(["head","last"],function(c,f){var y="take"+(f?"Right":"");ht.prototype[c]=function(){return this[y](1).value()[0]}}),Ai(["initial","tail"],function(c,f){var y="drop"+(f?"":"Right");ht.prototype[c]=function(){return this.__filtered__?new ht(this):this[y](1)}}),ht.prototype.compact=function(){return this.filter(Jr)},ht.prototype.find=function(c){return this.filter(c).head()},ht.prototype.findLast=function(c){return this.reverse().find(c)},ht.prototype.invokeMap=ot(function(c,f){return typeof c=="function"?new ht(this):this.map(function(y){return Pl(y,c,f)})}),ht.prototype.reject=function(c){return this.filter(dh(qe(c)))},ht.prototype.slice=function(c,f){c=tt(c);var y=this;return y.__filtered__&&(c>0||f<0)?new ht(y):(c<0?y=y.takeRight(-c):c&&(y=y.drop(c)),f!==t&&(f=tt(f),y=f<0?y.dropRight(-f):y.take(f-c)),y)},ht.prototype.takeRightWhile=function(c){return this.reverse().takeWhile(c).reverse()},ht.prototype.toArray=function(){return this.take(J)},gn(ht.prototype,function(c,f){var y=/^(?:filter|find|map|reject)|While$/.test(f),b=/^(?:head|last)$/.test(f),N=P[b?"take"+(f=="last"?"Right":""):f],O=b||/^find/.test(f);N&&(P.prototype[f]=function(){var G=this.__wrapped__,V=b?[1]:arguments,W=G instanceof ht,he=V[0],de=W||ze(G),pe=function(ct){var ft=N.apply(P,Rs([ct],V));return b&&Re?ft[0]:ft};de&&y&&typeof he=="function"&&he.length!=1&&(W=de=!1);var Re=this.__chain__,Be=!!this.__actions__.length,Ke=O&&!Re,nt=W&&!Be;if(!O&&de){G=nt?G:new ht(this);var He=c.apply(G,V);return He.__actions__.push({func:lh,args:[pe],thisArg:t}),new xi(He,Re)}return Ke&&nt?c.apply(this,V):(He=this.thru(pe),Ke?b?He.value()[0]:He.value():He)})}),Ai(["pop","push","shift","sort","splice","unshift"],function(c){var f=Pc[c],y=/^(?:push|sort|unshift)$/.test(c)?"tap":"thru",b=/^(?:pop|shift)$/.test(c);P.prototype[c]=function(){var N=arguments;if(b&&!this.__chain__){var O=this.value();return f.apply(ze(O)?O:[],N)}return this[y](function(G){return f.apply(ze(G)?G:[],N)})}}),gn(ht.prototype,function(c,f){var y=P[f];if(y){var b=y.name+"";Tt.call(Eo,b)||(Eo[b]=[]),Eo[b].push({name:f,func:y})}}),Eo[th(t,E).name]=[{name:"wrapper",func:t}],ht.prototype.clone=h5,ht.prototype.reverse=d5,ht.prototype.value=f5,P.prototype.at=q4,P.prototype.chain=V4,P.prototype.commit=H4,P.prototype.next=K4,P.prototype.plant=Y4,P.prototype.reverse=X4,P.prototype.toJSON=P.prototype.valueOf=P.prototype.value=j4,P.prototype.first=P.prototype.head,Il&&(P.prototype[Il]=W4),P},mo=HB();ta?((ta.exports=mo)._=mo,Hp._=mo):Ar._=mo}).call(KI)}(Ho,Ho.exports)),Ho.exports}var YI=WI();const It=Vs(YI);var Ld,Cv;function _a(){return Cv||(Cv=1,Ld=TypeError),Ld}const _d=HI(Object.freeze(Object.defineProperty({__proto__:null,default:{}},Symbol.toStringTag,{value:"Module"})));var Md,wv;function vu(){if(wv)return Md;wv=1;var i=typeof Map=="function"&&Map.prototype,e=Object.getOwnPropertyDescriptor&&i?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,t=i&&e&&typeof e.get=="function"?e.get:null,r=i&&Map.prototype.forEach,n=typeof Set=="function"&&Set.prototype,s=Object.getOwnPropertyDescriptor&&n?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,a=n&&s&&typeof s.get=="function"?s.get:null,o=n&&Set.prototype.forEach,l=typeof WeakMap=="function"&&WeakMap.prototype,u=l?WeakMap.prototype.has:null,h=typeof WeakSet=="function"&&WeakSet.prototype,d=h?WeakSet.prototype.has:null,p=typeof WeakRef=="function"&&WeakRef.prototype,g=p?WeakRef.prototype.deref:null,m=Boolean.prototype.valueOf,v=Object.prototype.toString,E=Function.prototype.toString,A=String.prototype.match,D=String.prototype.slice,R=String.prototype.replace,_=String.prototype.toUpperCase,F=String.prototype.toLowerCase,w=RegExp.prototype.test,C=Array.prototype.concat,M=Array.prototype.join,L=Array.prototype.slice,I=Math.floor,U=typeof BigInt=="function"?BigInt.prototype.valueOf:null,q=Object.getOwnPropertySymbols,$=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,X=typeof Symbol=="function"&&typeof Symbol.iterator=="object",ne=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===X||!0)?Symbol.toStringTag:null,se=Object.prototype.propertyIsEnumerable,ce=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(Z){return Z.__proto__}:null);function ie(Z,ee){if(Z===1/0||Z===-1/0||Z!==Z||Z&&Z>-1e3&&Z<1e3||w.call(/e/,ee))return ee;var gt=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof Z=="number"){var Dt=Z<0?-I(-Z):I(Z);if(Dt!==Z){var Rt=String(Dt),Ze=D.call(ee,Rt.length+1);return R.call(Rt,gt,"$&_")+"."+R.call(R.call(Ze,/([0-9]{3})/g,"$&_"),/_$/,"")}}return R.call(ee,gt,"$&_")}var H=_d,J=H.custom,ve=Ae(J)?J:null,fe={__proto__:null,double:'"',single:"'"},De={__proto__:null,double:/(["\\])/g,single:/(['\\])/g};Md=function Z(ee,gt,Dt,Rt){var Ze=gt||{};if(Ne(Ze,"quoteStyle")&&!Ne(fe,Ze.quoteStyle))throw new TypeError('option "quoteStyle" must be "single" or "double"');if(Ne(Ze,"maxStringLength")&&(typeof Ze.maxStringLength=="number"?Ze.maxStringLength<0&&Ze.maxStringLength!==1/0:Ze.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var dn=Ne(Ze,"customInspect")?Ze.customInspect:!0;if(typeof dn!="boolean"&&dn!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(Ne(Ze,"indent")&&Ze.indent!==null&&Ze.indent!=="	"&&!(parseInt(Ze.indent,10)===Ze.indent&&Ze.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(Ne(Ze,"numericSeparator")&&typeof Ze.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var Bn=Ze.numericSeparator;if(typeof ee>"u")return"undefined";if(ee===null)return"null";if(typeof ee=="boolean")return ee?"true":"false";if(typeof ee=="string")return ye(ee,Ze);if(typeof ee=="number"){if(ee===0)return 1/0/ee>0?"0":"-0";var Ur=String(ee);return Bn?ie(ee,Ur):Ur}if(typeof ee=="bigint"){var fn=String(ee)+"n";return Bn?ie(ee,fn):fn}var so=typeof Ze.depth>"u"?5:Ze.depth;if(typeof Dt>"u"&&(Dt=0),Dt>=so&&so>0&&typeof ee=="object")return $e(ee)?"[Array]":"[Object]";var Ss=Al(Ze,Dt);if(typeof Rt>"u")Rt=[];else if(K(Rt,ee)>=0)return"[Circular]";function ai(Ts,co,Bp){if(co&&(Rt=L.call(Rt),Rt.push(co)),Bp){var ea={depth:Ze.depth};return Ne(Ze,"quoteStyle")&&(ea.quoteStyle=Ze.quoteStyle),Z(Ts,ea,Dt+1,Rt)}return Z(Ts,Ze,Dt+1,Rt)}if(typeof ee=="function"&&!it(ee)){var xc=ue(ee),ao=As(ee,ai);return"[Function"+(xc?": "+xc:" (anonymous)")+"]"+(ao.length>0?" { "+M.call(ao,", ")+" }":"")}if(Ae(ee)){var Tc=X?R.call(String(ee),/^(Symbol\(.*\))_[^)]*$/,"$1"):$.call(ee);return typeof ee=="object"&&!X?Kt(Tc):Tc}if(me(ee)){for(var xs="<"+F.call(String(ee.nodeName)),oo=ee.attributes||[],lo=0;lo<oo.length;lo++)xs+=" "+oo[lo].name+"="+Ie(we(oo[lo].value),"double",Ze);return xs+=">",ee.childNodes&&ee.childNodes.length&&(xs+="..."),xs+="</"+F.call(String(ee.nodeName))+">",xs}if($e(ee)){if(ee.length===0)return"[]";var Sl=As(ee,ai);return Ss&&!bl(Sl)?"["+Zs(Sl,Ss)+"]":"[ "+M.call(Sl,", ")+" ]"}if(Ge(ee)){var xl=As(ee,ai);return!("cause"in Error.prototype)&&"cause"in ee&&!se.call(ee,"cause")?"{ ["+String(ee)+"] "+M.call(C.call("[cause]: "+ai(ee.cause),xl),", ")+" }":xl.length===0?"["+String(ee)+"]":"{ ["+String(ee)+"] "+M.call(xl,", ")+" }"}if(typeof ee=="object"&&dn){if(ve&&typeof ee[ve]=="function"&&H)return H(ee,{depth:so-Dt});if(dn!=="symbol"&&typeof ee.inspect=="function")return ee.inspect()}if(T(ee)){var Dc=[];return r&&r.call(ee,function(Ts,co){Dc.push(ai(co,ee,!0)+" => "+ai(Ts,ee))}),Ir("Map",t.call(ee),Dc,Ss)}if(j(ee)){var Rc=[];return o&&o.call(ee,function(Ts){Rc.push(ai(Ts,ee))}),Ir("Set",a.call(ee),Rc,Ss)}if(S(ee))return Ei("WeakMap");if(Te(ee))return Ei("WeakSet");if(k(ee))return Ei("WeakRef");if(B(ee))return Kt(ai(Number(ee)));if(be(ee))return Kt(ai(U.call(ee)));if(ae(ee))return Kt(m.call(ee));if(st(ee))return Kt(ai(String(ee)));if(typeof window<"u"&&ee===window)return"{ [object Window] }";if(typeof globalThis<"u"&&ee===globalThis||typeof wi<"u"&&ee===wi)return"{ [object globalThis] }";if(!et(ee)&&!it(ee)){var Tl=As(ee,ai),Ic=ce?ce(ee)===Object.prototype:ee instanceof Object||ee.constructor===Object,uo=ee instanceof Object?"":"null prototype",Nc=!Ic&&ne&&Object(ee)===ee&&ne in ee?D.call(Pe(ee),8,-1):uo?"Object":"",Fp=Ic||typeof ee.constructor!="function"?"":ee.constructor.name?ee.constructor.name+" ":"",Dl=Fp+(Nc||uo?"["+M.call(C.call([],Nc||[],uo||[]),": ")+"] ":"");return Tl.length===0?Dl+"{}":Ss?Dl+"{"+Zs(Tl,Ss)+"}":Dl+"{ "+M.call(Tl,", ")+" }"}return String(ee)};function Ie(Z,ee,gt){var Dt=gt.quoteStyle||ee,Rt=fe[Dt];return Rt+Z+Rt}function we(Z){return R.call(String(Z),/"/g,"&quot;")}function Ue(Z){return!ne||!(typeof Z=="object"&&(ne in Z||typeof Z[ne]<"u"))}function $e(Z){return Pe(Z)==="[object Array]"&&Ue(Z)}function et(Z){return Pe(Z)==="[object Date]"&&Ue(Z)}function it(Z){return Pe(Z)==="[object RegExp]"&&Ue(Z)}function Ge(Z){return Pe(Z)==="[object Error]"&&Ue(Z)}function st(Z){return Pe(Z)==="[object String]"&&Ue(Z)}function B(Z){return Pe(Z)==="[object Number]"&&Ue(Z)}function ae(Z){return Pe(Z)==="[object Boolean]"&&Ue(Z)}function Ae(Z){if(X)return Z&&typeof Z=="object"&&Z instanceof Symbol;if(typeof Z=="symbol")return!0;if(!Z||typeof Z!="object"||!$)return!1;try{return $.call(Z),!0}catch{}return!1}function be(Z){if(!Z||typeof Z!="object"||!U)return!1;try{return U.call(Z),!0}catch{}return!1}var ge=Object.prototype.hasOwnProperty||function(Z){return Z in this};function Ne(Z,ee){return ge.call(Z,ee)}function Pe(Z){return v.call(Z)}function ue(Z){if(Z.name)return Z.name;var ee=A.call(E.call(Z),/^function\s*([\w$]+)/);return ee?ee[1]:null}function K(Z,ee){if(Z.indexOf)return Z.indexOf(ee);for(var gt=0,Dt=Z.length;gt<Dt;gt++)if(Z[gt]===ee)return gt;return-1}function T(Z){if(!t||!Z||typeof Z!="object")return!1;try{t.call(Z);try{a.call(Z)}catch{return!0}return Z instanceof Map}catch{}return!1}function S(Z){if(!u||!Z||typeof Z!="object")return!1;try{u.call(Z,u);try{d.call(Z,d)}catch{return!0}return Z instanceof WeakMap}catch{}return!1}function k(Z){if(!g||!Z||typeof Z!="object")return!1;try{return g.call(Z),!0}catch{}return!1}function j(Z){if(!a||!Z||typeof Z!="object")return!1;try{a.call(Z);try{t.call(Z)}catch{return!0}return Z instanceof Set}catch{}return!1}function Te(Z){if(!d||!Z||typeof Z!="object")return!1;try{d.call(Z,d);try{u.call(Z,u)}catch{return!0}return Z instanceof WeakSet}catch{}return!1}function me(Z){return!Z||typeof Z!="object"?!1:typeof HTMLElement<"u"&&Z instanceof HTMLElement?!0:typeof Z.nodeName=="string"&&typeof Z.getAttribute=="function"}function ye(Z,ee){if(Z.length>ee.maxStringLength){var gt=Z.length-ee.maxStringLength,Dt="... "+gt+" more character"+(gt>1?"s":"");return ye(D.call(Z,0,ee.maxStringLength),ee)+Dt}var Rt=De[ee.quoteStyle||"single"];Rt.lastIndex=0;var Ze=R.call(R.call(Z,Rt,"\\$1"),/[\x00-\x1f]/g,at);return Ie(Ze,"single",ee)}function at(Z){var ee=Z.charCodeAt(0),gt={8:"b",9:"t",10:"n",12:"f",13:"r"}[ee];return gt?"\\"+gt:"\\x"+(ee<16?"0":"")+_.call(ee.toString(16))}function Kt(Z){return"Object("+Z+")"}function Ei(Z){return Z+" { ? }"}function Ir(Z,ee,gt,Dt){var Rt=Dt?Zs(gt,Dt):M.call(gt,", ");return Z+" ("+ee+") {"+Rt+"}"}function bl(Z){for(var ee=0;ee<Z.length;ee++)if(K(Z[ee],`
`)>=0)return!1;return!0}function Al(Z,ee){var gt;if(Z.indent==="	")gt="	";else if(typeof Z.indent=="number"&&Z.indent>0)gt=M.call(Array(Z.indent+1)," ");else return null;return{base:gt,prev:M.call(Array(ee+1),gt)}}function Zs(Z,ee){if(Z.length===0)return"";var gt=`
`+ee.prev+ee.base;return gt+M.call(Z,","+gt)+`
`+ee.prev}function As(Z,ee){var gt=$e(Z),Dt=[];if(gt){Dt.length=Z.length;for(var Rt=0;Rt<Z.length;Rt++)Dt[Rt]=Ne(Z,Rt)?ee(Z[Rt],Z):""}var Ze=typeof q=="function"?q(Z):[],dn;if(X){dn={};for(var Bn=0;Bn<Ze.length;Bn++)dn["$"+Ze[Bn]]=Ze[Bn]}for(var Ur in Z)Ne(Z,Ur)&&(gt&&String(Number(Ur))===Ur&&Ur<Z.length||X&&dn["$"+Ur]instanceof Symbol||(w.call(/[^\w$]/,Ur)?Dt.push(ee(Ur,Z)+": "+ee(Z[Ur],Z)):Dt.push(Ur+": "+ee(Z[Ur],Z))));if(typeof q=="function")for(var fn=0;fn<Ze.length;fn++)se.call(Z,Ze[fn])&&Dt.push("["+ee(Ze[fn])+"]: "+ee(Z[Ze[fn]],Z));return Dt}return Md}var Pd,Lv;function XI(){if(Lv)return Pd;Lv=1;var i=vu(),e=_a(),t=function(o,l,u){for(var h=o,d;(d=h.next)!=null;h=d)if(d.key===l)return h.next=d.next,u||(d.next=o.next,o.next=d),d},r=function(o,l){if(o){var u=t(o,l);return u&&u.value}},n=function(o,l,u){var h=t(o,l);h?h.value=u:o.next={key:l,next:o.next,value:u}},s=function(o,l){return o?!!t(o,l):!1},a=function(o,l){if(o)return t(o,l,!0)};return Pd=function(){var l,u={assert:function(h){if(!u.has(h))throw new e("Side channel does not contain "+i(h))},delete:function(h){var d=l&&l.next,p=a(l,h);return p&&d&&d===p&&(l=void 0),!!p},get:function(h){return r(l,h)},has:function(h){return s(l,h)},set:function(h,d){l||(l={next:void 0}),n(l,h,d)}};return u},Pd}var kd,_v;function Mv(){return _v||(_v=1,kd=Object),kd}var Od,Pv;function jI(){return Pv||(Pv=1,Od=Error),Od}var Fd,kv;function zI(){return kv||(kv=1,Fd=EvalError),Fd}var Bd,Ov;function JI(){return Ov||(Ov=1,Bd=RangeError),Bd}var Ud,Fv;function QI(){return Fv||(Fv=1,Ud=ReferenceError),Ud}var $d,Bv;function ZI(){return Bv||(Bv=1,$d=SyntaxError),$d}var Gd,Uv;function eN(){return Uv||(Uv=1,Gd=URIError),Gd}var qd,$v;function tN(){return $v||($v=1,qd=Math.abs),qd}var Vd,Gv;function rN(){return Gv||(Gv=1,Vd=Math.floor),Vd}var Hd,qv;function iN(){return qv||(qv=1,Hd=Math.max),Hd}var Kd,Vv;function nN(){return Vv||(Vv=1,Kd=Math.min),Kd}var Wd,Hv;function sN(){return Hv||(Hv=1,Wd=Math.pow),Wd}var Yd,Kv;function aN(){return Kv||(Kv=1,Yd=Math.round),Yd}var Xd,Wv;function oN(){return Wv||(Wv=1,Xd=Number.isNaN||function(e){return e!==e}),Xd}var jd,Yv;function lN(){if(Yv)return jd;Yv=1;var i=oN();return jd=function(t){return i(t)||t===0?t:t<0?-1:1},jd}var zd,Xv;function uN(){return Xv||(Xv=1,zd=Object.getOwnPropertyDescriptor),zd}var Jd,jv;function zv(){if(jv)return Jd;jv=1;var i=uN();if(i)try{i([],"length")}catch{i=null}return Jd=i,Jd}var Qd,Jv;function cN(){if(Jv)return Qd;Jv=1;var i=Object.defineProperty||!1;if(i)try{i({},"a",{value:1})}catch{i=!1}return Qd=i,Qd}var Zd,Qv;function hN(){return Qv||(Qv=1,Zd=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var e={},t=Symbol("test"),r=Object(t);if(typeof t=="string"||Object.prototype.toString.call(t)!=="[object Symbol]"||Object.prototype.toString.call(r)!=="[object Symbol]")return!1;var n=42;e[t]=n;for(var s in e)return!1;if(typeof Object.keys=="function"&&Object.keys(e).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(e).length!==0)return!1;var a=Object.getOwnPropertySymbols(e);if(a.length!==1||a[0]!==t||!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var o=Object.getOwnPropertyDescriptor(e,t);if(o.value!==n||o.enumerable!==!0)return!1}return!0}),Zd}var ef,Zv;function dN(){if(Zv)return ef;Zv=1;var i=typeof Symbol<"u"&&Symbol,e=hN();return ef=function(){return typeof i!="function"||typeof Symbol!="function"||typeof i("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:e()},ef}var tf,e1;function t1(){return e1||(e1=1,tf=typeof Reflect<"u"&&Reflect.getPrototypeOf||null),tf}var rf,r1;function i1(){if(r1)return rf;r1=1;var i=Mv();return rf=i.getPrototypeOf||null,rf}var nf,n1;function fN(){if(n1)return nf;n1=1;var i="Function.prototype.bind called on incompatible ",e=Object.prototype.toString,t=Math.max,r="[object Function]",n=function(l,u){for(var h=[],d=0;d<l.length;d+=1)h[d]=l[d];for(var p=0;p<u.length;p+=1)h[p+l.length]=u[p];return h},s=function(l,u){for(var h=[],d=u,p=0;d<l.length;d+=1,p+=1)h[p]=l[d];return h},a=function(o,l){for(var u="",h=0;h<o.length;h+=1)u+=o[h],h+1<o.length&&(u+=l);return u};return nf=function(l){var u=this;if(typeof u!="function"||e.apply(u)!==r)throw new TypeError(i+u);for(var h=s(arguments,1),d,p=function(){if(this instanceof d){var A=u.apply(this,n(h,arguments));return Object(A)===A?A:this}return u.apply(l,n(h,arguments))},g=t(0,u.length-h.length),m=[],v=0;v<g;v++)m[v]="$"+v;if(d=Function("binder","return function ("+a(m,",")+"){ return binder.apply(this,arguments); }")(p),u.prototype){var E=function(){};E.prototype=u.prototype,d.prototype=new E,E.prototype=null}return d},nf}var sf,s1;function Eu(){if(s1)return sf;s1=1;var i=fN();return sf=Function.prototype.bind||i,sf}var af,a1;function of(){return a1||(a1=1,af=Function.prototype.call),af}var lf,o1;function l1(){return o1||(o1=1,lf=Function.prototype.apply),lf}var uf,u1;function gN(){return u1||(u1=1,uf=typeof Reflect<"u"&&Reflect&&Reflect.apply),uf}var cf,c1;function pN(){if(c1)return cf;c1=1;var i=Eu(),e=l1(),t=of(),r=gN();return cf=r||i.call(t,e),cf}var hf,h1;function d1(){if(h1)return hf;h1=1;var i=Eu(),e=_a(),t=of(),r=pN();return hf=function(s){if(s.length<1||typeof s[0]!="function")throw new e("a function is required");return r(i,t,s)},hf}var df,f1;function mN(){if(f1)return df;f1=1;var i=d1(),e=zv(),t;try{t=[].__proto__===Array.prototype}catch(a){if(!a||typeof a!="object"||!("code"in a)||a.code!=="ERR_PROTO_ACCESS")throw a}var r=!!t&&e&&e(Object.prototype,"__proto__"),n=Object,s=n.getPrototypeOf;return df=r&&typeof r.get=="function"?i([r.get]):typeof s=="function"?function(o){return s(o==null?o:n(o))}:!1,df}var ff,g1;function yN(){if(g1)return ff;g1=1;var i=t1(),e=i1(),t=mN();return ff=i?function(n){return i(n)}:e?function(n){if(!n||typeof n!="object"&&typeof n!="function")throw new TypeError("getProto: not an object");return e(n)}:t?function(n){return t(n)}:null,ff}var gf,p1;function vN(){if(p1)return gf;p1=1;var i=Function.prototype.call,e=Object.prototype.hasOwnProperty,t=Eu();return gf=t.call(i,e),gf}var pf,m1;function mf(){if(m1)return pf;m1=1;var i,e=Mv(),t=jI(),r=zI(),n=JI(),s=QI(),a=ZI(),o=_a(),l=eN(),u=tN(),h=rN(),d=iN(),p=nN(),g=sN(),m=aN(),v=lN(),E=Function,A=function(it){try{return E('"use strict"; return ('+it+").constructor;")()}catch{}},D=zv(),R=cN(),_=function(){throw new o},F=D?function(){try{return arguments.callee,_}catch{try{return D(arguments,"callee").get}catch{return _}}}():_,w=dN()(),C=yN(),M=i1(),L=t1(),I=l1(),U=of(),q={},$=typeof Uint8Array>"u"||!C?i:C(Uint8Array),X={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?i:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?i:ArrayBuffer,"%ArrayIteratorPrototype%":w&&C?C([][Symbol.iterator]()):i,"%AsyncFromSyncIteratorPrototype%":i,"%AsyncFunction%":q,"%AsyncGenerator%":q,"%AsyncGeneratorFunction%":q,"%AsyncIteratorPrototype%":q,"%Atomics%":typeof Atomics>"u"?i:Atomics,"%BigInt%":typeof BigInt>"u"?i:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?i:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?i:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?i:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":t,"%eval%":eval,"%EvalError%":r,"%Float16Array%":typeof Float16Array>"u"?i:Float16Array,"%Float32Array%":typeof Float32Array>"u"?i:Float32Array,"%Float64Array%":typeof Float64Array>"u"?i:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?i:FinalizationRegistry,"%Function%":E,"%GeneratorFunction%":q,"%Int8Array%":typeof Int8Array>"u"?i:Int8Array,"%Int16Array%":typeof Int16Array>"u"?i:Int16Array,"%Int32Array%":typeof Int32Array>"u"?i:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":w&&C?C(C([][Symbol.iterator]())):i,"%JSON%":typeof JSON=="object"?JSON:i,"%Map%":typeof Map>"u"?i:Map,"%MapIteratorPrototype%":typeof Map>"u"||!w||!C?i:C(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":e,"%Object.getOwnPropertyDescriptor%":D,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?i:Promise,"%Proxy%":typeof Proxy>"u"?i:Proxy,"%RangeError%":n,"%ReferenceError%":s,"%Reflect%":typeof Reflect>"u"?i:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?i:Set,"%SetIteratorPrototype%":typeof Set>"u"||!w||!C?i:C(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?i:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":w&&C?C(""[Symbol.iterator]()):i,"%Symbol%":w?Symbol:i,"%SyntaxError%":a,"%ThrowTypeError%":F,"%TypedArray%":$,"%TypeError%":o,"%Uint8Array%":typeof Uint8Array>"u"?i:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?i:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?i:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?i:Uint32Array,"%URIError%":l,"%WeakMap%":typeof WeakMap>"u"?i:WeakMap,"%WeakRef%":typeof WeakRef>"u"?i:WeakRef,"%WeakSet%":typeof WeakSet>"u"?i:WeakSet,"%Function.prototype.call%":U,"%Function.prototype.apply%":I,"%Object.defineProperty%":R,"%Object.getPrototypeOf%":M,"%Math.abs%":u,"%Math.floor%":h,"%Math.max%":d,"%Math.min%":p,"%Math.pow%":g,"%Math.round%":m,"%Math.sign%":v,"%Reflect.getPrototypeOf%":L};if(C)try{null.error}catch(it){var ne=C(C(it));X["%Error.prototype%"]=ne}var se=function it(Ge){var st;if(Ge==="%AsyncFunction%")st=A("async function () {}");else if(Ge==="%GeneratorFunction%")st=A("function* () {}");else if(Ge==="%AsyncGeneratorFunction%")st=A("async function* () {}");else if(Ge==="%AsyncGenerator%"){var B=it("%AsyncGeneratorFunction%");B&&(st=B.prototype)}else if(Ge==="%AsyncIteratorPrototype%"){var ae=it("%AsyncGenerator%");ae&&C&&(st=C(ae.prototype))}return X[Ge]=st,st},ce={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},ie=Eu(),H=vN(),J=ie.call(U,Array.prototype.concat),ve=ie.call(I,Array.prototype.splice),fe=ie.call(U,String.prototype.replace),De=ie.call(U,String.prototype.slice),Ie=ie.call(U,RegExp.prototype.exec),we=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,Ue=/\\(\\)?/g,$e=function(Ge){var st=De(Ge,0,1),B=De(Ge,-1);if(st==="%"&&B!=="%")throw new a("invalid intrinsic syntax, expected closing `%`");if(B==="%"&&st!=="%")throw new a("invalid intrinsic syntax, expected opening `%`");var ae=[];return fe(Ge,we,function(Ae,be,ge,Ne){ae[ae.length]=ge?fe(Ne,Ue,"$1"):be||Ae}),ae},et=function(Ge,st){var B=Ge,ae;if(H(ce,B)&&(ae=ce[B],B="%"+ae[0]+"%"),H(X,B)){var Ae=X[B];if(Ae===q&&(Ae=se(B)),typeof Ae>"u"&&!st)throw new o("intrinsic "+Ge+" exists, but is not available. Please file an issue!");return{alias:ae,name:B,value:Ae}}throw new a("intrinsic "+Ge+" does not exist!")};return pf=function(Ge,st){if(typeof Ge!="string"||Ge.length===0)throw new o("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof st!="boolean")throw new o('"allowMissing" argument must be a boolean');if(Ie(/^%?[^%]*%?$/,Ge)===null)throw new a("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var B=$e(Ge),ae=B.length>0?B[0]:"",Ae=et("%"+ae+"%",st),be=Ae.name,ge=Ae.value,Ne=!1,Pe=Ae.alias;Pe&&(ae=Pe[0],ve(B,J([0,1],Pe)));for(var ue=1,K=!0;ue<B.length;ue+=1){var T=B[ue],S=De(T,0,1),k=De(T,-1);if((S==='"'||S==="'"||S==="`"||k==='"'||k==="'"||k==="`")&&S!==k)throw new a("property names with quotes must have matching quotes");if((T==="constructor"||!K)&&(Ne=!0),ae+="."+T,be="%"+ae+"%",H(X,be))ge=X[be];else if(ge!=null){if(!(T in ge)){if(!st)throw new o("base intrinsic for "+Ge+" exists, but the property is not available.");return}if(D&&ue+1>=B.length){var j=D(ge,T);K=!!j,K&&"get"in j&&!("originalValue"in j.get)?ge=j.get:ge=ge[T]}else K=H(ge,T),ge=ge[T];K&&!Ne&&(X[be]=ge)}}return ge},pf}var yf,y1;function v1(){if(y1)return yf;y1=1;var i=mf(),e=d1(),t=e([i("%String.prototype.indexOf%")]);return yf=function(n,s){var a=i(n,!!s);return typeof a=="function"&&t(n,".prototype.")>-1?e([a]):a},yf}var vf,E1;function b1(){if(E1)return vf;E1=1;var i=mf(),e=v1(),t=vu(),r=_a(),n=i("%Map%",!0),s=e("Map.prototype.get",!0),a=e("Map.prototype.set",!0),o=e("Map.prototype.has",!0),l=e("Map.prototype.delete",!0),u=e("Map.prototype.size",!0);return vf=!!n&&function(){var d,p={assert:function(g){if(!p.has(g))throw new r("Side channel does not contain "+t(g))},delete:function(g){if(d){var m=l(d,g);return u(d)===0&&(d=void 0),m}return!1},get:function(g){if(d)return s(d,g)},has:function(g){return d?o(d,g):!1},set:function(g,m){d||(d=new n),a(d,g,m)}};return p},vf}var Ef,A1;function EN(){if(A1)return Ef;A1=1;var i=mf(),e=v1(),t=vu(),r=b1(),n=_a(),s=i("%WeakMap%",!0),a=e("WeakMap.prototype.get",!0),o=e("WeakMap.prototype.set",!0),l=e("WeakMap.prototype.has",!0),u=e("WeakMap.prototype.delete",!0);return Ef=s?function(){var d,p,g={assert:function(m){if(!g.has(m))throw new n("Side channel does not contain "+t(m))},delete:function(m){if(s&&m&&(typeof m=="object"||typeof m=="function")){if(d)return u(d,m)}else if(r&&p)return p.delete(m);return!1},get:function(m){return s&&m&&(typeof m=="object"||typeof m=="function")&&d?a(d,m):p&&p.get(m)},has:function(m){return s&&m&&(typeof m=="object"||typeof m=="function")&&d?l(d,m):!!p&&p.has(m)},set:function(m,v){s&&m&&(typeof m=="object"||typeof m=="function")?(d||(d=new s),o(d,m,v)):r&&(p||(p=r()),p.set(m,v))}};return g}:r,Ef}var bf,S1;function bN(){if(S1)return bf;S1=1;var i=_a(),e=vu(),t=XI(),r=b1(),n=EN(),s=n||r||t;return bf=function(){var o,l={assert:function(u){if(!l.has(u))throw new i("Side channel does not contain "+e(u))},delete:function(u){return!!o&&o.delete(u)},get:function(u){return o&&o.get(u)},has:function(u){return!!o&&o.has(u)},set:function(u,h){o||(o=s()),o.set(u,h)}};return l},bf}var Af,x1;function Sf(){if(x1)return Af;x1=1;var i=String.prototype.replace,e=/%20/g,t={RFC1738:"RFC1738",RFC3986:"RFC3986"};return Af={default:t.RFC3986,formatters:{RFC1738:function(r){return i.call(r,e,"+")},RFC3986:function(r){return String(r)}},RFC1738:t.RFC1738,RFC3986:t.RFC3986},Af}var xf,T1;function D1(){if(T1)return xf;T1=1;var i=Sf(),e=Object.prototype.hasOwnProperty,t=Array.isArray,r=function(){for(var E=[],A=0;A<256;++A)E.push("%"+((A<16?"0":"")+A.toString(16)).toUpperCase());return E}(),n=function(A){for(;A.length>1;){var D=A.pop(),R=D.obj[D.prop];if(t(R)){for(var _=[],F=0;F<R.length;++F)typeof R[F]<"u"&&_.push(R[F]);D.obj[D.prop]=_}}},s=function(A,D){for(var R=D&&D.plainObjects?{__proto__:null}:{},_=0;_<A.length;++_)typeof A[_]<"u"&&(R[_]=A[_]);return R},a=function E(A,D,R){if(!D)return A;if(typeof D!="object"&&typeof D!="function"){if(t(A))A.push(D);else if(A&&typeof A=="object")(R&&(R.plainObjects||R.allowPrototypes)||!e.call(Object.prototype,D))&&(A[D]=!0);else return[A,D];return A}if(!A||typeof A!="object")return[A].concat(D);var _=A;return t(A)&&!t(D)&&(_=s(A,R)),t(A)&&t(D)?(D.forEach(function(F,w){if(e.call(A,w)){var C=A[w];C&&typeof C=="object"&&F&&typeof F=="object"?A[w]=E(C,F,R):A.push(F)}else A[w]=F}),A):Object.keys(D).reduce(function(F,w){var C=D[w];return e.call(F,w)?F[w]=E(F[w],C,R):F[w]=C,F},_)},o=function(A,D){return Object.keys(D).reduce(function(R,_){return R[_]=D[_],R},A)},l=function(E,A,D){var R=E.replace(/\+/g," ");if(D==="iso-8859-1")return R.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(R)}catch{return R}},u=1024,h=function(A,D,R,_,F){if(A.length===0)return A;var w=A;if(typeof A=="symbol"?w=Symbol.prototype.toString.call(A):typeof A!="string"&&(w=String(A)),R==="iso-8859-1")return escape(w).replace(/%u[0-9a-f]{4}/gi,function($){return"%26%23"+parseInt($.slice(2),16)+"%3B"});for(var C="",M=0;M<w.length;M+=u){for(var L=w.length>=u?w.slice(M,M+u):w,I=[],U=0;U<L.length;++U){var q=L.charCodeAt(U);if(q===45||q===46||q===95||q===126||q>=48&&q<=57||q>=65&&q<=90||q>=97&&q<=122||F===i.RFC1738&&(q===40||q===41)){I[I.length]=L.charAt(U);continue}if(q<128){I[I.length]=r[q];continue}if(q<2048){I[I.length]=r[192|q>>6]+r[128|q&63];continue}if(q<55296||q>=57344){I[I.length]=r[224|q>>12]+r[128|q>>6&63]+r[128|q&63];continue}U+=1,q=65536+((q&1023)<<10|L.charCodeAt(U)&1023),I[I.length]=r[240|q>>18]+r[128|q>>12&63]+r[128|q>>6&63]+r[128|q&63]}C+=I.join("")}return C},d=function(A){for(var D=[{obj:{o:A},prop:"o"}],R=[],_=0;_<D.length;++_)for(var F=D[_],w=F.obj[F.prop],C=Object.keys(w),M=0;M<C.length;++M){var L=C[M],I=w[L];typeof I=="object"&&I!==null&&R.indexOf(I)===-1&&(D.push({obj:w,prop:L}),R.push(I))}return n(D),A},p=function(A){return Object.prototype.toString.call(A)==="[object RegExp]"},g=function(A){return!A||typeof A!="object"?!1:!!(A.constructor&&A.constructor.isBuffer&&A.constructor.isBuffer(A))},m=function(A,D){return[].concat(A,D)},v=function(A,D){if(t(A)){for(var R=[],_=0;_<A.length;_+=1)R.push(D(A[_]));return R}return D(A)};return xf={arrayToObject:s,assign:o,combine:m,compact:d,decode:l,encode:h,isBuffer:g,isRegExp:p,maybeMap:v,merge:a},xf}var Tf,R1;function AN(){if(R1)return Tf;R1=1;var i=bN(),e=D1(),t=Sf(),r=Object.prototype.hasOwnProperty,n={brackets:function(E){return E+"[]"},comma:"comma",indices:function(E,A){return E+"["+A+"]"},repeat:function(E){return E}},s=Array.isArray,a=Array.prototype.push,o=function(v,E){a.apply(v,s(E)?E:[E])},l=Date.prototype.toISOString,u=t.default,h={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,commaRoundTrip:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:e.encode,encodeValuesOnly:!1,filter:void 0,format:u,formatter:t.formatters[u],indices:!1,serializeDate:function(E){return l.call(E)},skipNulls:!1,strictNullHandling:!1},d=function(E){return typeof E=="string"||typeof E=="number"||typeof E=="boolean"||typeof E=="symbol"||typeof E=="bigint"},p={},g=function v(E,A,D,R,_,F,w,C,M,L,I,U,q,$,X,ne,se,ce){for(var ie=E,H=ce,J=0,ve=!1;(H=H.get(p))!==void 0&&!ve;){var fe=H.get(E);if(J+=1,typeof fe<"u"){if(fe===J)throw new RangeError("Cyclic object value");ve=!0}typeof H.get(p)>"u"&&(J=0)}if(typeof L=="function"?ie=L(A,ie):ie instanceof Date?ie=q(ie):D==="comma"&&s(ie)&&(ie=e.maybeMap(ie,function(be){return be instanceof Date?q(be):be})),ie===null){if(F)return M&&!ne?M(A,h.encoder,se,"key",$):A;ie=""}if(d(ie)||e.isBuffer(ie)){if(M){var De=ne?A:M(A,h.encoder,se,"key",$);return[X(De)+"="+X(M(ie,h.encoder,se,"value",$))]}return[X(A)+"="+X(String(ie))]}var Ie=[];if(typeof ie>"u")return Ie;var we;if(D==="comma"&&s(ie))ne&&M&&(ie=e.maybeMap(ie,M)),we=[{value:ie.length>0?ie.join(",")||null:void 0}];else if(s(L))we=L;else{var Ue=Object.keys(ie);we=I?Ue.sort(I):Ue}var $e=C?String(A).replace(/\./g,"%2E"):String(A),et=R&&s(ie)&&ie.length===1?$e+"[]":$e;if(_&&s(ie)&&ie.length===0)return et+"[]";for(var it=0;it<we.length;++it){var Ge=we[it],st=typeof Ge=="object"&&Ge&&typeof Ge.value<"u"?Ge.value:ie[Ge];if(!(w&&st===null)){var B=U&&C?String(Ge).replace(/\./g,"%2E"):String(Ge),ae=s(ie)?typeof D=="function"?D(et,B):et:et+(U?"."+B:"["+B+"]");ce.set(E,J);var Ae=i();Ae.set(p,ce),o(Ie,v(st,ae,D,R,_,F,w,C,D==="comma"&&ne&&s(ie)?null:M,L,I,U,q,$,X,ne,se,Ae))}}return Ie},m=function(E){if(!E)return h;if(typeof E.allowEmptyArrays<"u"&&typeof E.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof E.encodeDotInKeys<"u"&&typeof E.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(E.encoder!==null&&typeof E.encoder<"u"&&typeof E.encoder!="function")throw new TypeError("Encoder has to be a function.");var A=E.charset||h.charset;if(typeof E.charset<"u"&&E.charset!=="utf-8"&&E.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var D=t.default;if(typeof E.format<"u"){if(!r.call(t.formatters,E.format))throw new TypeError("Unknown format option provided.");D=E.format}var R=t.formatters[D],_=h.filter;(typeof E.filter=="function"||s(E.filter))&&(_=E.filter);var F;if(E.arrayFormat in n?F=E.arrayFormat:"indices"in E?F=E.indices?"indices":"repeat":F=h.arrayFormat,"commaRoundTrip"in E&&typeof E.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var w=typeof E.allowDots>"u"?E.encodeDotInKeys===!0?!0:h.allowDots:!!E.allowDots;return{addQueryPrefix:typeof E.addQueryPrefix=="boolean"?E.addQueryPrefix:h.addQueryPrefix,allowDots:w,allowEmptyArrays:typeof E.allowEmptyArrays=="boolean"?!!E.allowEmptyArrays:h.allowEmptyArrays,arrayFormat:F,charset:A,charsetSentinel:typeof E.charsetSentinel=="boolean"?E.charsetSentinel:h.charsetSentinel,commaRoundTrip:!!E.commaRoundTrip,delimiter:typeof E.delimiter>"u"?h.delimiter:E.delimiter,encode:typeof E.encode=="boolean"?E.encode:h.encode,encodeDotInKeys:typeof E.encodeDotInKeys=="boolean"?E.encodeDotInKeys:h.encodeDotInKeys,encoder:typeof E.encoder=="function"?E.encoder:h.encoder,encodeValuesOnly:typeof E.encodeValuesOnly=="boolean"?E.encodeValuesOnly:h.encodeValuesOnly,filter:_,format:D,formatter:R,serializeDate:typeof E.serializeDate=="function"?E.serializeDate:h.serializeDate,skipNulls:typeof E.skipNulls=="boolean"?E.skipNulls:h.skipNulls,sort:typeof E.sort=="function"?E.sort:null,strictNullHandling:typeof E.strictNullHandling=="boolean"?E.strictNullHandling:h.strictNullHandling}};return Tf=function(v,E){var A=v,D=m(E),R,_;typeof D.filter=="function"?(_=D.filter,A=_("",A)):s(D.filter)&&(_=D.filter,R=_);var F=[];if(typeof A!="object"||A===null)return"";var w=n[D.arrayFormat],C=w==="comma"&&D.commaRoundTrip;R||(R=Object.keys(A)),D.sort&&R.sort(D.sort);for(var M=i(),L=0;L<R.length;++L){var I=R[L],U=A[I];D.skipNulls&&U===null||o(F,g(U,I,w,C,D.allowEmptyArrays,D.strictNullHandling,D.skipNulls,D.encodeDotInKeys,D.encode?D.encoder:null,D.filter,D.sort,D.allowDots,D.serializeDate,D.format,D.formatter,D.encodeValuesOnly,D.charset,M))}var q=F.join(D.delimiter),$=D.addQueryPrefix===!0?"?":"";return D.charsetSentinel&&(D.charset==="iso-8859-1"?$+="utf8=%26%2310003%3B&":$+="utf8=%E2%9C%93&"),q.length>0?$+q:""},Tf}var Df,I1;function SN(){if(I1)return Df;I1=1;var i=D1(),e=Object.prototype.hasOwnProperty,t=Array.isArray,r={allowDots:!1,allowEmptyArrays:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decodeDotInKeys:!1,decoder:i.decode,delimiter:"&",depth:5,duplicates:"combine",ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictDepth:!1,strictNullHandling:!1,throwOnLimitExceeded:!1},n=function(p){return p.replace(/&#(\d+);/g,function(g,m){return String.fromCharCode(parseInt(m,10))})},s=function(p,g,m){if(p&&typeof p=="string"&&g.comma&&p.indexOf(",")>-1)return p.split(",");if(g.throwOnLimitExceeded&&m>=g.arrayLimit)throw new RangeError("Array limit exceeded. Only "+g.arrayLimit+" element"+(g.arrayLimit===1?"":"s")+" allowed in an array.");return p},a="utf8=%26%2310003%3B",o="utf8=%E2%9C%93",l=function(g,m){var v={__proto__:null},E=m.ignoreQueryPrefix?g.replace(/^\?/,""):g;E=E.replace(/%5B/gi,"[").replace(/%5D/gi,"]");var A=m.parameterLimit===1/0?void 0:m.parameterLimit,D=E.split(m.delimiter,m.throwOnLimitExceeded?A+1:A);if(m.throwOnLimitExceeded&&D.length>A)throw new RangeError("Parameter limit exceeded. Only "+A+" parameter"+(A===1?"":"s")+" allowed.");var R=-1,_,F=m.charset;if(m.charsetSentinel)for(_=0;_<D.length;++_)D[_].indexOf("utf8=")===0&&(D[_]===o?F="utf-8":D[_]===a&&(F="iso-8859-1"),R=_,_=D.length);for(_=0;_<D.length;++_)if(_!==R){var w=D[_],C=w.indexOf("]="),M=C===-1?w.indexOf("="):C+1,L,I;M===-1?(L=m.decoder(w,r.decoder,F,"key"),I=m.strictNullHandling?null:""):(L=m.decoder(w.slice(0,M),r.decoder,F,"key"),I=i.maybeMap(s(w.slice(M+1),m,t(v[L])?v[L].length:0),function(q){return m.decoder(q,r.decoder,F,"value")})),I&&m.interpretNumericEntities&&F==="iso-8859-1"&&(I=n(String(I))),w.indexOf("[]=")>-1&&(I=t(I)?[I]:I);var U=e.call(v,L);U&&m.duplicates==="combine"?v[L]=i.combine(v[L],I):(!U||m.duplicates==="last")&&(v[L]=I)}return v},u=function(p,g,m,v){var E=0;if(p.length>0&&p[p.length-1]==="[]"){var A=p.slice(0,-1).join("");E=Array.isArray(g)&&g[A]?g[A].length:0}for(var D=v?g:s(g,m,E),R=p.length-1;R>=0;--R){var _,F=p[R];if(F==="[]"&&m.parseArrays)_=m.allowEmptyArrays&&(D===""||m.strictNullHandling&&D===null)?[]:i.combine([],D);else{_=m.plainObjects?{__proto__:null}:{};var w=F.charAt(0)==="["&&F.charAt(F.length-1)==="]"?F.slice(1,-1):F,C=m.decodeDotInKeys?w.replace(/%2E/g,"."):w,M=parseInt(C,10);!m.parseArrays&&C===""?_={0:D}:!isNaN(M)&&F!==C&&String(M)===C&&M>=0&&m.parseArrays&&M<=m.arrayLimit?(_=[],_[M]=D):C!=="__proto__"&&(_[C]=D)}D=_}return D},h=function(g,m,v,E){if(g){var A=v.allowDots?g.replace(/\.([^.[]+)/g,"[$1]"):g,D=/(\[[^[\]]*])/,R=/(\[[^[\]]*])/g,_=v.depth>0&&D.exec(A),F=_?A.slice(0,_.index):A,w=[];if(F){if(!v.plainObjects&&e.call(Object.prototype,F)&&!v.allowPrototypes)return;w.push(F)}for(var C=0;v.depth>0&&(_=R.exec(A))!==null&&C<v.depth;){if(C+=1,!v.plainObjects&&e.call(Object.prototype,_[1].slice(1,-1))&&!v.allowPrototypes)return;w.push(_[1])}if(_){if(v.strictDepth===!0)throw new RangeError("Input depth exceeded depth option of "+v.depth+" and strictDepth is true");w.push("["+A.slice(_.index)+"]")}return u(w,m,v,E)}},d=function(g){if(!g)return r;if(typeof g.allowEmptyArrays<"u"&&typeof g.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof g.decodeDotInKeys<"u"&&typeof g.decodeDotInKeys!="boolean")throw new TypeError("`decodeDotInKeys` option can only be `true` or `false`, when provided");if(g.decoder!==null&&typeof g.decoder<"u"&&typeof g.decoder!="function")throw new TypeError("Decoder has to be a function.");if(typeof g.charset<"u"&&g.charset!=="utf-8"&&g.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");if(typeof g.throwOnLimitExceeded<"u"&&typeof g.throwOnLimitExceeded!="boolean")throw new TypeError("`throwOnLimitExceeded` option must be a boolean");var m=typeof g.charset>"u"?r.charset:g.charset,v=typeof g.duplicates>"u"?r.duplicates:g.duplicates;if(v!=="combine"&&v!=="first"&&v!=="last")throw new TypeError("The duplicates option must be either combine, first, or last");var E=typeof g.allowDots>"u"?g.decodeDotInKeys===!0?!0:r.allowDots:!!g.allowDots;return{allowDots:E,allowEmptyArrays:typeof g.allowEmptyArrays=="boolean"?!!g.allowEmptyArrays:r.allowEmptyArrays,allowPrototypes:typeof g.allowPrototypes=="boolean"?g.allowPrototypes:r.allowPrototypes,allowSparse:typeof g.allowSparse=="boolean"?g.allowSparse:r.allowSparse,arrayLimit:typeof g.arrayLimit=="number"?g.arrayLimit:r.arrayLimit,charset:m,charsetSentinel:typeof g.charsetSentinel=="boolean"?g.charsetSentinel:r.charsetSentinel,comma:typeof g.comma=="boolean"?g.comma:r.comma,decodeDotInKeys:typeof g.decodeDotInKeys=="boolean"?g.decodeDotInKeys:r.decodeDotInKeys,decoder:typeof g.decoder=="function"?g.decoder:r.decoder,delimiter:typeof g.delimiter=="string"||i.isRegExp(g.delimiter)?g.delimiter:r.delimiter,depth:typeof g.depth=="number"||g.depth===!1?+g.depth:r.depth,duplicates:v,ignoreQueryPrefix:g.ignoreQueryPrefix===!0,interpretNumericEntities:typeof g.interpretNumericEntities=="boolean"?g.interpretNumericEntities:r.interpretNumericEntities,parameterLimit:typeof g.parameterLimit=="number"?g.parameterLimit:r.parameterLimit,parseArrays:g.parseArrays!==!1,plainObjects:typeof g.plainObjects=="boolean"?g.plainObjects:r.plainObjects,strictDepth:typeof g.strictDepth=="boolean"?!!g.strictDepth:r.strictDepth,strictNullHandling:typeof g.strictNullHandling=="boolean"?g.strictNullHandling:r.strictNullHandling,throwOnLimitExceeded:typeof g.throwOnLimitExceeded=="boolean"?g.throwOnLimitExceeded:!1}};return Df=function(p,g){var m=d(g);if(p===""||p===null||typeof p>"u")return m.plainObjects?{__proto__:null}:{};for(var v=typeof p=="string"?l(p,m):p,E=m.plainObjects?{__proto__:null}:{},A=Object.keys(v),D=0;D<A.length;++D){var R=A[D],_=h(R,v[R],m,typeof p=="string");E=i.merge(E,_,m)}return m.allowSparse===!0?E:i.compact(E)},Df}var Rf,N1;function xN(){if(N1)return Rf;N1=1;var i=AN(),e=SN(),t=Sf();return Rf={formats:t,parse:e,stringify:i},Rf}var C1=xN();const TN=Vs(C1);class Ma{buildVideoId(e,t){if(e.buildType==="join"){if(e.buildParams)return e.prefix!==void 0?e.prefix+t.join(e.buildParams[0]):t.join(e.buildParams[0]);throw console.log("ID extraction rule is configured with join method, but no separator is configured in buildParams",e),new Error("ID extraction rule is configured with join method, but no separator is configured in buildParams")}else return e.prefix!==void 0?e.prefix+t.join(""):t.join("")}}class DN extends Ma{getVideoId(e,t){if(It.isEmpty(e.values))throw console.error("Video ID extraction rule missing values property",e),new Error("Video ID extraction rule missing values property");let r=t.getParam("matchUrl")??window.location.href;const n=t.computeParsedQsIfAbsent(()=>C1.parse(new URL(r).search.substring(1))),s=Qr.of(e.values).map(a=>n[a]??e.defaultValue).toArray();return this.buildVideoId(e,s)}}var Qi={},w1;function RN(){if(w1)return Qi;w1=1,Object.defineProperty(Qi,"__esModule",{value:!0}),Qi.TokenData=void 0,Qi.parse=d,Qi.compile=p,Qi.match=v,Qi.pathToRegexp=E,Qi.stringify=_;const i="/",e=C=>C,t=/^[$_\p{ID_Start}]$/u,r=/^[$\u200c\u200d\p{ID_Continue}]$/u,n="https://git.new/pathToRegexpError",s={"{":"{","}":"}","(":"(",")":")","[":"[","]":"]","+":"+","?":"?","!":"!"};function a(C){return C.replace(/[{}()\[\]+?!:*]/g,"\\$&")}function o(C){return C.replace(/[.+*?^${}()[\]|/\\]/g,"\\$&")}function*l(C){const M=[...C];let L=0;function I(){let U="";if(t.test(M[++L]))for(U+=M[L];r.test(M[++L]);)U+=M[L];else if(M[L]==='"'){let q=L;for(;L<M.length;){if(M[++L]==='"'){L++,q=0;break}M[L]==="\\"?U+=M[++L]:U+=M[L]}if(q)throw new TypeError(`Unterminated quote at ${q}: ${n}`)}if(!U)throw new TypeError(`Missing parameter name at ${L}: ${n}`);return U}for(;L<M.length;){const U=M[L],q=s[U];if(q)yield{type:q,index:L++,value:U};else if(U==="\\")yield{type:"ESCAPED",index:L++,value:M[L++]};else if(U===":"){const $=I();yield{type:"PARAM",index:L,value:$}}else if(U==="*"){const $=I();yield{type:"WILDCARD",index:L,value:$}}else yield{type:"CHAR",index:L,value:M[L++]}}return{type:"END",index:L,value:""}}class u{constructor(M){this.tokens=M}peek(){if(!this._peek){const M=this.tokens.next();this._peek=M.value}return this._peek}tryConsume(M){const L=this.peek();if(L.type===M)return this._peek=void 0,L.value}consume(M){const L=this.tryConsume(M);if(L!==void 0)return L;const{type:I,index:U}=this.peek();throw new TypeError(`Unexpected ${I} at ${U}, expected ${M}: ${n}`)}text(){let M="",L;for(;L=this.tryConsume("CHAR")||this.tryConsume("ESCAPED");)M+=L;return M}}class h{constructor(M){this.tokens=M}}Qi.TokenData=h;function d(C,M={}){const{encodePath:L=e}=M,I=new u(l(C));function U($){const X=[];for(;;){const ne=I.text();ne&&X.push({type:"text",value:L(ne)});const se=I.tryConsume("PARAM");if(se){X.push({type:"param",name:se});continue}const ce=I.tryConsume("WILDCARD");if(ce){X.push({type:"wildcard",name:ce});continue}if(I.tryConsume("{")){X.push({type:"group",tokens:U("}")});continue}return I.consume($),X}}const q=U("END");return new h(q)}function p(C,M={}){const{encode:L=encodeURIComponent,delimiter:I=i}=M,U=C instanceof h?C:d(C,M),q=g(U.tokens,I,L);return function(X={}){const[ne,...se]=q(X);if(se.length)throw new TypeError(`Missing parameters: ${se.join(", ")}`);return ne}}function g(C,M,L){const I=C.map(U=>m(U,M,L));return U=>{const q=[""];for(const $ of I){const[X,...ne]=$(U);q[0]+=X,q.push(...ne)}return q}}function m(C,M,L){if(C.type==="text")return()=>[C.value];if(C.type==="group"){const U=g(C.tokens,M,L);return q=>{const[$,...X]=U(q);return X.length?[""]:[$]}}const I=L||e;return C.type==="wildcard"&&L!==!1?U=>{const q=U[C.name];if(q==null)return["",C.name];if(!Array.isArray(q)||q.length===0)throw new TypeError(`Expected "${C.name}" to be a non-empty array`);return[q.map(($,X)=>{if(typeof $!="string")throw new TypeError(`Expected "${C.name}/${X}" to be a string`);return I($)}).join(M)]}:U=>{const q=U[C.name];if(q==null)return["",C.name];if(typeof q!="string")throw new TypeError(`Expected "${C.name}" to be a string`);return[I(q)]}}function v(C,M={}){const{decode:L=decodeURIComponent,delimiter:I=i}=M,{regexp:U,keys:q}=E(C,M),$=q.map(X=>L===!1?e:X.type==="param"?L:ne=>ne.split(I).map(L));return function(ne){const se=U.exec(ne);if(!se)return!1;const ce=se[0],ie=Object.create(null);for(let H=1;H<se.length;H++){if(se[H]===void 0)continue;const J=q[H-1],ve=$[H-1];ie[J.name]=ve(se[H])}return{path:ce,params:ie}}}function E(C,M={}){const{delimiter:L=i,end:I=!0,sensitive:U=!1,trailing:q=!0}=M,$=[],X=[],ne=U?"":"i",ce=(Array.isArray(C)?C:[C]).map(J=>J instanceof h?J:d(J,M));for(const{tokens:J}of ce)for(const ve of A(J,0,[])){const fe=D(ve,L,$);X.push(fe)}let ie=`^(?:${X.join("|")})`;return q&&(ie+=`(?:${o(L)}$)?`),ie+=I?"$":`(?=${o(L)}|$)`,{regexp:new RegExp(ie,ne),keys:$}}function*A(C,M,L){if(M===C.length)return yield L;const I=C[M];if(I.type==="group"){const U=L.slice();for(const q of A(I.tokens,0,U))yield*A(C,M+1,q)}else L.push(I);yield*A(C,M+1,L)}function D(C,M,L){let I="",U="",q=!0;for(let $=0;$<C.length;$++){const X=C[$];if(X.type==="text"){I+=o(X.value),U+=X.value,q||(q=X.value.includes(M));continue}if(X.type==="param"||X.type==="wildcard"){if(!q&&!U)throw new TypeError(`Missing text after "${X.name}": ${n}`);X.type==="param"?I+=`(${R(M,q?"":U)}+)`:I+="([\\s\\S]+)",L.push(X),U="",q=!1;continue}}return I}function R(C,M){return M.length<2?C.length<2?`[^${o(C+M)}]`:`(?:(?!${o(C)})[^${o(M)}])`:C.length<2?`(?:(?!${o(M)})[^${o(C)}])`:`(?:(?!${o(M)}|${o(C)})[\\s\\S])`}function _(C){return C.tokens.map(function M(L,I,U){if(L.type==="text")return a(L.value);if(L.type==="group")return`{${L.tokens.map(M).join("")}}`;const $=F(L.name)&&w(U[I+1])?L.name:JSON.stringify(L.name);if(L.type==="param")return`:${$}`;if(L.type==="wildcard")return`*${$}`;throw new TypeError(`Unexpected token: ${L}`)}).join("")}function F(C){const[M,...L]=C;return t.test(M)?L.every(I=>r.test(I)):!1}function w(C){return(C==null?void 0:C.type)!=="text"?!0:!r.test(C.value[0])}return Qi}var If=RN();class IN extends Ma{getVideoId(e,t){if(It.isEmpty(e.values))throw console.error("Video ID extraction rule missing values property",e),new Error("Video ID extraction rule missing values property");const r=t.computeUrlMatchResultIfAbsent(()=>{const n=If.match(e.values[0]);let s=t.getParam("matchUrl")??window.location.href;return n(new URL(s).pathname)});if(!r)throw console.error("Video ID extraction rule configuration error for current URL:",e),new Error("Video ID extraction rule configuration error for current URL");return this.extractedVideoId(e,r)}extractedVideoId(e,t){const r=Qr.of(e.values).slice(1).map(n=>t.params[n]).toArray();return this.buildVideoId(e,r)}}class NN extends Ma{getVideoId(e,t){if(t.data===void 0)throw console.error("Context vo object is missing, unable to extract video ID using JSONPath",t),new Error("Context vo object is missing, unable to extract video ID using JSONPath");if(It.isEmpty(e.values))throw console.error("Video ID extraction rule missing JSONPath values property",e),new Error("Video ID extraction rule missing JSONPath values property");let r=Qr.of(e.values).map(n=>Ji(t.data,n)).flatten().toArray();return this.buildVideoId(e,r)}}const L1={"en-IE":{0:["Emily"],1:["Connor"]},"ar-KW":{0:["Noura"],1:["Fahed"]},"sw-TZ":{0:["Rehema"],1:["Daudi"]},"ms-MY":{0:["Yasmin"],1:["Osman"]},"en-IN":{0:["Neerja"],1:["Prabhat"]},"es-BO":{0:["Sofia"],1:["Marcelo"]},"ar-SY":{0:["Amany"],1:["Laith"]},"en-ZA":{0:["Leah"],1:["Luke"]},"ta-IN":{0:["Pallavi"],1:["Valluvar"]},"el-GR":{0:["Athina"],1:["Nestoras"]},"nl-NL":{0:["Fenna","Colette"],1:["Maarten"]},"zu-ZA":{0:["Thando"],1:["Themba"]},"ar-LB":{0:["Layla"],1:["Rami"]},"en-AU":{0:["Natasha"],1:["William"]},"he-IL":{0:["Hila"],1:["Avri"]},"mk-MK":{0:["Marija"],1:["Aleksandar"]},"ar-TN":{0:["Reem"],1:["Hedi"]},"ar-LY":{0:["Iman"],1:["Omar"]},"hu-HU":{0:["Noemi"],1:["Tamas"]},"ml-IN":{0:["Sobhana"],1:["Midhun"]},"es-SV":{0:["Lorena"],1:["Rodrigo"]},"es-CR":{0:["Maria"],1:["Juan"]},"es-CL":{0:["Catalina"],1:["Lorenzo"]},"fr-CA":{0:["Sylvie"],1:["Antoine","Jean"]},"es-CO":{0:["Salome"],1:["Gonzalo"]},"jv-ID":{0:["Siti"],1:["Dimas"]},"pl-PL":{0:["Zofia"],1:["Marek"]},"pt-PT":{0:["Raquel"],1:["Duarte"]},"ar-EG":{0:["Salma"],1:["Shakir"]},"es-CU":{0:["Belkys"],1:["Manuel"]},"fr-BE":{0:["Charline"],1:["Gerard"]},"ga-IE":{0:["Orla"],1:["Colm"]},"cy-GB":{0:["Nia"],1:["Aled"]},"ar-DZ":{0:["Amina"],1:["Ismael"]},"en-SG":{0:["Luna"],1:["Wayne"]},"ar-MA":{0:["Mouna"],1:["Jamal"]},"fil-PH":{0:["Blessica"],1:["Angelo"]},"ta-SG":{0:["Venba"],1:["Anbu"]},"en-KE":{0:["Asilia"],1:["Chilemba"]},"es-HN":{0:["Karla"],1:["Carlos"]},"nb-NO":{0:["Pernille"],1:["Finn"]},"hr-HR":{0:["Gabrijela"],1:["Srecko"]},"es-PR":{0:["Karina"],1:["Victor"]},"af-ZA":{0:["Adri"],1:["Willem"]},"gl-ES":{0:["Sabela"],1:["Roi"]},"es-PY":{0:["Tania"],1:["Mario"]},"de-AT":{0:["Ingrid"],1:["Jonas"]},"ta-LK":{0:["Saranya"],1:["Kumar"]},"is-IS":{0:["Gudrun"],1:["Gunnar"]},"my-MM":{0:["Nilar"],1:["Thiha"]},"bg-BG":{0:["Kalina"],1:["Borislav"]},"cs-CZ":{0:["Vlasta"],1:["Antonin"]},"en-PH":{0:["Rosa"],1:["James"]},"uz-UZ":{0:["Madina"],1:["Sardor"]},"zh-TW":{0:["HsiaoYu","HsiaoChen"],1:["YunJhe"]},"en-HK":{0:["Yan"],1:["Sam"]},"ko-KR":{0:["SunHi"],1:["InJoon"]},"sk-SK":{0:["Viktoria"],1:["Lukas"]},"ps-AF":{0:["Latifa"],1:["GulNawaz"]},"ar-OM":{0:["Aysha"],1:["Abdullah"]},"ru-RU":{0:["Svetlana"],1:["Dmitry"]},"sq-AL":{0:["Anila"],1:["Ilir"]},"es-AR":{0:["Elena"],1:["Tomas"]},"sv-SE":{0:["Sofie"],1:["Mattias"]},"am-ET":{0:["Mekdes"],1:["Ameha"]},"mr-IN":{0:["Aarohi"],1:["Manohar"]},"da-DK":{0:["Christel"],1:["Jeppe"]},"mn-MN":{0:["Yesui"],1:["Bataa"]},"uk-UA":{0:["Polina"],1:["Ostap"]},"en-US":{0:["Michelle","Ana","Aria","Jenny"],1:["Roger","Christopher","Eric","Steffan","Guy"]},"ta-MY":{0:["Kani"],1:["Surya"]},"gu-IN":{0:["Dhwani"],1:["Niranjan"]},"lv-LV":{0:["Everita"],1:["Nils"]},"nl-BE":{0:["Dena"],1:["Arnaud"]},"zh-CN":{0:["Xiaoxiao","Xiaoyi"],1:["Yunyang","Yunxia","Yunxi","Yunjian"]},"ur-PK":{0:["Uzma"],1:["Asad"]},"te-IN":{0:["Shruti"],1:["Mohan"]},"hi-IN":{0:["Swara"],1:["Madhur"]},"en-NG":{0:["Ezinne"],1:["Abeo"]},"de-CH":{0:["Leni"],1:["Jan"]},"ja-JP":{0:["Nanami"],1:["Keita"]},"bs-BA":{0:["Vesna"],1:["Goran"]},"ar-YE":{0:["Maryam"],1:["Saleh"]},"ne-NP":{0:["Hemkala"],1:["Sagar"]},"ka-GE":{0:["Eka"],1:["Giorgi"]},"ar-QA":{0:["Amal"],1:["Moaz"]},"es-GT":{0:["Marta"],1:["Andres"]},"es-GQ":{0:["Teresa"],1:["Javier"]},"es-PE":{0:["Camila"],1:["Alex"]},"en-NZ":{0:["Molly"],1:["Mitchell"]},"fa-IR":{0:["Dilara"],1:["Farid"]},"es-PA":{0:["Margarita"],1:["Roberto"]},"ro-RO":{0:["Alina"],1:["Emil"]},"mt-MT":{0:["Grace"],1:["Joseph"]},"et-EE":{0:["Anu"],1:["Kert"]},"tr-TR":{0:["Emel"],1:["Ahmet"]},"fr-FR":{0:["Denise","Eloise"],1:["Henri"]},"vi-VN":{0:["HoaiMy"],1:["NamMinh"]},"en-GB":{0:["Maisie","Libby","Sonia"],1:["Thomas","Ryan"]},"km-KH":{0:["Sreymom"],1:["Piseth"]},"fi-FI":{0:["Noora"],1:["Harri"]},"az-AZ":{0:["Banu"],1:["Babek"]},"en-CA":{0:["Clara"],1:["Liam"]},"lt-LT":{0:["Ona"],1:["Leonas"]},"ar-AE":{0:["Fatima"],1:["Hamdan"]},"sl-SI":{0:["Petra"],1:["Rok"]},"es-DO":{0:["Ramona"],1:["Emilio"]},"ar-IQ":{0:["Rana"],1:["Bassel"]},"bn-IN":{0:["Tanishaa"],1:["Bashkar"]},"si-LK":{0:["Thilini"],1:["Sameera"]},"fr-CH":{0:["Ariane"],1:["Fabrice"]},"es-EC":{0:["Andrea"],1:["Luis"]},"es-US":{0:["Paloma"],1:["Alonso"]},"kn-IN":{0:["Sapna"],1:["Gagan"]},"lo-LA":{0:["Keomany"],1:["Chanthavong"]},"ar-SA":{0:["Zariyah"],1:["Hamed"]},"ca-ES":{0:["Joana"],1:["Enric"]},"de-DE":{0:["Katja","Amala"],1:["Conrad","Killian"]},"zh-HK":{0:["HiuGaai","HiuMaan"],1:["WanLung"]},"pt-BR":{0:["Francisca"],1:["Antonio"]},"sr-RS":{0:["Sophie"],1:["Nicholas"]},"es-UY":{0:["Valentina"],1:["Mateo"]},"sw-KE":{0:["Zuri"],1:["Rafiki"]},"ar-BH":{0:["Laila"],1:["Ali"]},"es-ES":{0:["Elvira"],1:["Alvaro"]},"kk-KZ":{0:["Aigul"],1:["Daulet"]},"ar-JO":{0:["Sana"],1:["Taim"]},"es-VE":{0:["Paola"],1:["Sebastian"]},"so-SO":{0:["Ubax"],1:["Muuse"]},"en-TZ":{0:["Imani"],1:["Elimu"]},"su-ID":{0:["Tuti"],1:["Jajang"]},"es-MX":{0:["Dalia"],1:["Jorge"]},"it-IT":{0:["Elsa","Isabella"],1:["Diego"]},"ur-IN":{0:["Gul"],1:["Salman"]},"bn-BD":{0:["Nabanita"],1:["Pradeep"]},"id-ID":{0:["Gadis"],1:["Ardi"]},"es-NI":{0:["Yolanda"],1:["Federico"]},"th-TH":{0:["Premwadee"],1:["Niwat"]}},bu={AvaMultilingual:{code:"en-US-AvaMultilingualNeural",language:"en-US",displayName:"Ava Multilingual",localName:"Ava Multilingual"},EmmaMultilingual:{code:"en-US-EmmaMultilingualNeural",language:"en-US",displayName:"Emma Multilingual",localName:"Emma Multilingual"},AndrewMultilingual:{code:"en-US-AndrewMultilingualNeural",language:"en-US",displayName:"Andrew Multilingual",localName:"Andrew Multilingual"},BrianMultilingual:{code:"en-US-BrianMultilingualNeural",language:"en-US",displayName:"Brian Multilingual",localName:"Brian Multilingual"},JennyMultilingual:{code:"en-US-JennyMultilingualNeural",language:"en-US",displayName:"Jenny Multilingual",localName:"Jenny Multilingual"},RyanMultilingual:{code:"en-US-RyanMultilingualNeural",language:"en-US",displayName:"Ryan Multilingual",localName:"Ryan Multilingual"},SeraphinaMultilingual:{code:"de-DE-SeraphinaMultilingualNeural",language:"de-DE",displayName:"Seraphina Multilingual",localName:"Seraphina Mehrsprachig"},FlorianMultilingual:{code:"de-DE-FlorianMultilingualNeural",language:"de-DE",displayName:"Florian Multilingual",localName:"Florian Mehrsprachig"},VivienneMultilingual:{code:"fr-FR-VivienneMultilingualNeural",language:"fr-FR",displayName:"Vivienne Multilingual",localName:"Vivienne Multilingue"},RemyMultilingual:{code:"fr-FR-RemyMultilingualNeural",language:"fr-FR",displayName:"Remy Multilingual",localName:"Rémy Multilingue"},MasaruMultilingual:{code:"ja-JP-MasaruMultilingualNeural",language:"ja-JP",displayName:"Masaru Multilingual",localName:"勝 多言語"},YunyiMultilingual:{code:"zh-CN-YunyiMultilingualNeural",language:"zh-CN",displayName:"Yunyi Multilingual",localName:"云逸 多语言"},XiaoxiaoMultilingual:{code:"zh-CN-XiaoxiaoMultilingualNeural",language:"zh-CN",displayName:"Xiaoxiao Multilingual",localName:"晓晓 多语言"},XiaochenMultilingual:{code:"zh-CN-XiaochenMultilingualNeural",language:"zh-CN",displayName:"Xiaochen Multilingual",localName:"晓辰 多语言"},XiaoyuMultilingual:{code:"zh-CN-XiaoyuMultilingualNeural",language:"zh-CN",displayName:"Xiaoyu Multilingual",localName:"晓雨 多语言"},"Xiaochen:DragonHDLatestNeural":{code:"zh-CN-Xiaochen:DragonHDLatestNeural",language:"zh-CN",displayName:"Xiaochen:DragonHDLatestNeural",localName:"晓辰(龙)"},"Seraphina:DragonHDLatestNeural":{code:"de-DE-Seraphina:DragonHDLatestNeural",language:"de-DE",displayName:"Seraphina:DragonHDLatest",localName:"Seraphina:DragonHD"},"Aria:DragonHDLatestNeural":{code:"en-US-Aria:DragonHDLatestNeural",language:"en-US",displayName:"Aria:DragonHDLatest",localName:"Aria:DragonHD"},"Ava:DragonHDLatestNeural":{code:"en-US-Ava:DragonHDLatestNeural",language:"en-US",displayName:"Ava:DragonHDLatest",localName:"Ava:DragonHD"},"Emma:DragonHDLatestNeural":{code:"en-US-Emma:DragonHDLatestNeural",language:"en-US",displayName:"Emma:DragonHDLatest",localName:"Emma:DragonHD"},"Emma2:DragonHDLatestNeural":{code:"en-US-Emma2:DragonHDLatestNeural",language:"en-US",displayName:"Emma2:DragonHDLatest",localName:"Emma2:DragonHD"},"Jenny:DragonHDLatestNeural":{code:"en-US-Jenny:DragonHDLatestNeural",language:"en-US",displayName:"Jenny:DragonHDLatest",localName:"Jenny:DragonHD"},"Andrew:DragonHDLatestNeural":{code:"en-US-Andrew:DragonHDLatestNeural",language:"en-US",displayName:"Andrew:DragonHDLatest",localName:"Andrew:DragonHD"},"Andrew2:DragonHDLatestNeural":{code:"en-US-Andrew2:DragonHDLatestNeural",language:"en-US",displayName:"Andrew2:DragonHDLatest",localName:"Andrew2:DragonHD"},"Davis:DragonHDLatestNeural":{code:"en-US-Davis:DragonHDLatestNeural",language:"en-US",displayName:"Davis:DragonHDLatest",localName:"Davis:DragonHD"},"Steffan:DragonHDLatestNeural":{code:"en-US-Steffan:DragonHDLatestNeural",language:"en-US",displayName:"Steffan:DragonHDLatest",localName:"Steffan:DragonHD"},"Masaru:DragonHDLatestNeural":{code:"ja-JP-Masaru:DragonHDLatestNeural",language:"ja-JP",displayName:"Masaru:DragonHDLatest",localName:"Masaru:DragonHD"},Alba:{code:"ca-ES-AlbaNeural",language:"ca-ES",displayName:"Alba",localName:"Alba"},Gisela:{code:"de-DE-GiselaNeural",language:"de-DE",displayName:"Gisela",localName:"Gisela"},Elke:{code:"de-DE-ElkeNeural",language:"de-DE",displayName:"Elke",localName:"Elke"},Klarissa:{code:"de-DE-KlarissaNeural",language:"de-DE",displayName:"Klarissa",localName:"Klarissa"},Louisa:{code:"de-DE-LouisaNeural",language:"de-DE",displayName:"Louisa",localName:"Louisa"},Maja:{code:"de-DE-MajaNeural",language:"de-DE",displayName:"Maja",localName:"Maja"},Tanja:{code:"de-DE-TanjaNeural",language:"de-DE",displayName:"Tanja",localName:"Tanja"},Bernd:{code:"de-DE-BerndNeural",language:"de-DE",displayName:"Bernd",localName:"Bernd"},Kasper:{code:"de-DE-KasperNeural",language:"de-DE",displayName:"Kasper",localName:"Kasper"},Christoph:{code:"de-DE-ChristophNeural",language:"de-DE",displayName:"Christoph",localName:"Christoph"},Klaus:{code:"de-DE-KlausNeural",language:"de-DE",displayName:"Klaus",localName:"Klaus"},Ralf:{code:"de-DE-RalfNeural",language:"de-DE",displayName:"Ralf",localName:"Ralf"},Annette:{code:"en-AU-AnnetteNeural",language:"en-AU",displayName:"Annette",localName:"Annette"},Carly:{code:"en-AU-CarlyNeural",language:"en-AU",displayName:"Carly",localName:"Carly"},Elsie:{code:"en-AU-ElsieNeural",language:"en-AU",displayName:"Elsie",localName:"Elsie"},Freya:{code:"en-AU-FreyaNeural",language:"en-AU",displayName:"Freya",localName:"Freya"},Joanne:{code:"en-AU-JoanneNeural",language:"en-AU",displayName:"Joanne",localName:"Joanne"},Kim:{code:"en-AU-KimNeural",language:"en-AU",displayName:"Kim",localName:"Kim"},Tina:{code:"en-AU-TinaNeural",language:"en-AU",displayName:"Tina",localName:"Tina"},Darren:{code:"en-AU-DarrenNeural",language:"en-AU",displayName:"Darren",localName:"Darren"},Duncan:{code:"en-AU-DuncanNeural",language:"en-AU",displayName:"Duncan",localName:"Duncan"},Ken:{code:"en-AU-KenNeural",language:"en-AU",displayName:"Ken",localName:"Ken"},Neil:{code:"en-AU-NeilNeural",language:"en-AU",displayName:"Neil",localName:"Neil"},Tim:{code:"en-AU-TimNeural",language:"en-AU",displayName:"Tim",localName:"Tim"},Abbi:{code:"en-GB-AbbiNeural",language:"en-GB",displayName:"Abbi",localName:"Abbi"},Bella:{code:"en-GB-BellaNeural",language:"en-GB",displayName:"Bella",localName:"Bella"},Hollie:{code:"en-GB-HollieNeural",language:"en-GB",displayName:"Hollie",localName:"Hollie"},Maisie:{code:"en-GB-MaisieNeural",language:"en-GB",displayName:"Maisie",localName:"Maisie"},Olivia:{code:"en-GB-OliviaNeural",language:"en-GB",displayName:"Olivia",localName:"Olivia"},Mia:{code:"en-GB-MiaNeural",language:"en-GB",displayName:"Mia",localName:"Mia"},Alfie:{code:"en-GB-AlfieNeural",language:"en-GB",displayName:"Alfie",localName:"Alfie"},Elliot:{code:"en-GB-ElliotNeural",language:"en-GB",displayName:"Elliot",localName:"Elliot"},Ethan:{code:"en-GB-EthanNeural",language:"en-GB",displayName:"Ethan",localName:"Ethan"},Noah:{code:"en-GB-NoahNeural",language:"en-GB",displayName:"Noah",localName:"Noah"},Oliver:{code:"en-GB-OliverNeural",language:"en-GB",displayName:"Oliver",localName:"Oliver"},Aashi:{code:"en-IN-AashiNeural",language:"en-IN",displayName:"Aashi",localName:"Aashi"},Ananya:{code:"en-IN-AnanyaNeural",language:"en-IN",displayName:"Ananya",localName:"Ananya"},Kavya:{code:"en-IN-KavyaNeural",language:"en-IN",displayName:"Kavya",localName:"Kavya"},Jane:{code:"en-US-JaneNeural",language:"en-US",displayName:"Jane",localName:"Jane"},Sara:{code:"en-US-SaraNeural",language:"en-US",displayName:"Sara",localName:"Sara"},Nancy:{code:"en-US-NancyNeural",language:"en-US",displayName:"Nancy",localName:"Nancy"},Amber:{code:"en-US-AmberNeural",language:"en-US",displayName:"Amber",localName:"Amber"},Ashley:{code:"en-US-AshleyNeural",language:"en-US",displayName:"Ashley",localName:"Ashley"},Cora:{code:"en-US-CoraNeural",language:"en-US",displayName:"Cora",localName:"Cora"},Elizabeth:{code:"en-US-ElizabethNeural",language:"en-US",displayName:"Elizabeth",localName:"Elizabeth"},Michelle:{code:"en-US-MichelleNeural",language:"en-US",displayName:"Michelle",localName:"Michelle"},Monica:{code:"en-US-MonicaNeural",language:"en-US",displayName:"Monica",localName:"Monica"},AIGenerate2:{code:"en-US-AIGenerate2Neural",language:"en-US",displayName:"AIGenerate2",localName:"AIGenerate2"},Blue:{code:"en-US-BlueNeural",language:"en-US",displayName:"Blue",localName:"Blue"},Davis:{code:"en-US-DavisNeural",language:"en-US",displayName:"Davis",localName:"Davis"},Jason:{code:"en-US-JasonNeural",language:"en-US",displayName:"Jason",localName:"Jason"},Tony:{code:"en-US-TonyNeural",language:"en-US",displayName:"Tony",localName:"Tony"},Brandon:{code:"en-US-BrandonNeural",language:"en-US",displayName:"Brandon",localName:"Brandon"},Jacob:{code:"en-US-JacobNeural",language:"en-US",displayName:"Jacob",localName:"Jacob"},AIGenerate1:{code:"en-US-AIGenerate1Neural",language:"en-US",displayName:"AIGenerate1",localName:"AIGenerate1"},Abril:{code:"es-ES-AbrilNeural",language:"es-ES",displayName:"Abril",localName:"Abril"},Estrella:{code:"es-ES-EstrellaNeural",language:"es-ES",displayName:"Estrella",localName:"Estrella"},Irene:{code:"es-ES-IreneNeural",language:"es-ES",displayName:"Irene",localName:"Irene"},Laia:{code:"es-ES-LaiaNeural",language:"es-ES",displayName:"Laia",localName:"Laia"},Lia:{code:"es-ES-LiaNeural",language:"es-ES",displayName:"Lia",localName:"Lia"},Triana:{code:"es-ES-TrianaNeural",language:"es-ES",displayName:"Triana",localName:"Triana"},Vera:{code:"es-ES-VeraNeural",language:"es-ES",displayName:"Vera",localName:"Vera"},Ximena:{code:"es-ES-XimenaNeural",language:"es-ES",displayName:"Ximena",localName:"Ximena"},Arnau:{code:"es-ES-ArnauNeural",language:"es-ES",displayName:"Arnau",localName:"Arnau"},Dario:{code:"es-ES-DarioNeural",language:"es-ES",displayName:"Dario",localName:"Dario"},Elias:{code:"es-ES-EliasNeural",language:"es-ES",displayName:"Elias",localName:"Elias"},Nil:{code:"es-ES-NilNeural",language:"es-ES",displayName:"Nil",localName:"Nil"},Saul:{code:"es-ES-SaulNeural",language:"es-ES",displayName:"Saul",localName:"Saul"},Teo:{code:"es-ES-TeoNeural",language:"es-ES",displayName:"Teo",localName:"Teo"},Beatriz:{code:"es-MX-BeatrizNeural",language:"es-MX",displayName:"Beatriz",localName:"Beatriz"},Candela:{code:"es-MX-CandelaNeural",language:"es-MX",displayName:"Candela",localName:"Candela"},Carlota:{code:"es-MX-CarlotaNeural",language:"es-MX",displayName:"Carlota",localName:"Carlota"},Larissa:{code:"es-MX-LarissaNeural",language:"es-MX",displayName:"Larissa",localName:"Larissa"},Marina:{code:"es-MX-MarinaNeural",language:"es-MX",displayName:"Marina",localName:"Marina"},Nuria:{code:"es-MX-NuriaNeural",language:"es-MX",displayName:"Nuria",localName:"Nuria"},Renata:{code:"es-MX-RenataNeural",language:"es-MX",displayName:"Renata",localName:"Renata"},Cecilio:{code:"es-MX-CecilioNeural",language:"es-MX",displayName:"Cecilio",localName:"Cecilio"},Gerardo:{code:"es-MX-GerardoNeural",language:"es-MX",displayName:"Gerardo",localName:"Gerardo"},Liberto:{code:"es-MX-LibertoNeural",language:"es-MX",displayName:"Liberto",localName:"Liberto"},Luciano:{code:"es-MX-LucianoNeural",language:"es-MX",displayName:"Luciano",localName:"Luciano"},Pelayo:{code:"es-MX-PelayoNeural",language:"es-MX",displayName:"Pelayo",localName:"Pelayo"},Yago:{code:"es-MX-YagoNeural",language:"es-MX",displayName:"Yago",localName:"Yago"},Selma:{code:"fi-FI-SelmaNeural",language:"fi-FI",displayName:"Selma",localName:"Selma"},Thierry:{code:"fr-CA-ThierryNeural",language:"fr-CA",displayName:"Thierry",localName:"Thierry"},Jacqueline:{code:"fr-FR-JacquelineNeural",language:"fr-FR",displayName:"Jacqueline",localName:"Jacqueline"},Josephine:{code:"fr-FR-JosephineNeural",language:"fr-FR",displayName:"Josephine",localName:"Josephine"},Brigitte:{code:"fr-FR-BrigitteNeural",language:"fr-FR",displayName:"Brigitte",localName:"Brigitte"},Coralie:{code:"fr-FR-CoralieNeural",language:"fr-FR",displayName:"Coralie",localName:"Coralie"},Celeste:{code:"fr-FR-CelesteNeural",language:"fr-FR",displayName:"Celeste",localName:"Celeste"},Yvette:{code:"fr-FR-YvetteNeural",language:"fr-FR",displayName:"Yvette",localName:"Yvette"},Claude:{code:"fr-FR-ClaudeNeural",language:"fr-FR",displayName:"Claude",localName:"Claude"},Alain:{code:"fr-FR-AlainNeural",language:"fr-FR",displayName:"Alain",localName:"Alain"},Jerome:{code:"fr-FR-JeromeNeural",language:"fr-FR",displayName:"Jerome",localName:"Jerome"},Maurice:{code:"fr-FR-MauriceNeural",language:"fr-FR",displayName:"Maurice",localName:"Maurice"},Yves:{code:"fr-FR-YvesNeural",language:"fr-FR",displayName:"Yves",localName:"Yves"},"Ananya-hi":{code:"hi-IN-AnanyaNeural",language:"hi-IN",displayName:"Ananya",localName:"अनन्या"},"Kavya-hi":{code:"hi-IN-KavyaNeural",language:"hi-IN",displayName:"Kavya",localName:"काव्या"},Fabiola:{code:"it-IT-FabiolaNeural",language:"it-IT",displayName:"Fabiola",localName:"Fabiola"},Fiamma:{code:"it-IT-FiammaNeural",language:"it-IT",displayName:"Fiamma",localName:"Fiamma"},Imelda:{code:"it-IT-ImeldaNeural",language:"it-IT",displayName:"Imelda",localName:"Imelda"},Irma:{code:"it-IT-IrmaNeural",language:"it-IT",displayName:"Irma",localName:"Irma"},Palmira:{code:"it-IT-PalmiraNeural",language:"it-IT",displayName:"Palmira",localName:"Palmira"},Pierina:{code:"it-IT-PierinaNeural",language:"it-IT",displayName:"Pierina",localName:"Pierina"},Benigno:{code:"it-IT-BenignoNeural",language:"it-IT",displayName:"Benigno",localName:"Benigno"},Calimero:{code:"it-IT-CalimeroNeural",language:"it-IT",displayName:"Calimero",localName:"Calimero"},Cataldo:{code:"it-IT-CataldoNeural",language:"it-IT",displayName:"Cataldo",localName:"Cataldo"},Gianni:{code:"it-IT-GianniNeural",language:"it-IT",displayName:"Gianni",localName:"Gianni"},Giuseppe:{code:"it-IT-GiuseppeNeural",language:"it-IT",displayName:"Giuseppe",localName:"Giuseppe"},Lisandro:{code:"it-IT-LisandroNeural",language:"it-IT",displayName:"Lisandro",localName:"Lisandro"},Rinaldo:{code:"it-IT-RinaldoNeural",language:"it-IT",displayName:"Rinaldo",localName:"Rinaldo"},Shiori:{code:"ja-JP-ShioriNeural",language:"ja-JP",displayName:"Shiori",localName:"志織"},Mayu:{code:"ja-JP-MayuNeural",language:"ja-JP",displayName:"Mayu",localName:"真夕"},Aoi:{code:"ja-JP-AoiNeural",language:"ja-JP",displayName:"Aoi",localName:"碧衣"},Naoki:{code:"ja-JP-NaokiNeural",language:"ja-JP",displayName:"Naoki",localName:"直紀"},Daichi:{code:"ja-JP-DaichiNeural",language:"ja-JP",displayName:"Daichi",localName:"大智"},JiMin:{code:"ko-KR-JiMinNeural",language:"ko-KR",displayName:"JiMin",localName:"지민"},SeoHyeon:{code:"ko-KR-SeoHyeonNeural",language:"ko-KR",displayName:"SeoHyeon",localName:"서현"},SoonBok:{code:"ko-KR-SoonBokNeural",language:"ko-KR",displayName:"SoonBok",localName:"순복"},YuJin:{code:"ko-KR-YuJinNeural",language:"ko-KR",displayName:"YuJin",localName:"유진"},BongJin:{code:"ko-KR-BongJinNeural",language:"ko-KR",displayName:"BongJin",localName:"봉진"},GookMin:{code:"ko-KR-GookMinNeural",language:"ko-KR",displayName:"GookMin",localName:"국민"},Hyunsu:{code:"ko-KR-HyunsuNeural",language:"ko-KR",displayName:"Hyunsu",localName:"현수"},Nilar:{code:"my-MM-NilarNeural",language:"my-MM",displayName:"Nilar",localName:"နီလာ"},Thiha:{code:"my-MM-ThihaNeural",language:"my-MM",displayName:"Thiha",localName:"သီဟ"},Iselin:{code:"nb-NO-IselinNeural",language:"nb-NO",displayName:"Iselin",localName:"Iselin"},Agnieszka:{code:"pl-PL-AgnieszkaNeural",language:"pl-PL",displayName:"Agnieszka",localName:"Agnieszka"},Giovanna:{code:"pt-BR-GiovannaNeural",language:"pt-BR",displayName:"Giovanna",localName:"Giovanna"},Leila:{code:"pt-BR-LeilaNeural",language:"pt-BR",displayName:"Leila",localName:"Leila"},Leticia:{code:"pt-BR-LeticiaNeural",language:"pt-BR",displayName:"Leticia",localName:"Leticia"},Yara:{code:"pt-BR-YaraNeural",language:"pt-BR",displayName:"Yara",localName:"Yara"},Manuela:{code:"pt-BR-ManuelaNeural",language:"pt-BR",displayName:"Manuela",localName:"Manuela"},Thalita:{code:"pt-BR-ThalitaNeural",language:"pt-BR",displayName:"Thalita",localName:"Thalita"},Elza:{code:"pt-BR-ElzaNeural",language:"pt-BR",displayName:"Elza",localName:"Elza"},Brenda:{code:"pt-BR-BrendaNeural",language:"pt-BR",displayName:"Brenda",localName:"Brenda"},Julio:{code:"pt-BR-JulioNeural",language:"pt-BR",displayName:"Julio",localName:"Julio"},Humberto:{code:"pt-BR-HumbertoNeural",language:"pt-BR",displayName:"Humberto",localName:"Humberto"},Nicolau:{code:"pt-BR-NicolauNeural",language:"pt-BR",displayName:"Nicolau",localName:"Nicolau"},Valerio:{code:"pt-BR-ValerioNeural",language:"pt-BR",displayName:"Valerio",localName:"Valerio"},Fabio:{code:"pt-BR-FabioNeural",language:"pt-BR",displayName:"Fabio",localName:"Fabio"},Donato:{code:"pt-BR-DonatoNeural",language:"pt-BR",displayName:"Donato",localName:"Donato"},Fernanda:{code:"pt-PT-FernandaNeural",language:"pt-PT",displayName:"Fernanda",localName:"Fernanda"},Dariya:{code:"ru-RU-DariyaNeural",language:"ru-RU",displayName:"Dariya",localName:"Дария"},Nicholas:{code:"sr-RS-NicholasNeural",language:"sr-RS",displayName:"Nicholas",localName:"Никола"},Sophie:{code:"sr-RS-SophieNeural",language:"sr-RS",displayName:"Sophie",localName:"Софија"},Hillevi:{code:"sv-SE-HilleviNeural",language:"sv-SE",displayName:"Hillevi",localName:"Hillevi"},Achara:{code:"th-TH-AcharaNeural",language:"th-TH",displayName:"Achara",localName:"อัจฉรา"},Xiaohan:{code:"zh-CN-XiaohanNeural",language:"zh-CN",displayName:"Xiaohan",localName:"晓涵"},Xiaomeng:{code:"zh-CN-XiaomengNeural",language:"zh-CN",displayName:"Xiaomeng",localName:"晓梦"},Xiaomo:{code:"zh-CN-XiaomoNeural",language:"zh-CN",displayName:"Xiaomo",localName:"晓莫"},Xiaoqiu:{code:"zh-CN-XiaoqiuNeural",language:"zh-CN",displayName:"Xiaoqiu",localName:"晓秋"},Xiaorui:{code:"zh-CN-XiaoruiNeural",language:"zh-CN",displayName:"Xiaorui",localName:"晓睿"},Xiaoshuang:{code:"zh-CN-XiaoshuangNeural",language:"zh-CN",displayName:"Xiaoshuang",localName:"晓双"},Xiaoyan:{code:"zh-CN-XiaoyanNeural",language:"zh-CN",displayName:"Xiaoyan",localName:"晓颜"},Xiaoxuan:{code:"zh-CN-XiaoxuanNeural",language:"zh-CN",displayName:"Xiaoxuan",localName:"晓萱"},Xiaoyou:{code:"zh-CN-XiaoyouNeural",language:"zh-CN",displayName:"Xiaoyou",localName:"晓悠"},Xiaozhen:{code:"zh-CN-XiaozhenNeural",language:"zh-CN",displayName:"Xiaozhen",localName:"晓甄"},Xiaorou:{code:"zh-CN-XiaorouNeural",language:"zh-CN",displayName:"Xiaorou",localName:"晓柔"},Xiaotong:{code:"wuu-CN-XiaotongNeural",language:"zh-CN",displayName:"Xiaotong",localName:"晓彤"},XiaoMin:{code:"yue-CN-XiaoMinNeural",language:"zh-CN",displayName:"XiaoMin",localName:"晓敏"},Xiaobei:{code:"zh-CN-liaoning-XiaobeiNeural",language:"zh-CN",displayName:"Xiaobei",localName:"晓北 辽宁"},Xiaoni:{code:"zh-CN-shaanxi-XiaoniNeural",language:"zh-CN",displayName:"Xiaoni",localName:"晓妮 陕西"},Yunfeng:{code:"zh-CN-yunfengNeural",language:"zh-CN",displayName:"Yunfeng",localName:"云枫"},Yunhao:{code:"zh-CN-yunhaoNeural",language:"zh-CN",displayName:"Yunhao",localName:"云皓"},Yunjie:{code:"zh-CN-yunjieNeural",language:"zh-CN",displayName:"Yunjie",localName:"云杰"},Yunye:{code:"zh-CN-yunyeNeural",language:"zh-CN",displayName:"Yunye",localName:"云野"},Yunze:{code:"zh-CN-yunzeNeural",language:"zh-CN",displayName:"Yunze",localName:"云泽"},Yunzhe:{code:"wuu-CN-YunzheNeural",language:"zh-CN",displayName:"Yunzhe",localName:"云哲"},YunSong:{code:"yue-CN-YunSongNeural",language:"zh-CN",displayName:"YunSong",localName:"云松"},Yunqi:{code:"zh-CN-guangxi-YunqiNeural",language:"zh-CN",displayName:"Yunqi",localName:"云奇 广西"},Yundeng:{code:"zh-CN-henan-YundengNeural",language:"zh-CN",displayName:"Yundeng",localName:"云登 河南"},Yunbiao:{code:"zh-CN-liaoning-YunbiaoNeural",language:"zh-CN",displayName:"Yunbiao",localName:"云彪 辽宁"},Yunxiang:{code:"zh-CN-shandong-YunxiangNeural",language:"zh-CN",displayName:"Yunxiang",localName:"云翔 山东"},"Yunxi-SiChuan":{code:"zh-CN-sichuan-YunxiNeural",language:"zh-CN",displayName:"Yunxi",localName:"云希 四川"},Emily:{code:"en-IE-EmilyNeural",language:"en-IE",displayName:"Emily",localName:"Emily"},Connor:{code:"en-IE-ConnorNeural",language:"en-IE",displayName:"Connor",localName:"Connor"},Noura:{code:"ar-KW-NouraNeural",language:"ar-KW",displayName:"Noura",localName:"نورا"},Fahed:{code:"ar-KW-FahedNeural",language:"ar-KW",displayName:"Fahed",localName:"فهد"},Rehema:{code:"sw-TZ-RehemaNeural",language:"sw-TZ",displayName:"Rehema",localName:"Rehema"},Daudi:{code:"sw-TZ-DaudiNeural",language:"sw-TZ",displayName:"Daudi",localName:"Daudi"},Yasmin:{code:"ms-MY-YasminNeural",language:"ms-MY",displayName:"Yasmin",localName:"Yasmin"},Osman:{code:"ms-MY-OsmanNeural",language:"ms-MY",displayName:"Osman",localName:"Osman"},Neerja:{code:"en-IN-NeerjaNeural",language:"en-IN",displayName:"Neerja",localName:"Neerja"},Prabhat:{code:"en-IN-PrabhatNeural",language:"en-IN",displayName:"Prabhat",localName:"Prabhat"},Sofia:{code:"es-BO-SofiaNeural",language:"es-BO",displayName:"Sofia",localName:"Sofia"},Marcelo:{code:"es-BO-MarceloNeural",language:"es-BO",displayName:"Marcelo",localName:"Marcelo"},Amany:{code:"ar-SY-AmanyNeural",language:"ar-SY",displayName:"Amany",localName:"أماني"},Laith:{code:"ar-SY-LaithNeural",language:"ar-SY",displayName:"Laith",localName:"ليث"},Leah:{code:"en-ZA-LeahNeural",language:"en-ZA",displayName:"Leah",localName:"Leah"},Luke:{code:"en-ZA-LukeNeural",language:"en-ZA",displayName:"Luke",localName:"Luke"},Pallavi:{code:"ta-IN-PallaviNeural",language:"ta-IN",displayName:"Pallavi",localName:"பல்லவி"},Valluvar:{code:"ta-IN-ValluvarNeural",language:"ta-IN",displayName:"Valluvar",localName:"வள்ளுவர்"},Athina:{code:"el-GR-AthinaNeural",language:"el-GR",displayName:"Athina",localName:"Αθηνά"},Nestoras:{code:"el-GR-NestorasNeural",language:"el-GR",displayName:"Nestoras",localName:"Νέστορας"},Fenna:{code:"nl-NL-FennaNeural",language:"nl-NL",displayName:"Fenna",localName:"Fenna"},Colette:{code:"nl-NL-ColetteNeural",language:"nl-NL",displayName:"Colette",localName:"Colette"},Maarten:{code:"nl-NL-MaartenNeural",language:"nl-NL",displayName:"Maarten",localName:"Maarten"},Thando:{code:"zu-ZA-ThandoNeural",language:"zu-ZA",displayName:"Thando",localName:"Thando"},Themba:{code:"zu-ZA-ThembaNeural",language:"zu-ZA",displayName:"Themba",localName:"Themba"},Layla:{code:"ar-LB-LaylaNeural",language:"ar-LB",displayName:"Layla",localName:"ليلى"},Rami:{code:"ar-LB-RamiNeural",language:"ar-LB",displayName:"Rami",localName:"رامي"},Natasha:{code:"en-AU-NatashaNeural",language:"en-AU",displayName:"Natasha",localName:"Natasha"},William:{code:"en-AU-WilliamNeural",language:"en-AU",displayName:"William",localName:"William"},Hila:{code:"he-IL-HilaNeural",language:"he-IL",displayName:"Hila",localName:"הילה"},Avri:{code:"he-IL-AvriNeural",language:"he-IL",displayName:"Avri",localName:"אברי"},Marija:{code:"mk-MK-MarijaNeural",language:"mk-MK",displayName:"Marija",localName:"Марија"},Aleksandar:{code:"mk-MK-AleksandarNeural",language:"mk-MK",displayName:"Aleksandar",localName:"Александар"},Reem:{code:"ar-TN-ReemNeural",language:"ar-TN",displayName:"Reem",localName:"ريم"},Hedi:{code:"ar-TN-HediNeural",language:"ar-TN",displayName:"Hedi",localName:"هادي"},Iman:{code:"ar-LY-ImanNeural",language:"ar-LY",displayName:"Iman",localName:"إيمان"},Omar:{code:"ar-LY-OmarNeural",language:"ar-LY",displayName:"Omar",localName:"أحمد"},Noemi:{code:"hu-HU-NoemiNeural",language:"hu-HU",displayName:"Noemi",localName:"Noémi"},Tamas:{code:"hu-HU-TamasNeural",language:"hu-HU",displayName:"Tamas",localName:"Tamás"},Sobhana:{code:"ml-IN-SobhanaNeural",language:"ml-IN",displayName:"Sobhana",localName:"ശോഭന"},Midhun:{code:"ml-IN-MidhunNeural",language:"ml-IN",displayName:"Midhun",localName:"മിഥുൻ"},Lorena:{code:"es-SV-LorenaNeural",language:"es-SV",displayName:"Lorena",localName:"Lorena"},Rodrigo:{code:"es-SV-RodrigoNeural",language:"es-SV",displayName:"Rodrigo",localName:"Rodrigo"},Maria:{code:"es-CR-MariaNeural",language:"es-CR",displayName:"Maria",localName:"María"},Juan:{code:"es-CR-JuanNeural",language:"es-CR",displayName:"Juan",localName:"Juan"},Catalina:{code:"es-CL-CatalinaNeural",language:"es-CL",displayName:"Catalina",localName:"Catalina"},Lorenzo:{code:"es-CL-LorenzoNeural",language:"es-CL",displayName:"Lorenzo",localName:"Lorenzo"},Sylvie:{code:"fr-CA-SylvieNeural",language:"fr-CA",displayName:"Sylvie",localName:"Sylvie"},Antoine:{code:"fr-CA-AntoineNeural",language:"fr-CA",displayName:"Antoine",localName:"Antoine"},Jean:{code:"fr-CA-JeanNeural",language:"fr-CA",displayName:"Jean",localName:"Jean"},Salome:{code:"es-CO-SalomeNeural",language:"es-CO",displayName:"Salome",localName:"Salome"},Gonzalo:{code:"es-CO-GonzaloNeural",language:"es-CO",displayName:"Gonzalo",localName:"Gonzalo"},Siti:{code:"jv-ID-SitiNeural",language:"jv-ID",displayName:"Siti",localName:"Siti"},Dimas:{code:"jv-ID-DimasNeural",language:"jv-ID",displayName:"Dimas",localName:"Dimas"},Zofia:{code:"pl-PL-ZofiaNeural",language:"pl-PL",displayName:"Zofia",localName:"Zofia"},Marek:{code:"pl-PL-MarekNeural",language:"pl-PL",displayName:"Marek",localName:"Marek"},Raquel:{code:"pt-PT-RaquelNeural",language:"pt-PT",displayName:"Raquel",localName:"Raquel"},Duarte:{code:"pt-PT-DuarteNeural",language:"pt-PT",displayName:"Duarte",localName:"Duarte"},Salma:{code:"ar-EG-SalmaNeural",language:"ar-EG",displayName:"Salma",localName:"سلمى"},Shakir:{code:"ar-EG-ShakirNeural",language:"ar-EG",displayName:"Shakir",localName:"شاكر"},Belkys:{code:"es-CU-BelkysNeural",language:"es-CU",displayName:"Belkys",localName:"Belkys"},Manuel:{code:"es-CU-ManuelNeural",language:"es-CU",displayName:"Manuel",localName:"Manuel"},Charline:{code:"fr-BE-CharlineNeural",language:"fr-BE",displayName:"Charline",localName:"Charline"},Gerard:{code:"fr-BE-GerardNeural",language:"fr-BE",displayName:"Gerard",localName:"Gerard"},Orla:{code:"ga-IE-OrlaNeural",language:"ga-IE",displayName:"Orla",localName:"Orla"},Colm:{code:"ga-IE-ColmNeural",language:"ga-IE",displayName:"Colm",localName:"Colm"},Nia:{code:"cy-GB-NiaNeural",language:"cy-GB",displayName:"Nia",localName:"Nia"},Aled:{code:"cy-GB-AledNeural",language:"cy-GB",displayName:"Aled",localName:"Aled"},Amina:{code:"ar-DZ-AminaNeural",language:"ar-DZ",displayName:"Amina",localName:"أمينة"},Ismael:{code:"ar-DZ-IsmaelNeural",language:"ar-DZ",displayName:"Ismael",localName:"إسماعيل"},Luna:{code:"en-SG-LunaNeural",language:"en-SG",displayName:"Luna",localName:"Luna"},Wayne:{code:"en-SG-WayneNeural",language:"en-SG",displayName:"Wayne",localName:"Wayne"},Mouna:{code:"ar-MA-MounaNeural",language:"ar-MA",displayName:"Mouna",localName:"منى"},Jamal:{code:"ar-MA-JamalNeural",language:"ar-MA",displayName:"Jamal",localName:"جمال"},Blessica:{code:"fil-PH-BlessicaNeural",language:"fil-PH",displayName:"Blessica",localName:"Blessica"},Angelo:{code:"fil-PH-AngeloNeural",language:"fil-PH",displayName:"Angelo",localName:"Angelo"},Venba:{code:"ta-SG-VenbaNeural",language:"ta-SG",displayName:"Venba",localName:"வெண்பா"},Anbu:{code:"ta-SG-AnbuNeural",language:"ta-SG",displayName:"Anbu",localName:"அன்பு"},Asilia:{code:"en-KE-AsiliaNeural",language:"en-KE",displayName:"Asilia",localName:"Asilia"},Chilemba:{code:"en-KE-ChilembaNeural",language:"en-KE",displayName:"Chilemba",localName:"Chilemba"},Karla:{code:"es-HN-KarlaNeural",language:"es-HN",displayName:"Karla",localName:"Karla"},Carlos:{code:"es-HN-CarlosNeural",language:"es-HN",displayName:"Carlos",localName:"Carlos"},Pernille:{code:"nb-NO-PernilleNeural",language:"nb-NO",displayName:"Pernille",localName:"Pernille"},Finn:{code:"nb-NO-FinnNeural",language:"nb-NO",displayName:"Finn",localName:"Finn"},Gabrijela:{code:"hr-HR-GabrijelaNeural",language:"hr-HR",displayName:"Gabrijela",localName:"Gabrijela"},Srecko:{code:"hr-HR-SreckoNeural",language:"hr-HR",displayName:"Srecko",localName:"Srecko"},Karina:{code:"es-PR-KarinaNeural",language:"es-PR",displayName:"Karina",localName:"Karina"},Victor:{code:"es-PR-VictorNeural",language:"es-PR",displayName:"Victor",localName:"Victor"},Adri:{code:"af-ZA-AdriNeural",language:"af-ZA",displayName:"Adri",localName:"Adri"},Willem:{code:"af-ZA-WillemNeural",language:"af-ZA",displayName:"Willem",localName:"Willem"},Sabela:{code:"gl-ES-SabelaNeural",language:"gl-ES",displayName:"Sabela",localName:"Sabela"},Roi:{code:"gl-ES-RoiNeural",language:"gl-ES",displayName:"Roi",localName:"Roi"},Tania:{code:"es-PY-TaniaNeural",language:"es-PY",displayName:"Tania",localName:"Tania"},Mario:{code:"es-PY-MarioNeural",language:"es-PY",displayName:"Mario",localName:"Mario"},Ingrid:{code:"de-AT-IngridNeural",language:"de-AT",displayName:"Ingrid",localName:"Ingrid"},Jonas:{code:"de-AT-JonasNeural",language:"de-AT",displayName:"Jonas",localName:"Jonas"},Saranya:{code:"ta-LK-SaranyaNeural",language:"ta-LK",displayName:"Saranya",localName:"சரண்யா"},Kumar:{code:"ta-LK-KumarNeural",language:"ta-LK",displayName:"Kumar",localName:"குமார்"},Gudrun:{code:"is-IS-GudrunNeural",language:"is-IS",displayName:"Gudrun",localName:"Guðrún"},Gunnar:{code:"is-IS-GunnarNeural",language:"is-IS",displayName:"Gunnar",localName:"Gunnar"},Kalina:{code:"bg-BG-KalinaNeural",language:"bg-BG",displayName:"Kalina",localName:"Калина"},Borislav:{code:"bg-BG-BorislavNeural",language:"bg-BG",displayName:"Borislav",localName:"Борислав"},Vlasta:{code:"cs-CZ-VlastaNeural",language:"cs-CZ",displayName:"Vlasta",localName:"Vlasta"},Antonin:{code:"cs-CZ-AntoninNeural",language:"cs-CZ",displayName:"Antonin",localName:"Antonin"},Rosa:{code:"en-PH-RosaNeural",language:"en-PH",displayName:"Rosa",localName:"Rosa"},James:{code:"en-PH-JamesNeural",language:"en-PH",displayName:"James",localName:"James"},Madina:{code:"uz-UZ-MadinaNeural",language:"uz-UZ",displayName:"Madina",localName:"Madina"},Sardor:{code:"uz-UZ-SardorNeural",language:"uz-UZ",displayName:"Sardor",localName:"Сардор"},HsiaoYu:{code:"zh-TW-HsiaoYuNeural",language:"zh-TW",displayName:"HsiaoYu",localName:"曉雨"},HsiaoChen:{code:"zh-TW-HsiaoChenNeural",language:"zh-TW",displayName:"HsiaoChen",localName:"曉臻"},YunJhe:{code:"zh-TW-YunJheNeural",language:"zh-TW",displayName:"YunJhe",localName:"雲哲"},Yan:{code:"en-HK-YanNeural",language:"en-HK",displayName:"Yan",localName:"Yan"},Sam:{code:"en-HK-SamNeural",language:"en-HK",displayName:"Sam",localName:"Sam"},SunHi:{code:"ko-KR-SunHiNeural",language:"ko-KR",displayName:"SunHi",localName:"선히"},InJoon:{code:"ko-KR-InJoonNeural",language:"ko-KR",displayName:"InJoon",localName:"인준"},Viktoria:{code:"sk-SK-ViktoriaNeural",language:"sk-SK",displayName:"Viktoria",localName:"Viktória"},Lukas:{code:"sk-SK-LukasNeural",language:"sk-SK",displayName:"Lukas",localName:"Lukáš"},Latifa:{code:"ps-AF-LatifaNeural",language:"ps-AF",displayName:"Latifa",localName:"لطيفه"},GulNawaz:{code:"ps-AF-GulNawazNeural",language:"ps-AF",displayName:"Gul Nawaz",localName:" ګل نواز"},Aysha:{code:"ar-OM-AyshaNeural",language:"ar-OM",displayName:"Aysha",localName:"عائشة"},Abdullah:{code:"ar-OM-AbdullahNeural",language:"ar-OM",displayName:"Abdullah",localName:"عبدالله"},Svetlana:{code:"ru-RU-SvetlanaNeural",language:"ru-RU",displayName:"Svetlana",localName:"Светлана"},Dmitry:{code:"ru-RU-DmitryNeural",language:"ru-RU",displayName:"Dmitry",localName:"Дмитрий"},Anila:{code:"sq-AL-AnilaNeural",language:"sq-AL",displayName:"Anila",localName:"Anila"},Ilir:{code:"sq-AL-IlirNeural",language:"sq-AL",displayName:"Ilir",localName:"Ilir"},Elena:{code:"es-AR-ElenaNeural",language:"es-AR",displayName:"Elena",localName:"Elena"},Tomas:{code:"es-AR-TomasNeural",language:"es-AR",displayName:"Tomas",localName:"Tomas"},Sofie:{code:"sv-SE-SofieNeural",language:"sv-SE",displayName:"Sofie",localName:"Sofie"},Mattias:{code:"sv-SE-MattiasNeural",language:"sv-SE",displayName:"Mattias",localName:"Mattias"},Mekdes:{code:"am-ET-MekdesNeural",language:"am-ET",displayName:"Mekdes",localName:"መቅደስ"},Ameha:{code:"am-ET-AmehaNeural",language:"am-ET",displayName:"Ameha",localName:"አምሀ"},Aarohi:{code:"mr-IN-AarohiNeural",language:"mr-IN",displayName:"Aarohi",localName:"आरोही"},Manohar:{code:"mr-IN-ManoharNeural",language:"mr-IN",displayName:"Manohar",localName:"मनोहर"},Christel:{code:"da-DK-ChristelNeural",language:"da-DK",displayName:"Christel",localName:"Christel"},Jeppe:{code:"da-DK-JeppeNeural",language:"da-DK",displayName:"Jeppe",localName:"Jeppe"},Yesui:{code:"mn-MN-YesuiNeural",language:"mn-MN",displayName:"Yesui",localName:"Есүй"},Bataa:{code:"mn-MN-BataaNeural",language:"mn-MN",displayName:"Bataa",localName:"Батаа"},Polina:{code:"uk-UA-PolinaNeural",language:"uk-UA",displayName:"Polina",localName:"Поліна"},Ostap:{code:"uk-UA-OstapNeural",language:"uk-UA",displayName:"Ostap",localName:"Остап"},Ana:{code:"en-US-AnaNeural",language:"en-US",displayName:"Ana",localName:"Ana"},Aria:{code:"en-US-AriaNeural",language:"en-US",displayName:"Aria",localName:"Aria"},Jenny:{code:"en-US-JennyNeural",language:"en-US",displayName:"Jenny",localName:"Jenny"},Roger:{code:"en-US-RogerNeural",language:"en-US",displayName:"Roger",localName:"Roger"},Christopher:{code:"en-US-ChristopherNeural",language:"en-US",displayName:"Christopher",localName:"Christopher"},Eric:{code:"en-US-EricNeural",language:"en-US",displayName:"Eric",localName:"Eric"},Steffan:{code:"en-US-SteffanNeural",language:"en-US",displayName:"Steffan",localName:"Steffan"},Guy:{code:"en-US-GuyNeural",language:"en-US",displayName:"Guy",localName:"Guy"},Kani:{code:"ta-MY-KaniNeural",language:"ta-MY",displayName:"Kani",localName:"கனி"},Surya:{code:"ta-MY-SuryaNeural",language:"ta-MY",displayName:"Surya",localName:"சூர்யா"},Dhwani:{code:"gu-IN-DhwaniNeural",language:"gu-IN",displayName:"Dhwani",localName:"ધ્વની"},Niranjan:{code:"gu-IN-NiranjanNeural",language:"gu-IN",displayName:"Niranjan",localName:"નિરંજન"},Everita:{code:"lv-LV-EveritaNeural",language:"lv-LV",displayName:"Everita",localName:"Everita"},Nils:{code:"lv-LV-NilsNeural",language:"lv-LV",displayName:"Nils",localName:"Nils"},Dena:{code:"nl-BE-DenaNeural",language:"nl-BE",displayName:"Dena",localName:"Dena"},Arnaud:{code:"nl-BE-ArnaudNeural",language:"nl-BE",displayName:"Arnaud",localName:"Arnaud"},Xiaoyi:{code:"zh-CN-XiaoyiNeural",language:"zh-CN",displayName:"Xiaoyi",localName:"晓伊"},Xiaoxiao:{code:"zh-CN-XiaoxiaoNeural",language:"zh-CN",displayName:"Xiaoxiao",localName:"晓晓"},Yunyang:{code:"zh-CN-YunyangNeural",language:"zh-CN",displayName:"Yunyang",localName:"云扬"},Yunxia:{code:"zh-CN-YunxiaNeural",language:"zh-CN",displayName:"Yunxia",localName:"云夏"},Yunxi:{code:"zh-CN-YunxiNeural",language:"zh-CN",displayName:"Yunxi",localName:"云希"},Yunjian:{code:"zh-CN-YunjianNeural",language:"zh-CN",displayName:"Yunjian",localName:"云健"},Uzma:{code:"ur-PK-UzmaNeural",language:"ur-PK",displayName:"Uzma",localName:"عظمیٰ"},Asad:{code:"ur-PK-AsadNeural",language:"ur-PK",displayName:"Asad",localName:"اسد"},Shruti:{code:"te-IN-ShrutiNeural",language:"te-IN",displayName:"Shruti",localName:"శ్రుతి"},Mohan:{code:"te-IN-MohanNeural",language:"te-IN",displayName:"Mohan",localName:"మోహన్"},Swara:{code:"hi-IN-SwaraNeural",language:"hi-IN",displayName:"Swara",localName:"स्वरा"},Madhur:{code:"hi-IN-MadhurNeural",language:"hi-IN",displayName:"Madhur",localName:"मधुर"},Ezinne:{code:"en-NG-EzinneNeural",language:"en-NG",displayName:"Ezinne",localName:"Ezinne"},Abeo:{code:"en-NG-AbeoNeural",language:"en-NG",displayName:"Abeo",localName:"Abeo"},Leni:{code:"de-CH-LeniNeural",language:"de-CH",displayName:"Leni",localName:"Leni"},Jan:{code:"de-CH-JanNeural",language:"de-CH",displayName:"Jan",localName:"Jan"},Nanami:{code:"ja-JP-NanamiNeural",language:"ja-JP",displayName:"Nanami",localName:"七海"},Keita:{code:"ja-JP-KeitaNeural",language:"ja-JP",displayName:"Keita",localName:"圭太"},Vesna:{code:"bs-BA-VesnaNeural",language:"bs-BA",displayName:"Vesna",localName:"Vesna"},Goran:{code:"bs-BA-GoranNeural",language:"bs-BA",displayName:"Goran",localName:"Goran"},Maryam:{code:"ar-YE-MaryamNeural",language:"ar-YE",displayName:"Maryam",localName:"مريم"},Saleh:{code:"ar-YE-SalehNeural",language:"ar-YE",displayName:"Saleh",localName:"صالح"},Hemkala:{code:"ne-NP-HemkalaNeural",language:"ne-NP",displayName:"Hemkala",localName:"हेमकला"},Sagar:{code:"ne-NP-SagarNeural",language:"ne-NP",displayName:"Sagar",localName:"सागर"},Eka:{code:"ka-GE-EkaNeural",language:"ka-GE",displayName:"Eka",localName:"ეკა"},Giorgi:{code:"ka-GE-GiorgiNeural",language:"ka-GE",displayName:"Giorgi",localName:"გიორგი"},Amal:{code:"ar-QA-AmalNeural",language:"ar-QA",displayName:"Amal",localName:"أمل"},Moaz:{code:"ar-QA-MoazNeural",language:"ar-QA",displayName:"Moaz",localName:"معاذ"},Marta:{code:"es-GT-MartaNeural",language:"es-GT",displayName:"Marta",localName:"Marta"},Andres:{code:"es-GT-AndresNeural",language:"es-GT",displayName:"Andres",localName:"Ándres"},Teresa:{code:"es-GQ-TeresaNeural",language:"es-GQ",displayName:"Teresa",localName:"Teresa"},Javier:{code:"es-GQ-JavierNeural",language:"es-GQ",displayName:"Javier",localName:"Javier"},Camila:{code:"es-PE-CamilaNeural",language:"es-PE",displayName:"Camila",localName:"Camila"},Alex:{code:"es-PE-AlexNeural",language:"es-PE",displayName:"Alex",localName:"Álex"},Molly:{code:"en-NZ-MollyNeural",language:"en-NZ",displayName:"Molly",localName:"Molly"},Mitchell:{code:"en-NZ-MitchellNeural",language:"en-NZ",displayName:"Mitchell",localName:"Mitchell"},Dilara:{code:"fa-IR-DilaraNeural",language:"fa-IR",displayName:"Dilara",localName:"دلارا"},Farid:{code:"fa-IR-FaridNeural",language:"fa-IR",displayName:"Farid",localName:"فرید"},Margarita:{code:"es-PA-MargaritaNeural",language:"es-PA",displayName:"Margarita",localName:"Margarita"},Roberto:{code:"es-PA-RobertoNeural",language:"es-PA",displayName:"Roberto",localName:"Roberto"},Alina:{code:"ro-RO-AlinaNeural",language:"ro-RO",displayName:"Alina",localName:"Alina"},Emil:{code:"ro-RO-EmilNeural",language:"ro-RO",displayName:"Emil",localName:"Emil"},Grace:{code:"mt-MT-GraceNeural",language:"mt-MT",displayName:"Grace",localName:"Grace"},Joseph:{code:"mt-MT-JosephNeural",language:"mt-MT",displayName:"Joseph",localName:"Joseph"},Anu:{code:"et-EE-AnuNeural",language:"et-EE",displayName:"Anu",localName:"Anu"},Kert:{code:"et-EE-KertNeural",language:"et-EE",displayName:"Kert",localName:"Kert"},Emel:{code:"tr-TR-EmelNeural",language:"tr-TR",displayName:"Emel",localName:"Emel"},Ahmet:{code:"tr-TR-AhmetNeural",language:"tr-TR",displayName:"Ahmet",localName:"Ahmet"},Denise:{code:"fr-FR-DeniseNeural",language:"fr-FR",displayName:"Denise",localName:"Denise"},Eloise:{code:"fr-FR-EloiseNeural",language:"fr-FR",displayName:"Eloise",localName:"Eloise"},Henri:{code:"fr-FR-HenriNeural",language:"fr-FR",displayName:"Henri",localName:"Henri"},HoaiMy:{code:"vi-VN-HoaiMyNeural",language:"vi-VN",displayName:"HoaiMy",localName:"Hoài My"},NamMinh:{code:"vi-VN-NamMinhNeural",language:"vi-VN",displayName:"NamMinh",localName:"Nam Minh"},Libby:{code:"en-GB-LibbyNeural",language:"en-GB",displayName:"Libby",localName:"Libby"},Sonia:{code:"en-GB-SoniaNeural",language:"en-GB",displayName:"Sonia",localName:"Sonia"},Thomas:{code:"en-GB-ThomasNeural",language:"en-GB",displayName:"Thomas",localName:"Thomas"},Ryan:{code:"en-GB-RyanNeural",language:"en-GB",displayName:"Ryan",localName:"Ryan"},Sreymom:{code:"km-KH-SreymomNeural",language:"km-KH",displayName:"Sreymom",localName:"ស្រីមុំ"},Piseth:{code:"km-KH-PisethNeural",language:"km-KH",displayName:"Piseth",localName:"ពិសិដ្ឋ"},Noora:{code:"fi-FI-NooraNeural",language:"fi-FI",displayName:"Noora",localName:"Noora"},Harri:{code:"fi-FI-HarriNeural",language:"fi-FI",displayName:"Harri",localName:"Harri"},Banu:{code:"az-AZ-BanuNeural",language:"az-AZ",displayName:"Banu",localName:"Banu"},Babek:{code:"az-AZ-BabekNeural",language:"az-AZ",displayName:"Babek",localName:"Babək"},Clara:{code:"en-CA-ClaraNeural",language:"en-CA",displayName:"Clara",localName:"Clara"},Liam:{code:"en-CA-LiamNeural",language:"en-CA",displayName:"Liam",localName:"Liam"},Ona:{code:"lt-LT-OnaNeural",language:"lt-LT",displayName:"Ona",localName:"Ona"},Leonas:{code:"lt-LT-LeonasNeural",language:"lt-LT",displayName:"Leonas",localName:"Leonas"},Fatima:{code:"ar-AE-FatimaNeural",language:"ar-AE",displayName:"Fatima",localName:"فاطمة"},Hamdan:{code:"ar-AE-HamdanNeural",language:"ar-AE",displayName:"Hamdan",localName:"حمدان"},Petra:{code:"sl-SI-PetraNeural",language:"sl-SI",displayName:"Petra",localName:"Petra"},Rok:{code:"sl-SI-RokNeural",language:"sl-SI",displayName:"Rok",localName:"Rok"},Ramona:{code:"es-DO-RamonaNeural",language:"es-DO",displayName:"Ramona",localName:"Ramona"},Emilio:{code:"es-DO-EmilioNeural",language:"es-DO",displayName:"Emilio",localName:"Emilio"},Rana:{code:"ar-IQ-RanaNeural",language:"ar-IQ",displayName:"Rana",localName:"رنا"},Bassel:{code:"ar-IQ-BasselNeural",language:"ar-IQ",displayName:"Bassel",localName:"باسل"},Tanishaa:{code:"bn-IN-TanishaaNeural",language:"bn-IN",displayName:"Tanishaa",localName:"তানিশা"},Bashkar:{code:"bn-IN-BashkarNeural",language:"bn-IN",displayName:"Bashkar",localName:"ভাস্কর"},Thilini:{code:"si-LK-ThiliniNeural",language:"si-LK",displayName:"Thilini",localName:"තිළිණි"},Sameera:{code:"si-LK-SameeraNeural",language:"si-LK",displayName:"Sameera",localName:"සමීර"},Ariane:{code:"fr-CH-ArianeNeural",language:"fr-CH",displayName:"Ariane",localName:"Ariane"},Fabrice:{code:"fr-CH-FabriceNeural",language:"fr-CH",displayName:"Fabrice",localName:"Fabrice"},Andrea:{code:"es-EC-AndreaNeural",language:"es-EC",displayName:"Andrea",localName:"Andrea"},Luis:{code:"es-EC-LuisNeural",language:"es-EC",displayName:"Luis",localName:"Luis"},Paloma:{code:"es-US-PalomaNeural",language:"es-US",displayName:"Paloma",localName:"Paloma"},Alonso:{code:"es-US-AlonsoNeural",language:"es-US",displayName:"Alonso",localName:"Alonso"},Sapna:{code:"kn-IN-SapnaNeural",language:"kn-IN",displayName:"Sapna",localName:"ಸಪ್ನಾ"},Gagan:{code:"kn-IN-GaganNeural",language:"kn-IN",displayName:"Gagan",localName:"ಗಗನ್"},Keomany:{code:"lo-LA-KeomanyNeural",language:"lo-LA",displayName:"Keomany",localName:"ແກ້ວມະນີ"},Chanthavong:{code:"lo-LA-ChanthavongNeural",language:"lo-LA",displayName:"Chanthavong",localName:"ຈັນທະວົງ"},Zariyah:{code:"ar-SA-ZariyahNeural",language:"ar-SA",displayName:"Zariyah",localName:"زارية"},Hamed:{code:"ar-SA-HamedNeural",language:"ar-SA",displayName:"Hamed",localName:"حامد"},Joana:{code:"ca-ES-JoanaNeural",language:"ca-ES",displayName:"Joana",localName:"Joana"},Enric:{code:"ca-ES-EnricNeural",language:"ca-ES",displayName:"Enric",localName:"Enric"},Katja:{code:"de-DE-KatjaNeural",language:"de-DE",displayName:"Katja",localName:"Katja"},Amala:{code:"de-DE-AmalaNeural",language:"de-DE",displayName:"Amala",localName:"Amala"},Conrad:{code:"de-DE-ConradNeural",language:"de-DE",displayName:"Conrad",localName:"Conrad"},Killian:{code:"de-DE-KillianNeural",language:"de-DE",displayName:"Killian",localName:"Killian"},HiuGaai:{code:"zh-HK-HiuGaaiNeural",language:"zh-HK",displayName:"HiuGaai",localName:"曉佳"},HiuMaan:{code:"zh-HK-HiuMaanNeural",language:"zh-HK",displayName:"HiuMaan",localName:"曉曼"},WanLung:{code:"zh-HK-WanLungNeural",language:"zh-HK",displayName:"WanLung",localName:"雲龍"},Francisca:{code:"pt-BR-FranciscaNeural",language:"pt-BR",displayName:"Francisca",localName:"Francisca"},Antonio:{code:"pt-BR-AntonioNeural",language:"pt-BR",displayName:"Antonio",localName:"Antonio"},Valentina:{code:"es-UY-ValentinaNeural",language:"es-UY",displayName:"Valentina",localName:"Valentina"},Mateo:{code:"es-UY-MateoNeural",language:"es-UY",displayName:"Mateo",localName:"Mateo"},Zuri:{code:"sw-KE-ZuriNeural",language:"sw-KE",displayName:"Zuri",localName:"Zuri"},Rafiki:{code:"sw-KE-RafikiNeural",language:"sw-KE",displayName:"Rafiki",localName:"Rafiki"},Laila:{code:"ar-BH-LailaNeural",language:"ar-BH",displayName:"Laila",localName:"ليلى"},Ali:{code:"ar-BH-AliNeural",language:"ar-BH",displayName:"Ali",localName:"علي"},Elvira:{code:"es-ES-ElviraNeural",language:"es-ES",displayName:"Elvira",localName:"Elvira"},Alvaro:{code:"es-ES-AlvaroNeural",language:"es-ES",displayName:"Alvaro",localName:"Alvaro"},Aigul:{code:"kk-KZ-AigulNeural",language:"kk-KZ",displayName:"Aigul",localName:"Айгүл"},Daulet:{code:"kk-KZ-DauletNeural",language:"kk-KZ",displayName:"Daulet",localName:"Дәулет"},Sana:{code:"ar-JO-SanaNeural",language:"ar-JO",displayName:"Sana",localName:"سناء"},Taim:{code:"ar-JO-TaimNeural",language:"ar-JO",displayName:"Taim",localName:"تيم"},Paola:{code:"es-VE-PaolaNeural",language:"es-VE",displayName:"Paola",localName:"Paola"},Sebastian:{code:"es-VE-SebastianNeural",language:"es-VE",displayName:"Sebastian",localName:"Sebastián"},Ubax:{code:"so-SO-UbaxNeural",language:"so-SO",displayName:"Ubax",localName:"Ubax"},Muuse:{code:"so-SO-MuuseNeural",language:"so-SO",displayName:"Muuse",localName:"Muuse"},Imani:{code:"en-TZ-ImaniNeural",language:"en-TZ",displayName:"Imani",localName:"Imani"},Elimu:{code:"en-TZ-ElimuNeural",language:"en-TZ",displayName:"Elimu",localName:"Elimu"},Tuti:{code:"su-ID-TutiNeural",language:"su-ID",displayName:"Tuti",localName:"Tuti"},Jajang:{code:"su-ID-JajangNeural",language:"su-ID",displayName:"Jajang",localName:"Jajang"},Dalia:{code:"es-MX-DaliaNeural",language:"es-MX",displayName:"Dalia",localName:"Dalia"},Jorge:{code:"es-MX-JorgeNeural",language:"es-MX",displayName:"Jorge",localName:"Jorge"},Elsa:{code:"it-IT-ElsaNeural",language:"it-IT",displayName:"Elsa",localName:"Elsa"},Isabella:{code:"it-IT-IsabellaNeural",language:"it-IT",displayName:"Isabella",localName:"Isabella"},Diego:{code:"it-IT-DiegoNeural",language:"it-IT",displayName:"Diego",localName:"Diego"},Gul:{code:"ur-IN-GulNeural",language:"ur-IN",displayName:"Gul",localName:"گل"},Salman:{code:"ur-IN-SalmanNeural",language:"ur-IN",displayName:"Salman",localName:"سلمان"},Nabanita:{code:"bn-BD-NabanitaNeural",language:"bn-BD",displayName:"Nabanita",localName:"নবনীতা"},Pradeep:{code:"bn-BD-PradeepNeural",language:"bn-BD",displayName:"Pradeep",localName:"প্রদ্বীপ"},Gadis:{code:"id-ID-GadisNeural",language:"id-ID",displayName:"Gadis",localName:"Gadis"},Ardi:{code:"id-ID-ArdiNeural",language:"id-ID",displayName:"Ardi",localName:"Ardi"},Yolanda:{code:"es-NI-YolandaNeural",language:"es-NI",displayName:"Yolanda",localName:"Yolanda"},Federico:{code:"es-NI-FedericoNeural",language:"es-NI",displayName:"Federico",localName:"Federico"},Premwadee:{code:"th-TH-PremwadeeNeural",language:"th-TH",displayName:"Premwadee",localName:"เปรมวดี"},Niwat:{code:"th-TH-NiwatNeural",language:"th-TH",displayName:"Niwat",localName:"นิวัฒน์"}},_1={"af-ZA":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"am-ET":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"ar-AE":{0:[],1:[]},"ar-BH":{0:[],1:[]},"ar-DZ":{0:[],1:[]},"ar-EG":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"ar-IQ":{0:[],1:[]},"ar-JO":{0:[],1:[]},"ar-KW":{0:[],1:[]},"ar-LB":{0:[],1:[]},"ar-LY":{0:[],1:[]},"ar-MA":{0:[],1:[]},"ar-OM":{0:[],1:[]},"ar-QA":{0:[],1:[]},"ar-SA":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"ar-SY":{0:[],1:[]},"ar-TN":{0:[],1:[]},"ar-YE":{0:[],1:[]},"az-AZ":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"bg-BG":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"bn-BD":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"bn-IN":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"bs-BA":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"ca-ES":{0:["Alba","AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"cs-CZ":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"cy-GB":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"da-DK":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"de-AT":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"de-CH":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"de-DE":{0:["Seraphina:DragonHDLatestNeural","Gisela","Elke","Klarissa","Louisa","Maja","Tanja","AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["Bernd","Kasper","Christoph","Klaus","Ralf","AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"el-GR":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"en-AU":{0:["Annette","Carly","Elsie","Freya","Joanne","Kim","Tina","AvaMultilingual","EmmaMultilingual","JennyMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["Darren","Duncan","Ken","Neil","Tim","AndrewMultilingual","BrianMultilingual","RyanMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"en-CA":{0:["AvaMultilingual","EmmaMultilingual","JennyMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","RyanMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"en-GB":{0:["Abbi","Bella","Hollie","Olivia","Mia","AvaMultilingual","EmmaMultilingual","JennyMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["Alfie","Elliot","Ethan","Noah","Oliver","RyanMultilingual","AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"en-HK":{0:["JennyMultilingual"],1:["RyanMultilingual"]},"en-IE":{0:["AvaMultilingual","EmmaMultilingual","JennyMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","RyanMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"en-IN":{0:["Aashi","Ananya","Kavya","AvaMultilingual","EmmaMultilingual","JennyMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","RyanMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"en-KE":{0:[],1:[]},"en-NG":{0:[],1:[]},"en-NZ":{0:[],1:[]},"en-PH":{0:[],1:[]},"en-SG":{0:[],1:[]},"en-TZ":{0:[],1:[]},"en-US":{0:["Aria:DragonHDLatestNeural","Ava:DragonHDLatestNeural","Emma:DragonHDLatestNeural","Emma2:DragonHDLatestNeural","Jenny:DragonHDLatestNeural","Jane","Sara","Nancy","Amber","Ashley","Cora","Elizabeth","Monica","AIGenerate2","Blue","JennyMultilingual","AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["Andrew:DragonHDLatestNeural","Andrew2:DragonHDLatestNeural","Davis:DragonHDLatestNeural","Steffan:DragonHDLatestNeural","Davis","Jason","Tony","Brandon","Jacob","AIGenerate1","Blue","AndrewMultilingual","BrianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual","FlorianMultilingual"]},"en-ZA":{0:[],1:[]},"es-AR":{0:[],1:[]},"es-BO":{0:[],1:[]},"es-CL":{0:[],1:[]},"es-CO":{0:[],1:[]},"es-CR":{0:[],1:[]},"es-CU":{0:[],1:[]},"es-DO":{0:[],1:[]},"es-EC":{0:[],1:[]},"es-ES":{0:["Abril","Estrella","Irene","Laia","Lia","Triana","Vera","Ximena","AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["Arnau","Dario","Elias","Nil","Saul","Teo","AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"es-GQ":{0:[],1:[]},"es-GT":{0:[],1:[]},"es-HN":{0:[],1:[]},"es-MX":{0:["Beatriz","Candela","Carlota","Larissa","Marina","Nuria","Renata","AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["Cecilio","Gerardo","Liberto","Luciano","Pelayo","Yago","AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"es-NI":{0:[],1:[]},"es-PA":{0:[],1:[]},"es-PE":{0:[],1:[]},"es-PR":{0:[],1:[]},"es-PY":{0:[],1:[]},"es-SV":{0:[],1:[]},"es-US":{0:[],1:[]},"es-UY":{0:[],1:[]},"es-VE":{0:[],1:[]},"et-EE":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"eu-ES":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"fa-IR":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"fi-FI":{0:["Selma","AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"fil-PH":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","RyanMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"fr-BE":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"fr-CA":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["Thierry","AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"fr-CH":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"fr-FR":{0:["Jacqueline","Josephine","Brigitte","Coralie","Celeste","Yvette","AvaMultilingual","EmmaMultilingual","VivienneMultilingual","SeraphinaMultilingual","JennyMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["Claude","Alain","Jerome","Maurice","Yves","AndrewMultilingual","BrianMultilingual","RemyMultilingual","FlorianMultilingual","RyanMultilingual","MasaruMultilingual","YunyiMultilingual"]},"ga-IE":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"gl-ES":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"gu-IN":{0:[],1:[]},"he-IL":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"hi-IN":{0:["Ananya-hi","Kavya-hi","AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"hr-HR":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"hu-HU":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"hy-AM":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"id-ID":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"is-IS":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"it-IT":{0:["Fabiola","Fiamma","Imelda","Irma","Palmira","Pierina","AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["Benigno","Calimero","Cataldo","Gianni","Giuseppe","Lisandro","Rinaldo","AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"ja-JP":{0:["Shiori","Mayu","Aoi","AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["Masaru:DragonHDLatestNeural","Naoki","Daichi","AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"jv-ID":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"ka-GE":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"kk-KZ":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"km-KH":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"kn-IN":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"ko-KR":{0:["JiMin","SeoHyeon","SoonBok","YuJin","SeraphinaMultilingual","AvaMultilingual","EmmaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["BongJin","GookMin","Hyunsu","AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"lo-LA":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"lt-LT":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"lv-LV":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"mk-MK":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"ml-IN":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"mn-MN":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"mr-IN":{0:[],1:[]},"ms-MY":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"mt-MT":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"my-MM":{0:["Nilar","AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["Thiha","AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"nb-NO":{0:["Iselin","AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"ne-NP":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"nl-BE":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"nl-NL":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"pl-PL":{0:["Agnieszka","AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"ps-AF":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"pt-BR":{0:["Giovanna","Leila","Leticia","Yara","Manuela","Thalita","Elza","Brenda","AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["Julio","Humberto","Nicolau","Valerio","Fabio","Donato","AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"pt-PT":{0:["Fernanda","AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"ro-RO":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"ru-RU":{0:["Dariya","AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"si-LK":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"sk-SK":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"sl-SI":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"so-SO":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"sq-AL":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"sr-RS":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"su-ID":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"sv-SE":{0:["Hillevi","AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"sw-KE":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"sw-TZ":{0:[],1:[]},"ta-IN":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"ta-LK":{0:[],1:[]},"ta-MY":{0:[],1:[]},"ta-SG":{0:[],1:[]},"te-IN":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"th-TH":{0:["Achara","AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"tr-TR":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"uk-UA":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"ur-IN":{0:[],1:[]},"ur-PK":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"uz-UZ":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"vi-VN":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"zh-CN":{0:["Xiaochen:DragonHDLatestNeural","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual","Xiaohan","Xiaomeng","Xiaomo","Xiaoqiu","Xiaorui","Xiaoshuang","Xiaoyan","Xiaoxuan","Xiaoyou","Xiaozhen","Xiaorou","Xiaotong","XiaoMin","Xiaobei","Xiaoni"],1:["YunyiMultilingual","Yunfeng","Yunhao","Yunjie","Yunye","Yunze","Yunzhe","YunSong","Yunqi","Yundeng","Yunbiao","Yunxiang","Yunxi-SiChuan"]},"zh-HK":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"zh-TW":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"zu-ZA":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]}};class M1{static isEdgeVoice(e){let t=L1[dr.toLanguage][0];if(It.isArray(t)){for(let n of t)if(bu[n].code===e)return!0}let r=L1[dr.toLanguage][1];if(It.isArray(r)){for(let n of r)if(bu[n].code===e)return!0}return!1}static isAzureVoice(e){let t=_1[dr.toLanguage][0];if(It.isArray(t)){for(let n of t)if(bu[n].code===e)return!0}let r=_1[dr.toLanguage][1];if(It.isArray(r)){for(let n of r)if(bu[n].code===e)return!0}return!1}}class CN{static isMobile(){return"ontouchstart"in document.documentElement}}const Ot=class Ot{static get fromLanguage(){return this._fromLanguage}static set fromLanguage(e){this._fromLanguage=e}static get toLanguage(){return this._toLanguage}static set toLanguage(e){this._toLanguage=e}static get gender(){return this._gender}static set gender(e){this._gender=e}static get voice(){return this._voice}static set voice(e){this._voice=e}static get originalVolume(){return this._originalVolume}static set originalVolume(e){this._originalVolume=e}static get translationVolume(){return this._translationVolume}static set translationVolume(e){this._translationVolume=e}static get adjustmentModel(){return this._adjustmentModel}static set adjustmentModel(e){this._adjustmentModel=e}static get loadingContainerDiv(){return this._loadingContainerDiv}static set loadingContainerDiv(e){this._loadingContainerDiv=e}static get translateEngine(){return this._translateEngine}static set translateEngine(e){this._translateEngine=e}static set voicesType(e){this._voicesType=e}static get voicesType(){return this._voicesType}static set videoVolumeControlModel(e){this._videoVolumeControlModel=e}static get videoVolumeControlModel(){return this._videoVolumeControlModel}static set iosOpenOriginVolume(e){this._iosOpenOriginVolume=e}static get iosOpenOriginVolume(){return this._iosOpenOriginVolume}static set showSubtitle(e){this._showSubtitle=e}static get showSubtitle(){return this._showSubtitle}static set floatingBall(e){this._floatingBall=e}static get floatingBall(){return this._floatingBall}static set multiSpeaker(e){this._multiSpeaker=e}static get multiSpeaker(){return this._multiSpeaker}static hasMultipleSpeakers(){return this._multiSpeaker&&this._multiSpeaker.length>1}static set subtitleSize(e){this._subtitleSize=e}static get subtitleSize(){return this._subtitleSize}static isVoiceTypeMatchMultiVoice(){let e=Ot.multiSpeaker[0];return Ot.isUseFreeVoiceType()?M1.isEdgeVoice(e):M1.isAzureVoice(e)}static isUseFreeVoiceType(){return!Ot.voicesType||Ot.voicesType==="free"}static matchFromLanguage(e){let t=this._fromLanguage.toLowerCase(),r=e.toLowerCase();return t==="zh-cn"?r==="zh-hans"||r==="zh-cn"||r==="cn"?!0:t.startsWith(e):t==="zh-hk"||t==="zh-tw"?r==="zh-hant"||r==="zh-hk"||r==="zh-tw"||r==="tw"||r==="hk"?!0:t.startsWith(e):r===t?!0:r.length>t.length?r.startsWith(t):t.startsWith(r)}static get segmentationStrategy(){return this._segmentationStrategy}static set segmentationStrategy(e){this._segmentationStrategy=e}static get enableSmartSegmentation(){return this._enableSmartSegmentation}static set enableSmartSegmentation(e){this._enableSmartSegmentation=e}static get longSubtitleThreshold(){return this._longSubtitleThreshold}static set longSubtitleThreshold(e){this._longSubtitleThreshold=e}};re(Ot,"_fromLanguage","en-US"),re(Ot,"_toLanguage","zh_CN"),re(Ot,"_gender","1"),re(Ot,"_voice",""),re(Ot,"_originalVolume",0),re(Ot,"_translationVolume",1),re(Ot,"_videoVolumeControlModel",!1),re(Ot,"_adjustmentModel",!0),re(Ot,"_loadingContainerDiv"),re(Ot,"_translateEngine","google"),re(Ot,"_voicesType","free"),re(Ot,"_iosOpenOriginVolume",!1),re(Ot,"_showSubtitle",!1),re(Ot,"_floatingBall",CN.isMobile()),re(Ot,"_multiSpeaker",[]),re(Ot,"_subtitleSize",20),re(Ot,"_segmentationStrategy","reverse"),re(Ot,"_enableSmartSegmentation",!0),re(Ot,"_longSubtitleThreshold",60);let dr=Ot;class Ko{getBestSubtitle(e,t){const r=this.getSubtitles(e,t),n=this.selectBestSubtitle(r);return this.postProcessSubtitle(n,t)}selectBestSubtitle(e){if(!(!e||It.isEmpty(e))){if(e.length===1)return e[0];{let t=It.groupBy(e,n=>n.isAsr);const r=t.false;return It.isEmpty(r)?this.selectBestSubtitleByLanguage(t.true):this.selectBestSubtitleByLanguage(r)}}}selectBestSubtitleByLanguage(e){if(e.length===1)return e[0];try{return Qr.of(e).filter(t=>dr.matchFromLanguage(t.language)).toFirst()}catch{return e[0]}}postProcessSubtitle(e,t){return e}}class ti{static completeUrl(e){return e.startsWith("//")?window.location.protocol+e:e.startsWith("/")?window.location.origin+e:e}static resolveUrl(e,t){try{return new URL(e).href}catch{try{return new URL(e,t).href}catch{return e}}}static extractVideoId(e,t){const r=If.match(t),n=new URL(e).pathname,s=r(n);if(s)return s.params.videoId}static endsWith(e,t){try{return new URL(e).pathname.endsWith(t)}catch{return!1}}static addParam(e,t,r){try{const n=new URL(e);return n.searchParams.set(t,r),n.toString()}catch{const s=e.includes("?")?"&":"?";return`${e}${s}${encodeURIComponent(t)}=${encodeURIComponent(r)}`}}static replaceParam(e,t,r){try{const n=new URL(e);return n.searchParams.has(t)?(n.searchParams.set(t,r),n.toString()):e}catch{try{const s=e.indexOf("#"),a=s>=0?e.substring(s):"",o=s>=0?e.substring(0,s):e,l=o.indexOf("?");if(l===-1)return e;const u=o.substring(0,l),d=o.substring(l+1).split("&");let p=!1;const g=d.map(m=>{if(!m)return m;const v=m.indexOf("="),E=v>=0?m.substring(0,v):m;return decodeURIComponent(E)===t?(p=!0,`${E}=${encodeURIComponent(r)}`):m});return p?`${u}?${g.join("&")}${a}`:e}catch{return e}}}static removeQueryParams(e){try{const t=new URL(e);return t.search="",t.toString()}catch{return e}}}class P1 extends Ko{getSubtitles(e,t){if(!t.data)throw console.error("Context vo object is missing, unable to extract subtitles using JSONPath"),Error("Context vo object is missing, unable to extract subtitles using JSONPath");if(!e.subtitleListJsonPath)throw console.error("Subtitle extraction configuration is missing subtitleListJsonPath property",e),new Error("Subtitle extraction configuration is missing subtitleListJsonPath property");const r=Ji(t.data,e.subtitleListJsonPath);return It.isEmpty(r)?[]:Qr.of(r).map(n=>this.buildSubtitleMetaData(n,e)).toArray()}buildSubtitleMetaData(e,t){const r=this.isAsr(e,t);return{url:ti.completeUrl(e[t.subtitleUrlName]),language:e[t.subtitleLanguageName],isAsr:r,hasPunctuation:!r}}isAsr(e,t){return!t.subtitleAsrName||!t.subtitleAsrValue?!1:String(e[t.subtitleAsrName])===t.subtitleAsrValue}}class wN{getVideoLanguage(e,t){const r=e.subtitleExtract,n=new P1().getSubtitles(r,t);if(!It.isEmpty(n)){for(const s of n)if(s.isAsr)return s.language}}}class LN{getTitle(e,t){if(t.data===void 0)throw console.error("Context does not contain vo object, unable to extract video title"),new Error("Context vo is undefined, cannot extract title");if(!e.values||It.isEmpty(e.values))throw console.error("Title extraction configuration is missing jsonPath expressions",e),new Error("ExtractTitleConfig values are empty or undefined");return Qr.of(e.values).map(n=>Ji(t.data,n)).flatten().toArray()[0]}}class _N{getTitle(e,t){if(!e.values||It.isEmpty(e.values))throw console.error("Title extraction rule missing values property",e),new Error("Title extraction rule missing values property");const r=t.computeUrlMatchResultIfAbsent(()=>If.match(e.values[0],{decode:decodeURIComponent})(window.location.href));if(!r)throw console.error("Title extraction rule configuration error for current URL",e),new Error("Title extraction rule configuration error for current URL");return r.params[e.values[1]]}}const Rn=document,Au=window,k1=Rn.documentElement,Hs=Rn.createElement.bind(Rn),O1=Hs("div"),Nf=Hs("table"),MN=Hs("tbody"),F1=Hs("tr"),{isArray:Su,prototype:B1}=Array,{concat:PN,filter:Cf,indexOf:U1,map:$1,push:kN,slice:G1,some:wf,splice:ON}=B1,FN=/^#(?:[\w-]|\\.|[^\x00-\xa0])*$/,BN=/^\.(?:[\w-]|\\.|[^\x00-\xa0])*$/,UN=/<.+>/,$N=/^\w+$/;function Lf(i,e){const t=GN(e);return!i||!t&&!Ks(e)&&!fr(e)?[]:!t&&BN.test(i)?e.getElementsByClassName(i.slice(1).replace(/\\/g,"")):!t&&$N.test(i)?e.getElementsByTagName(i):e.querySelectorAll(i)}class xu{constructor(e,t){if(!e)return;if(_f(e))return e;let r=e;if(Fr(e)){const n=t||Rn;if(r=FN.test(e)&&Ks(n)?n.getElementById(e.slice(1).replace(/\\/g,"")):UN.test(e)?Y1(e):_f(n)?n.find(e):Fr(n)?Le(n).find(e):Lf(e,n),!r)return}else if(Ws(e))return this.ready(e);(r.nodeType||r===Au)&&(r=[r]),this.length=r.length;for(let n=0,s=this.length;n<s;n++)this[n]=r[n]}init(e,t){return new xu(e,t)}}const xe=xu.prototype,Le=xe.init;Le.fn=Le.prototype=xe,xe.length=0,xe.splice=ON,typeof Symbol=="function"&&(xe[Symbol.iterator]=B1[Symbol.iterator]);function _f(i){return i instanceof xu}function Pa(i){return!!i&&i===i.window}function Ks(i){return!!i&&i.nodeType===9}function GN(i){return!!i&&i.nodeType===11}function fr(i){return!!i&&i.nodeType===1}function qN(i){return!!i&&i.nodeType===3}function VN(i){return typeof i=="boolean"}function Ws(i){return typeof i=="function"}function Fr(i){return typeof i=="string"}function ri(i){return i===void 0}function Wo(i){return i===null}function q1(i){return!isNaN(parseFloat(i))&&isFinite(i)}function Mf(i){if(typeof i!="object"||i===null)return!1;const e=Object.getPrototypeOf(i);return e===null||e===Object.prototype}Le.isWindow=Pa,Le.isFunction=Ws,Le.isArray=Su,Le.isNumeric=q1,Le.isPlainObject=Mf;function Er(i,e,t){if(t){let r=i.length;for(;r--;)if(e.call(i[r],r,i[r])===!1)return i}else if(Mf(i)){const r=Object.keys(i);for(let n=0,s=r.length;n<s;n++){const a=r[n];if(e.call(i[a],a,i[a])===!1)return i}}else for(let r=0,n=i.length;r<n;r++)if(e.call(i[r],r,i[r])===!1)return i;return i}Le.each=Er,xe.each=function(i){return Er(this,i)},xe.empty=function(){return this.each((i,e)=>{for(;e.firstChild;)e.removeChild(e.firstChild)})};function Tu(...i){const e=VN(i[0])?i.shift():!1,t=i.shift(),r=i.length;if(!t)return{};if(!r)return Tu(e,Le,t);for(let n=0;n<r;n++){const s=i[n];for(const a in s)e&&(Su(s[a])||Mf(s[a]))?((!t[a]||t[a].constructor!==s[a].constructor)&&(t[a]=new s[a].constructor),Tu(e,t[a],s[a])):t[a]=s[a]}return t}Le.extend=Tu,xe.extend=function(i){return Tu(xe,i)};const HN=/\S+/g;function Du(i){return Fr(i)?i.match(HN)||[]:[]}xe.toggleClass=function(i,e){const t=Du(i),r=!ri(e);return this.each((n,s)=>{fr(s)&&Er(t,(a,o)=>{r?e?s.classList.add(o):s.classList.remove(o):s.classList.toggle(o)})})},xe.addClass=function(i){return this.toggleClass(i,!0)},xe.removeAttr=function(i){const e=Du(i);return this.each((t,r)=>{fr(r)&&Er(e,(n,s)=>{r.removeAttribute(s)})})};function KN(i,e){if(i){if(Fr(i)){if(arguments.length<2){if(!this[0]||!fr(this[0]))return;const t=this[0].getAttribute(i);return Wo(t)?void 0:t}return ri(e)?this:Wo(e)?this.removeAttr(i):this.each((t,r)=>{fr(r)&&r.setAttribute(i,e)})}for(const t in i)this.attr(t,i[t]);return this}}xe.attr=KN,xe.removeClass=function(i){return arguments.length?this.toggleClass(i,!1):this.attr("class","")},xe.hasClass=function(i){return!!i&&wf.call(this,e=>fr(e)&&e.classList.contains(i))},xe.get=function(i){return ri(i)?G1.call(this):(i=Number(i),this[i<0?i+this.length:i])},xe.eq=function(i){return Le(this.get(i))},xe.first=function(){return this.eq(0)},xe.last=function(){return this.eq(-1)};function WN(i){return ri(i)?this.get().map(e=>fr(e)||qN(e)?e.textContent:"").join(""):this.each((e,t)=>{fr(t)&&(t.textContent=i)})}xe.text=WN;function In(i,e,t){if(!fr(i))return;const r=Au.getComputedStyle(i,null);return t?r.getPropertyValue(e)||void 0:r[e]||i.style[e]}function Zi(i,e){return parseInt(In(i,e),10)||0}function V1(i,e){return Zi(i,`border${e?"Left":"Top"}Width`)+Zi(i,`padding${e?"Left":"Top"}`)+Zi(i,`padding${e?"Right":"Bottom"}`)+Zi(i,`border${e?"Right":"Bottom"}Width`)}const Pf={};function YN(i){if(Pf[i])return Pf[i];const e=Hs(i);Rn.body.insertBefore(e,null);const t=In(e,"display");return Rn.body.removeChild(e),Pf[i]=t!=="none"?t:"block"}function H1(i){return In(i,"display")==="none"}function K1(i,e){const t=i&&(i.matches||i.webkitMatchesSelector||i.msMatchesSelector);return!!t&&!!e&&t.call(i,e)}function Ru(i){return Fr(i)?(e,t)=>K1(t,i):Ws(i)?i:_f(i)?(e,t)=>i.is(t):i?(e,t)=>t===i:()=>!1}xe.filter=function(i){const e=Ru(i);return Le(Cf.call(this,(t,r)=>e.call(t,r,t)))};function os(i,e){return e?i.filter(e):i}xe.detach=function(i){return os(this,i).each((e,t)=>{t.parentNode&&t.parentNode.removeChild(t)}),this};const XN=/^\s*<(\w+)[^>]*>/,jN=/^<(\w+)\s*\/?>(?:<\/\1>)?$/,W1={"*":O1,tr:MN,td:F1,th:F1,thead:Nf,tbody:Nf,tfoot:Nf};function Y1(i){if(!Fr(i))return[];if(jN.test(i))return[Hs(RegExp.$1)];const e=XN.test(i)&&RegExp.$1,t=W1[e]||W1["*"];return t.innerHTML=i,Le(t.childNodes).detach().get()}Le.parseHTML=Y1,xe.has=function(i){const e=Fr(i)?(t,r)=>Lf(i,r).length:(t,r)=>r.contains(i);return this.filter(e)},xe.not=function(i){const e=Ru(i);return this.filter((t,r)=>(!Fr(i)||fr(r))&&!e.call(r,t,r))};function Nn(i,e,t,r){const n=[],s=Ws(e),a=r&&Ru(r);for(let o=0,l=i.length;o<l;o++)if(s){const u=e(i[o]);u.length&&kN.apply(n,u)}else{let u=i[o][e];for(;u!=null&&!(r&&a(-1,u));)n.push(u),u=t?u[e]:null}return n}function X1(i){return i.multiple&&i.options?Nn(Cf.call(i.options,e=>e.selected&&!e.disabled&&!e.parentNode.disabled),"value"):i.value||""}function zN(i){return arguments.length?this.each((e,t)=>{const r=t.multiple&&t.options;if(r||sE.test(t.type)){const n=Su(i)?$1.call(i,String):Wo(i)?[]:[String(i)];r?Er(t.options,(s,a)=>{a.selected=n.indexOf(a.value)>=0},!0):t.checked=n.indexOf(t.value)>=0}else t.value=ri(i)||Wo(i)?"":i}):this[0]&&X1(this[0])}xe.val=zN,xe.is=function(i){const e=Ru(i);return wf.call(this,(t,r)=>e.call(t,r,t))},Le.guid=1;function en(i){return i.length>1?Cf.call(i,(e,t,r)=>U1.call(r,e)===t):i}Le.unique=en,xe.add=function(i,e){return Le(en(this.get().concat(Le(i,e).get())))},xe.children=function(i){return os(Le(en(Nn(this,e=>e.children))),i)},xe.parent=function(i){return os(Le(en(Nn(this,"parentNode"))),i)},xe.index=function(i){const e=i?Le(i)[0]:this[0],t=i?this:Le(e).parent().children();return U1.call(t,e)},xe.closest=function(i){const e=this.filter(i);if(e.length)return e;const t=this.parent();return t.length?t.closest(i):e},xe.siblings=function(i){return os(Le(en(Nn(this,e=>Le(e).parent().children().not(e)))),i)},xe.find=function(i){return Le(en(Nn(this,e=>Lf(i,e))))};const JN=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,QN=/^$|^module$|\/(java|ecma)script/i,ZN=["type","src","nonce","noModule"];function eC(i,e){const t=Le(i);t.filter("script").add(t.find("script")).each((r,n)=>{if(QN.test(n.type)&&k1.contains(n)){const s=Hs("script");s.text=n.textContent.replace(JN,""),Er(ZN,(a,o)=>{n[o]&&(s[o]=n[o])}),e.head.insertBefore(s,null),e.head.removeChild(s)}})}function tC(i,e,t,r,n){r?i.insertBefore(e,t?i.firstChild:null):i.nodeName==="HTML"?i.parentNode.replaceChild(e,i):i.parentNode.insertBefore(e,t?i:i.nextSibling),n&&eC(e,i.ownerDocument)}function ls(i,e,t,r,n,s,a,o){return Er(i,(l,u)=>{Er(Le(u),(h,d)=>{Er(Le(e),(p,g)=>{const m=t?d:g,v=t?g:d,E=t?h:p;tC(m,E?v.cloneNode(!0):v,r,n,!E)},o)},a)},s),e}xe.after=function(){return ls(arguments,this,!1,!1,!1,!0,!0)},xe.append=function(){return ls(arguments,this,!1,!1,!0)};function rC(i){if(!arguments.length)return this[0]&&this[0].innerHTML;if(ri(i))return this;const e=/<script[\s>]/.test(i);return this.each((t,r)=>{fr(r)&&(e?Le(r).empty().append(i):r.innerHTML=i)})}xe.html=rC,xe.appendTo=function(i){return ls(arguments,this,!0,!1,!0)},xe.wrapInner=function(i){return this.each((e,t)=>{const r=Le(t),n=r.contents();n.length?n.wrapAll(i):r.append(i)})},xe.before=function(){return ls(arguments,this,!1,!0)},xe.wrapAll=function(i){let e=Le(i),t=e[0];for(;t.children.length;)t=t.firstElementChild;return this.first().before(e),this.appendTo(t)},xe.wrap=function(i){return this.each((e,t)=>{const r=Le(i)[0];Le(t).wrapAll(e?r.cloneNode(!0):r)})},xe.insertAfter=function(i){return ls(arguments,this,!0,!1,!1,!1,!1,!0)},xe.insertBefore=function(i){return ls(arguments,this,!0,!0)},xe.prepend=function(){return ls(arguments,this,!1,!0,!0,!0,!0)},xe.prependTo=function(i){return ls(arguments,this,!0,!0,!0,!1,!1,!0)},xe.contents=function(){return Le(en(Nn(this,i=>i.tagName==="IFRAME"?[i.contentDocument]:i.tagName==="TEMPLATE"?i.content.childNodes:i.childNodes)))},xe.next=function(i,e,t){return os(Le(en(Nn(this,"nextElementSibling",e,t))),i)},xe.nextAll=function(i){return this.next(i,!0)},xe.nextUntil=function(i,e){return this.next(e,!0,i)},xe.parents=function(i,e){return os(Le(en(Nn(this,"parentElement",!0,e))),i)},xe.parentsUntil=function(i,e){return this.parents(e,i)},xe.prev=function(i,e,t){return os(Le(en(Nn(this,"previousElementSibling",e,t))),i)},xe.prevAll=function(i){return this.prev(i,!0)},xe.prevUntil=function(i,e){return this.prev(e,!0,i)},xe.map=function(i){return Le(PN.apply([],$1.call(this,(e,t)=>i.call(e,t,e))))},xe.clone=function(){return this.map((i,e)=>e.cloneNode(!0))},xe.offsetParent=function(){return this.map((i,e)=>{let t=e.offsetParent;for(;t&&In(t,"position")==="static";)t=t.offsetParent;return t||k1})},xe.slice=function(i,e){return Le(G1.call(this,i,e))};const iC=/-([a-z])/g;function kf(i){return i.replace(iC,(e,t)=>t.toUpperCase())}xe.ready=function(i){const e=()=>setTimeout(i,0,Le);return Rn.readyState!=="loading"?e():Rn.addEventListener("DOMContentLoaded",e),this},xe.unwrap=function(){return this.parent().each((i,e)=>{if(e.tagName==="BODY")return;const t=Le(e);t.replaceWith(t.children())}),this},xe.offset=function(){const i=this[0];if(!i)return;const e=i.getBoundingClientRect();return{top:e.top+Au.pageYOffset,left:e.left+Au.pageXOffset}},xe.position=function(){const i=this[0];if(!i)return;const e=In(i,"position")==="fixed",t=e?i.getBoundingClientRect():this.offset();if(!e){const r=i.ownerDocument;let n=i.offsetParent||r.documentElement;for(;(n===r.body||n===r.documentElement)&&In(n,"position")==="static";)n=n.parentNode;if(n!==i&&fr(n)){const s=Le(n).offset();t.top-=s.top+Zi(n,"borderTopWidth"),t.left-=s.left+Zi(n,"borderLeftWidth")}}return{top:t.top-Zi(i,"marginTop"),left:t.left-Zi(i,"marginLeft")}};const j1={class:"className",contenteditable:"contentEditable",for:"htmlFor",readonly:"readOnly",maxlength:"maxLength",tabindex:"tabIndex",colspan:"colSpan",rowspan:"rowSpan",usemap:"useMap"};xe.prop=function(i,e){if(i){if(Fr(i))return i=j1[i]||i,arguments.length<2?this[0]&&this[0][i]:this.each((t,r)=>{r[i]=e});for(const t in i)this.prop(t,i[t]);return this}},xe.removeProp=function(i){return this.each((e,t)=>{delete t[j1[i]||i]})};const nC=/^--/;function Of(i){return nC.test(i)}const Ff={},{style:sC}=O1,aC=["webkit","moz","ms"];function oC(i,e=Of(i)){if(e)return i;if(!Ff[i]){const t=kf(i),r=`${t[0].toUpperCase()}${t.slice(1)}`,n=`${t} ${aC.join(`${r} `)}${r}`.split(" ");Er(n,(s,a)=>{if(a in sC)return Ff[i]=a,!1})}return Ff[i]}const lC={animationIterationCount:!0,columnCount:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0};function z1(i,e,t=Of(i)){return!t&&!lC[i]&&q1(e)?`${e}px`:e}function uC(i,e){if(Fr(i)){const t=Of(i);return i=oC(i,t),arguments.length<2?this[0]&&In(this[0],i,t):i?(e=z1(i,e,t),this.each((r,n)=>{fr(n)&&(t?n.style.setProperty(i,e):n.style[i]=e)})):this}for(const t in i)this.css(t,i[t]);return this}xe.css=uC;function J1(i,e){try{return i(e)}catch{return e}}const cC=/^\s+|\s+$/;function Q1(i,e){const t=i.dataset[e]||i.dataset[kf(e)];return cC.test(t)?t:J1(JSON.parse,t)}function hC(i,e,t){t=J1(JSON.stringify,t),i.dataset[kf(e)]=t}function dC(i,e){if(!i){if(!this[0])return;const t={};for(const r in this[0].dataset)t[r]=Q1(this[0],r);return t}if(Fr(i))return arguments.length<2?this[0]&&Q1(this[0],i):ri(e)?this:this.each((t,r)=>{hC(r,i,e)});for(const t in i)this.data(t,i[t]);return this}xe.data=dC;function Z1(i,e){const t=i.documentElement;return Math.max(i.body[`scroll${e}`],t[`scroll${e}`],i.body[`offset${e}`],t[`offset${e}`],t[`client${e}`])}Er([!0,!1],(i,e)=>{Er(["Width","Height"],(t,r)=>{const n=`${e?"outer":"inner"}${r}`;xe[n]=function(s){if(this[0])return Pa(this[0])?e?this[0][`inner${r}`]:this[0].document.documentElement[`client${r}`]:Ks(this[0])?Z1(this[0],r):this[0][`${e?"offset":"client"}${r}`]+(s&&e?Zi(this[0],`margin${t?"Top":"Left"}`)+Zi(this[0],`margin${t?"Bottom":"Right"}`):0)}})}),Er(["Width","Height"],(i,e)=>{const t=e.toLowerCase();xe[t]=function(r){if(!this[0])return ri(r)?void 0:this;if(!arguments.length)return Pa(this[0])?this[0].document.documentElement[`client${e}`]:Ks(this[0])?Z1(this[0],e):this[0].getBoundingClientRect()[t]-V1(this[0],!i);const n=parseInt(r,10);return this.each((s,a)=>{if(!fr(a))return;const o=In(a,"boxSizing");a.style[t]=z1(t,n+(o==="border-box"?V1(a,!i):0))})}});const eE="___cd";xe.toggle=function(i){return this.each((e,t)=>{if(!fr(t))return;const r=H1(t);(ri(i)?r:i)?(t.style.display=t[eE]||"",H1(t)&&(t.style.display=YN(t.tagName))):r||(t[eE]=In(t,"display"),t.style.display="none")})},xe.hide=function(){return this.toggle(!1)},xe.show=function(){return this.toggle(!0)};const tE="___ce",Bf=".",Uf={focus:"focusin",blur:"focusout"},rE={mouseenter:"mouseover",mouseleave:"mouseout"},fC=/^(mouse|pointer|contextmenu|drag|drop|click|dblclick)/i;function $f(i){return rE[i]||Uf[i]||i}function Gf(i){const e=i.split(Bf);return[e[0],e.slice(1).sort()]}xe.trigger=function(i,e){if(Fr(i)){const[r,n]=Gf(i),s=$f(r);if(!s)return this;const a=fC.test(s)?"MouseEvents":"HTMLEvents";i=Rn.createEvent(a),i.initEvent(s,!0,!0),i.namespace=n.join(Bf),i.___ot=r}i.___td=e;const t=i.___ot in Uf;return this.each((r,n)=>{t&&Ws(n[i.___ot])&&(n[`___i${i.type}`]=!0,n[i.___ot](),n[`___i${i.type}`]=!1),n.dispatchEvent(i)})};function iE(i){return i[tE]=i[tE]||{}}function gC(i,e,t,r,n){const s=iE(i);s[e]=s[e]||[],s[e].push([t,r,n]),i.addEventListener(e,n)}function nE(i,e){return!e||!wf.call(e,t=>i.indexOf(t)<0)}function Iu(i,e,t,r,n){const s=iE(i);if(e)s[e]&&(s[e]=s[e].filter(([a,o,l])=>{if(n&&l.guid!==n.guid||!nE(a,t)||r&&r!==o)return!0;i.removeEventListener(e,l)}));else for(e in s)Iu(i,e,t,r,n)}xe.off=function(i,e,t){if(ri(i))this.each((r,n)=>{!fr(n)&&!Ks(n)&&!Pa(n)||Iu(n)});else if(Fr(i))Ws(e)&&(t=e,e=""),Er(Du(i),(r,n)=>{const[s,a]=Gf(n),o=$f(s);this.each((l,u)=>{!fr(u)&&!Ks(u)&&!Pa(u)||Iu(u,o,a,e,t)})});else for(const r in i)this.off(r,i[r]);return this},xe.remove=function(i){return os(this,i).detach().off(),this},xe.replaceWith=function(i){return this.before(i).remove()},xe.replaceAll=function(i){return Le(i).replaceWith(this),this};function pC(i,e,t,r,n){if(!Fr(i)){for(const s in i)this.on(s,e,t,i[s],n);return this}return Fr(e)||(ri(e)||Wo(e)?e="":ri(t)?(t=e,e=""):(r=t,t=e,e="")),Ws(r)||(r=t,t=void 0),r?(Er(Du(i),(s,a)=>{const[o,l]=Gf(a),u=$f(o),h=o in rE,d=o in Uf;u&&this.each((p,g)=>{if(!fr(g)&&!Ks(g)&&!Pa(g))return;const m=function(v){if(v.target[`___i${v.type}`])return v.stopImmediatePropagation();if(v.namespace&&!nE(l,v.namespace.split(Bf))||!e&&(d&&(v.target!==g||v.___ot===u)||h&&v.relatedTarget&&g.contains(v.relatedTarget)))return;let E=g;if(e){let D=v.target;for(;!K1(D,e);)if(D===g||(D=D.parentNode,!D))return;E=D}Object.defineProperty(v,"currentTarget",{configurable:!0,get(){return E}}),Object.defineProperty(v,"delegateTarget",{configurable:!0,get(){return g}}),Object.defineProperty(v,"data",{configurable:!0,get(){return t}});const A=r.call(E,v,v.___td);n&&Iu(g,u,l,e,m),A===!1&&(v.preventDefault(),v.stopPropagation())};m.guid=r.guid=r.guid||Le.guid++,gC(g,u,l,e,m)})}),this):this}xe.on=pC;function mC(i,e,t,r){return this.on(i,e,t,r,!0)}xe.one=mC;const yC=/\r?\n/g;function vC(i,e){return`&${encodeURIComponent(i)}=${encodeURIComponent(e.replace(yC,`\r
`))}`}const EC=/file|reset|submit|button|image/i,sE=/radio|checkbox/i;xe.serialize=function(){let i="";return this.each((e,t)=>{Er(t.elements||[t],(r,n)=>{if(n.disabled||!n.name||n.tagName==="FIELDSET"||EC.test(n.type)||sE.test(n.type)&&!n.checked)return;const s=X1(n);if(!ri(s)){const a=Su(s)?s:[s];Er(a,(o,l)=>{i+=vC(n.name,l)})}})}),i.slice(1)};class bC{getTitle(e,t){if(!e.values||It.isEmpty(e.values))throw console.error("Title extraction configuration is missing CSS selector values",e),new Error("ExtractTitleConfig values are empty or undefined");return Le(e.values[0]).text()}}class AC{getTitle(e,t){if(!e.values||It.isEmpty(e.values))throw console.error("Title extraction configuration is missing CSS selector values",e),new Error("ExtractTitleConfig values are empty or undefined");if(e.values.length!==2)throw console.error("Title extraction configuration requires exactly 2 values: [cssSelector, attributeName], but got",e.values.length,"values:",e.values),new Error(`ExtractTitleConfig values array must contain exactly 2 elements (cssSelector and attributeName), but got ${e.values.length} elements`);return Le(e.values[0]).attr(e.values[1])}}class SC extends Ma{getVideoId(e,t){if(!e.values||It.isEmpty(e.values))throw console.error("Video ID extraction configuration is missing CSS selector values",e),new Error("ExtractVideoIdConfig values are empty or undefined");if(e.values.length!==2)throw console.error("Video ID extraction configuration requires exactly 2 values: [cssSelector, attributeName], but got",e.values.length,"values:",e.values),new Error(`ExtractVideoIdConfig values array must contain exactly 2 elements (cssSelector and attributeName), but got ${e.values.length} elements`);const r=Le(e.values[0]).attr(e.values[1]);return this.buildVideoId(e,[r])}}var aE=class{constructor(i){if(i==="<all_urls>")this.isAllUrls=!0,this.protocolMatches=[...aE.PROTOCOLS],this.hostnameMatch="*",this.pathnameMatch="*";else{const e=/(.*):\/\/(.*?)(\/.*)/.exec(i);if(e==null)throw new Nu(i,"Incorrect format");const[t,r,n,s]=e;xC(i,r),TC(i,n),this.protocolMatches=r==="*"?["http","https"]:[r],this.hostnameMatch=n,this.pathnameMatch=s}}includes(i){if(this.isAllUrls)return!0;const e=typeof i=="string"?new URL(i):i instanceof Location?new URL(i.href):i;return!!this.protocolMatches.find(t=>{if(t==="http")return this.isHttpMatch(e);if(t==="https")return this.isHttpsMatch(e);if(t==="file")return this.isFileMatch(e);if(t==="ftp")return this.isFtpMatch(e);if(t==="urn")return this.isUrnMatch(e)})}isHttpMatch(i){return i.protocol==="http:"&&this.isHostPathMatch(i)}isHttpsMatch(i){return i.protocol==="https:"&&this.isHostPathMatch(i)}isHostPathMatch(i){if(!this.hostnameMatch||!this.pathnameMatch)return!1;const e=[this.convertPatternToRegex(this.hostnameMatch),this.convertPatternToRegex(this.hostnameMatch.replace(/^\*\./,""))],t=this.convertPatternToRegex(this.pathnameMatch);return!!e.find(r=>r.test(i.hostname))&&t.test(i.pathname)}isFileMatch(i){throw Error("Not implemented: file:// pattern matching. Open a PR to add support")}isFtpMatch(i){throw Error("Not implemented: ftp:// pattern matching. Open a PR to add support")}isUrnMatch(i){throw Error("Not implemented: urn:// pattern matching. Open a PR to add support")}convertPatternToRegex(i){const t=this.escapeForRegex(i).replace(/\\\*/g,".*");return RegExp(`^${t}$`)}escapeForRegex(i){return i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}},gr=aE;gr.PROTOCOLS=["http","https","file","ftp","urn"];var Nu=class extends Error{constructor(i,e){super(`Invalid match pattern "${i}": ${e}`)}};function xC(i,e){if(!gr.PROTOCOLS.includes(e)&&e!=="*")throw new Nu(i,`${e} not a valid protocol (${gr.PROTOCOLS.join(", ")})`)}function TC(i,e){if(e.includes(":"))throw new Nu(i,"Hostname cannot include a port");if(e.includes("*")&&e.length>1&&!e.startsWith("*."))throw new Nu(i,"If using a wildcard (*), it must go at the start of the hostname")}class DC{constructor(){this.keyToValue=new Map,this.valueToKey=new Map}set(e,t){this.keyToValue.set(e,t),this.valueToKey.set(t,e)}getByKey(e){return this.keyToValue.get(e)}getByValue(e){return this.valueToKey.get(e)}clear(){this.keyToValue.clear(),this.valueToKey.clear()}}class oE{constructor(e){this.generateIdentifier=e,this.kv=new DC}register(e,t){this.kv.getByValue(e)||(t||(t=this.generateIdentifier(e)),this.kv.set(t,e))}clear(){this.kv.clear()}getIdentifier(e){return this.kv.getByValue(e)}getValue(e){return this.kv.getByKey(e)}}class RC extends oE{constructor(){super(e=>e.name),this.classToAllowedProps=new Map}register(e,t){typeof t=="object"?(t.allowProps&&this.classToAllowedProps.set(e,t.allowProps),super.register(e,t.identifier)):super.register(e,t)}getAllowedProps(e){return this.classToAllowedProps.get(e)}}function IC(i){if("values"in Object)return Object.values(i);const e=[];for(const t in i)i.hasOwnProperty(t)&&e.push(i[t]);return e}function NC(i,e){const t=IC(i);if("find"in t)return t.find(e);const r=t;for(let n=0;n<r.length;n++){const s=r[n];if(e(s))return s}}function ka(i,e){Object.entries(i).forEach(([t,r])=>e(r,t))}function Cu(i,e){return i.indexOf(e)!==-1}function lE(i,e){for(let t=0;t<i.length;t++){const r=i[t];if(e(r))return r}}class CC{constructor(){this.transfomers={}}register(e){this.transfomers[e.name]=e}findApplicable(e){return NC(this.transfomers,t=>t.isApplicable(e))}findByName(e){return this.transfomers[e]}}const wC=i=>Object.prototype.toString.call(i).slice(8,-1),uE=i=>typeof i>"u",LC=i=>i===null,Yo=i=>typeof i!="object"||i===null||i===Object.prototype?!1:Object.getPrototypeOf(i)===null?!0:Object.getPrototypeOf(i)===Object.prototype,qf=i=>Yo(i)&&Object.keys(i).length===0,us=i=>Array.isArray(i),_C=i=>typeof i=="string",MC=i=>typeof i=="number"&&!isNaN(i),PC=i=>typeof i=="boolean",kC=i=>i instanceof RegExp,Xo=i=>i instanceof Map,jo=i=>i instanceof Set,cE=i=>wC(i)==="Symbol",OC=i=>i instanceof Date&&!isNaN(i.valueOf()),FC=i=>i instanceof Error,hE=i=>typeof i=="number"&&isNaN(i),BC=i=>PC(i)||LC(i)||uE(i)||MC(i)||_C(i)||cE(i),UC=i=>typeof i=="bigint",$C=i=>i===1/0||i===-1/0,GC=i=>ArrayBuffer.isView(i)&&!(i instanceof DataView),qC=i=>i instanceof URL,dE=i=>i.replace(/\./g,"\\."),Vf=i=>i.map(String).map(dE).join("."),zo=i=>{const e=[];let t="";for(let n=0;n<i.length;n++){let s=i.charAt(n);if(s==="\\"&&i.charAt(n+1)==="."){t+=".",n++;continue}if(s==="."){e.push(t),t="";continue}t+=s}const r=t;return e.push(r),e};function tn(i,e,t,r){return{isApplicable:i,annotation:e,transform:t,untransform:r}}const fE=[tn(uE,"undefined",()=>null,()=>{}),tn(UC,"bigint",i=>i.toString(),i=>typeof BigInt<"u"?BigInt(i):(console.error("Please add a BigInt polyfill."),i)),tn(OC,"Date",i=>i.toISOString(),i=>new Date(i)),tn(FC,"Error",(i,e)=>{const t={name:i.name,message:i.message};return e.allowedErrorProps.forEach(r=>{t[r]=i[r]}),t},(i,e)=>{const t=new Error(i.message);return t.name=i.name,t.stack=i.stack,e.allowedErrorProps.forEach(r=>{t[r]=i[r]}),t}),tn(kC,"regexp",i=>""+i,i=>{const e=i.slice(1,i.lastIndexOf("/")),t=i.slice(i.lastIndexOf("/")+1);return new RegExp(e,t)}),tn(jo,"set",i=>[...i.values()],i=>new Set(i)),tn(Xo,"map",i=>[...i.entries()],i=>new Map(i)),tn(i=>hE(i)||$C(i),"number",i=>hE(i)?"NaN":i>0?"Infinity":"-Infinity",Number),tn(i=>i===0&&1/i===-1/0,"number",()=>"-0",Number),tn(qC,"URL",i=>i.toString(),i=>new URL(i))];function wu(i,e,t,r){return{isApplicable:i,annotation:e,transform:t,untransform:r}}const gE=wu((i,e)=>cE(i)?!!e.symbolRegistry.getIdentifier(i):!1,(i,e)=>["symbol",e.symbolRegistry.getIdentifier(i)],i=>i.description,(i,e,t)=>{const r=t.symbolRegistry.getValue(e[1]);if(!r)throw new Error("Trying to deserialize unknown symbol");return r}),VC=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array,Uint8ClampedArray].reduce((i,e)=>(i[e.name]=e,i),{}),pE=wu(GC,i=>["typed-array",i.constructor.name],i=>[...i],(i,e)=>{const t=VC[e[1]];if(!t)throw new Error("Trying to deserialize unknown typed array");return new t(i)});function mE(i,e){return i!=null&&i.constructor?!!e.classRegistry.getIdentifier(i.constructor):!1}const yE=wu(mE,(i,e)=>["class",e.classRegistry.getIdentifier(i.constructor)],(i,e)=>{const t=e.classRegistry.getAllowedProps(i.constructor);if(!t)return{...i};const r={};return t.forEach(n=>{r[n]=i[n]}),r},(i,e,t)=>{const r=t.classRegistry.getValue(e[1]);if(!r)throw new Error(`Trying to deserialize unknown class '${e[1]}' - check https://github.com/blitz-js/superjson/issues/116#issuecomment-773996564`);return Object.assign(Object.create(r.prototype),i)}),vE=wu((i,e)=>!!e.customTransformerRegistry.findApplicable(i),(i,e)=>["custom",e.customTransformerRegistry.findApplicable(i).name],(i,e)=>e.customTransformerRegistry.findApplicable(i).serialize(i),(i,e,t)=>{const r=t.customTransformerRegistry.findByName(e[1]);if(!r)throw new Error("Trying to deserialize unknown custom value");return r.deserialize(i)}),HC=[yE,gE,vE,pE],EE=(i,e)=>{const t=lE(HC,n=>n.isApplicable(i,e));if(t)return{value:t.transform(i,e),type:t.annotation(i,e)};const r=lE(fE,n=>n.isApplicable(i,e));if(r)return{value:r.transform(i,e),type:r.annotation}},bE={};fE.forEach(i=>{bE[i.annotation]=i});const KC=(i,e,t)=>{if(us(e))switch(e[0]){case"symbol":return gE.untransform(i,e,t);case"class":return yE.untransform(i,e,t);case"custom":return vE.untransform(i,e,t);case"typed-array":return pE.untransform(i,e,t);default:throw new Error("Unknown transformation: "+e)}else{const r=bE[e];if(!r)throw new Error("Unknown transformation: "+e);return r.untransform(i,t)}},Oa=(i,e)=>{if(e>i.size)throw new Error("index out of bounds");const t=i.keys();for(;e>0;)t.next(),e--;return t.next().value};function AE(i){if(Cu(i,"__proto__"))throw new Error("__proto__ is not allowed as a property");if(Cu(i,"prototype"))throw new Error("prototype is not allowed as a property");if(Cu(i,"constructor"))throw new Error("constructor is not allowed as a property")}const WC=(i,e)=>{AE(e);for(let t=0;t<e.length;t++){const r=e[t];if(jo(i))i=Oa(i,+r);else if(Xo(i)){const n=+r,s=+e[++t]==0?"key":"value",a=Oa(i,n);switch(s){case"key":i=a;break;case"value":i=i.get(a);break}}else i=i[r]}return i},Hf=(i,e,t)=>{if(AE(e),e.length===0)return t(i);let r=i;for(let s=0;s<e.length-1;s++){const a=e[s];if(us(r)){const o=+a;r=r[o]}else if(Yo(r))r=r[a];else if(jo(r)){const o=+a;r=Oa(r,o)}else if(Xo(r)){if(s===e.length-2)break;const l=+a,u=+e[++s]==0?"key":"value",h=Oa(r,l);switch(u){case"key":r=h;break;case"value":r=r.get(h);break}}}const n=e[e.length-1];if(us(r)?r[+n]=t(r[+n]):Yo(r)&&(r[n]=t(r[n])),jo(r)){const s=Oa(r,+n),a=t(s);s!==a&&(r.delete(s),r.add(a))}if(Xo(r)){const s=+e[e.length-2],a=Oa(r,s);switch(+n==0?"key":"value"){case"key":{const l=t(a);r.set(l,r.get(a)),l!==a&&r.delete(a);break}case"value":{r.set(a,t(r.get(a)));break}}}return i};function Kf(i,e,t=[]){if(!i)return;if(!us(i)){ka(i,(s,a)=>Kf(s,e,[...t,...zo(a)]));return}const[r,n]=i;n&&ka(n,(s,a)=>{Kf(s,e,[...t,...zo(a)])}),e(r,t)}function YC(i,e,t){return Kf(e,(r,n)=>{i=Hf(i,n,s=>KC(s,r,t))}),i}function XC(i,e){function t(r,n){const s=WC(i,zo(n));r.map(zo).forEach(a=>{i=Hf(i,a,()=>s)})}if(us(e)){const[r,n]=e;r.forEach(s=>{i=Hf(i,zo(s),()=>i)}),n&&ka(n,t)}else ka(e,t);return i}const jC=(i,e)=>Yo(i)||us(i)||Xo(i)||jo(i)||mE(i,e);function zC(i,e,t){const r=t.get(i);r?r.push(e):t.set(i,[e])}function JC(i,e){const t={};let r;return i.forEach(n=>{if(n.length<=1)return;e||(n=n.map(o=>o.map(String)).sort((o,l)=>o.length-l.length));const[s,...a]=n;s.length===0?r=a.map(Vf):t[Vf(s)]=a.map(Vf)}),r?qf(t)?[r]:[r,t]:qf(t)?void 0:t}const SE=(i,e,t,r,n=[],s=[],a=new Map)=>{const o=BC(i);if(!o){zC(i,n,e);const g=a.get(i);if(g)return r?{transformedValue:null}:g}if(!jC(i,t)){const g=EE(i,t),m=g?{transformedValue:g.value,annotations:[g.type]}:{transformedValue:i};return o||a.set(i,m),m}if(Cu(s,i))return{transformedValue:null};const l=EE(i,t),u=(l==null?void 0:l.value)??i,h=us(u)?[]:{},d={};ka(u,(g,m)=>{if(m==="__proto__"||m==="constructor"||m==="prototype")throw new Error(`Detected property ${m}. This is a prototype pollution risk, please remove it from your object.`);const v=SE(g,e,t,r,[...n,m],[...s,i],a);h[m]=v.transformedValue,us(v.annotations)?d[m]=v.annotations:Yo(v.annotations)&&ka(v.annotations,(E,A)=>{d[dE(m)+"."+A]=E})});const p=qf(d)?{transformedValue:h,annotations:l?[l.type]:void 0}:{transformedValue:h,annotations:l?[l.type,d]:d};return o||a.set(i,p),p};function xE(i){return Object.prototype.toString.call(i).slice(8,-1)}function TE(i){return xE(i)==="Array"}function QC(i){if(xE(i)!=="Object")return!1;const e=Object.getPrototypeOf(i);return!!e&&e.constructor===Object&&e===Object.prototype}function ZC(i,e,t,r,n){const s={}.propertyIsEnumerable.call(r,e)?"enumerable":"nonenumerable";s==="enumerable"&&(i[e]=t),n&&s==="nonenumerable"&&Object.defineProperty(i,e,{value:t,enumerable:!1,writable:!0,configurable:!0})}function Wf(i,e={}){if(TE(i))return i.map(n=>Wf(n,e));if(!QC(i))return i;const t=Object.getOwnPropertyNames(i),r=Object.getOwnPropertySymbols(i);return[...t,...r].reduce((n,s)=>{if(TE(e.props)&&!e.props.includes(s))return n;const a=i[s],o=Wf(a,e);return ZC(n,s,o,i,e.nonenumerable),n},{})}class rt{constructor({dedupe:e=!1}={}){this.classRegistry=new RC,this.symbolRegistry=new oE(t=>t.description??""),this.customTransformerRegistry=new CC,this.allowedErrorProps=[],this.dedupe=e}serialize(e){const t=new Map,r=SE(e,t,this,this.dedupe),n={json:r.transformedValue};r.annotations&&(n.meta={...n.meta,values:r.annotations});const s=JC(t,this.dedupe);return s&&(n.meta={...n.meta,referentialEqualities:s}),n}deserialize(e){const{json:t,meta:r}=e;let n=Wf(t);return r!=null&&r.values&&(n=YC(n,r.values,this)),r!=null&&r.referentialEqualities&&(n=XC(n,r.referentialEqualities)),n}stringify(e){return JSON.stringify(this.serialize(e))}parse(e){return this.deserialize(JSON.parse(e))}registerClass(e,t){this.classRegistry.register(e,t)}registerSymbol(e,t){this.symbolRegistry.register(e,t)}registerCustom(e,t){this.customTransformerRegistry.register({name:t,...e})}allowErrorProps(...e){this.allowedErrorProps.push(...e)}}rt.defaultInstance=new rt,rt.serialize=rt.defaultInstance.serialize.bind(rt.defaultInstance),rt.deserialize=rt.defaultInstance.deserialize.bind(rt.defaultInstance),rt.stringify=rt.defaultInstance.stringify.bind(rt.defaultInstance),rt.parse=rt.defaultInstance.parse.bind(rt.defaultInstance),rt.registerClass=rt.defaultInstance.registerClass.bind(rt.defaultInstance),rt.registerSymbol=rt.defaultInstance.registerSymbol.bind(rt.defaultInstance),rt.registerCustom=rt.defaultInstance.registerCustom.bind(rt.defaultInstance),rt.allowErrorProps=rt.defaultInstance.allowErrorProps.bind(rt.defaultInstance),rt.serialize,rt.deserialize,rt.stringify,rt.parse,rt.registerClass,rt.registerCustom,rt.registerSymbol,rt.allowErrorProps;class ew extends Ma{getVideoId(e,t){if(It.isEmpty(e.values))throw console.error("Video ID extraction rule missing values property",e),new Error("Video ID extraction rule missing values property");const r=rt.parse(e.values[0]);for(const[n,s]of r.configMap.entries())if(new gr(n).includes(window.location.href))return Vt.extractVideoId(s,t);throw new Error("No matching URL pattern found for current URL: "+window.location.href)}}class tw extends Ma{getVideoId(e,t){if(It.isEmpty(e.values))throw console.error("Video ID extraction rule missing values property",e),new Error("Video ID extraction rule missing values property");const r=rt.parse(e.values[0]);return this.buildVideoId(e,r.configList.map(n=>Vt.extractVideoId(n,t)))}}class Vt{static extractBooleanByJsonPath(e,t,r){const n=Qr.of(e);return Io(t).with("all",()=>n.allMatch(s=>Ji(r,s))).with("any",()=>n.anyMatch(s=>Ji(r,s))).exhaustive()}static extractVideoId(e,t){return Io(e.type).with("urlQueryParam",()=>new DN().getVideoId(e,t)).with("urlPath",()=>new IN().getVideoId(e,t)).with("jsonPath",()=>new NN().getVideoId(e,t)).with("attr",()=>new SC().getVideoId(e,t)).with("multi-pattern",()=>new ew().getVideoId(e,t)).with("multi-type",()=>new tw().getVideoId(e,t)).with("undefined",()=>"undefined").exhaustive()}static extractTitle(e,t){return Io(e.type).with("tab",()=>t.tabTitle).with("jsonPath",()=>new LN().getTitle(e,t)).with("urlPath",()=>new _N().getTitle(e,t)).with("selector",()=>new bC().getTitle(e,t)).with("attr",()=>new AC().getTitle(e,t)).exhaustive()}static extractVideoLanguage(e,t){return e.videoLanguageExtract?Io(e.videoLanguageExtract.type).with("asr",()=>new wN().getVideoLanguage(e,t)).exhaustive()??dr.fromLanguage:dr.fromLanguage}}class DE extends Ko{getSubtitles(e,t){const r=e.domKind?'track[kind="'+e.domKind+'"]':'track[kind="captions"], track[kind="subtitles"]';return Qr.of(this.findTracks(t,r)).map(n=>this.buildSubtitleMediaData(n,e)).toArray()}findTracks(e,t){return Le(e.media).find(t)}buildSubtitleMediaData(e,t){const r=Le(e);return{url:ti.completeUrl(r.prop("src")),language:r.prop(t.subtitleLanguageName).replaceAll("-x-autogen",""),isAsr:!1,hasPunctuation:!0}}}const Ce=Number.isFinite||function(i){return typeof i=="number"&&isFinite(i)},rw=Number.isSafeInteger||function(i){return typeof i=="number"&&Math.abs(i)<=iw},iw=Number.MAX_SAFE_INTEGER||9007199254740991;let Fe=function(i){return i.NETWORK_ERROR="networkError",i.MEDIA_ERROR="mediaError",i.KEY_SYSTEM_ERROR="keySystemError",i.MUX_ERROR="muxError",i.OTHER_ERROR="otherError",i}({}),Q=function(i){return i.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",i.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",i.KEY_SYSTEM_NO_SESSION="keySystemNoSession",i.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",i.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",i.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",i.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",i.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",i.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",i.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",i.KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR="keySystemDestroyMediaKeysError",i.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR="keySystemDestroyCloseSessionError",i.KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR="keySystemDestroyRemoveSessionError",i.MANIFEST_LOAD_ERROR="manifestLoadError",i.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",i.MANIFEST_PARSING_ERROR="manifestParsingError",i.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",i.LEVEL_EMPTY_ERROR="levelEmptyError",i.LEVEL_LOAD_ERROR="levelLoadError",i.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",i.LEVEL_PARSING_ERROR="levelParsingError",i.LEVEL_SWITCH_ERROR="levelSwitchError",i.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",i.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",i.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",i.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",i.FRAG_LOAD_ERROR="fragLoadError",i.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",i.FRAG_DECRYPT_ERROR="fragDecryptError",i.FRAG_PARSING_ERROR="fragParsingError",i.FRAG_GAP="fragGap",i.REMUX_ALLOC_ERROR="remuxAllocError",i.KEY_LOAD_ERROR="keyLoadError",i.KEY_LOAD_TIMEOUT="keyLoadTimeOut",i.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",i.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",i.BUFFER_APPEND_ERROR="bufferAppendError",i.BUFFER_APPENDING_ERROR="bufferAppendingError",i.BUFFER_STALLED_ERROR="bufferStalledError",i.BUFFER_FULL_ERROR="bufferFullError",i.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",i.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",i.ASSET_LIST_LOAD_ERROR="assetListLoadError",i.ASSET_LIST_LOAD_TIMEOUT="assetListLoadTimeout",i.ASSET_LIST_PARSING_ERROR="assetListParsingError",i.INTERSTITIAL_ASSET_ITEM_ERROR="interstitialAssetItemError",i.INTERNAL_EXCEPTION="internalException",i.INTERNAL_ABORTED="aborted",i.ATTACH_MEDIA_ERROR="attachMediaError",i.UNKNOWN="unknown",i}({}),x=function(i){return i.MEDIA_ATTACHING="hlsMediaAttaching",i.MEDIA_ATTACHED="hlsMediaAttached",i.MEDIA_DETACHING="hlsMediaDetaching",i.MEDIA_DETACHED="hlsMediaDetached",i.MEDIA_ENDED="hlsMediaEnded",i.STALL_RESOLVED="hlsStallResolved",i.BUFFER_RESET="hlsBufferReset",i.BUFFER_CODECS="hlsBufferCodecs",i.BUFFER_CREATED="hlsBufferCreated",i.BUFFER_APPENDING="hlsBufferAppending",i.BUFFER_APPENDED="hlsBufferAppended",i.BUFFER_EOS="hlsBufferEos",i.BUFFERED_TO_END="hlsBufferedToEnd",i.BUFFER_FLUSHING="hlsBufferFlushing",i.BUFFER_FLUSHED="hlsBufferFlushed",i.MANIFEST_LOADING="hlsManifestLoading",i.MANIFEST_LOADED="hlsManifestLoaded",i.MANIFEST_PARSED="hlsManifestParsed",i.LEVEL_SWITCHING="hlsLevelSwitching",i.LEVEL_SWITCHED="hlsLevelSwitched",i.LEVEL_LOADING="hlsLevelLoading",i.LEVEL_LOADED="hlsLevelLoaded",i.LEVEL_UPDATED="hlsLevelUpdated",i.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",i.LEVELS_UPDATED="hlsLevelsUpdated",i.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",i.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",i.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",i.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",i.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",i.AUDIO_TRACK_UPDATED="hlsAudioTrackUpdated",i.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",i.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",i.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",i.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",i.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",i.SUBTITLE_TRACK_UPDATED="hlsSubtitleTrackUpdated",i.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",i.CUES_PARSED="hlsCuesParsed",i.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",i.INIT_PTS_FOUND="hlsInitPtsFound",i.FRAG_LOADING="hlsFragLoading",i.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",i.FRAG_LOADED="hlsFragLoaded",i.FRAG_DECRYPTED="hlsFragDecrypted",i.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",i.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",i.FRAG_PARSING_METADATA="hlsFragParsingMetadata",i.FRAG_PARSED="hlsFragParsed",i.FRAG_BUFFERED="hlsFragBuffered",i.FRAG_CHANGED="hlsFragChanged",i.FPS_DROP="hlsFpsDrop",i.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",i.MAX_AUTO_LEVEL_UPDATED="hlsMaxAutoLevelUpdated",i.ERROR="hlsError",i.DESTROYING="hlsDestroying",i.KEY_LOADING="hlsKeyLoading",i.KEY_LOADED="hlsKeyLoaded",i.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",i.BACK_BUFFER_REACHED="hlsBackBufferReached",i.STEERING_MANIFEST_LOADED="hlsSteeringManifestLoaded",i.ASSET_LIST_LOADING="hlsAssetListLoading",i.ASSET_LIST_LOADED="hlsAssetListLoaded",i.INTERSTITIALS_UPDATED="hlsInterstitialsUpdated",i.INTERSTITIALS_BUFFERED_TO_BOUNDARY="hlsInterstitialsBufferedToBoundary",i.INTERSTITIAL_ASSET_PLAYER_CREATED="hlsInterstitialAssetPlayerCreated",i.INTERSTITIAL_STARTED="hlsInterstitialStarted",i.INTERSTITIAL_ASSET_STARTED="hlsInterstitialAssetStarted",i.INTERSTITIAL_ASSET_ENDED="hlsInterstitialAssetEnded",i.INTERSTITIAL_ASSET_ERROR="hlsInterstitialAssetError",i.INTERSTITIAL_ENDED="hlsInterstitialEnded",i.INTERSTITIALS_PRIMARY_RESUMED="hlsInterstitialsPrimaryResumed",i.PLAYOUT_LIMIT_REACHED="hlsPlayoutLimitReached",i.EVENT_CUE_ENTER="hlsEventCueEnter",i}({});var lt={MANIFEST:"manifest",LEVEL:"level",AUDIO_TRACK:"audioTrack",SUBTITLE_TRACK:"subtitleTrack"},ke={MAIN:"main",AUDIO:"audio",SUBTITLE:"subtitle"};class Fa{constructor(e,t=0,r=0){this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=e,this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=t,this.totalWeight_=r}sample(e,t){const r=Math.pow(this.alpha_,e);this.estimate_=t*(1-r)+r*this.estimate_,this.totalWeight_+=e}getTotalWeight(){return this.totalWeight_}getEstimate(){if(this.alpha_){const e=1-Math.pow(this.alpha_,this.totalWeight_);if(e)return this.estimate_/e}return this.estimate_}}class nw{constructor(e,t,r,n=100){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultTTFB_=void 0,this.ttfb_=void 0,this.defaultEstimate_=r,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new Fa(e),this.fast_=new Fa(t),this.defaultTTFB_=n,this.ttfb_=new Fa(e)}update(e,t){const{slow_:r,fast_:n,ttfb_:s}=this;r.halfLife!==e&&(this.slow_=new Fa(e,r.getEstimate(),r.getTotalWeight())),n.halfLife!==t&&(this.fast_=new Fa(t,n.getEstimate(),n.getTotalWeight())),s.halfLife!==e&&(this.ttfb_=new Fa(e,s.getEstimate(),s.getTotalWeight()))}sample(e,t){e=Math.max(e,this.minDelayMs_);const r=8*t,n=e/1e3,s=r/n;this.fast_.sample(n,s),this.slow_.sample(n,s)}sampleTTFB(e){const t=e/1e3,r=Math.sqrt(2)*Math.exp(-Math.pow(t,2)/2);this.ttfb_.sample(r,Math.max(e,5))}canEstimate(){return this.fast_.getTotalWeight()>=this.minWeight_}getEstimate(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}getEstimateTTFB(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_}get defaultEstimate(){return this.defaultEstimate_}destroy(){}}function sw(i,e,t){return(e=ow(e))in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function xt(){return xt=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(i[r]=t[r])}return i},xt.apply(null,arguments)}function RE(i,e){var t=Object.keys(i);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(i);e&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(i,n).enumerable})),t.push.apply(t,r)}return t}function Et(i){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?RE(Object(t),!0).forEach(function(r){sw(i,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(t)):RE(Object(t)).forEach(function(r){Object.defineProperty(i,r,Object.getOwnPropertyDescriptor(t,r))})}return i}function aw(i,e){if(typeof i!="object"||!i)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}function ow(i){var e=aw(i,"string");return typeof e=="symbol"?e:e+""}class Cn{constructor(e,t){this.trace=void 0,this.debug=void 0,this.log=void 0,this.warn=void 0,this.info=void 0,this.error=void 0;const r=`[${e}]:`;this.trace=cs,this.debug=t.debug.bind(null,r),this.log=t.log.bind(null,r),this.warn=t.warn.bind(null,r),this.info=t.info.bind(null,r),this.error=t.error.bind(null,r)}}const cs=function(){},lw={trace:cs,debug:cs,log:cs,warn:cs,info:cs,error:cs};function Yf(){return xt({},lw)}function uw(i,e){const t=self.console[i];return t?t.bind(self.console,`${e?"["+e+"] ":""}[${i}] >`):cs}function IE(i,e,t){return e[i]?e[i].bind(e):uw(i,t)}const Xf=Yf();function cw(i,e,t){const r=Yf();if(typeof console=="object"&&i===!0||typeof i=="object"){const n=["debug","log","info","warn","error"];n.forEach(s=>{r[s]=IE(s,i,t)});try{r.log(`Debug logs enabled for "${e}" in hls.js version 1.6.5`)}catch{return Yf()}n.forEach(s=>{Xf[s]=IE(s,i)})}else xt(Xf,r);return r}const mt=Xf;function hs(i=!0){return typeof self>"u"?void 0:(i||!self.MediaSource)&&self.ManagedMediaSource||self.MediaSource||self.WebKitMediaSource}function hw(i){return typeof self<"u"&&i===self.ManagedMediaSource}function NE(i,e){const t=Object.keys(i),r=Object.keys(e),n=t.length,s=r.length;return!n||!s||n===s&&!t.some(a=>r.indexOf(a)===-1)}function ii(i,e=!1){if(typeof TextDecoder<"u"){const u=new TextDecoder("utf-8").decode(i);if(e){const h=u.indexOf("\0");return h!==-1?u.substring(0,h):u}return u.replace(/\0/g,"")}const t=i.length;let r,n,s,a="",o=0;for(;o<t;){if(r=i[o++],r===0&&e)return a;if(r===0||r===3)continue;switch(r>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:a+=String.fromCharCode(r);break;case 12:case 13:n=i[o++],a+=String.fromCharCode((r&31)<<6|n&63);break;case 14:n=i[o++],s=i[o++],a+=String.fromCharCode((r&15)<<12|(n&63)<<6|(s&63)<<0);break}}return a}const rn={hexDump:function(i){let e="";for(let t=0;t<i.length;t++){let r=i[t].toString(16);r.length<2&&(r="0"+r),e+=r}return e}};function dw(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var jf={exports:{}},CE;function fw(){return CE||(CE=1,function(i,e){(function(t){var r=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,n=/^(?=([^\/?#]*))\1([^]*)$/,s=/(?:\/|^)\.(?=\/)/g,a=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,o={buildAbsoluteURL:function(l,u,h){if(h=h||{},l=l.trim(),u=u.trim(),!u){if(!h.alwaysNormalize)return l;var d=o.parseURL(l);if(!d)throw new Error("Error trying to parse base URL.");return d.path=o.normalizePath(d.path),o.buildURLFromParts(d)}var p=o.parseURL(u);if(!p)throw new Error("Error trying to parse relative URL.");if(p.scheme)return h.alwaysNormalize?(p.path=o.normalizePath(p.path),o.buildURLFromParts(p)):u;var g=o.parseURL(l);if(!g)throw new Error("Error trying to parse base URL.");if(!g.netLoc&&g.path&&g.path[0]!=="/"){var m=n.exec(g.path);g.netLoc=m[1],g.path=m[2]}g.netLoc&&!g.path&&(g.path="/");var v={scheme:g.scheme,netLoc:p.netLoc,path:null,params:p.params,query:p.query,fragment:p.fragment};if(!p.netLoc&&(v.netLoc=g.netLoc,p.path[0]!=="/"))if(!p.path)v.path=g.path,p.params||(v.params=g.params,p.query||(v.query=g.query));else{var E=g.path,A=E.substring(0,E.lastIndexOf("/")+1)+p.path;v.path=o.normalizePath(A)}return v.path===null&&(v.path=h.alwaysNormalize?o.normalizePath(p.path):p.path),o.buildURLFromParts(v)},parseURL:function(l){var u=r.exec(l);return u?{scheme:u[1]||"",netLoc:u[2]||"",path:u[3]||"",params:u[4]||"",query:u[5]||"",fragment:u[6]||""}:null},normalizePath:function(l){for(l=l.split("").reverse().join("").replace(s,"");l.length!==(l=l.replace(a,"")).length;);return l.split("").reverse().join("")},buildURLFromParts:function(l){return l.scheme+l.netLoc+l.path+l.params+l.query+l.fragment}};i.exports=o})()}(jf)),jf.exports}var zf=fw();class Jf{constructor(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}}var Nt={AUDIO:"audio",VIDEO:"video",AUDIOVIDEO:"audiovideo"};class wE{constructor(e){this._byteRange=null,this._url=null,this._stats=null,this._streams=null,this.base=void 0,this.relurl=void 0,typeof e=="string"&&(e={url:e}),this.base=e,pw(this,"stats")}setByteRange(e,t){const r=e.split("@",2);let n;r.length===1?n=(t==null?void 0:t.byteRangeEndOffset)||0:n=parseInt(r[1]),this._byteRange=[n,parseInt(r[0])+n]}get baseurl(){return this.base.url}get byteRange(){return this._byteRange===null?[]:this._byteRange}get byteRangeStartOffset(){return this.byteRange[0]}get byteRangeEndOffset(){return this.byteRange[1]}get elementaryStreams(){return this._streams===null&&(this._streams={[Nt.AUDIO]:null,[Nt.VIDEO]:null,[Nt.AUDIOVIDEO]:null}),this._streams}set elementaryStreams(e){this._streams=e}get hasStats(){return this._stats!==null}get hasStreams(){return this._streams!==null}get stats(){return this._stats===null&&(this._stats=new Jf),this._stats}set stats(e){this._stats=e}get url(){return!this._url&&this.baseurl&&this.relurl&&(this._url=zf.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""}set url(e){this._url=e}clearElementaryStreamInfo(){const{elementaryStreams:e}=this;e[Nt.AUDIO]=null,e[Nt.VIDEO]=null,e[Nt.AUDIOVIDEO]=null}}function pr(i){return i.sn!=="initSegment"}class Qf extends wE{constructor(e,t){super(t),this._decryptdata=null,this._programDateTime=null,this._ref=null,this._bitrate=void 0,this.rawProgramDateTime=null,this.tagList=[],this.duration=0,this.sn=0,this.levelkeys=void 0,this.type=void 0,this.loader=null,this.keyLoader=null,this.level=-1,this.cc=0,this.startPTS=void 0,this.endPTS=void 0,this.startDTS=void 0,this.endDTS=void 0,this.start=0,this.playlistOffset=0,this.deltaPTS=void 0,this.maxStartPTS=void 0,this.minEndPTS=void 0,this.data=void 0,this.bitrateTest=!1,this.title=null,this.initSegment=null,this.endList=void 0,this.gap=void 0,this.urlId=0,this.type=e}get byteLength(){if(this.hasStats){const e=this.stats.total;if(e)return e}if(this.byteRange){const e=this.byteRange[0],t=this.byteRange[1];if(Ce(e)&&Ce(t))return t-e}return null}get bitrate(){return this.byteLength?this.byteLength*8/this.duration:this._bitrate?this._bitrate:null}set bitrate(e){this._bitrate=e}get decryptdata(){const{levelkeys:e}=this;if(!e&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkeys&&!this.levelkeys.NONE){const t=this.levelkeys.identity;if(t)this._decryptdata=t.getDecryptData(this.sn);else{const r=Object.keys(this.levelkeys);if(r.length===1)return this._decryptdata=this.levelkeys[r[0]].getDecryptData(this.sn)}}return this._decryptdata}get end(){return this.start+this.duration}get endProgramDateTime(){if(this.programDateTime===null)return null;const e=Ce(this.duration)?this.duration:0;return this.programDateTime+e*1e3}get encrypted(){var e;if((e=this._decryptdata)!=null&&e.encrypted)return!0;if(this.levelkeys){const t=Object.keys(this.levelkeys),r=t.length;if(r>1||r===1&&this.levelkeys[t[0]].encrypted)return!0}return!1}get programDateTime(){return this._programDateTime===null&&this.rawProgramDateTime&&(this.programDateTime=Date.parse(this.rawProgramDateTime)),this._programDateTime}set programDateTime(e){if(!Ce(e)){this._programDateTime=this.rawProgramDateTime=null;return}this._programDateTime=e}get ref(){return pr(this)?(this._ref||(this._ref={base:this.base,start:this.start,duration:this.duration,sn:this.sn,programDateTime:this.programDateTime}),this._ref):null}addStart(e){this.setStart(this.start+e)}setStart(e){this.start=e,this._ref&&(this._ref.start=e)}setDuration(e){this.duration=e,this._ref&&(this._ref.duration=e)}setKeyFormat(e){if(this.levelkeys){const t=this.levelkeys[e];t&&!this._decryptdata&&(this._decryptdata=t.getDecryptData(this.sn))}}abortRequests(){var e,t;(e=this.loader)==null||e.abort(),(t=this.keyLoader)==null||t.abort()}setElementaryStreamInfo(e,t,r,n,s,a=!1){const{elementaryStreams:o}=this,l=o[e];if(!l){o[e]={startPTS:t,endPTS:r,startDTS:n,endDTS:s,partial:a};return}l.startPTS=Math.min(l.startPTS,t),l.endPTS=Math.max(l.endPTS,r),l.startDTS=Math.min(l.startDTS,n),l.endDTS=Math.max(l.endDTS,s)}}class gw extends wE{constructor(e,t,r,n,s){super(r),this.fragOffset=0,this.duration=0,this.gap=!1,this.independent=!1,this.relurl=void 0,this.fragment=void 0,this.index=void 0,this.duration=e.decimalFloatingPoint("DURATION"),this.gap=e.bool("GAP"),this.independent=e.bool("INDEPENDENT"),this.relurl=e.enumeratedString("URI"),this.fragment=t,this.index=n;const a=e.enumeratedString("BYTERANGE");a&&this.setByteRange(a,s),s&&(this.fragOffset=s.fragOffset+s.duration)}get start(){return this.fragment.start+this.fragOffset}get end(){return this.start+this.duration}get loaded(){const{elementaryStreams:e}=this;return!!(e.audio||e.video||e.audiovideo)}}function LE(i,e){const t=Object.getPrototypeOf(i);if(t){const r=Object.getOwnPropertyDescriptor(t,e);return r||LE(t,e)}}function pw(i,e){const t=LE(i,e);t&&(t.enumerable=!0,Object.defineProperty(i,e,t))}const Lu=Math.pow(2,32)-1,mw=[].push,_E={video:1,audio:2,id3:3,text:4};function ir(i){return String.fromCharCode.apply(null,i)}function ME(i,e){const t=i[e]<<8|i[e+1];return t<0?65536+t:t}function Ve(i,e){const t=kE(i,e);return t<0?4294967296+t:t}function PE(i,e){let t=Ve(i,e);return t*=Math.pow(2,32),t+=Ve(i,e+4),t}function kE(i,e){return i[e]<<24|i[e+1]<<16|i[e+2]<<8|i[e+3]}function Zf(i,e,t){i[e]=t>>24,i[e+1]=t>>16&255,i[e+2]=t>>8&255,i[e+3]=t&255}function yw(i){const e=i.byteLength;for(let t=0;t<e;){const r=Ve(i,t);if(r>8&&i[t+4]===109&&i[t+5]===111&&i[t+6]===111&&i[t+7]===102)return!0;t=r>1?t+r:e}return!1}function Qe(i,e){const t=[];if(!e.length)return t;const r=i.byteLength;for(let n=0;n<r;){const s=Ve(i,n),a=ir(i.subarray(n+4,n+8)),o=s>1?n+s:r;if(a===e[0])if(e.length===1)t.push(i.subarray(n+8,o));else{const l=Qe(i.subarray(n+8,o),e.slice(1));l.length&&mw.apply(t,l)}n=o}return t}function vw(i){const e=[],t=i[0];let r=8;const n=Ve(i,r);r+=4;let s=0,a=0;t===0?(s=Ve(i,r),a=Ve(i,r+4),r+=8):(s=PE(i,r),a=PE(i,r+8),r+=16),r+=2;let o=i.length+a;const l=ME(i,r);r+=2;for(let u=0;u<l;u++){let h=r;const d=Ve(i,h);h+=4;const p=d&2147483647;if((d&2147483648)>>>31===1)return mt.warn("SIDX has hierarchical references (not supported)"),null;const m=Ve(i,h);h+=4,e.push({referenceSize:p,subsegmentDuration:m,info:{duration:m/n,start:o,end:o+p-1}}),o+=p,h+=4,r=h}return{earliestPresentationTime:s,timescale:n,version:t,referencesCount:l,references:e}}function OE(i){const e=[],t=Qe(i,["moov","trak"]);for(let n=0;n<t.length;n++){const s=t[n],a=Qe(s,["tkhd"])[0];if(a){let o=a[0];const l=Ve(a,o===0?12:20),u=Qe(s,["mdia","mdhd"])[0];if(u){o=u[0];const h=Ve(u,o===0?12:20),d=Qe(s,["mdia","hdlr"])[0];if(d){const p=ir(d.subarray(8,12)),g={soun:Nt.AUDIO,vide:Nt.VIDEO}[p],m=Qe(s,["mdia","minf","stbl","stsd"])[0],v=Ew(m);g?(e[l]={timescale:h,type:g,stsd:v},e[g]=Et({timescale:h,id:l},v)):e[l]={timescale:h,type:p,stsd:v}}}}}return Qe(i,["moov","mvex","trex"]).forEach(n=>{const s=Ve(n,4),a=e[s];a&&(a.default={duration:Ve(n,12),flags:Ve(n,20)})}),e}function Ew(i){const e=i.subarray(8),t=e.subarray(86),r=ir(e.subarray(4,8));let n=r,s;const a=r==="enca"||r==="encv";if(a){const u=Qe(e,[r])[0].subarray(r==="enca"?28:78);Qe(u,["sinf"]).forEach(d=>{const p=Qe(d,["schm"])[0];if(p){const g=ir(p.subarray(4,8));if(g==="cbcs"||g==="cenc"){const m=Qe(d,["frma"])[0];m&&(n=ir(m))}}})}const o=n;switch(n){case"avc1":case"avc2":case"avc3":case"avc4":{const l=Qe(t,["avcC"])[0];l&&l.length>3&&(n+="."+Mu(l[1])+Mu(l[2])+Mu(l[3]),s=_u(o==="avc1"?"dva1":"dvav",t));break}case"mp4a":{const l=Qe(e,[r])[0],u=Qe(l.subarray(28),["esds"])[0];if(u&&u.length>7){let h=4;if(u[h++]!==3)break;h=eg(u,h),h+=2;const d=u[h++];if(d&128&&(h+=2),d&64&&(h+=u[h++]),u[h++]!==4)break;h=eg(u,h);const p=u[h++];if(p===64)n+="."+Mu(p);else break;if(h+=12,u[h++]!==5)break;h=eg(u,h);const g=u[h++];let m=(g&248)>>3;m===31&&(m+=1+((g&7)<<3)+((u[h]&224)>>5)),n+="."+m}break}case"hvc1":case"hev1":{const l=Qe(t,["hvcC"])[0];if(l&&l.length>12){const u=l[1],h=["","A","B","C"][u>>6],d=u&31,p=Ve(l,2),g=(u&32)>>5?"H":"L",m=l[12],v=l.subarray(6,12);n+="."+h+d,n+="."+bw(p).toString(16).toUpperCase(),n+="."+g+m;let E="";for(let A=v.length;A--;){const D=v[A];(D||E)&&(E="."+D.toString(16).toUpperCase()+E)}n+=E}s=_u(o=="hev1"?"dvhe":"dvh1",t);break}case"dvh1":case"dvhe":case"dvav":case"dva1":case"dav1":{n=_u(n,t)||n;break}case"vp09":{const l=Qe(t,["vpcC"])[0];if(l&&l.length>6){const u=l[4],h=l[5],d=l[6]>>4&15;n+="."+nn(u)+"."+nn(h)+"."+nn(d)}break}case"av01":{const l=Qe(t,["av1C"])[0];if(l&&l.length>2){const u=l[1]>>>5,h=l[1]&31,d=l[2]>>>7?"H":"M",p=(l[2]&64)>>6,g=(l[2]&32)>>5,m=u===2&&p?g?12:10:p?10:8,v=(l[2]&16)>>4,E=(l[2]&8)>>3,A=(l[2]&4)>>2,D=l[2]&3;n+="."+u+"."+nn(h)+d+"."+nn(m)+"."+v+"."+E+A+D+"."+nn(1)+"."+nn(1)+"."+nn(1)+"."+0,s=_u("dav1",t)}break}}return{codec:n,encrypted:a,supplemental:s}}function _u(i,e){const t=Qe(e,["dvvC"]),r=t.length?t[0]:Qe(e,["dvcC"])[0];if(r){const n=r[2]>>1&127,s=r[2]<<5&32|r[3]>>3&31;return i+"."+nn(n)+"."+nn(s)}}function bw(i){let e=0;for(let t=0;t<32;t++)e|=(i>>t&1)<<31-t;return e>>>0}function eg(i,e){const t=e+5;for(;i[e++]&128&&e<t;);return e}function Mu(i){return("0"+i.toString(16).toUpperCase()).slice(-2)}function nn(i){return(i<10?"0":"")+i}function Aw(i,e){if(!i||!e)return i;const t=e.keyId;return t&&e.isCommonEncryption&&Qe(i,["moov","trak"]).forEach(n=>{const a=Qe(n,["mdia","minf","stbl","stsd"])[0].subarray(8);let o=Qe(a,["enca"]);const l=o.length>0;l||(o=Qe(a,["encv"])),o.forEach(u=>{const h=l?u.subarray(28):u.subarray(78);Qe(h,["sinf"]).forEach(p=>{const g=FE(p);if(g){const m=g.subarray(8,24);m.some(v=>v!==0)||(mt.log(`[eme] Patching keyId in 'enc${l?"a":"v"}>sinf>>tenc' box: ${rn.hexDump(m)} -> ${rn.hexDump(t)}`),g.set(t,8))}})})}),i}function FE(i){const e=Qe(i,["schm"])[0];if(e){const t=ir(e.subarray(4,8));if(t==="cbcs"||t==="cenc")return Qe(i,["schi","tenc"])[0]}return null}function Sw(i,e,t){const r={},n=Qe(i,["moof","traf"]);for(let s=0;s<n.length;s++){const a=n[s],o=Qe(a,["tfhd"])[0],l=Ve(o,4),u=e[l];if(!u)continue;const h=r[l]||(r[l]={start:NaN,duration:0,sampleCount:0,timescale:u.timescale,type:u.type}),d=Qe(a,["tfdt"])[0];if(d){const R=d[0];let _=Ve(d,4);R===1&&(_===Lu?t.warn("[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time"):(_*=Lu+1,_+=Ve(d,8))),Ce(_)&&(!Ce(h.start)||_<h.start)&&(h.start=_)}const p=u.default,g=Ve(o,0)|(p==null?void 0:p.flags);let m=(p==null?void 0:p.duration)||0;g&8&&(g&2?m=Ve(o,12):m=Ve(o,8));const v=Qe(a,["trun"]);let E=h.start||0,A=0,D=m;for(let R=0;R<v.length;R++){const _=v[R],F=Ve(_,4),w=h.sampleCount;h.sampleCount+=F;const C=_[3]&1,M=_[3]&4,L=_[2]&1,I=_[2]&2,U=_[2]&4,q=_[2]&8;let $=8,X=F;for(C&&($+=4),M&&F&&(!(_[$+1]&1)&&h.keyFrameIndex===void 0&&(h.keyFrameIndex=w),$+=4,L?(D=Ve(_,$),$+=4):D=m,I&&($+=4),q&&($+=4),E+=D,A+=D,X--);X--;)L?(D=Ve(_,$),$+=4):D=m,I&&($+=4),U&&(_[$+1]&1||h.keyFrameIndex===void 0&&(h.keyFrameIndex=h.sampleCount-(X+1),h.keyFrameStart=E),$+=4),q&&($+=4),E+=D,A+=D;!A&&m&&(A+=m*F)}h.duration+=A}if(!Object.keys(r).some(s=>r[s].duration)){let s=1/0,a=0;const o=Qe(i,["sidx"]);for(let l=0;l<o.length;l++){const u=vw(o[l]);if(u!=null&&u.references){s=Math.min(s,u.earliestPresentationTime/u.timescale);const h=u.references.reduce((d,p)=>d+p.info.duration||0,0);a=Math.max(a,h+u.earliestPresentationTime/u.timescale)}}a&&Ce(a)&&Object.keys(r).forEach(l=>{r[l].duration||(r[l].duration=a*r[l].timescale-r[l].start)})}return r}function xw(i,e,t){Qe(e,["moof","traf"]).forEach(r=>{Qe(r,["tfhd"]).forEach(n=>{const s=Ve(n,4),a=i[s];if(!a)return;const o=a.timescale||9e4;Qe(r,["tfdt"]).forEach(l=>{const u=l[0],h=t*o;if(h){let d=Ve(l,4);if(u===0)d-=h,d=Math.max(d,0),Zf(l,4,d);else{d*=Math.pow(2,32),d+=Ve(l,8),d-=h,d=Math.max(d,0);const p=Math.floor(d/(Lu+1)),g=Math.floor(d%(Lu+1));Zf(l,4,p),Zf(l,8,g)}}})})})}function Tw(i){const e={valid:null,remainder:null},t=Qe(i,["moof"]);if(t.length<2)return e.remainder=i,e;const r=t[t.length-1];return e.valid=i.slice(0,r.byteOffset-8),e.remainder=i.slice(r.byteOffset-8),e}function pi(i,e){const t=new Uint8Array(i.length+e.length);return t.set(i),t.set(e,i.length),t}function BE(i,e){const t=[],r=e.samples,n=e.timescale,s=e.id;let a=!1;return Qe(r,["moof"]).map(l=>{const u=l.byteOffset-8;Qe(l,["traf"]).map(d=>{const p=Qe(d,["tfdt"]).map(g=>{const m=g[0];let v=Ve(g,4);return m===1&&(v*=Math.pow(2,32),v+=Ve(g,8)),v/n})[0];return p!==void 0&&(i=p),Qe(d,["tfhd"]).map(g=>{const m=Ve(g,4),v=Ve(g,0)&16777215,E=(v&1)!==0,A=(v&2)!==0,D=(v&8)!==0;let R=0;const _=(v&16)!==0;let F=0;const w=(v&32)!==0;let C=8;m===s&&(E&&(C+=8),A&&(C+=4),D&&(R=Ve(g,C),C+=4),_&&(F=Ve(g,C),C+=4),w&&(C+=4),e.type==="video"&&(a=Pu(e.codec)),Qe(d,["trun"]).map(M=>{const L=M[0],I=Ve(M,0)&16777215,U=(I&1)!==0;let q=0;const $=(I&4)!==0,X=(I&256)!==0;let ne=0;const se=(I&512)!==0;let ce=0;const ie=(I&1024)!==0,H=(I&2048)!==0;let J=0;const ve=Ve(M,4);let fe=8;U&&(q=Ve(M,fe),fe+=4),$&&(fe+=4);let De=q+u;for(let Ie=0;Ie<ve;Ie++){if(X?(ne=Ve(M,fe),fe+=4):ne=R,se?(ce=Ve(M,fe),fe+=4):ce=F,ie&&(fe+=4),H&&(L===0?J=Ve(M,fe):J=kE(M,fe),fe+=4),e.type===Nt.VIDEO){let we=0;for(;we<ce;){const Ue=Ve(r,De);if(De+=4,Dw(a,r[De])){const $e=r.subarray(De,De+Ue);tg($e,a?2:1,i+J/n,t)}De+=Ue,we+=Ue+4}}i+=ne/n}}))})})}),t}function Pu(i){if(!i)return!1;const e=i.substring(0,4);return e==="hvc1"||e==="hev1"||e==="dvh1"||e==="dvhe"}function Dw(i,e){if(i){const t=e>>1&63;return t===39||t===40}else return(e&31)===6}function tg(i,e,t,r){const n=UE(i);let s=0;s+=e;let a=0,o=0,l=0;for(;s<n.length;){a=0;do{if(s>=n.length)break;l=n[s++],a+=l}while(l===255);o=0;do{if(s>=n.length)break;l=n[s++],o+=l}while(l===255);const u=n.length-s;let h=s;if(o<u)s+=o;else if(o>u){mt.error(`Malformed SEI payload. ${o} is too small, only ${u} bytes left to parse.`);break}if(a===4){if(n[h++]===181){const p=ME(n,h);if(h+=2,p===49){const g=Ve(n,h);if(h+=4,g===1195456820){const m=n[h++];if(m===3){const v=n[h++],E=31&v,A=64&v,D=A?2+E*3:0,R=new Uint8Array(D);if(A){R[0]=v;for(let _=1;_<D;_++)R[_]=n[h++]}r.push({type:m,payloadType:a,pts:t,bytes:R})}}}}}else if(a===5&&o>16){const d=[];for(let m=0;m<16;m++){const v=n[h++].toString(16);d.push(v.length==1?"0"+v:v),(m===3||m===5||m===7||m===9)&&d.push("-")}const p=o-16,g=new Uint8Array(p);for(let m=0;m<p;m++)g[m]=n[h++];r.push({payloadType:a,pts:t,uuid:d.join(""),userData:ii(g),userDataBytes:g})}}}function UE(i){const e=i.byteLength,t=[];let r=1;for(;r<e-2;)i[r]===0&&i[r+1]===0&&i[r+2]===3?(t.push(r+2),r+=2):r++;if(t.length===0)return i;const n=e-t.length,s=new Uint8Array(n);let a=0;for(r=0;r<n;a++,r++)a===t[0]&&(a++,t.shift()),s[r]=i[a];return s}function Rw(i){const e=i[0];let t="",r="",n=0,s=0,a=0,o=0,l=0,u=0;if(e===0){for(;ir(i.subarray(u,u+1))!=="\0";)t+=ir(i.subarray(u,u+1)),u+=1;for(t+=ir(i.subarray(u,u+1)),u+=1;ir(i.subarray(u,u+1))!=="\0";)r+=ir(i.subarray(u,u+1)),u+=1;r+=ir(i.subarray(u,u+1)),u+=1,n=Ve(i,12),s=Ve(i,16),o=Ve(i,20),l=Ve(i,24),u=28}else if(e===1){u+=4,n=Ve(i,u),u+=4;const d=Ve(i,u);u+=4;const p=Ve(i,u);for(u+=4,a=4294967296*d+p,rw(a)||(a=Number.MAX_SAFE_INTEGER,mt.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),o=Ve(i,u),u+=4,l=Ve(i,u),u+=4;ir(i.subarray(u,u+1))!=="\0";)t+=ir(i.subarray(u,u+1)),u+=1;for(t+=ir(i.subarray(u,u+1)),u+=1;ir(i.subarray(u,u+1))!=="\0";)r+=ir(i.subarray(u,u+1)),u+=1;r+=ir(i.subarray(u,u+1)),u+=1}const h=i.subarray(u,i.byteLength);return{schemeIdUri:t,value:r,timeScale:n,presentationTime:a,presentationTimeDelta:s,eventDuration:o,id:l,payload:h}}function Iw(i,...e){const t=e.length;let r=8,n=t;for(;n--;)r+=e[n].byteLength;const s=new Uint8Array(r);for(s[0]=r>>24&255,s[1]=r>>16&255,s[2]=r>>8&255,s[3]=r&255,s.set(i,4),n=0,r=8;n<t;n++)s.set(e[n],r),r+=e[n].byteLength;return s}function Nw(i,e,t){if(i.byteLength!==16)throw new RangeError("Invalid system id");let r,n;r=0,n=new Uint8Array;let s;r>0?(s=new Uint8Array(4),e.length>0&&new DataView(s.buffer).setUint32(0,e.length,!1)):s=new Uint8Array;const a=new Uint8Array(4);return t&&t.byteLength>0&&new DataView(a.buffer).setUint32(0,t.byteLength,!1),Iw([112,115,115,104],new Uint8Array([r,0,0,0]),i,s,n,a,t||new Uint8Array)}function Cw(i){const e=[];if(i instanceof ArrayBuffer){const t=i.byteLength;let r=0;for(;r+32<t;){const n=new DataView(i,r),s=ww(n);e.push(s),r+=s.size}}return e}function ww(i){const e=i.getUint32(0),t=i.byteOffset,r=i.byteLength;if(r<e)return{offset:t,size:r};if(i.getUint32(4)!==1886614376)return{offset:t,size:e};const s=i.getUint32(8)>>>24;if(s!==0&&s!==1)return{offset:t,size:e};const a=i.buffer,o=rn.hexDump(new Uint8Array(a,t+12,16)),l=i.getUint32(28);let u=null,h=null;if(s===0){if(e-32<l||l<22)return{offset:t,size:e};h=new Uint8Array(a,t+32,l)}else if(s===1){if(!l||r<t+32+l*16+16)return{offset:t,size:e};u=[];for(let d=0;d<l;d++)u.push(new Uint8Array(a,t+32+d*16,16))}return{version:s,systemId:o,kids:u,data:h,offset:t,size:e}}const $E=()=>/\(Windows.+Firefox\//i.test(navigator.userAgent),Ba={audio:{a3ds:1,"ac-3":.95,"ac-4":1,alac:.9,alaw:1,dra1:1,"dts+":1,"dts-":1,dtsc:1,dtse:1,dtsh:1,"ec-3":.9,enca:1,fLaC:.9,flac:.9,FLAC:.9,g719:1,g726:1,m4ae:1,mha1:1,mha2:1,mhm1:1,mhm2:1,mlpa:1,mp4a:1,"raw ":1,Opus:1,opus:1,samr:1,sawb:1,sawp:1,sevc:1,sqcp:1,ssmv:1,twos:1,ulaw:1},video:{avc1:1,avc2:1,avc3:1,avc4:1,avcp:1,av01:.8,dav1:.8,drac:1,dva1:1,dvav:1,dvh1:.7,dvhe:.7,encv:1,hev1:.75,hvc1:.75,mjp2:1,mp4v:1,mvc1:1,mvc2:1,mvc3:1,mvc4:1,resv:1,rv60:1,s263:1,svc1:1,svc2:1,"vc-1":1,vp08:1,vp09:.9},text:{stpp:1,wvtt:1}};function GE(i,e){const t=Ba[e];return!!t&&!!t[i.slice(0,4)]}function rg(i,e,t=!0){return!i.split(",").some(r=>!qE(r,e,t))}function qE(i,e,t=!0){var r;const n=hs(t);return(r=n==null?void 0:n.isTypeSupported(Jo(i,e)))!=null?r:!1}function Jo(i,e){return`${e}/mp4;codecs=${i}`}function VE(i){if(i){const e=i.substring(0,4);return Ba.video[e]}return 2}function ku(i){const e=$E();return i.split(",").reduce((t,r)=>{const s=e&&Pu(r)?9:Ba.video[r];return s?(s*2+t)/(t?3:2):(Ba.audio[r]+t)/(t?2:1)},0)}const ig={};function Lw(i,e=!0){if(ig[i])return ig[i];const t={flac:["flac","fLaC","FLAC"],opus:["opus","Opus"],"mp4a.40.34":["mp3"]}[i];for(let n=0;n<t.length;n++){var r;if(qE(t[n],"audio",e))return ig[i]=t[n],t[n];if(t[n]==="mp3"&&(r=hs(e))!=null&&r.isTypeSupported("audio/mpeg"))return""}return i}const _w=/flac|opus|mp4a\.40\.34/i;function Ou(i,e=!0){return i.replace(_w,t=>Lw(t.toLowerCase(),e))}function Mw(i,e){const t=[];if(i){const r=i.split(",");for(let n=0;n<r.length;n++)GE(r[n],"video")||t.push(r[n])}return e&&t.push(e),t.join(",")}function Fu(i,e){if(i&&(i.length>4||["ac-3","ec-3","alac","fLaC","Opus"].indexOf(i)!==-1))return i;if(e){const t=e.split(",");if(t.length>1){if(i){for(let r=t.length;r--;)if(t[r].substring(0,4)===i.substring(0,4))return t[r]}return t[0]}}return e||i}function Pw(i){const e=i.split(",");for(let t=0;t<e.length;t++){const r=e[t].split(".");r.length>2&&r[0]==="avc1"&&(e[t]=`avc1.${parseInt(r[1]).toString(16)}${("000"+parseInt(r[2]).toString(16)).slice(-4)}`)}return e.join(",")}function kw(i){if(i.startsWith("av01.")){const e=i.split("."),t=["0","111","01","01","01","0"];for(let r=e.length;r>4&&r<10;r++)e[r]=t[r-4];return e.join(".")}return i}function HE(i){const e=hs(i)||{isTypeSupported:()=>!1};return{mpeg:e.isTypeSupported("audio/mpeg"),mp3:e.isTypeSupported('audio/mp4; codecs="mp3"'),ac3:e.isTypeSupported('audio/mp4; codecs="ac-3"')}}function KE(i){return i.replace(/^.+codecs=["']?([^"']+).*$/,"$1")}const WE={supported:!0,configurations:[],decodingInfoResults:[{supported:!0,powerEfficient:!0,smooth:!0}]};function YE(i,e){return{supported:!1,configurations:e,decodingInfoResults:[{supported:!1,smooth:!1,powerEfficient:!1}],error:i}}const XE={};function Ow(i,e,t,r,n,s){const a=i.audioCodec?i.audioGroups:null,o=s==null?void 0:s.audioCodec,l=s==null?void 0:s.channels,u=l?parseInt(l):o?1/0:2;let h=null;if(a!=null&&a.length)try{a.length===1&&a[0]?h=e.groups[a[0]].channels:h=a.reduce((d,p)=>{if(p){const g=e.groups[p];if(!g)throw new Error(`Audio track group ${p} not found`);Object.keys(g.channels).forEach(m=>{d[m]=(d[m]||0)+g.channels[m]})}return d},{2:0})}catch{return!0}return i.videoCodec!==void 0&&(i.width>1920&&i.height>1088||i.height>1920&&i.width>1088||i.frameRate>Math.max(r,30)||i.videoRange!=="SDR"&&i.videoRange!==t||i.bitrate>Math.max(n,8e6))||!!h&&Ce(u)&&Object.keys(h).some(d=>parseInt(d)>u)}function jE(i,e,t){const r=i.videoCodec,n=i.audioCodec;if(!r&&!n||!t)return Promise.resolve(WE);const s=[];if(r){const a={width:i.width,height:i.height,bitrate:Math.ceil(Math.max(i.bitrate*.9,i.averageBitrate)),framerate:i.frameRate||30},o=i.videoRange;o!=="SDR"&&(a.transferFunction=o.toLowerCase());const l=r.split(","),u=navigator.userAgent;if(l.some(h=>Pu(h))&&$E())return Promise.resolve(YE(new Error(`Overriding Windows Firefox HEVC MediaCapabilities result based on user-agent sting: (${u})`),s));s.push.apply(s,l.map(h=>({type:"media-source",video:Et(Et({},a),{},{contentType:Jo(kw(h),"video")})})))}return n&&i.audioGroups&&i.audioGroups.forEach(a=>{var o;a&&((o=e.groups[a])==null||o.tracks.forEach(l=>{if(l.groupId===a){const u=l.channels||"",h=parseFloat(u);Ce(h)&&h>2&&s.push.apply(s,n.split(",").map(d=>({type:"media-source",audio:{contentType:Jo(d,"audio"),channels:""+h}})))}}))}),Promise.all(s.map(a=>{const o=Fw(a);return XE[o]||(XE[o]=t.decodingInfo(a))})).then(a=>({supported:!a.some(o=>!o.supported),configurations:s,decodingInfoResults:a})).catch(a=>({supported:!1,configurations:s,decodingInfoResults:[],error:a}))}function Fw(i){const{audio:e,video:t}=i,r=t||e;if(r){const n=KE(r.contentType);if(t)return`r${t.height}x${t.width}f${Math.ceil(t.framerate)}${t.transferFunction||"sd"}_${n}_${Math.ceil(t.bitrate/1e5)}`;if(e)return`c${e.channels}${e.spatialRendering?"s":"n"}_${n}`}return""}const ng=["NONE","TYPE-0","TYPE-1",null];function Bw(i){return ng.indexOf(i)>-1}const Bu=["SDR","PQ","HLG"];function Uw(i){return!!i&&Bu.indexOf(i)>-1}var Uu={No:"",Yes:"YES",v2:"v2"};function zE(i){const{canSkipUntil:e,canSkipDateRanges:t,age:r}=i,n=r<e/2;return e&&n?t?Uu.v2:Uu.Yes:Uu.No}class JE{constructor(e,t,r){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=e,this.part=t,this.skip=r}addDirectives(e){const t=new self.URL(e);return this.msn!==void 0&&t.searchParams.set("_HLS_msn",this.msn.toString()),this.part!==void 0&&t.searchParams.set("_HLS_part",this.part.toString()),this.skip&&t.searchParams.set("_HLS_skip",this.skip),t.href}}class Qo{constructor(e){if(this._attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.url=void 0,this.frameRate=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.supplemental=void 0,this.videoCodec=void 0,this.width=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.supportedPromise=void 0,this.supportedResult=void 0,this._avgBitrate=0,this._audioGroups=void 0,this._subtitleGroups=void 0,this._urlId=0,this.url=[e.url],this._attrs=[e.attrs],this.bitrate=e.bitrate,e.details&&(this.details=e.details),this.id=e.id||0,this.name=e.name,this.width=e.width||0,this.height=e.height||0,this.frameRate=e.attrs.optionalFloat("FRAME-RATE",0),this._avgBitrate=e.attrs.decimalInteger("AVERAGE-BANDWIDTH"),this.audioCodec=e.audioCodec,this.videoCodec=e.videoCodec,this.codecSet=[e.videoCodec,e.audioCodec].filter(r=>!!r).map(r=>r.substring(0,4)).join(","),"supplemental"in e){var t;this.supplemental=e.supplemental;const r=(t=e.supplemental)==null?void 0:t.videoCodec;r&&r!==e.videoCodec&&(this.codecSet+=`,${r.substring(0,4)}`)}this.addGroupId("audio",e.attrs.AUDIO),this.addGroupId("text",e.attrs.SUBTITLES)}get maxBitrate(){return Math.max(this.realBitrate,this.bitrate)}get averageBitrate(){return this._avgBitrate||this.realBitrate||this.bitrate}get attrs(){return this._attrs[0]}get codecs(){return this.attrs.CODECS||""}get pathwayId(){return this.attrs["PATHWAY-ID"]||"."}get videoRange(){return this.attrs["VIDEO-RANGE"]||"SDR"}get score(){return this.attrs.optionalFloat("SCORE",0)}get uri(){return this.url[0]||""}hasAudioGroup(e){return QE(this._audioGroups,e)}hasSubtitleGroup(e){return QE(this._subtitleGroups,e)}get audioGroups(){return this._audioGroups}get subtitleGroups(){return this._subtitleGroups}addGroupId(e,t){if(t){if(e==="audio"){let r=this._audioGroups;r||(r=this._audioGroups=[]),r.indexOf(t)===-1&&r.push(t)}else if(e==="text"){let r=this._subtitleGroups;r||(r=this._subtitleGroups=[]),r.indexOf(t)===-1&&r.push(t)}}}get urlId(){return 0}set urlId(e){}get audioGroupIds(){return this.audioGroups?[this.audioGroupId]:void 0}get textGroupIds(){return this.subtitleGroups?[this.textGroupId]:void 0}get audioGroupId(){var e;return(e=this.audioGroups)==null?void 0:e[0]}get textGroupId(){var e;return(e=this.subtitleGroups)==null?void 0:e[0]}addFallback(){}}function QE(i,e){return!e||!i?!1:i.indexOf(e)!==-1}function $w(){if(typeof matchMedia=="function"){const i=matchMedia("(dynamic-range: high)"),e=matchMedia("bad query");if(i.media!==e.media)return i.matches===!0}return!1}function Gw(i,e){let t=!1,r=[];if(i&&(t=i!=="SDR",r=[i]),e){r=e.allowedVideoRanges||Bu.slice(0);const n=r.join("")!=="SDR"&&!e.videoCodec;t=e.preferHDR!==void 0?e.preferHDR:n&&$w(),t||(r=["SDR"])}return{preferHDR:t,allowedVideoRanges:r}}const qw=i=>{const e=new WeakSet;return(t,r)=>{if(i&&(r=i(t,r)),typeof r=="object"&&r!==null){if(e.has(r))return;e.add(r)}return r}},Gt=(i,e)=>JSON.stringify(i,qw(e));function Vw(i,e,t,r,n){const s=Object.keys(i),a=r==null?void 0:r.channels,o=r==null?void 0:r.audioCodec,l=n==null?void 0:n.videoCodec,u=a&&parseInt(a)===2;let h=!1,d=!1,p=1/0,g=1/0,m=1/0,v=1/0,E=0,A=[];const{preferHDR:D,allowedVideoRanges:R}=Gw(e,n);for(let M=s.length;M--;){const L=i[s[M]];h||(h=L.channels[2]>0),p=Math.min(p,L.minHeight),g=Math.min(g,L.minFramerate),m=Math.min(m,L.minBitrate),R.filter(U=>L.videoRanges[U]>0).length>0&&(d=!0)}p=Ce(p)?p:0,g=Ce(g)?g:0;const _=Math.max(1080,p),F=Math.max(30,g);m=Ce(m)?m:t,t=Math.max(m,t),d||(e=void 0);const w=s.length>1;return{codecSet:s.reduce((M,L)=>{const I=i[L];if(L===M)return M;if(A=d?R.filter(U=>I.videoRanges[U]>0):[],w){if(I.minBitrate>t)return sn(L,`min bitrate of ${I.minBitrate} > current estimate of ${t}`),M;if(!I.hasDefaultAudio)return sn(L,"no renditions with default or auto-select sound found"),M;if(o&&L.indexOf(o.substring(0,4))%5!==0)return sn(L,`audio codec preference "${o}" not found`),M;if(a&&!u){if(!I.channels[a])return sn(L,`no renditions with ${a} channel sound found (channels options: ${Object.keys(I.channels)})`),M}else if((!o||u)&&h&&I.channels[2]===0)return sn(L,"no renditions with stereo sound found"),M;if(I.minHeight>_)return sn(L,`min resolution of ${I.minHeight} > maximum of ${_}`),M;if(I.minFramerate>F)return sn(L,`min framerate of ${I.minFramerate} > maximum of ${F}`),M;if(!A.some(U=>I.videoRanges[U]>0))return sn(L,`no variants with VIDEO-RANGE of ${Gt(A)} found`),M;if(l&&L.indexOf(l.substring(0,4))%5!==0)return sn(L,`video codec preference "${l}" not found`),M;if(I.maxScore<E)return sn(L,`max score of ${I.maxScore} < selected max of ${E}`),M}return M&&(ku(L)>=ku(M)||I.fragmentError>i[M].fragmentError)?M:(v=I.minIndex,E=I.maxScore,L)},void 0),videoRanges:A,preferHDR:D,minFramerate:g,minBitrate:m,minIndex:v}}function sn(i,e){mt.log(`[abr] start candidates with "${i}" ignored because ${e}`)}function ZE(i){return i.reduce((e,t)=>{let r=e.groups[t.groupId];r||(r=e.groups[t.groupId]={tracks:[],channels:{2:0},hasDefault:!1,hasAutoSelect:!1}),r.tracks.push(t);const n=t.channels||"2";return r.channels[n]=(r.channels[n]||0)+1,r.hasDefault=r.hasDefault||t.default,r.hasAutoSelect=r.hasAutoSelect||t.autoselect,r.hasDefault&&(e.hasDefaultAudio=!0),r.hasAutoSelect&&(e.hasAutoSelectAudio=!0),e},{hasDefaultAudio:!1,hasAutoSelectAudio:!1,groups:{}})}function Hw(i,e,t,r){return i.slice(t,r+1).reduce((n,s,a)=>{if(!s.codecSet)return n;const o=s.audioGroups;let l=n[s.codecSet];l||(n[s.codecSet]=l={minBitrate:1/0,minHeight:1/0,minFramerate:1/0,minIndex:a,maxScore:0,videoRanges:{SDR:0},channels:{2:0},hasDefaultAudio:!o,fragmentError:0}),l.minBitrate=Math.min(l.minBitrate,s.bitrate);const u=Math.min(s.height,s.width);return l.minHeight=Math.min(l.minHeight,u),l.minFramerate=Math.min(l.minFramerate,s.frameRate),l.minIndex=Math.min(l.minIndex,a),l.maxScore=Math.max(l.maxScore,s.score),l.fragmentError+=s.fragmentError,l.videoRanges[s.videoRange]=(l.videoRanges[s.videoRange]||0)+1,o&&o.forEach(h=>{if(!h)return;const d=e.groups[h];d&&(l.hasDefaultAudio=l.hasDefaultAudio||e.hasDefaultAudio?d.hasDefault:d.hasAutoSelect||!e.hasDefaultAudio&&!e.hasAutoSelectAudio,Object.keys(d.channels).forEach(p=>{l.channels[p]=(l.channels[p]||0)+d.channels[p]}))}),n},{})}function eb(i){if(!i)return i;const{lang:e,assocLang:t,characteristics:r,channels:n,audioCodec:s}=i;return{lang:e,assocLang:t,characteristics:r,channels:n,audioCodec:s}}function an(i,e,t){if("attrs"in i){const r=e.indexOf(i);if(r!==-1)return r}for(let r=0;r<e.length;r++){const n=e[r];if(Ys(i,n,t))return r}return-1}function Ys(i,e,t){const{groupId:r,name:n,lang:s,assocLang:a,default:o}=i,l=i.forced;return(r===void 0||e.groupId===r)&&(n===void 0||e.name===n)&&(s===void 0||Kw(s,e.lang))&&(s===void 0||e.assocLang===a)&&(o===void 0||e.default===o)&&(l===void 0||e.forced===l)&&(!("characteristics"in i)||Ww(i.characteristics||"",e.characteristics))&&(t===void 0||t(i,e))}function Kw(i,e="--"){return i.length===e.length?i===e:i.startsWith(e)||e.startsWith(i)}function Ww(i,e=""){const t=i.split(","),r=e.split(",");return t.length===r.length&&!t.some(n=>r.indexOf(n)===-1)}function Xs(i,e){const{audioCodec:t,channels:r}=i;return(t===void 0||(e.audioCodec||"").substring(0,4)===t.substring(0,4))&&(r===void 0||r===(e.channels||"2"))}function Yw(i,e,t,r,n){const s=e[r],o=e.reduce((p,g,m)=>{const v=g.uri;return(p[v]||(p[v]=[])).push(m),p},{})[s.uri];o.length>1&&(r=Math.max.apply(Math,o));const l=s.videoRange,u=s.frameRate,h=s.codecSet.substring(0,4),d=tb(e,r,p=>{if(p.videoRange!==l||p.frameRate!==u||p.codecSet.substring(0,4)!==h)return!1;const g=p.audioGroups,m=t.filter(v=>!g||g.indexOf(v.groupId)!==-1);return an(i,m,n)>-1});return d>-1?d:tb(e,r,p=>{const g=p.audioGroups,m=t.filter(v=>!g||g.indexOf(v.groupId)!==-1);return an(i,m,n)>-1})}function tb(i,e,t){for(let r=e;r>-1;r--)if(t(i[r]))return r;for(let r=e+1;r<i.length;r++)if(t(i[r]))return r;return-1}function $u(i,e){var t;return!!i&&i!==((t=e.loadLevelObj)==null?void 0:t.uri)}class Xw extends Cn{constructor(e){super("abr",e.logger),this.hls=void 0,this.lastLevelLoadSec=0,this.lastLoadedFragLevel=-1,this.firstSelection=-1,this._nextAutoLevel=-1,this.nextAutoLevelKey="",this.audioTracksByGroup=null,this.codecTiers=null,this.timer=-1,this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.rebufferNotice=-1,this.bwEstimator=void 0,this._abandonRulesCheck=t=>{var r;const{fragCurrent:n,partCurrent:s,hls:a}=this,{autoLevelEnabled:o,media:l}=a;if(!n||!l)return;const u=performance.now(),h=s?s.stats:n.stats,d=s?s.duration:n.duration,p=u-h.loading.start,g=a.minAutoLevel,m=n.level,v=this._nextAutoLevel;if(h.aborted||h.loaded&&h.loaded===h.total||m<=g){this.clearTimer(),this._nextAutoLevel=-1;return}if(!o)return;const E=v>-1&&v!==m,A=!!t||E;if(!A&&(l.paused||!l.playbackRate||!l.readyState))return;const D=a.mainForwardBufferInfo;if(!A&&D===null)return;const R=this.bwEstimator.getEstimateTTFB(),_=Math.abs(l.playbackRate);if(p<=Math.max(R,1e3*(d/(_*2))))return;const F=D?D.len/_:0,w=h.loading.first?h.loading.first-h.loading.start:-1,C=h.loaded&&w>-1,M=this.getBwEstimate(),L=a.levels,I=L[m],U=Math.max(h.loaded,Math.round(d*(n.bitrate||I.averageBitrate)/8));let q=C?p-w:p;q<1&&C&&(q=Math.min(p,h.loaded*8/M));const $=C?h.loaded*1e3/q:0,X=R/1e3,ne=$?(U-h.loaded)/$:U*8/M+X;if(ne<=F)return;const se=$?$*8:M,ce=((r=(t==null?void 0:t.details)||this.hls.latestLevelDetails)==null?void 0:r.live)===!0,ie=this.hls.config.abrBandWidthUpFactor;let H=Number.POSITIVE_INFINITY,J;for(J=m-1;J>g;J--){const Ie=L[J].maxBitrate,we=!L[J].details||ce;if(H=this.getTimeToLoadFrag(X,se,d*Ie,we),H<Math.min(F,d+X))break}if(H>=ne||H>d*10)return;C?this.bwEstimator.sample(p-Math.min(R,w),h.loaded):this.bwEstimator.sampleTTFB(p);const ve=L[J].maxBitrate;this.getBwEstimate()*ie>ve&&this.resetEstimator(ve);const fe=this.findBestLevel(ve,g,J,0,F,1,1);fe>-1&&(J=fe),this.warn(`Fragment ${n.sn}${s?" part "+s.index:""} of level ${m} is loading too slowly;
      Fragment duration: ${n.duration.toFixed(3)}
      Time to underbuffer: ${F.toFixed(3)} s
      Estimated load time for current fragment: ${ne.toFixed(3)} s
      Estimated load time for down switch fragment: ${H.toFixed(3)} s
      TTFB estimate: ${w|0} ms
      Current BW estimate: ${Ce(M)?M|0:"Unknown"} bps
      New BW estimate: ${this.getBwEstimate()|0} bps
      Switching to level ${J} @ ${ve|0} bps`),a.nextLoadLevel=a.nextAutoLevel=J,this.clearTimer();const De=()=>{if(this.clearTimer(),this.fragCurrent===n&&this.hls.loadLevel===J&&J>0){const Ie=this.getStarvationDelay();if(this.warn(`Aborting inflight request ${J>0?"and switching down":""}
      Fragment duration: ${n.duration.toFixed(3)} s
      Time to underbuffer: ${Ie.toFixed(3)} s`),n.abortRequests(),this.fragCurrent=this.partCurrent=null,J>g){let we=this.findBestLevel(this.hls.levels[g].bitrate,g,J,0,Ie,1,1);we===-1&&(we=g),this.hls.nextLoadLevel=this.hls.nextAutoLevel=we,this.resetEstimator(this.hls.levels[we].bitrate)}}};E||ne>H*2?De():this.timer=self.setInterval(De,H*1e3),a.trigger(x.FRAG_LOAD_EMERGENCY_ABORTED,{frag:n,part:s,stats:h})},this.hls=e,this.bwEstimator=this.initEstimator(),this.registerListeners()}resetEstimator(e){e&&(this.log(`setting initial bwe to ${e}`),this.hls.config.abrEwmaDefaultEstimate=e),this.firstSelection=-1,this.bwEstimator=this.initEstimator()}initEstimator(){const e=this.hls.config;return new nw(e.abrEwmaSlowVoD,e.abrEwmaFastVoD,e.abrEwmaDefaultEstimate)}registerListeners(){const{hls:e}=this;e.on(x.MANIFEST_LOADING,this.onManifestLoading,this),e.on(x.FRAG_LOADING,this.onFragLoading,this),e.on(x.FRAG_LOADED,this.onFragLoaded,this),e.on(x.FRAG_BUFFERED,this.onFragBuffered,this),e.on(x.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(x.LEVEL_LOADED,this.onLevelLoaded,this),e.on(x.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(x.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.on(x.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e&&(e.off(x.MANIFEST_LOADING,this.onManifestLoading,this),e.off(x.FRAG_LOADING,this.onFragLoading,this),e.off(x.FRAG_LOADED,this.onFragLoaded,this),e.off(x.FRAG_BUFFERED,this.onFragBuffered,this),e.off(x.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(x.LEVEL_LOADED,this.onLevelLoaded,this),e.off(x.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(x.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.off(x.ERROR,this.onError,this))}destroy(){this.unregisterListeners(),this.clearTimer(),this.hls=this._abandonRulesCheck=null,this.fragCurrent=this.partCurrent=null}onManifestLoading(e,t){this.lastLoadedFragLevel=-1,this.firstSelection=-1,this.lastLevelLoadSec=0,this.fragCurrent=this.partCurrent=null,this.onLevelsUpdated(),this.clearTimer()}onLevelsUpdated(){this.lastLoadedFragLevel>-1&&this.fragCurrent&&(this.lastLoadedFragLevel=this.fragCurrent.level),this._nextAutoLevel=-1,this.onMaxAutoLevelUpdated(),this.codecTiers=null,this.audioTracksByGroup=null}onMaxAutoLevelUpdated(){this.firstSelection=-1,this.nextAutoLevelKey=""}onFragLoading(e,t){const r=t.frag;if(!this.ignoreFragment(r)){if(!r.bitrateTest){var n;this.fragCurrent=r,this.partCurrent=(n=t.part)!=null?n:null}this.clearTimer(),this.timer=self.setInterval(this._abandonRulesCheck,100)}}onLevelSwitching(e,t){this.clearTimer()}onError(e,t){if(!t.fatal)switch(t.details){case Q.BUFFER_ADD_CODEC_ERROR:case Q.BUFFER_APPEND_ERROR:this.lastLoadedFragLevel=-1,this.firstSelection=-1;break;case Q.FRAG_LOAD_TIMEOUT:{const r=t.frag,{fragCurrent:n,partCurrent:s}=this;if(r&&n&&r.sn===n.sn&&r.level===n.level){const a=performance.now(),o=s?s.stats:r.stats,l=a-o.loading.start,u=o.loading.first?o.loading.first-o.loading.start:-1;if(o.loaded&&u>-1){const d=this.bwEstimator.getEstimateTTFB();this.bwEstimator.sample(l-Math.min(d,u),o.loaded)}else this.bwEstimator.sampleTTFB(l)}break}}}getTimeToLoadFrag(e,t,r,n){const s=e+r/t,a=n?e+this.lastLevelLoadSec:0;return s+a}onLevelLoaded(e,t){const r=this.hls.config,{loading:n}=t.stats,s=n.end-n.first;Ce(s)&&(this.lastLevelLoadSec=s/1e3),t.details.live?this.bwEstimator.update(r.abrEwmaSlowLive,r.abrEwmaFastLive):this.bwEstimator.update(r.abrEwmaSlowVoD,r.abrEwmaFastVoD),this.timer>-1&&this._abandonRulesCheck(t.levelInfo)}onFragLoaded(e,{frag:t,part:r}){const n=r?r.stats:t.stats;if(t.type===ke.MAIN&&this.bwEstimator.sampleTTFB(n.loading.first-n.loading.start),!this.ignoreFragment(t)){if(this.clearTimer(),t.level===this._nextAutoLevel&&(this._nextAutoLevel=-1),this.firstSelection=-1,this.hls.config.abrMaxWithRealBitrate){const s=r?r.duration:t.duration,a=this.hls.levels[t.level],o=(a.loaded?a.loaded.bytes:0)+n.loaded,l=(a.loaded?a.loaded.duration:0)+s;a.loaded={bytes:o,duration:l},a.realBitrate=Math.round(8*o/l)}if(t.bitrateTest){const s={stats:n,frag:t,part:r,id:t.type};this.onFragBuffered(x.FRAG_BUFFERED,s),t.bitrateTest=!1}else this.lastLoadedFragLevel=t.level}}onFragBuffered(e,t){const{frag:r,part:n}=t,s=n!=null&&n.stats.loaded?n.stats:r.stats;if(s.aborted||this.ignoreFragment(r))return;const a=s.parsing.end-s.loading.start-Math.min(s.loading.first-s.loading.start,this.bwEstimator.getEstimateTTFB());this.bwEstimator.sample(a,s.loaded),s.bwEstimate=this.getBwEstimate(),r.bitrateTest?this.bitrateTestDelay=a/1e3:this.bitrateTestDelay=0}ignoreFragment(e){return e.type!==ke.MAIN||e.sn==="initSegment"}clearTimer(){this.timer>-1&&(self.clearInterval(this.timer),this.timer=-1)}get firstAutoLevel(){const{maxAutoLevel:e,minAutoLevel:t}=this.hls,r=this.getBwEstimate(),n=this.hls.config.maxStarvationDelay,s=this.findBestLevel(r,t,e,0,n,1,1);if(s>-1)return s;const a=this.hls.firstLevel,o=Math.min(Math.max(a,t),e);return this.warn(`Could not find best starting auto level. Defaulting to first in playlist ${a} clamped to ${o}`),o}get forcedAutoLevel(){return this.nextAutoLevelKey?-1:this._nextAutoLevel}get nextAutoLevel(){const e=this.forcedAutoLevel,r=this.bwEstimator.canEstimate(),n=this.lastLoadedFragLevel>-1;if(e!==-1&&(!r||!n||this.nextAutoLevelKey===this.getAutoLevelKey()))return e;const s=r&&n?this.getNextABRAutoLevel():this.firstAutoLevel;if(e!==-1){const a=this.hls.levels;if(a.length>Math.max(e,s)&&a[e].loadError<=a[s].loadError)return e}return this._nextAutoLevel=s,this.nextAutoLevelKey=this.getAutoLevelKey(),s}getAutoLevelKey(){return`${this.getBwEstimate()}_${this.getStarvationDelay().toFixed(2)}`}getNextABRAutoLevel(){const{fragCurrent:e,partCurrent:t,hls:r}=this;if(r.levels.length<=1)return r.loadLevel;const{maxAutoLevel:n,config:s,minAutoLevel:a}=r,o=t?t.duration:e?e.duration:0,l=this.getBwEstimate(),u=this.getStarvationDelay();let h=s.abrBandWidthFactor,d=s.abrBandWidthUpFactor;if(u){const E=this.findBestLevel(l,a,n,u,0,h,d);if(E>=0)return this.rebufferNotice=-1,E}let p=o?Math.min(o,s.maxStarvationDelay):s.maxStarvationDelay;if(!u){const E=this.bitrateTestDelay;E&&(p=(o?Math.min(o,s.maxLoadingDelay):s.maxLoadingDelay)-E,this.info(`bitrate test took ${Math.round(1e3*E)}ms, set first fragment max fetchDuration to ${Math.round(1e3*p)} ms`),h=d=1)}const g=this.findBestLevel(l,a,n,u,p,h,d);if(this.rebufferNotice!==g&&(this.rebufferNotice=g,this.info(`${u?"rebuffering expected":"buffer is empty"}, optimal quality level ${g}`)),g>-1)return g;const m=r.levels[a],v=r.loadLevelObj;return v&&(m==null?void 0:m.bitrate)<v.bitrate?a:r.loadLevel}getStarvationDelay(){const e=this.hls,t=e.media;if(!t)return 1/0;const r=t&&t.playbackRate!==0?Math.abs(t.playbackRate):1,n=e.mainForwardBufferInfo;return(n?n.len:0)/r}getBwEstimate(){return this.bwEstimator.canEstimate()?this.bwEstimator.getEstimate():this.hls.config.abrEwmaDefaultEstimate}findBestLevel(e,t,r,n,s,a,o){var l;const u=n+s,h=this.lastLoadedFragLevel,d=h===-1?this.hls.firstLevel:h,{fragCurrent:p,partCurrent:g}=this,{levels:m,allAudioTracks:v,loadLevel:E,config:A}=this.hls;if(m.length===1)return 0;const D=m[d],R=!!((l=this.hls.latestLevelDetails)!=null&&l.live),_=E===-1||h===-1;let F,w="SDR",C=(D==null?void 0:D.frameRate)||0;const{audioPreference:M,videoPreference:L}=A,I=this.audioTracksByGroup||(this.audioTracksByGroup=ZE(v));let U=-1;if(_){if(this.firstSelection!==-1)return this.firstSelection;const se=this.codecTiers||(this.codecTiers=Hw(m,I,t,r)),ce=Vw(se,w,e,M,L),{codecSet:ie,videoRanges:H,minFramerate:J,minBitrate:ve,minIndex:fe,preferHDR:De}=ce;U=fe,F=ie,w=De?H[H.length-1]:H[0],C=J,e=Math.max(e,ve),this.log(`picked start tier ${Gt(ce)}`)}else F=D==null?void 0:D.codecSet,w=D==null?void 0:D.videoRange;const q=g?g.duration:p?p.duration:0,$=this.bwEstimator.getEstimateTTFB()/1e3,X=[];for(let se=r;se>=t;se--){var ne;const ce=m[se],ie=se>d;if(!ce)continue;if(A.useMediaCapabilities&&!ce.supportedResult&&!ce.supportedPromise){const we=navigator.mediaCapabilities;typeof(we==null?void 0:we.decodingInfo)=="function"&&(Ow(ce,I,w,C,e,M)||Pu(ce.videoCodec))?(ce.supportedPromise=jE(ce,I,we),ce.supportedPromise.then(Ue=>{if(!this.hls)return;ce.supportedResult=Ue;const $e=this.hls.levels,et=$e.indexOf(ce);Ue.error?this.warn(`MediaCapabilities decodingInfo error: "${Ue.error}" for level ${et} ${Gt(Ue)}`):Ue.supported||(this.warn(`Unsupported MediaCapabilities decodingInfo result for level ${et} ${Gt(Ue)}`),et>-1&&$e.length>1&&(this.log(`Removing unsupported level ${et}`),this.hls.removeLevel(et),this.hls.loadLevel===-1&&(this.hls.nextLoadLevel=0)))})):ce.supportedResult=WE}if((F&&ce.codecSet!==F||w&&ce.videoRange!==w||ie&&C>ce.frameRate||!ie&&C>0&&C<ce.frameRate||ce.supportedResult&&!((ne=ce.supportedResult.decodingInfoResults)!=null&&ne[0].smooth))&&(!_||se!==U)){X.push(se);continue}const H=ce.details,J=(g?H==null?void 0:H.partTarget:H==null?void 0:H.averagetargetduration)||q;let ve;ie?ve=o*e:ve=a*e;const fe=q&&n>=q*2&&s===0?ce.averageBitrate:ce.maxBitrate,De=this.getTimeToLoadFrag($,ve,fe*J,H===void 0);if(ve>=fe&&(se===h||ce.loadError===0&&ce.fragmentError===0)&&(De<=$||!Ce(De)||R&&!this.bitrateTestDelay||De<u)){const we=this.forcedAutoLevel;return se!==E&&(we===-1||we!==E)&&(X.length&&this.trace(`Skipped level(s) ${X.join(",")} of ${r} max with CODECS and VIDEO-RANGE:"${m[X[0]].codecs}" ${m[X[0]].videoRange}; not compatible with "${F}" ${w}`),this.info(`switch candidate:${d}->${se} adjustedbw(${Math.round(ve)})-bitrate=${Math.round(ve-fe)} ttfb:${$.toFixed(1)} avgDuration:${J.toFixed(1)} maxFetchDuration:${u.toFixed(1)} fetchDuration:${De.toFixed(1)} firstSelection:${_} codecSet:${ce.codecSet} videoRange:${ce.videoRange} hls.loadLevel:${E}`)),_&&(this.firstSelection=se),se}}return-1}set nextAutoLevel(e){const t=this.deriveNextAutoLevel(e);this._nextAutoLevel!==t&&(this.nextAutoLevelKey="",this._nextAutoLevel=t)}deriveNextAutoLevel(e){const{maxAutoLevel:t,minAutoLevel:r}=this.hls;return Math.min(Math.max(e,r),t)}}const rb={search:function(i,e){let t=0,r=i.length-1,n=null,s=null;for(;t<=r;){n=(t+r)/2|0,s=i[n];const a=e(s);if(a>0)t=n+1;else if(a<0)r=n-1;else return s}return null}};function jw(i,e,t){if(e===null||!Array.isArray(i)||!i.length||!Ce(e))return null;const r=i[0].programDateTime;if(e<(r||0))return null;const n=i[i.length-1].endProgramDateTime;if(e>=(n||0))return null;for(let s=0;s<i.length;++s){const a=i[s];if(Jw(e,t,a))return a}return null}function js(i,e,t=0,r=0,n=.005){let s=null;if(i){s=e[1+i.sn-e[0].sn]||null;const o=i.endDTS-t;o>0&&o<15e-7&&(t+=15e-7),s&&i.level!==s.level&&s.end<=i.end&&(s=e[2+i.sn-e[0].sn]||null)}else t===0&&e[0].start===0&&(s=e[0]);if(s&&((!i||i.level===s.level)&&ib(t,r,s)===0||zw(s,i,Math.min(n,r))))return s;const a=rb.search(e,ib.bind(null,t,r));return a&&(a!==i||!s)?a:s}function zw(i,e,t){if(e&&e.start===0&&e.level<i.level&&(e.endPTS||0)>0){const r=e.tagList.reduce((n,s)=>(s[0]==="INF"&&(n+=parseFloat(s[1])),n),t);return i.start<=r}return!1}function ib(i=0,e=0,t){if(t.start<=i&&t.start+t.duration>i)return 0;const r=Math.min(e,t.duration+(t.deltaPTS?t.deltaPTS:0));return t.start+t.duration-r<=i?1:t.start-r>i&&t.start?-1:0}function Jw(i,e,t){const r=Math.min(e,t.duration+(t.deltaPTS?t.deltaPTS:0))*1e3;return(t.endProgramDateTime||0)-r>i}function nb(i,e,t){if(i&&i.startCC<=e&&i.endCC>=e){let r=i.fragments;const{fragmentHint:n}=i;n&&(r=r.concat(n));let s;return rb.search(r,a=>a.cc<e?1:a.cc>e?-1:(s=a,a.end<=t?1:a.start>t?-1:0)),s||null}return null}function Gu(i){switch(i.details){case Q.FRAG_LOAD_TIMEOUT:case Q.KEY_LOAD_TIMEOUT:case Q.LEVEL_LOAD_TIMEOUT:case Q.MANIFEST_LOAD_TIMEOUT:return!0}return!1}function sb(i,e){const t=Gu(e);return i.default[`${t?"timeout":"error"}Retry`]}function sg(i,e){const t=i.backoff==="linear"?1:Math.pow(2,e);return Math.min(t*i.retryDelayMs,i.maxRetryDelayMs)}function ab(i){return Et(Et({},i),{errorRetry:null,timeoutRetry:null})}function qu(i,e,t,r){if(!i)return!1;const n=r==null?void 0:r.code,s=e<i.maxNumRetry&&(Qw(n)||!!t);return i.shouldRetry?i.shouldRetry(i,e,t,r,s):s}function Qw(i){return i===0&&navigator.onLine===!1||!!i&&(i<400||i>499)}var Rr={DoNothing:0,SendAlternateToPenaltyBox:2,RemoveAlternatePermanently:3,RetryRequest:5},Li={None:0,MoveAllAlternatesMatchingHost:1,MoveAllAlternatesMatchingHDCP:2};class Zw extends Cn{constructor(e){super("error-controller",e.logger),this.hls=void 0,this.playlistError=0,this.penalizedRenditions={},this.hls=e,this.registerListeners()}registerListeners(){const e=this.hls;e.on(x.ERROR,this.onError,this),e.on(x.MANIFEST_LOADING,this.onManifestLoading,this),e.on(x.LEVEL_UPDATED,this.onLevelUpdated,this)}unregisterListeners(){const e=this.hls;e&&(e.off(x.ERROR,this.onError,this),e.off(x.ERROR,this.onErrorOut,this),e.off(x.MANIFEST_LOADING,this.onManifestLoading,this),e.off(x.LEVEL_UPDATED,this.onLevelUpdated,this))}destroy(){this.unregisterListeners(),this.hls=null,this.penalizedRenditions={}}startLoad(e){}stopLoad(){this.playlistError=0}getVariantLevelIndex(e){return(e==null?void 0:e.type)===ke.MAIN?e.level:this.hls.loadLevel}onManifestLoading(){this.playlistError=0,this.penalizedRenditions={}}onLevelUpdated(){this.playlistError=0}onError(e,t){var r;if(t.fatal)return;const n=this.hls,s=t.context;switch(t.details){case Q.FRAG_LOAD_ERROR:case Q.FRAG_LOAD_TIMEOUT:case Q.KEY_LOAD_ERROR:case Q.KEY_LOAD_TIMEOUT:t.errorAction=this.getFragRetryOrSwitchAction(t);return;case Q.FRAG_PARSING_ERROR:if((r=t.frag)!=null&&r.gap){t.errorAction=Zo();return}case Q.FRAG_GAP:case Q.FRAG_DECRYPT_ERROR:{t.errorAction=this.getFragRetryOrSwitchAction(t),t.errorAction.action=Rr.SendAlternateToPenaltyBox;return}case Q.LEVEL_EMPTY_ERROR:case Q.LEVEL_PARSING_ERROR:{var a,o;const u=t.parent===ke.MAIN?t.level:n.loadLevel;t.details===Q.LEVEL_EMPTY_ERROR&&((a=t.context)!=null&&(o=a.levelDetails)!=null&&o.live)?t.errorAction=this.getPlaylistRetryOrSwitchAction(t,u):(t.levelRetry=!1,t.errorAction=this.getLevelSwitchAction(t,u))}return;case Q.LEVEL_LOAD_ERROR:case Q.LEVEL_LOAD_TIMEOUT:typeof(s==null?void 0:s.level)=="number"&&(t.errorAction=this.getPlaylistRetryOrSwitchAction(t,s.level));return;case Q.AUDIO_TRACK_LOAD_ERROR:case Q.AUDIO_TRACK_LOAD_TIMEOUT:case Q.SUBTITLE_LOAD_ERROR:case Q.SUBTITLE_TRACK_LOAD_TIMEOUT:if(s){const u=n.loadLevelObj;if(u&&(s.type===lt.AUDIO_TRACK&&u.hasAudioGroup(s.groupId)||s.type===lt.SUBTITLE_TRACK&&u.hasSubtitleGroup(s.groupId))){t.errorAction=this.getPlaylistRetryOrSwitchAction(t,n.loadLevel),t.errorAction.action=Rr.SendAlternateToPenaltyBox,t.errorAction.flags=Li.MoveAllAlternatesMatchingHost;return}}return;case Q.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:{const u=n.loadLevelObj,h=u==null?void 0:u.attrs["HDCP-LEVEL"];h?t.errorAction={action:Rr.SendAlternateToPenaltyBox,flags:Li.MoveAllAlternatesMatchingHDCP,hdcpLevel:h}:this.keySystemError(t)}return;case Q.BUFFER_ADD_CODEC_ERROR:case Q.REMUX_ALLOC_ERROR:case Q.BUFFER_APPEND_ERROR:if(!t.errorAction){var l;t.errorAction=this.getLevelSwitchAction(t,(l=t.level)!=null?l:n.loadLevel)}return;case Q.INTERNAL_EXCEPTION:case Q.BUFFER_APPENDING_ERROR:case Q.BUFFER_FULL_ERROR:case Q.LEVEL_SWITCH_ERROR:case Q.BUFFER_STALLED_ERROR:case Q.BUFFER_SEEK_OVER_HOLE:case Q.BUFFER_NUDGE_ON_STALL:t.errorAction=Zo();return}t.type===Fe.KEY_SYSTEM_ERROR&&this.keySystemError(t)}keySystemError(e){const t=this.getVariantLevelIndex(e.frag);e.levelRetry=!1,e.errorAction=this.getLevelSwitchAction(e,t)}getPlaylistRetryOrSwitchAction(e,t){const r=this.hls,n=sb(r.config.playlistLoadPolicy,e),s=this.playlistError++;if(qu(n,s,Gu(e),e.response))return{action:Rr.RetryRequest,flags:Li.None,retryConfig:n,retryCount:s};const o=this.getLevelSwitchAction(e,t);return n&&(o.retryConfig=n,o.retryCount=s),o}getFragRetryOrSwitchAction(e){const t=this.hls,r=this.getVariantLevelIndex(e.frag),n=t.levels[r],{fragLoadPolicy:s,keyLoadPolicy:a}=t.config,o=sb(e.details.startsWith("key")?a:s,e),l=t.levels.reduce((h,d)=>h+d.fragmentError,0);if(n&&(e.details!==Q.FRAG_GAP&&n.fragmentError++,qu(o,l,Gu(e),e.response)))return{action:Rr.RetryRequest,flags:Li.None,retryConfig:o,retryCount:l};const u=this.getLevelSwitchAction(e,r);return o&&(u.retryConfig=o,u.retryCount=l),u}getLevelSwitchAction(e,t){const r=this.hls;t==null&&(t=r.loadLevel);const n=this.hls.levels[t];if(n){var s,a;const u=e.details;n.loadError++,u===Q.BUFFER_APPEND_ERROR&&n.fragmentError++;let h=-1;const{levels:d,loadLevel:p,minAutoLevel:g,maxAutoLevel:m}=r;!r.autoLevelEnabled&&!r.config.preserveManualLevelOnError&&(r.loadLevel=-1);const v=(s=e.frag)==null?void 0:s.type,A=(v===ke.AUDIO&&u===Q.FRAG_PARSING_ERROR||e.sourceBufferName==="audio"&&(u===Q.BUFFER_ADD_CODEC_ERROR||u===Q.BUFFER_APPEND_ERROR))&&d.some(({audioCodec:w})=>n.audioCodec!==w),R=e.sourceBufferName==="video"&&(u===Q.BUFFER_ADD_CODEC_ERROR||u===Q.BUFFER_APPEND_ERROR)&&d.some(({codecSet:w,audioCodec:C})=>n.codecSet!==w&&n.audioCodec===C),{type:_,groupId:F}=(a=e.context)!=null?a:{};for(let w=d.length;w--;){const C=(w+p)%d.length;if(C!==p&&C>=g&&C<=m&&d[C].loadError===0){var o,l;const M=d[C];if(u===Q.FRAG_GAP&&v===ke.MAIN&&e.frag){const L=d[C].details;if(L){const I=js(e.frag,L.fragments,e.frag.start);if(I!=null&&I.gap)continue}}else{if(_===lt.AUDIO_TRACK&&M.hasAudioGroup(F)||_===lt.SUBTITLE_TRACK&&M.hasSubtitleGroup(F))continue;if(v===ke.AUDIO&&(o=n.audioGroups)!=null&&o.some(L=>M.hasAudioGroup(L))||v===ke.SUBTITLE&&(l=n.subtitleGroups)!=null&&l.some(L=>M.hasSubtitleGroup(L))||A&&n.audioCodec===M.audioCodec||!A&&n.audioCodec!==M.audioCodec||R&&n.codecSet===M.codecSet)continue}h=C;break}}if(h>-1&&r.loadLevel!==h)return e.levelRetry=!0,this.playlistError=0,{action:Rr.SendAlternateToPenaltyBox,flags:Li.None,nextAutoLevel:h}}return{action:Rr.SendAlternateToPenaltyBox,flags:Li.MoveAllAlternatesMatchingHost}}onErrorOut(e,t){var r;switch((r=t.errorAction)==null?void 0:r.action){case Rr.DoNothing:break;case Rr.SendAlternateToPenaltyBox:this.sendAlternateToPenaltyBox(t),!t.errorAction.resolved&&t.details!==Q.FRAG_GAP?t.fatal=!0:/MediaSource readyState: ended/.test(t.error.message)&&(this.warn(`MediaSource ended after "${t.sourceBufferName}" sourceBuffer append error. Attempting to recover from media error.`),this.hls.recoverMediaError());break}if(t.fatal){this.hls.stopLoad();return}}sendAlternateToPenaltyBox(e){const t=this.hls,r=e.errorAction;if(!r)return;const{flags:n,hdcpLevel:s,nextAutoLevel:a}=r;switch(n){case Li.None:this.switchLevel(e,a);break;case Li.MoveAllAlternatesMatchingHDCP:s&&(t.maxHdcpLevel=ng[ng.indexOf(s)-1],r.resolved=!0),this.warn(`Restricting playback to HDCP-LEVEL of "${t.maxHdcpLevel}" or lower`);break}r.resolved||this.switchLevel(e,a)}switchLevel(e,t){if(t!==void 0&&e.errorAction&&(this.warn(`switching to level ${t} after ${e.details}`),this.hls.nextAutoLevel=t,e.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel,e.details===Q.BUFFER_ADD_CODEC_ERROR&&e.mimeType&&e.sourceBufferName!=="audiovideo")){const r=KE(e.mimeType),n=this.hls.levels;for(let s=n.length;s--;)n[s][`${e.sourceBufferName}Codec`]===r&&this.hls.removeLevel(s)}}}function Zo(i){const e={action:Rr.DoNothing,flags:Li.None};return i&&(e.resolved=!0),e}var nr={NOT_LOADED:"NOT_LOADED",APPENDING:"APPENDING",PARTIAL:"PARTIAL",OK:"OK"};class eL{constructor(e){this.activePartLists=Object.create(null),this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hasGaps=!1,this.hls=e,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(x.MANIFEST_LOADING,this.onManifestLoading,this),e.on(x.BUFFER_APPENDED,this.onBufferAppended,this),e.on(x.FRAG_BUFFERED,this.onFragBuffered,this),e.on(x.FRAG_LOADED,this.onFragLoaded,this)}_unregisterListeners(){const{hls:e}=this;e.off(x.MANIFEST_LOADING,this.onManifestLoading,this),e.off(x.BUFFER_APPENDED,this.onBufferAppended,this),e.off(x.FRAG_BUFFERED,this.onFragBuffered,this),e.off(x.FRAG_LOADED,this.onFragLoaded,this)}destroy(){this._unregisterListeners(),this.fragments=this.activePartLists=this.endListFragments=this.timeRanges=null}getAppendedFrag(e,t){const r=this.activePartLists[t];if(r)for(let n=r.length;n--;){const s=r[n];if(!s)break;const a=s.end;if(s.start<=e&&a!==null&&e<=a)return s}return this.getBufferedFrag(e,t)}getBufferedFrag(e,t){return this.getFragAtPos(e,t,!0)}getFragAtPos(e,t,r){const{fragments:n}=this,s=Object.keys(n);for(let a=s.length;a--;){const o=n[s[a]];if((o==null?void 0:o.body.type)===t&&(!r||o.buffered)){const l=o.body;if(l.start<=e&&e<=l.end)return l}}return null}detectEvictedFragments(e,t,r,n,s){this.timeRanges&&(this.timeRanges[e]=t);const a=(n==null?void 0:n.fragment.sn)||-1;Object.keys(this.fragments).forEach(o=>{const l=this.fragments[o];if(!l||a>=l.body.sn)return;if(!l.buffered&&(!l.loaded||s)){l.body.type===r&&this.removeFragment(l.body);return}const u=l.range[e];if(u){if(u.time.length===0){this.removeFragment(l.body);return}u.time.some(h=>{const d=!this.isTimeBuffered(h.startPTS,h.endPTS,t);return d&&this.removeFragment(l.body),d})}})}detectPartialFragments(e){const t=this.timeRanges;if(!t||e.frag.sn==="initSegment")return;const r=e.frag,n=Ua(r),s=this.fragments[n];if(!s||s.buffered&&r.gap)return;const a=!r.relurl;Object.keys(t).forEach(o=>{const l=r.elementaryStreams[o];if(!l)return;const u=t[o],h=a||l.partial===!0;s.range[o]=this.getBufferedTimes(r,e.part,h,u)}),s.loaded=null,Object.keys(s.range).length?(s.buffered=!0,(s.body.endList=r.endList||s.body.endList)&&(this.endListFragments[s.body.type]=s),Vu(s)||this.removeParts(r.sn-1,r.type)):this.removeFragment(s.body)}removeParts(e,t){const r=this.activePartLists[t];r&&(this.activePartLists[t]=ob(r,n=>n.fragment.sn>=e))}fragBuffered(e,t){const r=Ua(e);let n=this.fragments[r];!n&&t&&(n=this.fragments[r]={body:e,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)},e.gap&&(this.hasGaps=!0)),n&&(n.loaded=null,n.buffered=!0)}getBufferedTimes(e,t,r,n){const s={time:[],partial:r},a=e.start,o=e.end,l=e.minEndPTS||o,u=e.maxStartPTS||a;for(let h=0;h<n.length;h++){const d=n.start(h)-this.bufferPadding,p=n.end(h)+this.bufferPadding;if(u>=d&&l<=p){s.time.push({startPTS:Math.max(a,n.start(h)),endPTS:Math.min(o,n.end(h))});break}else if(a<p&&o>d){const g=Math.max(a,n.start(h)),m=Math.min(o,n.end(h));m>g&&(s.partial=!0,s.time.push({startPTS:g,endPTS:m}))}else if(o<=d)break}return s}getPartialFragment(e){let t=null,r,n,s,a=0;const{bufferPadding:o,fragments:l}=this;return Object.keys(l).forEach(u=>{const h=l[u];h&&Vu(h)&&(n=h.body.start-o,s=h.body.end+o,e>=n&&e<=s&&(r=Math.min(e-n,s-e),a<=r&&(t=h.body,a=r)))}),t}isEndListAppended(e){const t=this.endListFragments[e];return t!==void 0&&(t.buffered||Vu(t))}getState(e){const t=Ua(e),r=this.fragments[t];return r?r.buffered?Vu(r)?nr.PARTIAL:nr.OK:nr.APPENDING:nr.NOT_LOADED}isTimeBuffered(e,t,r){let n,s;for(let a=0;a<r.length;a++){if(n=r.start(a)-this.bufferPadding,s=r.end(a)+this.bufferPadding,e>=n&&t<=s)return!0;if(t<=n)return!1}return!1}onManifestLoading(){this.removeAllFragments()}onFragLoaded(e,t){if(t.frag.sn==="initSegment"||t.frag.bitrateTest)return;const r=t.frag,n=t.part?null:t,s=Ua(r);this.fragments[s]={body:r,appendedPTS:null,loaded:n,buffered:!1,range:Object.create(null)}}onBufferAppended(e,t){const{frag:r,part:n,timeRanges:s,type:a}=t;if(r.sn==="initSegment")return;const o=r.type;if(n){let u=this.activePartLists[o];u||(this.activePartLists[o]=u=[]),u.push(n)}this.timeRanges=s;const l=s[a];this.detectEvictedFragments(a,l,o,n)}onFragBuffered(e,t){this.detectPartialFragments(t)}hasFragment(e){const t=Ua(e);return!!this.fragments[t]}hasFragments(e){const{fragments:t}=this,r=Object.keys(t);if(!e)return r.length>0;for(let n=r.length;n--;){const s=t[r[n]];if((s==null?void 0:s.body.type)===e)return!0}return!1}hasParts(e){var t;return!!((t=this.activePartLists[e])!=null&&t.length)}removeFragmentsInRange(e,t,r,n,s){n&&!this.hasGaps||Object.keys(this.fragments).forEach(a=>{const o=this.fragments[a];if(!o)return;const l=o.body;l.type!==r||n&&!l.gap||l.start<t&&l.end>e&&(o.buffered||s)&&this.removeFragment(l)})}removeFragment(e){const t=Ua(e);e.clearElementaryStreamInfo();const r=this.activePartLists[e.type];if(r){const n=e.sn;this.activePartLists[e.type]=ob(r,s=>s.fragment.sn!==n)}delete this.fragments[t],e.endList&&delete this.endListFragments[e.type]}removeAllFragments(){var e,t;this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activePartLists=Object.create(null),this.hasGaps=!1;const r=(e=this.hls)==null||(t=e.latestLevelDetails)==null?void 0:t.partList;r&&r.forEach(n=>n.clearElementaryStreamInfo())}}function Vu(i){var e,t,r;return i.buffered&&(i.body.gap||((e=i.range.video)==null?void 0:e.partial)||((t=i.range.audio)==null?void 0:t.partial)||((r=i.range.audiovideo)==null?void 0:r.partial))}function Ua(i){return`${i.type}_${i.level}_${i.sn}`}function ob(i,e){return i.filter(t=>{const r=e(t);return r||t.clearElementaryStreamInfo(),r})}var ds={cbc:0,ctr:1};class tL{constructor(e,t,r){this.subtle=void 0,this.aesIV=void 0,this.aesMode=void 0,this.subtle=e,this.aesIV=t,this.aesMode=r}decrypt(e,t){switch(this.aesMode){case ds.cbc:return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e);case ds.ctr:return this.subtle.decrypt({name:"AES-CTR",counter:this.aesIV,length:64},t,e);default:throw new Error(`[AESCrypto] invalid aes mode ${this.aesMode}`)}}}function rL(i){const e=i.byteLength,t=e&&new DataView(i.buffer).getUint8(e-1);return t?i.slice(0,e-t):i}class iL{constructor(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}uint8ArrayToUint32Array_(e){const t=new DataView(e),r=new Uint32Array(4);for(let n=0;n<4;n++)r[n]=t.getUint32(n*4);return r}initTable(){const e=this.sBox,t=this.invSBox,r=this.subMix,n=r[0],s=r[1],a=r[2],o=r[3],l=this.invSubMix,u=l[0],h=l[1],d=l[2],p=l[3],g=new Uint32Array(256);let m=0,v=0,E=0;for(E=0;E<256;E++)E<128?g[E]=E<<1:g[E]=E<<1^283;for(E=0;E<256;E++){let A=v^v<<1^v<<2^v<<3^v<<4;A=A>>>8^A&255^99,e[m]=A,t[A]=m;const D=g[m],R=g[D],_=g[R];let F=g[A]*257^A*16843008;n[m]=F<<24|F>>>8,s[m]=F<<16|F>>>16,a[m]=F<<8|F>>>24,o[m]=F,F=_*16843009^R*65537^D*257^m*16843008,u[A]=F<<24|F>>>8,h[A]=F<<16|F>>>16,d[A]=F<<8|F>>>24,p[A]=F,m?(m=D^g[g[g[_^D]]],v^=g[g[v]]):m=v=1}}expandKey(e){const t=this.uint8ArrayToUint32Array_(e);let r=!0,n=0;for(;n<t.length&&r;)r=t[n]===this.key[n],n++;if(r)return;this.key=t;const s=this.keySize=t.length;if(s!==4&&s!==6&&s!==8)throw new Error("Invalid aes key size="+s);const a=this.ksRows=(s+6+1)*4;let o,l;const u=this.keySchedule=new Uint32Array(a),h=this.invKeySchedule=new Uint32Array(a),d=this.sBox,p=this.rcon,g=this.invSubMix,m=g[0],v=g[1],E=g[2],A=g[3];let D,R;for(o=0;o<a;o++){if(o<s){D=u[o]=t[o];continue}R=D,o%s===0?(R=R<<8|R>>>24,R=d[R>>>24]<<24|d[R>>>16&255]<<16|d[R>>>8&255]<<8|d[R&255],R^=p[o/s|0]<<24):s>6&&o%s===4&&(R=d[R>>>24]<<24|d[R>>>16&255]<<16|d[R>>>8&255]<<8|d[R&255]),u[o]=D=(u[o-s]^R)>>>0}for(l=0;l<a;l++)o=a-l,l&3?R=u[o]:R=u[o-4],l<4||o<=4?h[l]=R:h[l]=m[d[R>>>24]]^v[d[R>>>16&255]]^E[d[R>>>8&255]]^A[d[R&255]],h[l]=h[l]>>>0}networkToHostOrderSwap(e){return e<<24|(e&65280)<<8|(e&16711680)>>8|e>>>24}decrypt(e,t,r){const n=this.keySize+6,s=this.invKeySchedule,a=this.invSBox,o=this.invSubMix,l=o[0],u=o[1],h=o[2],d=o[3],p=this.uint8ArrayToUint32Array_(r);let g=p[0],m=p[1],v=p[2],E=p[3];const A=new Int32Array(e),D=new Int32Array(A.length);let R,_,F,w,C,M,L,I,U,q,$,X,ne,se;const ce=this.networkToHostOrderSwap;for(;t<A.length;){for(U=ce(A[t]),q=ce(A[t+1]),$=ce(A[t+2]),X=ce(A[t+3]),C=U^s[0],M=X^s[1],L=$^s[2],I=q^s[3],ne=4,se=1;se<n;se++)R=l[C>>>24]^u[M>>16&255]^h[L>>8&255]^d[I&255]^s[ne],_=l[M>>>24]^u[L>>16&255]^h[I>>8&255]^d[C&255]^s[ne+1],F=l[L>>>24]^u[I>>16&255]^h[C>>8&255]^d[M&255]^s[ne+2],w=l[I>>>24]^u[C>>16&255]^h[M>>8&255]^d[L&255]^s[ne+3],C=R,M=_,L=F,I=w,ne=ne+4;R=a[C>>>24]<<24^a[M>>16&255]<<16^a[L>>8&255]<<8^a[I&255]^s[ne],_=a[M>>>24]<<24^a[L>>16&255]<<16^a[I>>8&255]<<8^a[C&255]^s[ne+1],F=a[L>>>24]<<24^a[I>>16&255]<<16^a[C>>8&255]<<8^a[M&255]^s[ne+2],w=a[I>>>24]<<24^a[C>>16&255]<<16^a[M>>8&255]<<8^a[L&255]^s[ne+3],D[t]=ce(R^g),D[t+1]=ce(w^m),D[t+2]=ce(F^v),D[t+3]=ce(_^E),g=U,m=q,v=$,E=X,t=t+4}return D.buffer}}class nL{constructor(e,t,r){this.subtle=void 0,this.key=void 0,this.aesMode=void 0,this.subtle=e,this.key=t,this.aesMode=r}expandKey(){const e=sL(this.aesMode);return this.subtle.importKey("raw",this.key,{name:e},!1,["encrypt","decrypt"])}}function sL(i){switch(i){case ds.cbc:return"AES-CBC";case ds.ctr:return"AES-CTR";default:throw new Error(`[FastAESKey] invalid aes mode ${i}`)}}const aL=16;class ag{constructor(e,{removePKCS7Padding:t=!0}={}){if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.enableSoftwareAES=void 0,this.enableSoftwareAES=e.enableSoftwareAES,this.removePKCS7Padding=t,t)try{const r=self.crypto;r&&(this.subtle=r.subtle||r.webkitSubtle)}catch{}this.useSoftware=!this.subtle}destroy(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null}isSync(){return this.useSoftware}flush(){const{currentResult:e,remainderData:t}=this;if(!e||t)return this.reset(),null;const r=new Uint8Array(e);return this.reset(),this.removePKCS7Padding?rL(r):r}reset(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)}decrypt(e,t,r,n){return this.useSoftware?new Promise((s,a)=>{const o=ArrayBuffer.isView(e)?e:new Uint8Array(e);this.softwareDecrypt(o,t,r,n);const l=this.flush();l?s(l.buffer):a(new Error("[softwareDecrypt] Failed to decrypt data"))}):this.webCryptoDecrypt(new Uint8Array(e),t,r,n)}softwareDecrypt(e,t,r,n){const{currentIV:s,currentResult:a,remainderData:o}=this;if(n!==ds.cbc||t.byteLength!==16)return mt.warn("SoftwareDecrypt: can only handle AES-128-CBC"),null;this.logOnce("JS AES decrypt"),o&&(e=pi(o,e),this.remainderData=null);const l=this.getValidChunk(e);if(!l.length)return null;s&&(r=s);let u=this.softwareDecrypter;u||(u=this.softwareDecrypter=new iL),u.expandKey(t);const h=a;return this.currentResult=u.decrypt(l.buffer,0,r),this.currentIV=l.slice(-16).buffer,h||null}webCryptoDecrypt(e,t,r,n){if(this.key!==t||!this.fastAesKey){if(!this.subtle)return Promise.resolve(this.onWebCryptoError(e,t,r,n));this.key=t,this.fastAesKey=new nL(this.subtle,t,n)}return this.fastAesKey.expandKey().then(s=>this.subtle?(this.logOnce("WebCrypto AES decrypt"),new tL(this.subtle,new Uint8Array(r),n).decrypt(e.buffer,s)):Promise.reject(new Error("web crypto not initialized"))).catch(s=>(mt.warn(`[decrypter]: WebCrypto Error, disable WebCrypto API, ${s.name}: ${s.message}`),this.onWebCryptoError(e,t,r,n)))}onWebCryptoError(e,t,r,n){const s=this.enableSoftwareAES;if(s){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(e,t,r,n);const a=this.flush();if(a)return a.buffer}throw new Error("WebCrypto"+(s?" and softwareDecrypt":"")+": failed to decrypt data")}getValidChunk(e){let t=e;const r=e.length-e.length%aL;return r!==e.length&&(t=e.slice(0,r),this.remainderData=e.slice(r)),t}logOnce(e){this.logEnabled&&(mt.log(`[decrypter]: ${e}`),this.logEnabled=!1)}}const lb=Math.pow(2,17);class oL{constructor(e){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=e}destroy(){this.loader&&(this.loader.destroy(),this.loader=null)}abort(){this.loader&&this.loader.abort()}load(e,t){const r=e.url;if(!r)return Promise.reject(new wn({type:Fe.NETWORK_ERROR,details:Q.FRAG_LOAD_ERROR,fatal:!1,frag:e,error:new Error(`Fragment does not have a ${r?"part list":"url"}`),networkDetails:null}));this.abort();const n=this.config,s=n.fLoader,a=n.loader;return new Promise((o,l)=>{if(this.loader&&this.loader.destroy(),e.gap)if(e.tagList.some(m=>m[0]==="GAP")){l(cb(e));return}else e.gap=!1;const u=this.loader=s?new s(n):new a(n),h=ub(e);e.loader=u;const d=ab(n.fragLoadPolicy.default),p={loadPolicy:d,timeout:d.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:e.sn==="initSegment"?1/0:lb};e.stats=u.stats;const g={onSuccess:(m,v,E,A)=>{this.resetLoader(e,u);let D=m.data;E.resetIV&&e.decryptdata&&(e.decryptdata.iv=new Uint8Array(D.slice(0,16)),D=D.slice(16)),o({frag:e,part:null,payload:D,networkDetails:A})},onError:(m,v,E,A)=>{this.resetLoader(e,u),l(new wn({type:Fe.NETWORK_ERROR,details:Q.FRAG_LOAD_ERROR,fatal:!1,frag:e,response:Et({url:r,data:void 0},m),error:new Error(`HTTP Error ${m.code} ${m.text}`),networkDetails:E,stats:A}))},onAbort:(m,v,E)=>{this.resetLoader(e,u),l(new wn({type:Fe.NETWORK_ERROR,details:Q.INTERNAL_ABORTED,fatal:!1,frag:e,error:new Error("Aborted"),networkDetails:E,stats:m}))},onTimeout:(m,v,E)=>{this.resetLoader(e,u),l(new wn({type:Fe.NETWORK_ERROR,details:Q.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,error:new Error(`Timeout after ${p.timeout}ms`),networkDetails:E,stats:m}))}};t&&(g.onProgress=(m,v,E,A)=>t({frag:e,part:null,payload:E,networkDetails:A})),u.load(h,p,g)})}loadPart(e,t,r){this.abort();const n=this.config,s=n.fLoader,a=n.loader;return new Promise((o,l)=>{if(this.loader&&this.loader.destroy(),e.gap||t.gap){l(cb(e,t));return}const u=this.loader=s?new s(n):new a(n),h=ub(e,t);e.loader=u;const d=ab(n.fragLoadPolicy.default),p={loadPolicy:d,timeout:d.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:lb};t.stats=u.stats,u.load(h,p,{onSuccess:(g,m,v,E)=>{this.resetLoader(e,u),this.updateStatsFromPart(e,t);const A={frag:e,part:t,payload:g.data,networkDetails:E};r(A),o(A)},onError:(g,m,v,E)=>{this.resetLoader(e,u),l(new wn({type:Fe.NETWORK_ERROR,details:Q.FRAG_LOAD_ERROR,fatal:!1,frag:e,part:t,response:Et({url:h.url,data:void 0},g),error:new Error(`HTTP Error ${g.code} ${g.text}`),networkDetails:v,stats:E}))},onAbort:(g,m,v)=>{e.stats.aborted=t.stats.aborted,this.resetLoader(e,u),l(new wn({type:Fe.NETWORK_ERROR,details:Q.INTERNAL_ABORTED,fatal:!1,frag:e,part:t,error:new Error("Aborted"),networkDetails:v,stats:g}))},onTimeout:(g,m,v)=>{this.resetLoader(e,u),l(new wn({type:Fe.NETWORK_ERROR,details:Q.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,part:t,error:new Error(`Timeout after ${p.timeout}ms`),networkDetails:v,stats:g}))}})})}updateStatsFromPart(e,t){const r=e.stats,n=t.stats,s=n.total;if(r.loaded+=n.loaded,s){const l=Math.round(e.duration/t.duration),u=Math.min(Math.round(r.loaded/s),l),d=(l-u)*Math.round(r.loaded/u);r.total=r.loaded+d}else r.total=Math.max(r.loaded,r.total);const a=r.loading,o=n.loading;a.start?a.first+=o.first-o.start:(a.start=o.start,a.first=o.first),a.end=o.end}resetLoader(e,t){e.loader=null,this.loader===t&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),t.destroy()}}function ub(i,e=null){const t=e||i,r={frag:i,part:e,responseType:"arraybuffer",url:t.url,headers:{},rangeStart:0,rangeEnd:0},n=t.byteRangeStartOffset,s=t.byteRangeEndOffset;if(Ce(n)&&Ce(s)){var a;let o=n,l=s;if(i.sn==="initSegment"&&lL((a=i.decryptdata)==null?void 0:a.method)){const u=s-n;u%16&&(l=s+(16-u%16)),n!==0&&(r.resetIV=!0,o=n-16)}r.rangeStart=o,r.rangeEnd=l}return r}function cb(i,e){const t=new Error(`GAP ${i.gap?"tag":"attribute"} found`),r={type:Fe.MEDIA_ERROR,details:Q.FRAG_GAP,fatal:!1,frag:i,error:t,networkDetails:null};return e&&(r.part=e),(e||i).stats.aborted=!0,new wn(r)}function lL(i){return i==="AES-128"||i==="AES-256"}class wn extends Error{constructor(e){super(e.error.message),this.data=void 0,this.data=e}}class hb extends Cn{constructor(e,t){super(e,t),this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}destroy(){this.onHandlerDestroying(),this.onHandlerDestroyed()}onHandlerDestroying(){this.clearNextTick(),this.clearInterval()}onHandlerDestroyed(){}hasInterval(){return!!this._tickInterval}hasNextTick(){return!!this._tickTimer}setInterval(e){return this._tickInterval?!1:(this._tickCallCount=0,this._tickInterval=self.setInterval(this._boundTick,e),!0)}clearInterval(){return this._tickInterval?(self.clearInterval(this._tickInterval),this._tickInterval=null,!0):!1}clearNextTick(){return this._tickTimer?(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0):!1}tick(){this._tickCallCount++,this._tickCallCount===1&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)}tickImmediate(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)}doTick(){}}class og{constructor(e,t,r,n=0,s=-1,a=!1){this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing=Hu(),this.buffering={audio:Hu(),video:Hu(),audiovideo:Hu()},this.level=e,this.sn=t,this.id=r,this.size=n,this.part=s,this.partial=a}}function Hu(){return{start:0,executeStart:0,executeEnd:0,end:0}}const db={length:0,start:()=>0,end:()=>0};class Xe{static isBuffered(e,t){if(e){const r=Xe.getBuffered(e);for(let n=r.length;n--;)if(t>=r.start(n)&&t<=r.end(n))return!0}return!1}static bufferedRanges(e){if(e){const t=Xe.getBuffered(e);return Xe.timeRangesToArray(t)}return[]}static timeRangesToArray(e){const t=[];for(let r=0;r<e.length;r++)t.push({start:e.start(r),end:e.end(r)});return t}static bufferInfo(e,t,r){if(e){const n=Xe.bufferedRanges(e);if(n.length)return Xe.bufferedInfo(n,t,r)}return{len:0,start:t,end:t,bufferedIndex:-1}}static bufferedInfo(e,t,r){t=Math.max(0,t),e.length>1&&e.sort((h,d)=>h.start-d.start||d.end-h.end);let n=-1,s=[];if(r)for(let h=0;h<e.length;h++){t>=e[h].start&&t<=e[h].end&&(n=h);const d=s.length;if(d){const p=s[d-1].end;e[h].start-p<r?e[h].end>p&&(s[d-1].end=e[h].end):s.push(e[h])}else s.push(e[h])}else s=e;let a=0,o,l=t,u=t;for(let h=0;h<s.length;h++){const d=s[h].start,p=s[h].end;if(n===-1&&t>=d&&t<=p&&(n=h),t+r>=d&&t<p)l=d,u=p,a=u-t;else if(t+r<d){o=d;break}}return{len:a,start:l||0,end:u||0,nextStart:o,buffered:e,bufferedIndex:n}}static getBuffered(e){try{return e.buffered||db}catch(t){return mt.log("failed to get media.buffered",t),db}}}const fb=/\{\$([a-zA-Z0-9-_]+)\}/g;function gb(i){return fb.test(i)}function lg(i,e){if(i.variableList!==null||i.hasVariableRefs){const t=i.variableList;return e.replace(fb,r=>{const n=r.substring(2,r.length-1),s=t==null?void 0:t[n];return s===void 0?(i.playlistParsingError||(i.playlistParsingError=new Error(`Missing preceding EXT-X-DEFINE tag for Variable Reference: "${n}"`)),r):s})}return e}function pb(i,e,t){let r=i.variableList;r||(i.variableList=r={});let n,s;if("QUERYPARAM"in e){n=e.QUERYPARAM;try{const a=new self.URL(t).searchParams;if(a.has(n))s=a.get(n);else throw new Error(`"${n}" does not match any query parameter in URI: "${t}"`)}catch(a){i.playlistParsingError||(i.playlistParsingError=new Error(`EXT-X-DEFINE QUERYPARAM: ${a.message}`))}}else n=e.NAME,s=e.VALUE;n in r?i.playlistParsingError||(i.playlistParsingError=new Error(`EXT-X-DEFINE duplicate Variable Name declarations: "${n}"`)):r[n]=s||""}function uL(i,e,t){const r=e.IMPORT;if(t&&r in t){let n=i.variableList;n||(i.variableList=n={}),n[r]=t[r]}else i.playlistParsingError||(i.playlistParsingError=new Error(`EXT-X-DEFINE IMPORT attribute not found in Multivariant Playlist: "${r}"`))}const cL=/^(\d+)x(\d+)$/,mb=/(.+?)=(".*?"|.*?)(?:,|$)/g;class Ht{constructor(e,t){typeof e=="string"&&(e=Ht.parseAttrList(e,t)),xt(this,e)}get clientAttrs(){return Object.keys(this).filter(e=>e.substring(0,2)==="X-")}decimalInteger(e){const t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?1/0:t}hexadecimalInteger(e){if(this[e]){let t=(this[e]||"0x").slice(2);t=(t.length&1?"0":"")+t;const r=new Uint8Array(t.length/2);for(let n=0;n<t.length/2;n++)r[n]=parseInt(t.slice(n*2,n*2+2),16);return r}return null}hexadecimalIntegerAsNumber(e){const t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?1/0:t}decimalFloatingPoint(e){return parseFloat(this[e])}optionalFloat(e,t){const r=this[e];return r?parseFloat(r):t}enumeratedString(e){return this[e]}enumeratedStringList(e,t){const r=this[e];return(r?r.split(/[ ,]+/):[]).reduce((n,s)=>(n[s.toLowerCase()]=!0,n),t)}bool(e){return this[e]==="YES"}decimalResolution(e){const t=cL.exec(this[e]);if(t!==null)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}}static parseAttrList(e,t){let r;const n={},s='"';for(mb.lastIndex=0;(r=mb.exec(e))!==null;){const a=r[1].trim();let o=r[2];const l=o.indexOf(s)===0&&o.lastIndexOf(s)===o.length-1;let u=!1;if(l)o=o.slice(1,-1);else switch(a){case"IV":case"SCTE35-CMD":case"SCTE35-IN":case"SCTE35-OUT":u=!0}if(t&&(l||u))o=lg(t,o);else if(!u&&!l)switch(a){case"CLOSED-CAPTIONS":if(o==="NONE")break;case"ALLOWED-CPC":case"CLASS":case"ASSOC-LANGUAGE":case"AUDIO":case"BYTERANGE":case"CHANNELS":case"CHARACTERISTICS":case"CODECS":case"DATA-ID":case"END-DATE":case"GROUP-ID":case"ID":case"IMPORT":case"INSTREAM-ID":case"KEYFORMAT":case"KEYFORMATVERSIONS":case"LANGUAGE":case"NAME":case"PATHWAY-ID":case"QUERYPARAM":case"RECENTLY-REMOVED-DATERANGES":case"SERVER-URI":case"STABLE-RENDITION-ID":case"STABLE-VARIANT-ID":case"START-DATE":case"SUBTITLES":case"SUPPLEMENTAL-CODECS":case"URI":case"VALUE":case"VIDEO":case"X-ASSET-LIST":case"X-ASSET-URI":mt.warn(`${e}: attribute ${a} is missing quotes`)}n[a]=o}return n}}const hL="com.apple.hls.interstitial";function dL(i){return i!=="ID"&&i!=="CLASS"&&i!=="CUE"&&i!=="START-DATE"&&i!=="DURATION"&&i!=="END-DATE"&&i!=="END-ON-NEXT"}function fL(i){return i==="SCTE35-OUT"||i==="SCTE35-IN"||i==="SCTE35-CMD"}class yb{constructor(e,t,r=0){var n;if(this.attr=void 0,this.tagAnchor=void 0,this.tagOrder=void 0,this._startDate=void 0,this._endDate=void 0,this._dateAtEnd=void 0,this._cue=void 0,this._badValueForSameId=void 0,this.tagAnchor=(t==null?void 0:t.tagAnchor)||null,this.tagOrder=(n=t==null?void 0:t.tagOrder)!=null?n:r,t){const s=t.attr;for(const a in s)if(Object.prototype.hasOwnProperty.call(e,a)&&e[a]!==s[a]){mt.warn(`DATERANGE tag attribute: "${a}" does not match for tags with ID: "${e.ID}"`),this._badValueForSameId=a;break}e=xt(new Ht({}),s,e)}if(this.attr=e,t?(this._startDate=t._startDate,this._cue=t._cue,this._endDate=t._endDate,this._dateAtEnd=t._dateAtEnd):this._startDate=new Date(e["START-DATE"]),"END-DATE"in this.attr){const s=(t==null?void 0:t.endDate)||new Date(this.attr["END-DATE"]);Ce(s.getTime())&&(this._endDate=s)}}get id(){return this.attr.ID}get class(){return this.attr.CLASS}get cue(){const e=this._cue;return e===void 0?this._cue=this.attr.enumeratedStringList(this.attr.CUE?"CUE":"X-CUE",{pre:!1,post:!1,once:!1}):e}get startTime(){const{tagAnchor:e}=this;return e===null||e.programDateTime===null?(mt.warn(`Expected tagAnchor Fragment with PDT set for DateRange "${this.id}": ${e}`),NaN):e.start+(this.startDate.getTime()-e.programDateTime)/1e3}get startDate(){return this._startDate}get endDate(){const e=this._endDate||this._dateAtEnd;if(e)return e;const t=this.duration;return t!==null?this._dateAtEnd=new Date(this._startDate.getTime()+t*1e3):null}get duration(){if("DURATION"in this.attr){const e=this.attr.decimalFloatingPoint("DURATION");if(Ce(e))return e}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}get plannedDuration(){return"PLANNED-DURATION"in this.attr?this.attr.decimalFloatingPoint("PLANNED-DURATION"):null}get endOnNext(){return this.attr.bool("END-ON-NEXT")}get isInterstitial(){return this.class===hL}get isValid(){return!!this.id&&!this._badValueForSameId&&Ce(this.startDate.getTime())&&(this.duration===null||this.duration>=0)&&(!this.endOnNext||!!this.class)&&(!this.attr.CUE||!this.cue.pre&&!this.cue.post||this.cue.pre!==this.cue.post)&&(!this.isInterstitial||"X-ASSET-URI"in this.attr||"X-ASSET-LIST"in this.attr)}}const gL=10;class pL{constructor(e){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.dateRangeTagCount=0,this.live=!0,this.requestScheduled=-1,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.playlistParsingError=null,this.variableList=null,this.hasVariableRefs=!1,this.appliedTimelineOffset=void 0,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=e}reloaded(e){if(!e){this.advanced=!0,this.updated=!0;return}const t=this.lastPartSn-e.lastPartSn,r=this.lastPartIndex-e.lastPartIndex;this.updated=this.endSN!==e.endSN||!!r||!!t||!this.live,this.advanced=this.endSN>e.endSN||t>0||t===0&&r>0,this.updated||this.advanced?this.misses=Math.floor(e.misses*.6):this.misses=e.misses+1}get hasProgramDateTime(){return this.fragments.length?Ce(this.fragments[this.fragments.length-1].programDateTime):!1}get levelTargetDuration(){return this.averagetargetduration||this.targetduration||gL}get drift(){const e=this.driftEndTime-this.driftStartTime;return e>0?(this.driftEnd-this.driftStart)*1e3/e:1}get edge(){return this.partEnd||this.fragmentEnd}get partEnd(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].end:this.fragmentEnd}get fragmentEnd(){var e;return(e=this.fragments)!=null&&e.length?this.fragments[this.fragments.length-1].end:0}get fragmentStart(){var e;return(e=this.fragments)!=null&&e.length?this.fragments[0].start:0}get age(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}get lastPartIndex(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].index:-1}get maxPartIndex(){const e=this.partList;if(e){const t=this.lastPartIndex;if(t!==-1){for(let r=e.length;r--;)if(e[r].index>t)return e[r].index;return t}}return 0}get lastPartSn(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}get expired(){if(this.live&&this.age&&this.misses<3){const e=this.partEnd-this.fragmentStart;return this.age>Math.max(e,this.totalduration)+this.levelTargetDuration}return!1}}function $a(i){return i==="AES-128"||i==="AES-256"||i==="AES-256-CTR"}function ug(i){switch(i){case"AES-128":case"AES-256":return ds.cbc;case"AES-256-CTR":return ds.ctr;default:throw new Error(`invalid full segment method ${i}`)}}function cg(i){return Uint8Array.from(atob(i),e=>e.charCodeAt(0))}function hg(i){return Uint8Array.from(unescape(encodeURIComponent(i)),e=>e.charCodeAt(0))}function mL(i){const e=hg(i).subarray(0,16),t=new Uint8Array(16);return t.set(e,16-e.length),t}function yL(i){const e=function(r,n,s){const a=r[n];r[n]=r[s],r[s]=a};e(i,0,3),e(i,1,2),e(i,4,5),e(i,6,7)}function vL(i){const e=i.split(":");let t=null;if(e[0]==="data"&&e.length===2){const r=e[1].split(";"),n=r[r.length-1].split(",");if(n.length===2){const s=n[0]==="base64",a=n[1];s?(r.splice(-1,1),t=cg(a)):t=mL(a)}}return t}const Ku=typeof self<"u"?self:void 0;var bt={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.fps",PLAYREADY:"com.microsoft.playready",WIDEVINE:"com.widevine.alpha"},Kr={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.streamingkeydelivery",PLAYREADY:"com.microsoft.playready",WIDEVINE:"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"};function Wu(i){switch(i){case Kr.FAIRPLAY:return bt.FAIRPLAY;case Kr.PLAYREADY:return bt.PLAYREADY;case Kr.WIDEVINE:return bt.WIDEVINE;case Kr.CLEARKEY:return bt.CLEARKEY}}var Yu={CENC:"1077efecc0b24d02ace33c1e52e2fb4b",CLEARKEY:"e2719d58a985b3c9781ab030af78d30e",PLAYREADY:"9a04f07998404286ab92e65be0885f95",WIDEVINE:"edef8ba979d64acea3c827dcd51d21ed"};function dg(i){if(i===Yu.WIDEVINE)return bt.WIDEVINE;if(i===Yu.PLAYREADY)return bt.PLAYREADY;if(i===Yu.CENC||i===Yu.CLEARKEY)return bt.CLEARKEY}function Xu(i){switch(i){case bt.FAIRPLAY:return Kr.FAIRPLAY;case bt.PLAYREADY:return Kr.PLAYREADY;case bt.WIDEVINE:return Kr.WIDEVINE;case bt.CLEARKEY:return Kr.CLEARKEY}}function el(i){const{drmSystems:e,widevineLicenseUrl:t}=i,r=e?[bt.FAIRPLAY,bt.WIDEVINE,bt.PLAYREADY,bt.CLEARKEY].filter(n=>!!e[n]):[];return!r[bt.WIDEVINE]&&t&&r.push(bt.WIDEVINE),r}const vb=function(i){return Ku!=null&&(i=Ku.navigator)!=null&&i.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null}();function EL(i,e,t,r){let n;switch(i){case bt.FAIRPLAY:n=["cenc","sinf"];break;case bt.WIDEVINE:case bt.PLAYREADY:n=["cenc"];break;case bt.CLEARKEY:n=["cenc","keyids"];break;default:throw new Error(`Unknown key-system: ${i}`)}return bL(n,e,t,r)}function bL(i,e,t,r){return[{initDataTypes:i,persistentState:r.persistentState||"optional",distinctiveIdentifier:r.distinctiveIdentifier||"optional",sessionTypes:r.sessionTypes||[r.sessionType||"temporary"],audioCapabilities:e.map(s=>({contentType:`audio/mp4; codecs=${s}`,robustness:r.audioRobustness||"",encryptionScheme:r.audioEncryptionScheme||null})),videoCapabilities:t.map(s=>({contentType:`video/mp4; codecs=${s}`,robustness:r.videoRobustness||"",encryptionScheme:r.videoEncryptionScheme||null}))}]}function AL(i){var e;return i.sessionType==="persistent-license"||!!((e=i.sessionTypes)!=null&&e.some(t=>t==="persistent-license"))}function Eb(i){const e=new Uint16Array(i.buffer,i.byteOffset,i.byteLength/2),t=String.fromCharCode.apply(null,Array.from(e)),r=t.substring(t.indexOf("<"),t.length),a=new DOMParser().parseFromString(r,"text/xml").getElementsByTagName("KID")[0];if(a){const o=a.childNodes[0]?a.childNodes[0].nodeValue:a.getAttribute("VALUE");if(o){const l=cg(o).subarray(0,16);return yL(l),l}}return null}let ju={};class tl{static clearKeyUriToKeyIdMap(){ju={}}constructor(e,t,r,n=[1],s=null){this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=e,this.uri=t,this.keyFormat=r,this.keyFormatVersions=n,this.iv=s,this.encrypted=e?e!=="NONE":!1,this.isCommonEncryption=this.encrypted&&!$a(e)}isSupported(){if(this.method){if($a(this.method)||this.method==="NONE")return!0;if(this.keyFormat==="identity")return this.method==="SAMPLE-AES";switch(this.keyFormat){case Kr.FAIRPLAY:case Kr.WIDEVINE:case Kr.PLAYREADY:case Kr.CLEARKEY:return["ISO-23001-7","SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)!==-1}}return!1}getDecryptData(e){if(!this.encrypted||!this.uri)return null;if($a(this.method)&&this.uri&&!this.iv){typeof e!="number"&&(mt.warn(`missing IV for initialization segment with method="${this.method}" - compliance issue`),e=0);const r=SL(e);return new tl(this.method,this.uri,"identity",this.keyFormatVersions,r)}const t=vL(this.uri);if(t)switch(this.keyFormat){case Kr.WIDEVINE:this.pssh=t,t.length>=22&&(this.keyId=t.subarray(t.length-22,t.length-6));break;case Kr.PLAYREADY:{const r=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=Nw(r,null,t),this.keyId=Eb(t);break}default:{let r=t.subarray(0,16);if(r.length!==16){const n=new Uint8Array(16);n.set(r,16-r.length),r=n}this.keyId=r;break}}if(!this.keyId||this.keyId.byteLength!==16){let r=ju[this.uri];if(!r){const n=Object.keys(ju).length%Number.MAX_SAFE_INTEGER;r=new Uint8Array(16),new DataView(r.buffer,12,4).setUint32(0,n),ju[this.uri]=r}this.keyId=r}return this}}function SL(i){const e=new Uint8Array(16);for(let t=12;t<16;t++)e[t]=i>>8*(15-t)&255;return e}const bb=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,Ab=/#EXT-X-MEDIA:(.*)/g,xL=/^#EXT(?:INF|-X-TARGETDURATION):/m,fg=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[^\r\n]*)/.source,/#.*/.source].join("|"),"g"),TL=new RegExp([/#EXT-X-(PROGRAM-DATE-TIME|BYTERANGE|DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP|INDEPENDENT-SEGMENTS)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|"));class on{static findGroup(e,t){for(let r=0;r<e.length;r++){const n=e[r];if(n.id===t)return n}}static resolve(e,t){return zf.buildAbsoluteURL(t,e,{alwaysNormalize:!0})}static isMediaPlaylist(e){return xL.test(e)}static parseMasterPlaylist(e,t){const r=gb(e),n={contentSteering:null,levels:[],playlistParsingError:null,sessionData:null,sessionKeys:null,startTimeOffset:null,variableList:null,hasVariableRefs:r},s=[];bb.lastIndex=0;let a;for(;(a=bb.exec(e))!=null;)if(a[1]){var o;const u=new Ht(a[1],n),h=lg(n,a[2]),d={attrs:u,bitrate:u.decimalInteger("BANDWIDTH")||u.decimalInteger("AVERAGE-BANDWIDTH"),name:u.NAME,url:on.resolve(h,t)},p=u.decimalResolution("RESOLUTION");p&&(d.width=p.width,d.height=p.height),Db(u.CODECS,d);const g=u["SUPPLEMENTAL-CODECS"];g&&(d.supplemental={},Db(g,d.supplemental)),(o=d.unknownCodecs)!=null&&o.length||s.push(d),n.levels.push(d)}else if(a[3]){const u=a[3],h=a[4];switch(u){case"SESSION-DATA":{const d=new Ht(h,n),p=d["DATA-ID"];p&&(n.sessionData===null&&(n.sessionData={}),n.sessionData[p]=d);break}case"SESSION-KEY":{const d=xb(h,t,n);d.encrypted&&d.isSupported()?(n.sessionKeys===null&&(n.sessionKeys=[]),n.sessionKeys.push(d)):mt.warn(`[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "${h}"`);break}case"DEFINE":{{const d=new Ht(h,n);pb(n,d,t)}break}case"CONTENT-STEERING":{const d=new Ht(h,n);n.contentSteering={uri:on.resolve(d["SERVER-URI"],t),pathwayId:d["PATHWAY-ID"]||"."};break}case"START":{n.startTimeOffset=Tb(h);break}}}const l=s.length>0&&s.length<n.levels.length;return n.levels=l?s:n.levels,n.levels.length===0&&(n.playlistParsingError=new Error("no levels found in manifest")),n}static parseMasterPlaylistMedia(e,t,r){let n;const s={},a=r.levels,o={AUDIO:a.map(u=>({id:u.attrs.AUDIO,audioCodec:u.audioCodec})),SUBTITLES:a.map(u=>({id:u.attrs.SUBTITLES,textCodec:u.textCodec})),"CLOSED-CAPTIONS":[]};let l=0;for(Ab.lastIndex=0;(n=Ab.exec(e))!==null;){const u=new Ht(n[1],r),h=u.TYPE;if(h){const d=o[h],p=s[h]||[];s[h]=p;const g=u.LANGUAGE,m=u["ASSOC-LANGUAGE"],v=u.CHANNELS,E=u.CHARACTERISTICS,A=u["INSTREAM-ID"],D={attrs:u,bitrate:0,id:l++,groupId:u["GROUP-ID"]||"",name:u.NAME||g||"",type:h,default:u.bool("DEFAULT"),autoselect:u.bool("AUTOSELECT"),forced:u.bool("FORCED"),lang:g,url:u.URI?on.resolve(u.URI,t):""};if(m&&(D.assocLang=m),v&&(D.channels=v),E&&(D.characteristics=E),A&&(D.instreamId=A),d!=null&&d.length){const R=on.findGroup(d,D.groupId)||d[0];Rb(D,R,"audioCodec"),Rb(D,R,"textCodec")}p.push(D)}}return s}static parseLevelPlaylist(e,t,r,n,s,a){var o;const l={url:t},u=new pL(t),h=u.fragments,d=[];let p=null,g=0,m=0,v=0,E=0,A=0,D=null,R=new Qf(n,l),_,F,w,C=-1,M=!1,L=null,I;if(fg.lastIndex=0,u.m3u8=e,u.hasVariableRefs=gb(e),((o=fg.exec(e))==null?void 0:o[0])!=="#EXTM3U")return u.playlistParsingError=new Error("Missing format identifier #EXTM3U"),u;for(;(_=fg.exec(e))!==null;){M&&(M=!1,R=new Qf(n,l),R.playlistOffset=v,R.start=v,R.sn=g,R.cc=E,A&&(R.bitrate=A),R.level=r,p&&(R.initSegment=p,p.rawProgramDateTime&&(R.rawProgramDateTime=p.rawProgramDateTime,p.rawProgramDateTime=null),L&&(R.setByteRange(L),L=null)));const X=_[1];if(X){R.duration=parseFloat(X);const ne=(" "+_[2]).slice(1);R.title=ne||null,R.tagList.push(ne?["INF",X,ne]:["INF",X])}else if(_[3]){if(Ce(R.duration)){R.playlistOffset=v,R.start=v,w&&Nb(R,w,u),R.sn=g,R.level=r,R.cc=E,h.push(R);const ne=(" "+_[3]).slice(1);R.relurl=lg(u,ne),gg(R,D,d),D=R,v+=R.duration,g++,m=0,M=!0}}else{if(_=_[0].match(TL),!_){mt.warn("No matches on slow regex match for level playlist!");continue}for(F=1;F<_.length&&_[F]===void 0;F++);const ne=(" "+_[F]).slice(1),se=(" "+_[F+1]).slice(1),ce=_[F+2]?(" "+_[F+2]).slice(1):null;switch(ne){case"BYTERANGE":D?R.setByteRange(se,D):R.setByteRange(se);break;case"PROGRAM-DATE-TIME":R.rawProgramDateTime=se,R.tagList.push(["PROGRAM-DATE-TIME",se]),C===-1&&(C=h.length);break;case"PLAYLIST-TYPE":u.type&&Ln(u,ne,_),u.type=se.toUpperCase();break;case"MEDIA-SEQUENCE":u.startSN!==0?Ln(u,ne,_):h.length>0&&Cb(u,ne,_),g=u.startSN=parseInt(se);break;case"SKIP":{u.skippedSegments&&Ln(u,ne,_);const ie=new Ht(se,u),H=ie.decimalInteger("SKIPPED-SEGMENTS");if(Ce(H)){u.skippedSegments+=H;for(let ve=H;ve--;)h.push(null);g+=H}const J=ie.enumeratedString("RECENTLY-REMOVED-DATERANGES");J&&(u.recentlyRemovedDateranges=(u.recentlyRemovedDateranges||[]).concat(J.split("	")));break}case"TARGETDURATION":u.targetduration!==0&&Ln(u,ne,_),u.targetduration=Math.max(parseInt(se),1);break;case"VERSION":u.version!==null&&Ln(u,ne,_),u.version=parseInt(se);break;case"INDEPENDENT-SEGMENTS":break;case"ENDLIST":u.live||Ln(u,ne,_),u.live=!1;break;case"#":(se||ce)&&R.tagList.push(ce?[se,ce]:[se]);break;case"DISCONTINUITY":E++,R.tagList.push(["DIS"]);break;case"GAP":R.gap=!0,R.tagList.push([ne]);break;case"BITRATE":R.tagList.push([ne,se]),A=parseInt(se)*1e3,Ce(A)?R.bitrate=A:A=0;break;case"DATERANGE":{const ie=new Ht(se,u),H=new yb(ie,u.dateRanges[ie.ID],u.dateRangeTagCount);u.dateRangeTagCount++,H.isValid||u.skippedSegments?u.dateRanges[H.id]=H:mt.warn(`Ignoring invalid DATERANGE tag: "${se}"`),R.tagList.push(["EXT-X-DATERANGE",se]);break}case"DEFINE":{{const ie=new Ht(se,u);"IMPORT"in ie?uL(u,ie,a):pb(u,ie,t)}break}case"DISCONTINUITY-SEQUENCE":u.startCC!==0?Ln(u,ne,_):h.length>0&&Cb(u,ne,_),u.startCC=E=parseInt(se);break;case"KEY":{const ie=xb(se,t,u);if(ie.isSupported()){if(ie.method==="NONE"){w=void 0;break}w||(w={}),w[ie.keyFormat]&&(w=xt({},w)),w[ie.keyFormat]=ie}else mt.warn(`[Keys] Ignoring invalid EXT-X-KEY tag: "${se}"`);break}case"START":u.startTimeOffset=Tb(se);break;case"MAP":{const ie=new Ht(se,u);if(R.duration){const H=new Qf(n,l);Ib(H,ie,r,w),p=H,R.initSegment=p,p.rawProgramDateTime&&!R.rawProgramDateTime&&(R.rawProgramDateTime=p.rawProgramDateTime)}else{const H=R.byteRangeEndOffset;if(H){const J=R.byteRangeStartOffset;L=`${H-J}@${J}`}else L=null;Ib(R,ie,r,w),p=R,M=!0}p.cc=E;break}case"SERVER-CONTROL":{I&&Ln(u,ne,_),I=new Ht(se),u.canBlockReload=I.bool("CAN-BLOCK-RELOAD"),u.canSkipUntil=I.optionalFloat("CAN-SKIP-UNTIL",0),u.canSkipDateRanges=u.canSkipUntil>0&&I.bool("CAN-SKIP-DATERANGES"),u.partHoldBack=I.optionalFloat("PART-HOLD-BACK",0),u.holdBack=I.optionalFloat("HOLD-BACK",0);break}case"PART-INF":{u.partTarget&&Ln(u,ne,_);const ie=new Ht(se);u.partTarget=ie.decimalFloatingPoint("PART-TARGET");break}case"PART":{let ie=u.partList;ie||(ie=u.partList=[]);const H=m>0?ie[ie.length-1]:void 0,J=m++,ve=new Ht(se,u),fe=new gw(ve,R,l,J,H);ie.push(fe),R.duration+=fe.duration;break}case"PRELOAD-HINT":{const ie=new Ht(se,u);u.preloadHint=ie;break}case"RENDITION-REPORT":{const ie=new Ht(se,u);u.renditionReports=u.renditionReports||[],u.renditionReports.push(ie);break}default:mt.warn(`line parsed but not handled: ${_}`);break}}}D&&!D.relurl?(h.pop(),v-=D.duration,u.partList&&(u.fragmentHint=D)):u.partList&&(gg(R,D,d),R.cc=E,u.fragmentHint=R,w&&Nb(R,w,u)),u.targetduration||(u.playlistParsingError=new Error("#EXT-X-TARGETDURATION is required"));const U=h.length,q=h[0],$=h[U-1];if(v+=u.skippedSegments*u.targetduration,v>0&&U&&$){u.averagetargetduration=v/U;const X=$.sn;u.endSN=X!=="initSegment"?X:0,u.live||($.endList=!0),q&&u.startCC===void 0&&(u.startCC=q.cc),C>0&&(RL(h,C),q&&d.unshift(q))}else u.endSN=0,u.startCC=0;return u.fragmentHint&&(v+=u.fragmentHint.duration),u.totalduration=v,d.length&&u.dateRangeTagCount&&q&&Sb(d,u),u.endCC=E,u}}function Sb(i,e){const t=i.length;if(!t)return;const r=i[t-1],n=e.live?1/0:e.totalduration,s=Object.keys(e.dateRanges);for(let a=s.length;a--;){const o=e.dateRanges[s[a]],l=o.startDate.getTime();o.tagAnchor=r.ref;for(let u=t;u--;){const h=DL(e,l,i,u,n);if(h!==-1){o.tagAnchor=e.fragments[h].ref;break}}}}function DL(i,e,t,r,n){const s=t[r];if(s){const o=s.programDateTime;if(e>=o||r===0){var a;const l=(((a=t[r+1])==null?void 0:a.start)||n)-s.start;if(e<=o+l*1e3){const u=t[r].sn-i.startSN,h=i.fragments;if(h.length>t.length){const p=(t[r+1]||h[h.length-1]).sn-i.startSN;for(let g=p;g>u;g--){const m=h[g].programDateTime;if(e>=m&&e<m+h[g].duration*1e3)return g}}return u}}}return-1}function xb(i,e,t){var r,n;const s=new Ht(i,t),a=(r=s.METHOD)!=null?r:"",o=s.URI,l=s.hexadecimalInteger("IV"),u=s.KEYFORMATVERSIONS,h=(n=s.KEYFORMAT)!=null?n:"identity";o&&s.IV&&!l&&mt.error(`Invalid IV: ${s.IV}`);const d=o?on.resolve(o,e):"",p=(u||"1").split("/").map(Number).filter(Number.isFinite);return new tl(a,d,h,p,l)}function Tb(i){const t=new Ht(i).decimalFloatingPoint("TIME-OFFSET");return Ce(t)?t:null}function Db(i,e){let t=(i||"").split(/[ ,]+/).filter(r=>r);["video","audio","text"].forEach(r=>{const n=t.filter(s=>GE(s,r));n.length&&(e[`${r}Codec`]=n.map(s=>s.split("/")[0]).join(","),t=t.filter(s=>n.indexOf(s)===-1))}),e.unknownCodecs=t}function Rb(i,e,t){const r=e[t];r&&(i[t]=r)}function RL(i,e){let t=i[e];for(let r=e;r--;){const n=i[r];if(!n)return;n.programDateTime=t.programDateTime-n.duration*1e3,t=n}}function gg(i,e,t){i.rawProgramDateTime?t.push(i):e!=null&&e.programDateTime&&(i.programDateTime=e.endProgramDateTime)}function Ib(i,e,t,r){i.relurl=e.URI,e.BYTERANGE&&i.setByteRange(e.BYTERANGE),i.level=t,i.sn="initSegment",r&&(i.levelkeys=r),i.initSegment=null}function Nb(i,e,t){i.levelkeys=e;const{encryptedFragments:r}=t;(!r.length||r[r.length-1].levelkeys!==e)&&Object.keys(e).some(n=>e[n].isCommonEncryption)&&r.push(i)}function Ln(i,e,t){i.playlistParsingError=new Error(`#EXT-X-${e} must not appear more than once (${t[0]})`)}function Cb(i,e,t){i.playlistParsingError=new Error(`#EXT-X-${e} must appear before the first Media Segment (${t[0]})`)}function pg(i,e){const t=e.startPTS;if(Ce(t)){let r=0,n;e.sn>i.sn?(r=t-i.start,n=i):(r=i.start-t,n=e),n.duration!==r&&n.setDuration(r)}else e.sn>i.sn?i.cc===e.cc&&i.minEndPTS?e.setStart(i.start+(i.minEndPTS-i.start)):e.setStart(i.start+i.duration):e.setStart(Math.max(i.start-e.duration,0))}function wb(i,e,t,r,n,s){r-t<=0&&(mt.warn("Fragment should have a positive duration",e),r=t+e.duration,s=n+e.duration);let o=t,l=r;const u=e.startPTS,h=e.endPTS;if(Ce(u)){const E=Math.abs(u-t);Ce(e.deltaPTS)?e.deltaPTS=Math.max(E,e.deltaPTS):e.deltaPTS=E,o=Math.max(t,u),t=Math.min(t,u),n=Math.min(n,e.startDTS),l=Math.min(r,h),r=Math.max(r,h),s=Math.max(s,e.endDTS)}const d=t-e.start;e.start!==0&&e.setStart(t),e.setDuration(r-e.start),e.startPTS=t,e.maxStartPTS=o,e.startDTS=n,e.endPTS=r,e.minEndPTS=l,e.endDTS=s;const p=e.sn;if(!i||p<i.startSN||p>i.endSN)return 0;let g;const m=p-i.startSN,v=i.fragments;for(v[m]=e,g=m;g>0;g--)pg(v[g],v[g-1]);for(g=m;g<v.length-1;g++)pg(v[g],v[g+1]);return i.fragmentHint&&pg(v[v.length-1],i.fragmentHint),i.PTSKnown=i.alignedSliding=!0,d}function IL(i,e){if(i===e)return;let t=null;const r=i.fragments;for(let u=r.length-1;u>=0;u--){const h=r[u].initSegment;if(h){t=h;break}}i.fragmentHint&&delete i.fragmentHint.endPTS;let n;wL(i,e,(u,h,d,p)=>{if((!e.startCC||e.skippedSegments)&&h.cc!==u.cc){const g=u.cc-h.cc;for(let m=d;m<p.length;m++)p[m].cc+=g;e.endCC=p[p.length-1].cc}Ce(u.startPTS)&&Ce(u.endPTS)&&(h.setStart(h.startPTS=u.startPTS),h.startDTS=u.startDTS,h.maxStartPTS=u.maxStartPTS,h.endPTS=u.endPTS,h.endDTS=u.endDTS,h.minEndPTS=u.minEndPTS,h.setDuration(u.endPTS-u.startPTS),h.duration&&(n=h),e.PTSKnown=e.alignedSliding=!0),u.hasStreams&&(h.elementaryStreams=u.elementaryStreams),h.loader=u.loader,u.hasStats&&(h.stats=u.stats),u.initSegment&&(h.initSegment=u.initSegment,t=u.initSegment)});const s=e.fragments,a=e.fragmentHint?s.concat(e.fragmentHint):s;if(t&&a.forEach(u=>{var h;u&&(!u.initSegment||u.initSegment.relurl===((h=t)==null?void 0:h.relurl))&&(u.initSegment=t)}),e.skippedSegments){if(e.deltaUpdateFailed=s.some(u=>!u),e.deltaUpdateFailed){mt.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(let u=e.skippedSegments;u--;)s.shift();e.startSN=s[0].sn}else{e.canSkipDateRanges&&(e.dateRanges=NL(i.dateRanges,e));const u=i.fragments.filter(h=>h.rawProgramDateTime);if(i.hasProgramDateTime&&!e.hasProgramDateTime)for(let h=1;h<a.length;h++)a[h].programDateTime===null&&gg(a[h],a[h-1],u);Sb(u,e)}e.endCC=s[s.length-1].cc}if(!e.startCC){var o;const u=Pb(i,e.startSN-1);e.startCC=(o=u==null?void 0:u.cc)!=null?o:s[0].cc}CL(i.partList,e.partList,(u,h)=>{h.elementaryStreams=u.elementaryStreams,h.stats=u.stats}),n?wb(e,n,n.startPTS,n.endPTS,n.startDTS,n.endDTS):_b(i,e),s.length&&(e.totalduration=e.edge-s[0].start),e.driftStartTime=i.driftStartTime,e.driftStart=i.driftStart;const l=e.advancedDateTime;if(e.advanced&&l){const u=e.edge;e.driftStart||(e.driftStartTime=l,e.driftStart=u),e.driftEndTime=l,e.driftEnd=u}else e.driftEndTime=i.driftEndTime,e.driftEnd=i.driftEnd,e.advancedDateTime=i.advancedDateTime;e.requestScheduled===-1&&(e.requestScheduled=i.requestScheduled)}function NL(i,e){const{dateRanges:t,recentlyRemovedDateranges:r}=e,n=xt({},i);r&&r.forEach(o=>{delete n[o]});const a=Object.keys(n).length;return a&&Object.keys(t).forEach(o=>{const l=n[o],u=new yb(t[o].attr,l);u.isValid?(n[o]=u,l||(u.tagOrder+=a)):mt.warn(`Ignoring invalid Playlist Delta Update DATERANGE tag: "${Gt(t[o].attr)}"`)}),n}function CL(i,e,t){if(i&&e){let r=0;for(let n=0,s=i.length;n<=s;n++){const a=i[n],o=e[n+r];a&&o&&a.index===o.index&&a.fragment.sn===o.fragment.sn?t(a,o):r--}}}function wL(i,e,t){const r=e.skippedSegments,n=Math.max(i.startSN,e.startSN)-e.startSN,s=(i.fragmentHint?1:0)+(r?e.endSN:Math.min(i.endSN,e.endSN))-e.startSN,a=e.startSN-i.startSN,o=e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments,l=i.fragmentHint?i.fragments.concat(i.fragmentHint):i.fragments;for(let u=n;u<=s;u++){const h=l[a+u];let d=o[u];if(r&&!d&&h&&(d=e.fragments[u]=h),h&&d){if(t(h,d,u,o),h.url&&h.url!==d.url){e.playlistParsingError=Lb(`media sequence mismatch ${d.sn}:`,i,e,h,d);return}else if(h.cc!==d.cc){e.playlistParsingError=Lb(`discontinuity sequence mismatch (${h.cc}!=${d.cc})`,i,e,h,d);return}}}}function Lb(i,e,t,r,n){return new Error(`${i} ${n.url}
Playlist starting @${e.startSN}
${e.m3u8}

Playlist starting @${t.startSN}
${t.m3u8}`)}function _b(i,e,t=!0){const r=e.startSN+e.skippedSegments-i.startSN,n=i.fragments,s=r>=0;let a=0;if(s&&r<n.length)a=n[r].start;else if(s&&e.startSN===i.endSN+1)a=i.fragmentEnd;else if(s&&t)a=i.fragmentStart+r*e.levelTargetDuration;else if(!e.skippedSegments&&e.fragmentStart===0)a=i.fragmentStart;else return;mg(e,a)}function mg(i,e){if(e){const t=i.fragments;for(let r=i.skippedSegments;r<t.length;r++)t[r].addStart(e);i.fragmentHint&&i.fragmentHint.addStart(e)}}function Mb(i,e=1/0){let t=1e3*i.targetduration;if(i.updated){const r=i.fragments;if(r.length&&t*4>e){const s=r[r.length-1].duration*1e3;s<t&&(t=s)}}else t/=2;return Math.round(t)}function Pb(i,e,t){if(!i)return null;let r=i.fragments[e-i.startSN];return r||(r=i.fragmentHint,r&&r.sn===e)?r:e<i.startSN&&t&&t.sn===e?t:null}function kb(i,e,t){return i?Ob(i.partList,e,t):null}function Ob(i,e,t){if(i)for(let r=i.length;r--;){const n=i[r];if(n.index===t&&n.fragment.sn===e)return n}return null}function Fb(i){i.forEach((e,t)=>{var r;(r=e.details)==null||r.fragments.forEach(n=>{n.level=t,n.initSegment&&(n.initSegment.level=t)})})}function rl(i,e){for(let r=0,n=i.length;r<n;r++){var t;if(((t=i[r])==null?void 0:t.cc)===e)return i[r]}return null}function LL(i,e){return!!(i&&e.startCC<i.endCC&&e.endCC>i.startCC)}function Bb(i,e){if(i){const t=i.start+e;i.start=i.startPTS=t,i.endPTS=t+i.duration}}function Ub(i,e){const t=e.fragments;for(let r=0,n=t.length;r<n;r++)Bb(t[r],i);e.fragmentHint&&Bb(e.fragmentHint,i),e.alignedSliding=!0}function _L(i,e){i&&($b(e,i),!e.alignedSliding&&i&&zu(e,i),!e.alignedSliding&&i&&!e.skippedSegments&&_b(i,e,!1))}function $b(i,e){if(!LL(e,i))return;const t=Math.min(e.endCC,i.endCC),r=rl(e.fragments,t),n=rl(i.fragments,t);if(!r||!n)return;mt.log(`Aligning playlist at start of dicontinuity sequence ${t}`);const s=r.start-n.start;Ub(s,i)}function zu(i,e){if(!i.hasProgramDateTime||!e.hasProgramDateTime)return;const t=i.fragments,r=e.fragments;if(!t.length||!r.length)return;let n,s;const a=Math.min(e.endCC,i.endCC);e.startCC<a&&i.startCC<a&&(n=rl(r,a),s=rl(t,a)),(!n||!s)&&(n=r[Math.floor(r.length/2)],s=rl(t,n.cc)||t[Math.floor(t.length/2)]);const o=n.programDateTime,l=s.programDateTime;if(!o||!l)return;const u=(l-o)/1e3-(s.start-n.start);Ub(u,i)}const ML={toString:function(i){let e="";const t=i.length;for(let r=0;r<t;r++)e+=`[${i.start(r).toFixed(3)}-${i.end(r).toFixed(3)}]`;return e}},le={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"};class yg extends hb{constructor(e,t,r,n,s){super(n,e.logger),this.hls=void 0,this.fragPrevious=null,this.fragCurrent=null,this.fragmentTracker=void 0,this.transmuxer=null,this._state=le.STOPPED,this.playlistType=void 0,this.media=null,this.mediaBuffer=null,this.config=void 0,this.bitrateTest=!1,this.lastCurrentTime=0,this.nextLoadPosition=0,this.startPosition=0,this.startTimeOffset=null,this.retryDate=0,this.levels=null,this.fragmentLoader=void 0,this.keyLoader=void 0,this.levelLastLoaded=null,this.startFragRequested=!1,this.decrypter=void 0,this.initPTS=[],this.buffering=!0,this.loadingParts=!1,this.loopSn=void 0,this.onMediaSeeking=()=>{const{config:a,fragCurrent:o,media:l,mediaBuffer:u,state:h}=this,d=l?l.currentTime:0,p=Xe.bufferInfo(u||l,d,a.maxBufferHole);if(this.log(`media seeking to ${Ce(d)?d.toFixed(3):d}, state: ${h}`),this.state===le.ENDED)this.resetLoadingState();else if(o){const g=a.maxFragLookUpTolerance,m=o.start-g,v=o.start+o.duration+g;if(!p.len||v<p.start||m>p.end){const E=d>v;(d<m||E)&&(E&&o.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),o.abortRequests(),this.resetLoadingState()),this.fragPrevious=null)}}if(l){this.fragmentTracker.removeFragmentsInRange(d,1/0,this.playlistType,!0);const g=this.lastCurrentTime;if(d>g&&(this.lastCurrentTime=d),!this.loadingParts){const m=Math.max(p.end,d),v=this.shouldLoadParts(this.getLevelDetails(),m);v&&(this.log(`LL-Part loading ON after seeking to ${d.toFixed(2)} with buffer @${m.toFixed(2)}`),this.loadingParts=v)}}!this.hls.hasEnoughToStart&&!p.len&&(this.log(`setting startPosition to ${d} because of seek before start`),this.nextLoadPosition=this.startPosition=d),this.tickImmediate()},this.onMediaEnded=()=>{this.log("setting startPosition to 0 because media ended"),this.startPosition=this.lastCurrentTime=0},this.playlistType=s,this.hls=e,this.fragmentLoader=new oL(e.config),this.keyLoader=r,this.fragmentTracker=t,this.config=e.config,this.decrypter=new ag(e.config)}registerListeners(){const{hls:e}=this;e.on(x.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(x.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(x.MANIFEST_LOADING,this.onManifestLoading,this),e.on(x.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(x.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(x.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(x.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(x.MANIFEST_LOADING,this.onManifestLoading,this),e.off(x.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(x.ERROR,this.onError,this)}doTick(){this.onTickEnd()}onTickEnd(){}startLoad(e){}stopLoad(){if(this.state===le.STOPPED)return;this.fragmentLoader.abort(),this.keyLoader.abort(this.playlistType);const e=this.fragCurrent;e!=null&&e.loader&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=le.STOPPED}get startPositionValue(){const{nextLoadPosition:e,startPosition:t}=this;return t===-1&&e?e:t}get bufferingEnabled(){return this.buffering}pauseBuffering(){this.buffering=!1}resumeBuffering(){this.buffering=!0}get inFlightFrag(){return{frag:this.fragCurrent,state:this.state}}_streamEnded(e,t){if(t.live||!this.media)return!1;const r=e.end||0,n=this.config.timelineOffset||0;if(r<=n)return!1;const s=e.buffered;this.config.maxBufferHole&&s&&s.length>1&&(e=Xe.bufferedInfo(s,e.start,0));const a=e.nextStart;if(a&&a>n&&a<t.edge||this.media.currentTime<e.start)return!1;const l=t.partList;if(l!=null&&l.length){const h=l[l.length-1];return Xe.isBuffered(this.media,h.start+h.duration/2)}const u=t.fragments[t.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(u)}getLevelDetails(){if(this.levels&&this.levelLastLoaded!==null){var e;return(e=this.levelLastLoaded)==null?void 0:e.details}}get timelineOffset(){const e=this.config.timelineOffset;if(e){var t;return((t=this.getLevelDetails())==null?void 0:t.appliedTimelineOffset)||e}return 0}onMediaAttached(e,t){const r=this.media=this.mediaBuffer=t.media;r.removeEventListener("seeking",this.onMediaSeeking),r.removeEventListener("ended",this.onMediaEnded),r.addEventListener("seeking",this.onMediaSeeking),r.addEventListener("ended",this.onMediaEnded);const n=this.config;this.levels&&n.autoStartLoad&&this.state===le.STOPPED&&this.startLoad(n.startPosition)}onMediaDetaching(e,t){const r=!!t.transferMedia,n=this.media;if(n!==null){if(n.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),n.removeEventListener("seeking",this.onMediaSeeking),n.removeEventListener("ended",this.onMediaEnded),this.keyLoader&&!r&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loopSn=void 0,r){this.resetLoadingState(),this.resetTransmuxer();return}this.loadingParts=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()}}onManifestLoading(){this.initPTS=[],this.levels=this.levelLastLoaded=this.fragCurrent=null,this.lastCurrentTime=this.startPosition=0,this.startFragRequested=!1}onError(e,t){}onManifestLoaded(e,t){this.startTimeOffset=t.startTimeOffset}onHandlerDestroying(){this.stopLoad(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),super.onHandlerDestroying(),this.hls=this.onMediaSeeking=this.onMediaEnded=null}onHandlerDestroyed(){this.state=le.STOPPED,this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,super.onHandlerDestroyed()}loadFragment(e,t,r){this.startFragRequested=!0,this._loadFragForPlayback(e,t,r)}_loadFragForPlayback(e,t,r){const n=s=>{const a=s.frag;if(this.fragContextChanged(a)){this.warn(`${a.type} sn: ${a.sn}${s.part?" part: "+s.part.index:""} of ${this.fragInfo(a,!1,s.part)}) was dropped during download.`),this.fragmentTracker.removeFragment(a);return}a.stats.chunkCount++,this._handleFragmentLoadProgress(s)};this._doFragLoad(e,t,r,n).then(s=>{if(!s)return;const a=this.state,o=s.frag;if(this.fragContextChanged(o)){(a===le.FRAG_LOADING||!this.fragCurrent&&a===le.PARSING)&&(this.fragmentTracker.removeFragment(o),this.state=le.IDLE);return}"payload"in s&&(this.log(`Loaded ${o.type} sn: ${o.sn} of ${this.playlistLabel()} ${o.level}`),this.hls.trigger(x.FRAG_LOADED,s)),this._handleFragmentLoadComplete(s)}).catch(s=>{this.state===le.STOPPED||this.state===le.ERROR||(this.warn(`Frag error: ${(s==null?void 0:s.message)||s}`),this.resetFragmentLoading(e))})}clearTrackerIfNeeded(e){var t;const{fragmentTracker:r}=this;if(r.getState(e)===nr.APPENDING){const s=e.type,a=this.getFwdBufferInfo(this.mediaBuffer,s),o=Math.max(e.duration,a?a.len:this.config.maxBufferLength),l=this.backtrackFragment;((l?e.sn-l.sn:0)===1||this.reduceMaxBufferLength(o,e.duration))&&r.removeFragment(e)}else((t=this.mediaBuffer)==null?void 0:t.buffered.length)===0?r.removeAllFragments():r.hasParts(e.type)&&(r.detectPartialFragments({frag:e,part:null,stats:e.stats,id:e.type}),r.getState(e)===nr.PARTIAL&&r.removeFragment(e))}checkLiveUpdate(e){if(e.updated&&!e.live){const t=e.fragments[e.fragments.length-1];this.fragmentTracker.detectPartialFragments({frag:t,part:null,stats:t.stats,id:t.type})}e.fragments[0]||(e.deltaUpdateFailed=!0)}waitForLive(e){const t=e.details;return(t==null?void 0:t.live)&&t.type!=="EVENT"&&(this.levelLastLoaded!==e||t.expired)}flushMainBuffer(e,t,r=null){if(!(e-t))return;const n={startOffset:e,endOffset:t,type:r};this.hls.trigger(x.BUFFER_FLUSHING,n)}_loadInitSegment(e,t){this._doFragLoad(e,t).then(r=>{const n=r==null?void 0:r.frag;if(!n||this.fragContextChanged(n)||!this.levels)throw new Error("init load aborted");return r}).then(r=>{const{hls:n}=this,{frag:s,payload:a}=r,o=s.decryptdata;if(a&&a.byteLength>0&&o!=null&&o.key&&o.iv&&$a(o.method)){const l=self.performance.now();return this.decrypter.decrypt(new Uint8Array(a),o.key.buffer,o.iv.buffer,ug(o.method)).catch(u=>{throw n.trigger(x.ERROR,{type:Fe.MEDIA_ERROR,details:Q.FRAG_DECRYPT_ERROR,fatal:!1,error:u,reason:u.message,frag:s}),u}).then(u=>{const h=self.performance.now();return n.trigger(x.FRAG_DECRYPTED,{frag:s,payload:u,stats:{tstart:l,tdecrypt:h}}),r.payload=u,this.completeInitSegmentLoad(r)})}return this.completeInitSegmentLoad(r)}).catch(r=>{this.state===le.STOPPED||this.state===le.ERROR||(this.warn(r),this.resetFragmentLoading(e))})}completeInitSegmentLoad(e){const{levels:t}=this;if(!t)throw new Error("init load aborted, missing levels");const r=e.frag.stats;this.state!==le.STOPPED&&(this.state=le.IDLE),e.frag.data=new Uint8Array(e.payload),r.parsing.start=r.buffering.start=self.performance.now(),r.parsing.end=r.buffering.end=self.performance.now(),this.tick()}fragContextChanged(e){const{fragCurrent:t}=this;return!e||!t||e.sn!==t.sn||e.level!==t.level}fragBufferedComplete(e,t){const r=this.mediaBuffer?this.mediaBuffer:this.media;if(this.log(`Buffered ${e.type} sn: ${e.sn}${t?" part: "+t.index:""} of ${this.fragInfo(e,!1,t)} > buffer:${r?ML.toString(Xe.getBuffered(r)):"(detached)"})`),pr(e)){var n;if(e.type!==ke.SUBTITLE){const a=e.elementaryStreams;if(!Object.keys(a).some(o=>!!a[o])){this.state=le.IDLE;return}}const s=(n=this.levels)==null?void 0:n[e.level];s!=null&&s.fragmentError&&(this.log(`Resetting level fragment error count of ${s.fragmentError} on frag buffered`),s.fragmentError=0)}this.state=le.IDLE}_handleFragmentLoadComplete(e){const{transmuxer:t}=this;if(!t)return;const{frag:r,part:n,partsLoaded:s}=e,a=!s||s.length===0||s.some(l=>!l),o=new og(r.level,r.sn,r.stats.chunkCount+1,0,n?n.index:-1,!a);t.flush(o)}_handleFragmentLoadProgress(e){}_doFragLoad(e,t,r=null,n){var s;this.fragCurrent=e;const a=t==null?void 0:t.details;if(!this.levels||!a)throw new Error(`frag load aborted, missing level${a?"":" detail"}s`);let o=null;e.encrypted&&!((s=e.decryptdata)!=null&&s.key)?(this.log(`Loading key for ${e.sn} of [${a.startSN}-${a.endSN}], ${this.playlistLabel()} ${e.level}`),this.state=le.KEY_LOADING,this.fragCurrent=e,o=this.keyLoader.load(e).then(d=>{if(!this.fragContextChanged(d.frag))return this.hls.trigger(x.KEY_LOADED,d),this.state===le.KEY_LOADING&&(this.state=le.IDLE),d}),this.hls.trigger(x.KEY_LOADING,{frag:e}),this.fragCurrent===null&&(o=Promise.reject(new Error("frag load aborted, context changed in KEY_LOADING")))):e.encrypted||(o=this.keyLoader.loadClear(e,a.encryptedFragments),o&&this.log("[eme] blocking frag load until media-keys acquired"));const l=this.fragPrevious;if(pr(e)&&(!l||e.sn!==l.sn)){const d=this.shouldLoadParts(t.details,e.end);d!==this.loadingParts&&(this.log(`LL-Part loading ${d?"ON":"OFF"} loading sn ${l==null?void 0:l.sn}->${e.sn}`),this.loadingParts=d)}if(r=Math.max(e.start,r||0),this.loadingParts&&pr(e)){const d=a.partList;if(d&&n){r>e.end&&a.fragmentHint&&(e=a.fragmentHint);const p=this.getNextPart(d,e,r);if(p>-1){const g=d[p];e=this.fragCurrent=g.fragment,this.log(`Loading ${e.type} sn: ${e.sn} part: ${g.index} (${p}/${d.length-1}) of ${this.fragInfo(e,!1,g)}) cc: ${e.cc} [${a.startSN}-${a.endSN}], target: ${parseFloat(r.toFixed(3))}`),this.nextLoadPosition=g.start+g.duration,this.state=le.FRAG_LOADING;let m;return o?m=o.then(v=>!v||this.fragContextChanged(v.frag)?null:this.doFragPartsLoad(e,g,t,n)).catch(v=>this.handleFragLoadError(v)):m=this.doFragPartsLoad(e,g,t,n).catch(v=>this.handleFragLoadError(v)),this.hls.trigger(x.FRAG_LOADING,{frag:e,part:g,targetBufferTime:r}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING parts")):m}else if(!e.url||this.loadedEndOfParts(d,r))return Promise.resolve(null)}}if(pr(e)&&this.loadingParts)this.log(`LL-Part loading OFF after next part miss @${r.toFixed(2)}`),this.loadingParts=!1;else if(!e.url)return Promise.resolve(null);this.log(`Loading ${e.type} sn: ${e.sn} of ${this.fragInfo(e,!1)}) cc: ${e.cc} ${a?"["+a.startSN+"-"+a.endSN+"]":""}, target: ${parseFloat(r.toFixed(3))}`),Ce(e.sn)&&!this.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),this.state=le.FRAG_LOADING;const u=this.config.progressive;let h;return u&&o?h=o.then(d=>!d||this.fragContextChanged(d==null?void 0:d.frag)?null:this.fragmentLoader.load(e,n)).catch(d=>this.handleFragLoadError(d)):h=Promise.all([this.fragmentLoader.load(e,u?n:void 0),o]).then(([d])=>(!u&&d&&n&&n(d),d)).catch(d=>this.handleFragLoadError(d)),this.hls.trigger(x.FRAG_LOADING,{frag:e,targetBufferTime:r}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING")):h}doFragPartsLoad(e,t,r,n){return new Promise((s,a)=>{var o;const l=[],u=(o=r.details)==null?void 0:o.partList,h=d=>{this.fragmentLoader.loadPart(e,d,n).then(p=>{l[d.index]=p;const g=p.part;this.hls.trigger(x.FRAG_LOADED,p);const m=kb(r.details,e.sn,d.index+1)||Ob(u,e.sn,d.index+1);if(m)h(m);else return s({frag:e,part:g,partsLoaded:l})}).catch(a)};h(t)})}handleFragLoadError(e){if("data"in e){const t=e.data;e.data&&t.details===Q.INTERNAL_ABORTED?this.handleFragLoadAborted(t.frag,t.part):this.hls.trigger(x.ERROR,t)}else this.hls.trigger(x.ERROR,{type:Fe.OTHER_ERROR,details:Q.INTERNAL_EXCEPTION,err:e,error:e,fatal:!0});return null}_handleTransmuxerFlush(e){const t=this.getCurrentContext(e);if(!t||this.state!==le.PARSING){!this.fragCurrent&&this.state!==le.STOPPED&&this.state!==le.ERROR&&(this.state=le.IDLE);return}const{frag:r,part:n,level:s}=t,a=self.performance.now();r.stats.parsing.end=a,n&&(n.stats.parsing.end=a);const o=this.getLevelDetails(),u=o&&r.sn>o.endSN||this.shouldLoadParts(o,r.end);u!==this.loadingParts&&(this.log(`LL-Part loading ${u?"ON":"OFF"} after parsing segment ending @${r.end.toFixed(2)}`),this.loadingParts=u),this.updateLevelTiming(r,n,s,e.partial)}shouldLoadParts(e,t){if(this.config.lowLatencyMode){if(!e)return this.loadingParts;if(e!=null&&e.partList){var r;const s=e.partList[0],a=s.end+(((r=e.fragmentHint)==null?void 0:r.duration)||0);if(t>=a){var n;if((this.hls.hasEnoughToStart?((n=this.media)==null?void 0:n.currentTime)||this.lastCurrentTime:this.getLoadPosition())>s.start-s.fragment.duration)return!0}}}return!1}getCurrentContext(e){const{levels:t,fragCurrent:r}=this,{level:n,sn:s,part:a}=e;if(!(t!=null&&t[n]))return this.warn(`Levels object was unset while buffering fragment ${s} of ${this.playlistLabel()} ${n}. The current chunk will not be buffered.`),null;const o=t[n],l=o.details,u=a>-1?kb(l,s,a):null,h=u?u.fragment:Pb(l,s,r);return h?(r&&r!==h&&(h.stats=r.stats),{frag:h,part:u,level:o}):null}bufferFragmentData(e,t,r,n,s){var a;if(!e||this.state!==le.PARSING)return;const{data1:o,data2:l}=e;let u=o;if(o&&l&&(u=pi(o,l)),!((a=u)!=null&&a.length))return;const h={type:e.type,frag:t,part:r,chunkMeta:n,parent:t.type,data:u};if(this.hls.trigger(x.BUFFER_APPENDING,h),e.dropped&&e.independent&&!r){if(s)return;this.flushBufferGap(t)}}flushBufferGap(e){const t=this.media;if(!t)return;if(!Xe.isBuffered(t,t.currentTime)){this.flushMainBuffer(0,e.start);return}const r=t.currentTime,n=Xe.bufferInfo(t,r,0),s=e.duration,a=Math.min(this.config.maxFragLookUpTolerance*2,s*.25),o=Math.max(Math.min(e.start-a,n.end-a),r+a);e.start-o>a&&this.flushMainBuffer(o,e.start)}getFwdBufferInfo(e,t){var r;const n=this.getLoadPosition();if(!Ce(n))return null;const a=this.lastCurrentTime>n||(r=this.media)!=null&&r.paused?0:this.config.maxBufferHole;return this.getFwdBufferInfoAtPos(e,n,t,a)}getFwdBufferInfoAtPos(e,t,r,n){const s=Xe.bufferInfo(e,t,n);if(s.len===0&&s.nextStart!==void 0){const a=this.fragmentTracker.getBufferedFrag(t,r);if(a&&(s.nextStart<=a.end||a.gap)){const o=Math.max(Math.min(s.nextStart,a.end)-t,n);return Xe.bufferInfo(e,t,o)}}return s}getMaxBufferLength(e){const{config:t}=this;let r;return e?r=Math.max(8*t.maxBufferSize/e,t.maxBufferLength):r=t.maxBufferLength,Math.min(r,t.maxMaxBufferLength)}reduceMaxBufferLength(e,t){const r=this.config,n=Math.max(Math.min(e-t,r.maxBufferLength),t),s=Math.max(e-t*3,r.maxMaxBufferLength/2,n);return s>=n?(r.maxMaxBufferLength=s,this.warn(`Reduce max buffer length to ${s}s`),!0):!1}getAppendedFrag(e,t=ke.MAIN){var r;const n=(r=this.fragmentTracker)==null?void 0:r.getAppendedFrag(e,t);return n&&"fragment"in n?n.fragment:n}getNextFragment(e,t){const r=t.fragments,n=r.length;if(!n)return null;const{config:s}=this,a=r[0].start,o=s.lowLatencyMode&&!!t.partList;let l=null;if(t.live){const d=s.initialLiveManifestSize;if(n<d)return this.warn(`Not enough fragments to start playback (have: ${n}, need: ${d})`),null;if(!t.PTSKnown&&!this.startFragRequested&&this.startPosition===-1||e<a){var u;o&&!this.loadingParts&&(this.log("LL-Part loading ON for initial live fragment"),this.loadingParts=!0),l=this.getInitialLiveFragment(t);const p=this.hls.startPosition,g=this.hls.liveSyncPosition,m=l?(p!==-1&&p>=a?p:g)||l.start:e;this.log(`Setting startPosition to ${m} to match start frag at live edge. mainStart: ${p} liveSyncPosition: ${g} frag.start: ${(u=l)==null?void 0:u.start}`),this.startPosition=this.nextLoadPosition=m}}else e<=a&&(l=r[0]);if(!l){const d=this.loadingParts?t.partEnd:t.fragmentEnd;l=this.getFragmentAtPosition(e,d,t)}let h=this.filterReplacedPrimary(l,t);if(!h&&l){const d=l.sn-t.startSN;h=this.filterReplacedPrimary(r[d+1]||null,t)}return this.mapToInitFragWhenRequired(h)}isLoopLoading(e,t){const r=this.fragmentTracker.getState(e);return(r===nr.OK||r===nr.PARTIAL&&!!e.gap)&&this.nextLoadPosition>t}getNextFragmentLoopLoading(e,t,r,n,s){let a=null;if(e.gap&&(a=this.getNextFragment(this.nextLoadPosition,t),a&&!a.gap&&r.nextStart)){const o=this.getFwdBufferInfoAtPos(this.mediaBuffer?this.mediaBuffer:this.media,r.nextStart,n,0);if(o!==null&&r.len+o.len>=s){const l=a.sn;return this.loopSn!==l&&(this.log(`buffer full after gaps in "${n}" playlist starting at sn: ${l}`),this.loopSn=l),null}}return this.loopSn=void 0,a}get primaryPrefetch(){if(Gb(this.hls.config)){var e,t;if((e=this.hls.interstitialsManager)==null||(t=e.playingItem)==null?void 0:t.event)return!0}return!1}filterReplacedPrimary(e,t){if(!e)return e;if(Gb(this.hls.config)&&e.type!==ke.SUBTITLE){const r=this.hls.interstitialsManager,n=r==null?void 0:r.bufferingItem;if(n){const a=n.event;if(a){if(a.appendInPlace||Math.abs(e.start-n.start)>1||n.start===0)return null}else if(e.end<=n.start&&(t==null?void 0:t.live)===!1||e.start>n.end&&n.nextEvent&&(n.nextEvent.appendInPlace||e.start-n.end>1))return null}const s=r==null?void 0:r.playerQueue;if(s)for(let a=s.length;a--;){const o=s[a].interstitial;if(o.appendInPlace&&e.start>=o.startTime&&e.end<=o.resumeTime)return null}}return e}mapToInitFragWhenRequired(e){return e!=null&&e.initSegment&&!(e!=null&&e.initSegment.data)&&!this.bitrateTest?e.initSegment:e}getNextPart(e,t,r){let n=-1,s=!1,a=!0;for(let o=0,l=e.length;o<l;o++){const u=e[o];if(a=a&&!u.independent,n>-1&&r<u.start)break;const h=u.loaded;h?n=-1:(s||u.independent||a)&&u.fragment===t&&(n=o),s=h}return n}loadedEndOfParts(e,t){const r=e[e.length-1];return r&&t>r.start&&r.loaded}getInitialLiveFragment(e){const t=e.fragments,r=this.fragPrevious;let n=null;if(r){if(e.hasProgramDateTime&&(this.log(`Live playlist, switching playlist, load frag with same PDT: ${r.programDateTime}`),n=jw(t,r.endProgramDateTime,this.config.maxFragLookUpTolerance)),!n){const s=r.sn+1;if(s>=e.startSN&&s<=e.endSN){const a=t[s-e.startSN];r.cc===a.cc&&(n=a,this.log(`Live playlist, switching playlist, load frag with next SN: ${n.sn}`))}n||(n=nb(e,r.cc,r.end),n&&this.log(`Live playlist, switching playlist, load frag with same CC: ${n.sn}`))}}else{const s=this.hls.liveSyncPosition;s!==null&&(n=this.getFragmentAtPosition(s,this.bitrateTest?e.fragmentEnd:e.edge,e))}return n}getFragmentAtPosition(e,t,r){const{config:n}=this;let{fragPrevious:s}=this,{fragments:a,endSN:o}=r;const{fragmentHint:l}=r,{maxFragLookUpTolerance:u}=n,h=r.partList,d=!!(this.loadingParts&&h!=null&&h.length&&l);d&&l&&!this.bitrateTest&&h[h.length-1].fragment.sn===l.sn&&(a=a.concat(l),o=l.sn);let p;if(e<t){var g;const v=e<this.lastCurrentTime||e>t-u||(g=this.media)!=null&&g.paused||!this.startFragRequested?0:u;p=js(s,a,e,v)}else p=a[a.length-1];if(p){const m=p.sn-r.startSN,v=this.fragmentTracker.getState(p);if((v===nr.OK||v===nr.PARTIAL&&p.gap)&&(s=p),s&&p.sn===s.sn&&(!d||h[0].fragment.sn>p.sn||!r.live&&!d)&&s&&p.level===s.level){const A=a[m+1];p.sn<o&&this.fragmentTracker.getState(A)!==nr.OK?p=A:p=null}}return p}alignPlaylists(e,t,r){const n=e.fragments.length;if(!n)return this.warn("No fragments in live playlist"),0;const s=e.fragmentStart,a=!t,o=e.alignedSliding&&Ce(s);if(a||!o&&!s){_L(r,e);const l=e.fragmentStart;return this.log(`Live playlist sliding: ${l.toFixed(2)} start-sn: ${t?t.startSN:"na"}->${e.startSN} fragments: ${n}`),l}return s}waitForCdnTuneIn(e){return e.live&&e.canBlockReload&&e.partTarget&&e.tuneInGoal>Math.max(e.partHoldBack,e.partTarget*3)}setStartPosition(e,t){let r=this.startPosition;r<t&&(r=-1);const n=this.timelineOffset;if(r===-1){const s=this.startTimeOffset!==null,a=s?this.startTimeOffset:e.startTimeOffset;a!==null&&Ce(a)?(r=t+a,a<0&&(r+=e.edge),r=Math.min(Math.max(t,r),t+e.totalduration),this.log(`Setting startPosition to ${r} for start time offset ${a} found in ${s?"multivariant":"media"} playlist`),this.startPosition=r):e.live?(r=this.hls.liveSyncPosition||t,this.log(`Setting startPosition to -1 to start at live edge ${r}`),this.startPosition=-1):(this.log("setting startPosition to 0 by default"),this.startPosition=r=0),this.lastCurrentTime=r+n}this.nextLoadPosition=r+n}getLoadPosition(){var e;const{media:t}=this;let r=0;return(e=this.hls)!=null&&e.hasEnoughToStart&&t?r=t.currentTime:this.nextLoadPosition>=0&&(r=this.nextLoadPosition),r}handleFragLoadAborted(e,t){this.transmuxer&&e.type===this.playlistType&&pr(e)&&e.stats.aborted&&(this.warn(`Fragment ${e.sn}${t?" part "+t.index:""} of ${this.playlistLabel()} ${e.level} was aborted`),this.resetFragmentLoading(e))}resetFragmentLoading(e){(!this.fragCurrent||!this.fragContextChanged(e)&&this.state!==le.FRAG_LOADING_WAITING_RETRY)&&(this.state=le.IDLE)}onFragmentOrKeyLoadError(e,t){if(t.chunkMeta&&!t.frag){const m=this.getCurrentContext(t.chunkMeta);m&&(t.frag=m.frag)}const r=t.frag;if(!r||r.type!==e||!this.levels)return;if(this.fragContextChanged(r)){var n;this.warn(`Frag load error must match current frag to retry ${r.url} > ${(n=this.fragCurrent)==null?void 0:n.url}`);return}const s=t.details===Q.FRAG_GAP;s&&this.fragmentTracker.fragBuffered(r,!0);const a=t.errorAction,{action:o,flags:l,retryCount:u=0,retryConfig:h}=a||{},d=!!a&&!!h,p=d&&o===Rr.RetryRequest,g=d&&!a.resolved&&l===Li.MoveAllAlternatesMatchingHost;if(!p&&g&&pr(r)&&!r.endList)this.resetFragmentErrors(e),this.treatAsGap(r),a.resolved=!0;else if((p||g)&&u<h.maxNumRetry){this.resetStartWhenNotLoaded(this.levelLastLoaded);const m=sg(h,u);this.warn(`Fragment ${r.sn} of ${e} ${r.level} errored with ${t.details}, retrying loading ${u+1}/${h.maxNumRetry} in ${m}ms`),a.resolved=!0,this.retryDate=self.performance.now()+m,this.state=le.FRAG_LOADING_WAITING_RETRY}else if(h&&a)if(this.resetFragmentErrors(e),u<h.maxNumRetry)!s&&o!==Rr.RemoveAlternatePermanently&&(a.resolved=!0);else{this.warn(`${t.details} reached or exceeded max retry (${u})`);return}else o===Rr.SendAlternateToPenaltyBox?this.state=le.WAITING_LEVEL:this.state=le.ERROR;this.tickImmediate()}reduceLengthAndFlushBuffer(e){if(this.state===le.PARSING||this.state===le.PARSED){const t=e.frag,r=e.parent,n=this.getFwdBufferInfo(this.mediaBuffer,r),s=n&&n.len>.5;s&&this.reduceMaxBufferLength(n.len,(t==null?void 0:t.duration)||10);const a=!s;return a&&this.warn(`Buffer full error while media.currentTime is not buffered, flush ${r} buffer`),t&&(this.fragmentTracker.removeFragment(t),this.nextLoadPosition=t.start),this.resetLoadingState(),a}return!1}resetFragmentErrors(e){e===ke.AUDIO&&(this.fragCurrent=null),this.hls.hasEnoughToStart||(this.startFragRequested=!1),this.state!==le.STOPPED&&(this.state=le.IDLE)}afterBufferFlushed(e,t,r){if(!e)return;const n=Xe.getBuffered(e);this.fragmentTracker.detectEvictedFragments(t,n,r),this.state===le.ENDED&&this.resetLoadingState()}resetLoadingState(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state!==le.STOPPED&&(this.state=le.IDLE)}resetStartWhenNotLoaded(e){if(!this.hls.hasEnoughToStart){this.startFragRequested=!1;const t=e?e.details:null;t!=null&&t.live?(this.log("resetting startPosition for live start"),this.startPosition=-1,this.setStartPosition(t,t.fragmentStart),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}}resetWhenMissingContext(e){this.warn(`The loading context changed while buffering fragment ${e.sn} of ${this.playlistLabel()} ${e.level}. This chunk will not be buffered.`),this.removeUnbufferedFrags(),this.resetStartWhenNotLoaded(this.levelLastLoaded),this.resetLoadingState()}removeUnbufferedFrags(e=0){this.fragmentTracker.removeFragmentsInRange(e,1/0,this.playlistType,!1,!0)}updateLevelTiming(e,t,r,n){const s=r.details;if(!s){this.warn("level.details undefined");return}if(!Object.keys(e.elementaryStreams).reduce((l,u)=>{const h=e.elementaryStreams[u];if(h){const d=h.endPTS-h.startPTS;if(d<=0)return this.warn(`Could not parse fragment ${e.sn} ${u} duration reliably (${d})`),l||!1;const p=n?0:wb(s,e,h.startPTS,h.endPTS,h.startDTS,h.endDTS);return this.hls.trigger(x.LEVEL_PTS_UPDATED,{details:s,level:r,drift:p,type:u,frag:e,start:h.startPTS,end:h.endPTS}),!0}return l},!1)){var o;if(r.fragmentError===0&&this.treatAsGap(e,r),((o=this.transmuxer)==null?void 0:o.error)===null){const l=new Error(`Found no media in fragment ${e.sn} of ${this.playlistLabel()} ${e.level} resetting transmuxer to fallback to playlist timing`);if(this.warn(l.message),this.hls.trigger(x.ERROR,{type:Fe.MEDIA_ERROR,details:Q.FRAG_PARSING_ERROR,fatal:!1,error:l,frag:e,reason:`Found no media in msn ${e.sn} of ${this.playlistLabel()} "${r.url}"`}),!this.hls)return;this.resetTransmuxer()}}this.state=le.PARSED,this.log(`Parsed ${e.type} sn: ${e.sn}${t?" part: "+t.index:""} of ${this.fragInfo(e,!1,t)})`),this.hls.trigger(x.FRAG_PARSED,{frag:e,part:t})}playlistLabel(){return this.playlistType===ke.MAIN?"level":"track"}fragInfo(e,t=!0,r){var n,s;return`${this.playlistLabel()} ${e.level} (${r?"part":"frag"}:[${((n=t&&!r?e.startPTS:(r||e).start)!=null?n:NaN).toFixed(3)}-${((s=t&&!r?e.endPTS:(r||e).end)!=null?s:NaN).toFixed(3)}]${r&&e.type==="main"?"INDEPENDENT="+(r.independent?"YES":"NO"):""}`}treatAsGap(e,t){t&&t.fragmentError++,e.gap=!0,this.fragmentTracker.removeFragment(e),this.fragmentTracker.fragBuffered(e,!0)}resetTransmuxer(){var e;(e=this.transmuxer)==null||e.reset()}recoverWorkerError(e){e.event==="demuxerWorker"&&(this.fragmentTracker.removeAllFragments(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),this.resetStartWhenNotLoaded(this.levelLastLoaded),this.resetLoadingState())}set state(e){const t=this._state;t!==e&&(this._state=e,this.log(`${t}->${e}`))}get state(){return this._state}}function Gb(i){return!!i.interstitialsController&&i.enableInterstitialPlayback!==!1}class qb{constructor(){this.chunks=[],this.dataLength=0}push(e){this.chunks.push(e),this.dataLength+=e.length}flush(){const{chunks:e,dataLength:t}=this;let r;if(e.length)e.length===1?r=e[0]:r=PL(e,t);else return new Uint8Array(0);return this.reset(),r}reset(){this.chunks.length=0,this.dataLength=0}}function PL(i,e){const t=new Uint8Array(e);let r=0;for(let n=0;n<i.length;n++){const s=i[n];t.set(s,r),r+=s.length}return t}var vg={exports:{}},Vb;function kL(){return Vb||(Vb=1,function(i){var e=Object.prototype.hasOwnProperty,t="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(t=!1));function n(l,u,h){this.fn=l,this.context=u,this.once=h||!1}function s(l,u,h,d,p){if(typeof h!="function")throw new TypeError("The listener must be a function");var g=new n(h,d||l,p),m=t?t+u:u;return l._events[m]?l._events[m].fn?l._events[m]=[l._events[m],g]:l._events[m].push(g):(l._events[m]=g,l._eventsCount++),l}function a(l,u){--l._eventsCount===0?l._events=new r:delete l._events[u]}function o(){this._events=new r,this._eventsCount=0}o.prototype.eventNames=function(){var u=[],h,d;if(this._eventsCount===0)return u;for(d in h=this._events)e.call(h,d)&&u.push(t?d.slice(1):d);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(h)):u},o.prototype.listeners=function(u){var h=t?t+u:u,d=this._events[h];if(!d)return[];if(d.fn)return[d.fn];for(var p=0,g=d.length,m=new Array(g);p<g;p++)m[p]=d[p].fn;return m},o.prototype.listenerCount=function(u){var h=t?t+u:u,d=this._events[h];return d?d.fn?1:d.length:0},o.prototype.emit=function(u,h,d,p,g,m){var v=t?t+u:u;if(!this._events[v])return!1;var E=this._events[v],A=arguments.length,D,R;if(E.fn){switch(E.once&&this.removeListener(u,E.fn,void 0,!0),A){case 1:return E.fn.call(E.context),!0;case 2:return E.fn.call(E.context,h),!0;case 3:return E.fn.call(E.context,h,d),!0;case 4:return E.fn.call(E.context,h,d,p),!0;case 5:return E.fn.call(E.context,h,d,p,g),!0;case 6:return E.fn.call(E.context,h,d,p,g,m),!0}for(R=1,D=new Array(A-1);R<A;R++)D[R-1]=arguments[R];E.fn.apply(E.context,D)}else{var _=E.length,F;for(R=0;R<_;R++)switch(E[R].once&&this.removeListener(u,E[R].fn,void 0,!0),A){case 1:E[R].fn.call(E[R].context);break;case 2:E[R].fn.call(E[R].context,h);break;case 3:E[R].fn.call(E[R].context,h,d);break;case 4:E[R].fn.call(E[R].context,h,d,p);break;default:if(!D)for(F=1,D=new Array(A-1);F<A;F++)D[F-1]=arguments[F];E[R].fn.apply(E[R].context,D)}}return!0},o.prototype.on=function(u,h,d){return s(this,u,h,d,!1)},o.prototype.once=function(u,h,d){return s(this,u,h,d,!0)},o.prototype.removeListener=function(u,h,d,p){var g=t?t+u:u;if(!this._events[g])return this;if(!h)return a(this,g),this;var m=this._events[g];if(m.fn)m.fn===h&&(!p||m.once)&&(!d||m.context===d)&&a(this,g);else{for(var v=0,E=[],A=m.length;v<A;v++)(m[v].fn!==h||p&&!m[v].once||d&&m[v].context!==d)&&E.push(m[v]);E.length?this._events[g]=E.length===1?E[0]:E:a(this,g)}return this},o.prototype.removeAllListeners=function(u){var h;return u?(h=t?t+u:u,this._events[h]&&a(this,h)):(this._events=new r,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=t,o.EventEmitter=o,i.exports=o}(vg)),vg.exports}var OL=kL(),Eg=dw(OL);const il="1.6.5",Ga={};function FL(){return typeof __HLS_WORKER_BUNDLE__=="function"}function BL(){const i=Ga[il];if(i)return i.clientCount++,i;const e=new self.Blob([`var exports={};var module={exports:exports};function define(f){f()};define.amd=true;(${__HLS_WORKER_BUNDLE__.toString()})(true);`],{type:"text/javascript"}),t=self.URL.createObjectURL(e),n={worker:new self.Worker(t),objectURL:t,clientCount:1};return Ga[il]=n,n}function UL(i){const e=Ga[i];if(e)return e.clientCount++,e;const t=new self.URL(i,self.location.href).href,n={worker:new self.Worker(t),scriptURL:t,clientCount:1};return Ga[i]=n,n}function $L(i){const e=Ga[i||il];if(e&&e.clientCount--===1){const{worker:r,objectURL:n}=e;delete Ga[i||il],n&&self.URL.revokeObjectURL(n),r.terminate()}}function Hb(i,e){return e+10<=i.length&&i[e]===51&&i[e+1]===68&&i[e+2]===73&&i[e+3]<255&&i[e+4]<255&&i[e+6]<128&&i[e+7]<128&&i[e+8]<128&&i[e+9]<128}function bg(i,e){return e+10<=i.length&&i[e]===73&&i[e+1]===68&&i[e+2]===51&&i[e+3]<255&&i[e+4]<255&&i[e+6]<128&&i[e+7]<128&&i[e+8]<128&&i[e+9]<128}function Ju(i,e){let t=0;return t=(i[e]&127)<<21,t|=(i[e+1]&127)<<14,t|=(i[e+2]&127)<<7,t|=i[e+3]&127,t}function nl(i,e){const t=e;let r=0;for(;bg(i,e);){r+=10;const n=Ju(i,e+6);r+=n,Hb(i,e+10)&&(r+=10),e+=r}if(r>0)return i.subarray(t,t+r)}function GL(i,e,t,r){const n=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],s=e[t+2],a=s>>2&15;if(a>12){const g=new Error(`invalid ADTS sampling index:${a}`);i.emit(x.ERROR,x.ERROR,{type:Fe.MEDIA_ERROR,details:Q.FRAG_PARSING_ERROR,fatal:!0,error:g,reason:g.message});return}const o=(s>>6&3)+1,l=e[t+3]>>6&3|(s&1)<<2,u="mp4a.40."+o,h=n[a];let d=a;(o===5||o===29)&&(d-=3);const p=[o<<3|(d&14)>>1,(d&1)<<7|l<<3];return mt.log(`manifest codec:${r}, parsed codec:${u}, channels:${l}, rate:${h} (ADTS object type:${o} sampling index:${a})`),{config:p,samplerate:h,channelCount:l,codec:u,parsedCodec:u,manifestCodec:r}}function Kb(i,e){return i[e]===255&&(i[e+1]&246)===240}function Wb(i,e){return i[e+1]&1?7:9}function Ag(i,e){return(i[e+3]&3)<<11|i[e+4]<<3|(i[e+5]&224)>>>5}function qL(i,e){return e+5<i.length}function Qu(i,e){return e+1<i.length&&Kb(i,e)}function VL(i,e){return qL(i,e)&&Kb(i,e)&&Ag(i,e)<=i.length-e}function HL(i,e){if(Qu(i,e)){const t=Wb(i,e);if(e+t>=i.length)return!1;const r=Ag(i,e);if(r<=t)return!1;const n=e+r;return n===i.length||Qu(i,n)}return!1}function Yb(i,e,t,r,n){if(!i.samplerate){const s=GL(e,t,r,n);if(!s)return;xt(i,s)}}function Xb(i){return 9216e4/i}function KL(i,e){const t=Wb(i,e);if(e+t<=i.length){const r=Ag(i,e)-t;if(r>0)return{headerLength:t,frameLength:r}}}function jb(i,e,t,r,n){const s=Xb(i.samplerate),a=r+n*s,o=KL(e,t);let l;if(o){const{frameLength:d,headerLength:p}=o,g=p+d,m=Math.max(0,t+g-e.length);m?(l=new Uint8Array(g-p),l.set(e.subarray(t+p,e.length),0)):l=e.subarray(t+p,t+g);const v={unit:l,pts:a};return m||i.samples.push(v),{sample:v,length:g,missing:m}}const u=e.length-t;return l=new Uint8Array(u),l.set(e.subarray(t,e.length),0),{sample:{unit:l,pts:a},length:u,missing:-1}}function WL(i,e){return bg(i,e)&&Ju(i,e+6)+10<=i.length-e}function YL(i){return i instanceof ArrayBuffer?i:i.byteOffset==0&&i.byteLength==i.buffer.byteLength?i.buffer:new Uint8Array(i).buffer}function Sg(i,e=0,t=1/0){return XL(i,e,t,Uint8Array)}function XL(i,e,t,r){const n=jL(i);let s=1;"BYTES_PER_ELEMENT"in r&&(s=r.BYTES_PER_ELEMENT);const a=zL(i)?i.byteOffset:0,o=(a+i.byteLength)/s,l=(a+e)/s,u=Math.floor(Math.max(0,Math.min(l,o))),h=Math.floor(Math.min(u+Math.max(t,0),o));return new r(n,u,h-u)}function jL(i){return i instanceof ArrayBuffer?i:i.buffer}function zL(i){return i&&i.buffer instanceof ArrayBuffer&&i.byteLength!==void 0&&i.byteOffset!==void 0}function JL(i){const e={key:i.type,description:"",data:"",mimeType:null,pictureType:null},t=3;if(i.size<2)return;if(i.data[0]!==t){console.log("Ignore frame with unrecognized character encoding");return}const r=i.data.subarray(1).indexOf(0);if(r===-1)return;const n=ii(Sg(i.data,1,r)),s=i.data[2+r],a=i.data.subarray(3+r).indexOf(0);if(a===-1)return;const o=ii(Sg(i.data,3+r,a));let l;return n==="-->"?l=ii(Sg(i.data,4+r+a)):l=YL(i.data.subarray(4+r+a)),e.mimeType=n,e.pictureType=s,e.description=o,e.data=l,e}function QL(i){if(i.size<2)return;const e=ii(i.data,!0),t=new Uint8Array(i.data.subarray(e.length+1));return{key:i.type,info:e,data:t.buffer}}function ZL(i){if(i.size<2)return;if(i.type==="TXXX"){let t=1;const r=ii(i.data.subarray(t),!0);t+=r.length+1;const n=ii(i.data.subarray(t));return{key:i.type,info:r,data:n}}const e=ii(i.data.subarray(1));return{key:i.type,info:"",data:e}}function e_(i){if(i.type==="WXXX"){if(i.size<2)return;let t=1;const r=ii(i.data.subarray(t),!0);t+=r.length+1;const n=ii(i.data.subarray(t));return{key:i.type,info:r,data:n}}const e=ii(i.data);return{key:i.type,info:"",data:e}}function t_(i){return i.type==="PRIV"?QL(i):i.type[0]==="W"?e_(i):i.type==="APIC"?JL(i):ZL(i)}function r_(i){const e=String.fromCharCode(i[0],i[1],i[2],i[3]),t=Ju(i,4),r=10;return{type:e,size:t,data:i.subarray(r,r+t)}}const Zu=10,i_=10;function zb(i){let e=0;const t=[];for(;bg(i,e);){const r=Ju(i,e+6);i[e+5]>>6&1&&(e+=Zu),e+=Zu;const n=e+r;for(;e+i_<n;){const s=r_(i.subarray(e)),a=t_(s);a&&t.push(a),e+=s.size+Zu}Hb(i,e)&&(e+=Zu)}return t}function Jb(i){return i&&i.key==="PRIV"&&i.info==="com.apple.streaming.transportStreamTimestamp"}function n_(i){if(i.data.byteLength===8){const e=new Uint8Array(i.data),t=e[3]&1;let r=(e[4]<<23)+(e[5]<<15)+(e[6]<<7)+e[7];return r/=45,t&&(r+=4772185884e-2),Math.round(r)}}function xg(i){const e=zb(i);for(let t=0;t<e.length;t++){const r=e[t];if(Jb(r))return n_(r)}}let ni=function(i){return i.audioId3="org.id3",i.dateRange="com.apple.quicktime.HLS",i.emsg="https://aomedia.org/emsg/ID3",i.misbklv="urn:misb:KLV:bin:1910.1",i}({});function ln(i="",e=9e4){return{type:i,id:-1,pid:-1,inputTimeScale:e,sequenceNumber:-1,samples:[],dropped:0}}class Tg{constructor(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}resetInitSegment(e,t,r,n){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}}resetTimeStamp(e){this.initPTS=e,this.resetContiguity()}resetContiguity(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0}canParse(e,t){return!1}appendFrame(e,t,r){}demux(e,t){this.cachedData&&(e=pi(this.cachedData,e),this.cachedData=null);let r=nl(e,0),n=r?r.length:0,s;const a=this._audioTrack,o=this._id3Track,l=r?xg(r):void 0,u=e.length;for((this.basePTS===null||this.frameIndex===0&&Ce(l))&&(this.basePTS=s_(l,t,this.initPTS),this.lastPTS=this.basePTS),this.lastPTS===null&&(this.lastPTS=this.basePTS),r&&r.length>0&&o.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:r,type:ni.audioId3,duration:Number.POSITIVE_INFINITY});n<u;){if(this.canParse(e,n)){const h=this.appendFrame(a,e,n);h?(this.frameIndex++,this.lastPTS=h.sample.pts,n+=h.length,s=n):n=u}else WL(e,n)?(r=nl(e,n),o.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:r,type:ni.audioId3,duration:Number.POSITIVE_INFINITY}),n+=r.length,s=n):n++;if(n===u&&s!==u){const h=e.slice(s);this.cachedData?this.cachedData=pi(this.cachedData,h):this.cachedData=h}}return{audioTrack:a,videoTrack:ln(),id3Track:o,textTrack:ln()}}demuxSampleAes(e,t,r){return Promise.reject(new Error(`[${this}] This demuxer does not support Sample-AES decryption`))}flush(e){const t=this.cachedData;return t&&(this.cachedData=null,this.demux(t,0)),{audioTrack:this._audioTrack,videoTrack:ln(),id3Track:this._id3Track,textTrack:ln()}}destroy(){this.cachedData=null,this._audioTrack=this._id3Track=void 0}}const s_=(i,e,t)=>{if(Ce(i))return i*90;const r=t?t.baseTime*9e4/t.timescale:0;return e*9e4+r};let ec=null;const a_=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],o_=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],l_=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],u_=[0,1,1,4];function Qb(i,e,t,r,n){if(t+24>e.length)return;const s=Zb(e,t);if(s&&t+s.frameLength<=e.length){const a=s.samplesPerFrame*9e4/s.sampleRate,o=r+n*a,l={unit:e.subarray(t,t+s.frameLength),pts:o,dts:o};return i.config=[],i.channelCount=s.channelCount,i.samplerate=s.sampleRate,i.samples.push(l),{sample:l,length:s.frameLength,missing:0}}}function Zb(i,e){const t=i[e+1]>>3&3,r=i[e+1]>>1&3,n=i[e+2]>>4&15,s=i[e+2]>>2&3;if(t!==1&&n!==0&&n!==15&&s!==3){const a=i[e+2]>>1&1,o=i[e+3]>>6,l=t===3?3-r:r===3?3:4,u=a_[l*14+n-1]*1e3,d=o_[(t===3?0:t===2?1:2)*3+s],p=o===3?1:2,g=l_[t][r],m=u_[r],v=g*8*m,E=Math.floor(g*u/d+a)*m;if(ec===null){const R=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);ec=R?parseInt(R[1]):0}return!!ec&&ec<=87&&r===2&&u>=224e3&&o===0&&(i[e+3]=i[e+3]|128),{sampleRate:d,channelCount:p,frameLength:E,samplesPerFrame:v}}}function Dg(i,e){return i[e]===255&&(i[e+1]&224)===224&&(i[e+1]&6)!==0}function eA(i,e){return e+1<i.length&&Dg(i,e)}function c_(i,e){return Dg(i,e)&&4<=i.length-e}function tA(i,e){if(e+1<i.length&&Dg(i,e)){const r=Zb(i,e);let n=4;r!=null&&r.frameLength&&(n=r.frameLength);const s=e+n;return s===i.length||eA(i,s)}return!1}class h_ extends Tg{constructor(e,t){super(),this.observer=void 0,this.config=void 0,this.observer=e,this.config=t}resetInitSegment(e,t,r,n){super.resetInitSegment(e,t,r,n),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:t,duration:n,inputTimeScale:9e4,dropped:0}}static probe(e,t){if(!e)return!1;const r=nl(e,0);let n=(r==null?void 0:r.length)||0;if(tA(e,n))return!1;for(let s=e.length;n<s;n++)if(HL(e,n))return t.log("ADTS sync word found !"),!0;return!1}canParse(e,t){return VL(e,t)}appendFrame(e,t,r){Yb(e,this.observer,t,r,e.manifestCodec);const n=jb(e,t,r,this.basePTS,this.frameIndex);if(n&&n.missing===0)return n}}const rA=(i,e)=>{let t=0,r=5;e+=r;const n=new Uint32Array(1),s=new Uint32Array(1),a=new Uint8Array(1);for(;r>0;){a[0]=i[e];const o=Math.min(r,8),l=8-o;s[0]=4278190080>>>24+l<<l,n[0]=(a[0]&s[0])>>l,t=t?t<<o|n[0]:n[0],e+=1,r-=o}return t};class d_ extends Tg{constructor(e){super(),this.observer=void 0,this.observer=e}resetInitSegment(e,t,r,n){super.resetInitSegment(e,t,r,n),this._audioTrack={container:"audio/ac-3",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"ac3",samples:[],manifestCodec:t,duration:n,inputTimeScale:9e4,dropped:0}}canParse(e,t){return t+64<e.length}appendFrame(e,t,r){const n=iA(e,t,r,this.basePTS,this.frameIndex);if(n!==-1)return{sample:e.samples[e.samples.length-1],length:n,missing:0}}static probe(e){if(!e)return!1;const t=nl(e,0);if(!t)return!1;const r=t.length;return e[r]===11&&e[r+1]===119&&xg(t)!==void 0&&rA(e,r)<16}}function iA(i,e,t,r,n){if(t+8>e.length||e[t]!==11||e[t+1]!==119)return-1;const s=e[t+4]>>6;if(s>=3)return-1;const o=[48e3,44100,32e3][s],l=e[t+4]&63,h=[64,69,96,64,70,96,80,87,120,80,88,120,96,104,144,96,105,144,112,121,168,112,122,168,128,139,192,128,140,192,160,174,240,160,175,240,192,208,288,192,209,288,224,243,336,224,244,336,256,278,384,256,279,384,320,348,480,320,349,480,384,417,576,384,418,576,448,487,672,448,488,672,512,557,768,512,558,768,640,696,960,640,697,960,768,835,1152,768,836,1152,896,975,1344,896,976,1344,1024,1114,1536,1024,1115,1536,1152,1253,1728,1152,1254,1728,1280,1393,1920,1280,1394,1920][l*3+s]*2;if(t+h>e.length)return-1;const d=e[t+6]>>5;let p=0;d===2?p+=2:(d&1&&d!==1&&(p+=2),d&4&&(p+=2));const g=(e[t+6]<<8|e[t+7])>>12-p&1,v=[2,1,2,3,3,4,4,5][d]+g,E=e[t+5]>>3,A=e[t+5]&7,D=new Uint8Array([s<<6|E<<1|A>>2,(A&3)<<6|d<<3|g<<2|l>>4,l<<4&224]),R=1536/o*9e4,_=r+n*R,F=e.subarray(t,t+h);return i.config=D,i.channelCount=v,i.samplerate=o,i.samples.push({unit:F,pts:_}),h}class f_ extends Tg{resetInitSegment(e,t,r,n){super.resetInitSegment(e,t,r,n),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:t,duration:n,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;const t=nl(e,0);let r=(t==null?void 0:t.length)||0;if(t&&e[r]===11&&e[r+1]===119&&xg(t)!==void 0&&rA(e,r)<=16)return!1;for(let n=e.length;r<n;r++)if(tA(e,r))return mt.log("MPEG Audio sync word found !"),!0;return!1}canParse(e,t){return c_(e,t)}appendFrame(e,t,r){if(this.basePTS!==null)return Qb(e,t,r,this.basePTS,this.frameIndex)}}const g_=/\/emsg[-/]ID3/i;class p_{constructor(e,t){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=t}resetTimeStamp(){}resetInitSegment(e,t,r,n){const s=this.videoTrack=ln("video",1),a=this.audioTrack=ln("audio",1),o=this.txtTrack=ln("text",1);if(this.id3Track=ln("id3",1),this.timeOffset=0,!(e!=null&&e.byteLength))return;const l=OE(e);if(l.video){const{id:u,timescale:h,codec:d,supplemental:p}=l.video;s.id=u,s.timescale=o.timescale=h,s.codec=d,s.supplemental=p}if(l.audio){const{id:u,timescale:h,codec:d}=l.audio;a.id=u,a.timescale=h,a.codec=d}o.id=_E.text,s.sampleDuration=0,s.duration=a.duration=n}resetContiguity(){this.remainderData=null}static probe(e){return yw(e)}demux(e,t){this.timeOffset=t;let r=e;const n=this.videoTrack,s=this.txtTrack;if(this.config.progressive){this.remainderData&&(r=pi(this.remainderData,e));const o=Tw(r);this.remainderData=o.remainder,n.samples=o.valid||new Uint8Array}else n.samples=r;const a=this.extractID3Track(n,t);return s.samples=BE(t,n),{videoTrack:n,audioTrack:this.audioTrack,id3Track:a,textTrack:this.txtTrack}}flush(){const e=this.timeOffset,t=this.videoTrack,r=this.txtTrack;t.samples=this.remainderData||new Uint8Array,this.remainderData=null;const n=this.extractID3Track(t,this.timeOffset);return r.samples=BE(e,t),{videoTrack:t,audioTrack:ln(),id3Track:n,textTrack:ln()}}extractID3Track(e,t){const r=this.id3Track;if(e.samples.length){const n=Qe(e.samples,["emsg"]);n&&n.forEach(s=>{const a=Rw(s);if(g_.test(a.schemeIdUri)){const o=nA(a,t);let l=a.eventDuration===4294967295?Number.POSITIVE_INFINITY:a.eventDuration/a.timeScale;l<=.001&&(l=Number.POSITIVE_INFINITY);const u=a.payload;r.samples.push({data:u,len:u.byteLength,dts:o,pts:o,type:ni.emsg,duration:l})}else if(this.config.enableEmsgKLVMetadata&&a.schemeIdUri.startsWith("urn:misb:KLV:bin:1910.1")){const o=nA(a,t);r.samples.push({data:a.payload,len:a.payload.byteLength,dts:o,pts:o,type:ni.misbklv,duration:Number.POSITIVE_INFINITY})}})}return r}demuxSampleAes(e,t,r){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))}destroy(){this.config=null,this.remainderData=null,this.videoTrack=this.audioTrack=this.id3Track=this.txtTrack=void 0}}function nA(i,e){return Ce(i.presentationTime)?i.presentationTime/i.timeScale:e+i.presentationTimeDelta/i.timeScale}class m_{constructor(e,t,r){this.keyData=void 0,this.decrypter=void 0,this.keyData=r,this.decrypter=new ag(t,{removePKCS7Padding:!1})}decryptBuffer(e){return this.decrypter.decrypt(e,this.keyData.key.buffer,this.keyData.iv.buffer,ds.cbc)}decryptAacSample(e,t,r){const n=e[t].unit;if(n.length<=16)return;const s=n.subarray(16,n.length-n.length%16),a=s.buffer.slice(s.byteOffset,s.byteOffset+s.length);this.decryptBuffer(a).then(o=>{const l=new Uint8Array(o);n.set(l,16),this.decrypter.isSync()||this.decryptAacSamples(e,t+1,r)})}decryptAacSamples(e,t,r){for(;;t++){if(t>=e.length){r();return}if(!(e[t].unit.length<32)&&(this.decryptAacSample(e,t,r),!this.decrypter.isSync()))return}}getAvcEncryptedData(e){const t=Math.floor((e.length-48)/160)*16+16,r=new Int8Array(t);let n=0;for(let s=32;s<e.length-16;s+=160,n+=16)r.set(e.subarray(s,s+16),n);return r}getAvcDecryptedUnit(e,t){const r=new Uint8Array(t);let n=0;for(let s=32;s<e.length-16;s+=160,n+=16)e.set(r.subarray(n,n+16),s);return e}decryptAvcSample(e,t,r,n,s){const a=UE(s.data),o=this.getAvcEncryptedData(a);this.decryptBuffer(o.buffer).then(l=>{s.data=this.getAvcDecryptedUnit(a,l),this.decrypter.isSync()||this.decryptAvcSamples(e,t,r+1,n)})}decryptAvcSamples(e,t,r,n){if(e instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;t++,r=0){if(t>=e.length){n();return}const s=e[t].units;for(;!(r>=s.length);r++){const a=s[r];if(!(a.data.length<=48||a.type!==1&&a.type!==5)&&(this.decryptAvcSample(e,t,r,n,a),!this.decrypter.isSync()))return}}}}class sA{constructor(){this.VideoSample=null}createVideoSample(e,t,r){return{key:e,frame:!1,pts:t,dts:r,units:[],length:0}}getLastNalUnit(e){var t;let r=this.VideoSample,n;if((!r||r.units.length===0)&&(r=e[e.length-1]),(t=r)!=null&&t.units){const s=r.units;n=s[s.length-1]}return n}pushAccessUnit(e,t){if(e.units.length&&e.frame){if(e.pts===void 0){const r=t.samples,n=r.length;if(n){const s=r[n-1];e.pts=s.pts,e.dts=s.dts}else{t.dropped++;return}}t.samples.push(e)}}parseNALu(e,t,r){const n=t.byteLength;let s=e.naluState||0;const a=s,o=[];let l=0,u,h,d,p=-1,g=0;for(s===-1&&(p=0,g=this.getNALuType(t,0),s=0,l=1);l<n;){if(u=t[l++],!s){s=u?0:1;continue}if(s===1){s=u?0:2;continue}if(!u)s=3;else if(u===1){if(h=l-s-1,p>=0){const m={data:t.subarray(p,h),type:g};o.push(m)}else{const m=this.getLastNalUnit(e.samples);m&&(a&&l<=4-a&&m.state&&(m.data=m.data.subarray(0,m.data.byteLength-a)),h>0&&(m.data=pi(m.data,t.subarray(0,h)),m.state=0))}l<n?(d=this.getNALuType(t,l),p=l,g=d,s=0):s=-1}else s=0}if(p>=0&&s>=0){const m={data:t.subarray(p,n),type:g,state:s};o.push(m)}if(o.length===0){const m=this.getLastNalUnit(e.samples);m&&(m.data=pi(m.data,t))}return e.naluState=s,o}}class sl{constructor(e){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}loadWord(){const e=this.data,t=this.bytesAvailable,r=e.byteLength-t,n=new Uint8Array(4),s=Math.min(4,t);if(s===0)throw new Error("no bytes available");n.set(e.subarray(r,r+s)),this.word=new DataView(n.buffer).getUint32(0),this.bitsAvailable=s*8,this.bytesAvailable-=s}skipBits(e){let t;e=Math.min(e,this.bytesAvailable*8+this.bitsAvailable),this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(e-=this.bitsAvailable,t=e>>3,e-=t<<3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)}readBits(e){let t=Math.min(this.bitsAvailable,e);const r=this.word>>>32-t;if(e>32&&mt.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0)this.word<<=t;else if(this.bytesAvailable>0)this.loadWord();else throw new Error("no bits available");return t=e-t,t>0&&this.bitsAvailable?r<<t|this.readBits(t):r}skipLZ(){let e;for(e=0;e<this.bitsAvailable;++e)if((this.word&2147483648>>>e)!==0)return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()}skipUEG(){this.skipBits(1+this.skipLZ())}skipEG(){this.skipBits(1+this.skipLZ())}readUEG(){const e=this.skipLZ();return this.readBits(e+1)-1}readEG(){const e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)}readBoolean(){return this.readBits(1)===1}readUByte(){return this.readBits(8)}readUShort(){return this.readBits(16)}readUInt(){return this.readBits(32)}}class aA extends sA{parsePES(e,t,r,n){const s=this.parseNALu(e,r.data,n);let a=this.VideoSample,o,l=!1;r.data=null,a&&s.length&&!e.audFound&&(this.pushAccessUnit(a,e),a=this.VideoSample=this.createVideoSample(!1,r.pts,r.dts)),s.forEach(u=>{var h,d;switch(u.type){case 1:{let v=!1;o=!0;const E=u.data;if(l&&E.length>4){const A=this.readSliceType(E);(A===2||A===4||A===7||A===9)&&(v=!0)}if(v){var p;(p=a)!=null&&p.frame&&!a.key&&(this.pushAccessUnit(a,e),a=this.VideoSample=null)}a||(a=this.VideoSample=this.createVideoSample(!0,r.pts,r.dts)),a.frame=!0,a.key=v;break}case 5:o=!0,(h=a)!=null&&h.frame&&!a.key&&(this.pushAccessUnit(a,e),a=this.VideoSample=null),a||(a=this.VideoSample=this.createVideoSample(!0,r.pts,r.dts)),a.key=!0,a.frame=!0;break;case 6:{o=!0,tg(u.data,1,r.pts,t.samples);break}case 7:{var g,m;o=!0,l=!0;const v=u.data,E=this.readSPS(v);if(!e.sps||e.width!==E.width||e.height!==E.height||((g=e.pixelRatio)==null?void 0:g[0])!==E.pixelRatio[0]||((m=e.pixelRatio)==null?void 0:m[1])!==E.pixelRatio[1]){e.width=E.width,e.height=E.height,e.pixelRatio=E.pixelRatio,e.sps=[v];const A=v.subarray(1,4);let D="avc1.";for(let R=0;R<3;R++){let _=A[R].toString(16);_.length<2&&(_="0"+_),D+=_}e.codec=D}break}case 8:o=!0,e.pps=[u.data];break;case 9:o=!0,e.audFound=!0,(d=a)!=null&&d.frame&&(this.pushAccessUnit(a,e),a=null),a||(a=this.VideoSample=this.createVideoSample(!1,r.pts,r.dts));break;case 12:o=!0;break;default:o=!1;break}a&&o&&a.units.push(u)}),n&&a&&(this.pushAccessUnit(a,e),this.VideoSample=null)}getNALuType(e,t){return e[t]&31}readSliceType(e){const t=new sl(e);return t.readUByte(),t.readUEG(),t.readUEG()}skipScalingList(e,t){let r=8,n=8,s;for(let a=0;a<e;a++)n!==0&&(s=t.readEG(),n=(r+s+256)%256),r=n===0?r:n}readSPS(e){const t=new sl(e);let r=0,n=0,s=0,a=0,o,l,u;const h=t.readUByte.bind(t),d=t.readBits.bind(t),p=t.readUEG.bind(t),g=t.readBoolean.bind(t),m=t.skipBits.bind(t),v=t.skipEG.bind(t),E=t.skipUEG.bind(t),A=this.skipScalingList.bind(this);h();const D=h();if(d(5),m(3),h(),E(),D===100||D===110||D===122||D===244||D===44||D===83||D===86||D===118||D===128){const M=p();if(M===3&&m(1),E(),E(),m(1),g())for(l=M!==3?8:12,u=0;u<l;u++)g()&&(u<6?A(16,t):A(64,t))}E();const R=p();if(R===0)p();else if(R===1)for(m(1),v(),v(),o=p(),u=0;u<o;u++)v();E(),m(1);const _=p(),F=p(),w=d(1);w===0&&m(1),m(1),g()&&(r=p(),n=p(),s=p(),a=p());let C=[1,1];if(g()&&g())switch(h()){case 1:C=[1,1];break;case 2:C=[12,11];break;case 3:C=[10,11];break;case 4:C=[16,11];break;case 5:C=[40,33];break;case 6:C=[24,11];break;case 7:C=[20,11];break;case 8:C=[32,11];break;case 9:C=[80,33];break;case 10:C=[18,11];break;case 11:C=[15,11];break;case 12:C=[64,33];break;case 13:C=[160,99];break;case 14:C=[4,3];break;case 15:C=[3,2];break;case 16:C=[2,1];break;case 255:{C=[h()<<8|h(),h()<<8|h()];break}}return{width:Math.ceil((_+1)*16-r*2-n*2),height:(2-w)*(F+1)*16-(w?2:4)*(s+a),pixelRatio:C}}}class oA extends sA{constructor(...e){super(...e),this.initVPS=null}parsePES(e,t,r,n){const s=this.parseNALu(e,r.data,n);let a=this.VideoSample,o,l=!1;r.data=null,a&&s.length&&!e.audFound&&(this.pushAccessUnit(a,e),a=this.VideoSample=this.createVideoSample(!1,r.pts,r.dts)),s.forEach(u=>{var h,d;switch(u.type){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:a||(a=this.VideoSample=this.createVideoSample(!1,r.pts,r.dts)),a.frame=!0,o=!0;break;case 16:case 17:case 18:case 21:if(o=!0,l){var p;(p=a)!=null&&p.frame&&!a.key&&(this.pushAccessUnit(a,e),a=this.VideoSample=null)}a||(a=this.VideoSample=this.createVideoSample(!0,r.pts,r.dts)),a.key=!0,a.frame=!0;break;case 19:case 20:o=!0,(h=a)!=null&&h.frame&&!a.key&&(this.pushAccessUnit(a,e),a=this.VideoSample=null),a||(a=this.VideoSample=this.createVideoSample(!0,r.pts,r.dts)),a.key=!0,a.frame=!0;break;case 39:o=!0,tg(u.data,2,r.pts,t.samples);break;case 32:o=!0,e.vps||(typeof e.params!="object"&&(e.params={}),e.params=xt(e.params,this.readVPS(u.data)),this.initVPS=u.data),e.vps=[u.data];break;case 33:if(o=!0,l=!0,e.vps!==void 0&&e.vps[0]!==this.initVPS&&e.sps!==void 0&&!this.matchSPS(e.sps[0],u.data)&&(this.initVPS=e.vps[0],e.sps=e.pps=void 0),!e.sps){const g=this.readSPS(u.data);e.width=g.width,e.height=g.height,e.pixelRatio=g.pixelRatio,e.codec=g.codecString,e.sps=[],typeof e.params!="object"&&(e.params={});for(const m in g.params)e.params[m]=g.params[m]}this.pushParameterSet(e.sps,u.data,e.vps),a||(a=this.VideoSample=this.createVideoSample(!0,r.pts,r.dts)),a.key=!0;break;case 34:if(o=!0,typeof e.params=="object"){if(!e.pps){e.pps=[];const g=this.readPPS(u.data);for(const m in g)e.params[m]=g[m]}this.pushParameterSet(e.pps,u.data,e.vps)}break;case 35:o=!0,e.audFound=!0,(d=a)!=null&&d.frame&&(this.pushAccessUnit(a,e),a=null),a||(a=this.VideoSample=this.createVideoSample(!1,r.pts,r.dts));break;default:o=!1;break}a&&o&&a.units.push(u)}),n&&a&&(this.pushAccessUnit(a,e),this.VideoSample=null)}pushParameterSet(e,t,r){(r&&r[0]===this.initVPS||!r&&!e.length)&&e.push(t)}getNALuType(e,t){return(e[t]&126)>>>1}ebsp2rbsp(e){const t=new Uint8Array(e.byteLength);let r=0;for(let n=0;n<e.byteLength;n++)n>=2&&e[n]===3&&e[n-1]===0&&e[n-2]===0||(t[r]=e[n],r++);return new Uint8Array(t.buffer,0,r)}pushAccessUnit(e,t){super.pushAccessUnit(e,t),this.initVPS&&(this.initVPS=null)}readVPS(e){const t=new sl(e);t.readUByte(),t.readUByte(),t.readBits(4),t.skipBits(2),t.readBits(6);const r=t.readBits(3),n=t.readBoolean();return{numTemporalLayers:r+1,temporalIdNested:n}}readSPS(e){const t=new sl(this.ebsp2rbsp(e));t.readUByte(),t.readUByte(),t.readBits(4);const r=t.readBits(3);t.readBoolean();const n=t.readBits(2),s=t.readBoolean(),a=t.readBits(5),o=t.readUByte(),l=t.readUByte(),u=t.readUByte(),h=t.readUByte(),d=t.readUByte(),p=t.readUByte(),g=t.readUByte(),m=t.readUByte(),v=t.readUByte(),E=t.readUByte(),A=t.readUByte(),D=[],R=[];for(let ge=0;ge<r;ge++)D.push(t.readBoolean()),R.push(t.readBoolean());if(r>0)for(let ge=r;ge<8;ge++)t.readBits(2);for(let ge=0;ge<r;ge++)D[ge]&&(t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte()),R[ge]&&t.readUByte();t.readUEG();const _=t.readUEG();_==3&&t.skipBits(1);const F=t.readUEG(),w=t.readUEG(),C=t.readBoolean();let M=0,L=0,I=0,U=0;C&&(M+=t.readUEG(),L+=t.readUEG(),I+=t.readUEG(),U+=t.readUEG());const q=t.readUEG(),$=t.readUEG(),X=t.readUEG(),ne=t.readBoolean();for(let ge=ne?0:r;ge<=r;ge++)t.skipUEG(),t.skipUEG(),t.skipUEG();if(t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.readBoolean()&&t.readBoolean())for(let Ne=0;Ne<4;Ne++)for(let Pe=0;Pe<(Ne===3?2:6);Pe++)if(!t.readBoolean())t.readUEG();else{const K=Math.min(64,1<<4+(Ne<<1));Ne>1&&t.readEG();for(let T=0;T<K;T++)t.readEG()}t.readBoolean(),t.readBoolean(),t.readBoolean()&&(t.readUByte(),t.skipUEG(),t.skipUEG(),t.readBoolean());const ie=t.readUEG();let H=0;for(let ge=0;ge<ie;ge++){let Ne=!1;if(ge!==0&&(Ne=t.readBoolean()),Ne){ge===ie&&t.readUEG(),t.readBoolean(),t.readUEG();let Pe=0;for(let ue=0;ue<=H;ue++){const K=t.readBoolean();let T=!1;K||(T=t.readBoolean()),(K||T)&&Pe++}H=Pe}else{const Pe=t.readUEG(),ue=t.readUEG();H=Pe+ue;for(let K=0;K<Pe;K++)t.readUEG(),t.readBoolean();for(let K=0;K<ue;K++)t.readUEG(),t.readBoolean()}}if(t.readBoolean()){const ge=t.readUEG();for(let Ne=0;Ne<ge;Ne++){for(let Pe=0;Pe<X+4;Pe++)t.readBits(1);t.readBits(1)}}let ve=0,fe=1,De=1,Ie=!0,we=1,Ue=0;t.readBoolean(),t.readBoolean();let $e=!1;if(t.readBoolean()){if(t.readBoolean()){const S=t.readUByte(),k=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2],j=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1];S>0&&S<16?(fe=k[S-1],De=j[S-1]):S===255&&(fe=t.readBits(16),De=t.readBits(16))}if(t.readBoolean()&&t.readBoolean(),t.readBoolean()&&(t.readBits(3),t.readBoolean(),t.readBoolean()&&(t.readUByte(),t.readUByte(),t.readUByte())),t.readBoolean()&&(t.readUEG(),t.readUEG()),t.readBoolean(),t.readBoolean(),t.readBoolean(),$e=t.readBoolean(),$e&&(M+=t.readUEG(),L+=t.readUEG(),I+=t.readUEG(),U+=t.readUEG()),t.readBoolean()&&(we=t.readBits(32),Ue=t.readBits(32),t.readBoolean()&&t.readUEG(),t.readBoolean())){const j=t.readBoolean(),Te=t.readBoolean();let me=!1;(j||Te)&&(me=t.readBoolean(),me&&(t.readUByte(),t.readBits(5),t.readBoolean(),t.readBits(5)),t.readBits(4),t.readBits(4),me&&t.readBits(4),t.readBits(5),t.readBits(5),t.readBits(5));for(let ye=0;ye<=r;ye++){Ie=t.readBoolean();const at=Ie||t.readBoolean();let Kt=!1;at?t.readEG():Kt=t.readBoolean();const Ei=Kt?1:t.readUEG()+1;if(j)for(let Ir=0;Ir<Ei;Ir++)t.readUEG(),t.readUEG(),me&&(t.readUEG(),t.readUEG()),t.skipBits(1);if(Te)for(let Ir=0;Ir<Ei;Ir++)t.readUEG(),t.readUEG(),me&&(t.readUEG(),t.readUEG()),t.skipBits(1)}}t.readBoolean()&&(t.readBoolean(),t.readBoolean(),t.readBoolean(),ve=t.readUEG())}let it=F,Ge=w;if(C||$e){let ge=1,Ne=1;_===1?ge=Ne=2:_==2&&(ge=2),it=F-ge*L-ge*M,Ge=w-Ne*U-Ne*I}const st=n?["A","B","C"][n]:"",B=o<<24|l<<16|u<<8|h;let ae=0;for(let ge=0;ge<32;ge++)ae=(ae|(B>>ge&1)<<31-ge)>>>0;let Ae=ae.toString(16);return a===1&&Ae==="2"&&(Ae="6"),{codecString:`hvc1.${st}${a}.${Ae}.${s?"H":"L"}${A}.B0`,params:{general_tier_flag:s,general_profile_idc:a,general_profile_space:n,general_profile_compatibility_flags:[o,l,u,h],general_constraint_indicator_flags:[d,p,g,m,v,E],general_level_idc:A,bit_depth:q+8,bit_depth_luma_minus8:q,bit_depth_chroma_minus8:$,min_spatial_segmentation_idc:ve,chroma_format_idc:_,frame_rate:{fixed:Ie,fps:Ue/we}},width:it,height:Ge,pixelRatio:[fe,De]}}readPPS(e){const t=new sl(this.ebsp2rbsp(e));t.readUByte(),t.readUByte(),t.skipUEG(),t.skipUEG(),t.skipBits(2),t.skipBits(3),t.skipBits(2),t.skipUEG(),t.skipUEG(),t.skipEG(),t.skipBits(2),t.readBoolean()&&t.skipUEG(),t.skipEG(),t.skipEG(),t.skipBits(4);const n=t.readBoolean(),s=t.readBoolean();let a=1;return s&&n?a=0:s?a=3:n&&(a=2),{parallelismType:a}}matchSPS(e,t){return String.fromCharCode.apply(null,e).substr(3)===String.fromCharCode.apply(null,t).substr(3)}}const mr=188;class fs{constructor(e,t,r,n){this.logger=void 0,this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._pmtId=-1,this._videoTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.remainderData=null,this.videoParser=void 0,this.observer=e,this.config=t,this.typeSupported=r,this.logger=n,this.videoParser=null}static probe(e,t){const r=fs.syncOffset(e);return r>0&&t.warn(`MPEG2-TS detected but first sync word found @ offset ${r}`),r!==-1}static syncOffset(e){const t=e.length;let r=Math.min(mr*5,t-mr)+1,n=0;for(;n<r;){let s=!1,a=-1,o=0;for(let l=n;l<t;l+=mr)if(e[l]===71&&(t-l===mr||e[l+mr]===71)){if(o++,a===-1&&(a=l,a!==0&&(r=Math.min(a+mr*99,e.length-mr)+1)),s||(s=Rg(e,l)===0),s&&o>1&&(a===0&&o>2||l+mr>r))return a}else{if(o)return-1;break}n++}return-1}static createTrack(e,t){return{container:e==="video"||e==="audio"?"video/mp2t":void 0,type:e,id:_E[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:e==="audio"?t:void 0}}resetInitSegment(e,t,r,n){this.pmtParsed=!1,this._pmtId=-1,this._videoTrack=fs.createTrack("video"),this._videoTrack.duration=n,this._audioTrack=fs.createTrack("audio",n),this._id3Track=fs.createTrack("id3"),this._txtTrack=fs.createTrack("text"),this._audioTrack.segmentCodec="aac",this.aacOverFlow=null,this.remainderData=null,this.audioCodec=t,this.videoCodec=r}resetTimeStamp(){}resetContiguity(){const{_audioTrack:e,_videoTrack:t,_id3Track:r}=this;e&&(e.pesData=null),t&&(t.pesData=null),r&&(r.pesData=null),this.aacOverFlow=null,this.remainderData=null}demux(e,t,r=!1,n=!1){r||(this.sampleAes=null);let s;const a=this._videoTrack,o=this._audioTrack,l=this._id3Track,u=this._txtTrack;let h=a.pid,d=a.pesData,p=o.pid,g=l.pid,m=o.pesData,v=l.pesData,E=null,A=this.pmtParsed,D=this._pmtId,R=e.length;if(this.remainderData&&(e=pi(this.remainderData,e),R=e.length,this.remainderData=null),R<mr&&!n)return this.remainderData=e,{audioTrack:o,videoTrack:a,id3Track:l,textTrack:u};const _=Math.max(0,fs.syncOffset(e));R-=(R-_)%mr,R<e.byteLength&&!n&&(this.remainderData=new Uint8Array(e.buffer,R,e.buffer.byteLength-R));let F=0;for(let C=_;C<R;C+=mr)if(e[C]===71){const M=!!(e[C+1]&64),L=Rg(e,C),I=(e[C+3]&48)>>4;let U;if(I>1){if(U=C+5+e[C+4],U===C+mr)continue}else U=C+4;switch(L){case h:if(M){if(d&&(s=qa(d,this.logger))){if(this.videoParser===null)switch(a.segmentCodec){case"avc":this.videoParser=new aA;break;case"hevc":this.videoParser=new oA;break}this.videoParser!==null&&this.videoParser.parsePES(a,u,s,!1)}d={data:[],size:0}}d&&(d.data.push(e.subarray(U,C+mr)),d.size+=C+mr-U);break;case p:if(M){if(m&&(s=qa(m,this.logger)))switch(o.segmentCodec){case"aac":this.parseAACPES(o,s);break;case"mp3":this.parseMPEGPES(o,s);break;case"ac3":this.parseAC3PES(o,s);break}m={data:[],size:0}}m&&(m.data.push(e.subarray(U,C+mr)),m.size+=C+mr-U);break;case g:M&&(v&&(s=qa(v,this.logger))&&this.parseID3PES(l,s),v={data:[],size:0}),v&&(v.data.push(e.subarray(U,C+mr)),v.size+=C+mr-U);break;case 0:M&&(U+=e[U]+1),D=this._pmtId=y_(e,U);break;case D:{M&&(U+=e[U]+1);const q=v_(e,U,this.typeSupported,r,this.observer,this.logger);h=q.videoPid,h>0&&(a.pid=h,a.segmentCodec=q.segmentVideoCodec),p=q.audioPid,p>0&&(o.pid=p,o.segmentCodec=q.segmentAudioCodec),g=q.id3Pid,g>0&&(l.pid=g),E!==null&&!A&&(this.logger.warn(`MPEG-TS PMT found at ${C} after unknown PID '${E}'. Backtracking to sync byte @${_} to parse all TS packets.`),E=null,C=_-188),A=this.pmtParsed=!0;break}case 17:case 8191:break;default:E=L;break}}else F++;F>0&&Ig(this.observer,new Error(`Found ${F} TS packet/s that do not start with 0x47`),void 0,this.logger),a.pesData=d,o.pesData=m,l.pesData=v;const w={audioTrack:o,videoTrack:a,id3Track:l,textTrack:u};return n&&this.extractRemainingSamples(w),w}flush(){const{remainderData:e}=this;this.remainderData=null;let t;return e?t=this.demux(e,-1,!1,!0):t={videoTrack:this._videoTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(t),this.sampleAes?this.decrypt(t,this.sampleAes):t}extractRemainingSamples(e){const{audioTrack:t,videoTrack:r,id3Track:n,textTrack:s}=e,a=r.pesData,o=t.pesData,l=n.pesData;let u;if(a&&(u=qa(a,this.logger))){if(this.videoParser===null)switch(r.segmentCodec){case"avc":this.videoParser=new aA;break;case"hevc":this.videoParser=new oA;break}this.videoParser!==null&&(this.videoParser.parsePES(r,s,u,!0),r.pesData=null)}else r.pesData=a;if(o&&(u=qa(o,this.logger))){switch(t.segmentCodec){case"aac":this.parseAACPES(t,u);break;case"mp3":this.parseMPEGPES(t,u);break;case"ac3":this.parseAC3PES(t,u);break}t.pesData=null}else o!=null&&o.size&&this.logger.log("last AAC PES packet truncated,might overlap between fragments"),t.pesData=o;l&&(u=qa(l,this.logger))?(this.parseID3PES(n,u),n.pesData=null):n.pesData=l}demuxSampleAes(e,t,r){const n=this.demux(e,r,!0,!this.config.progressive),s=this.sampleAes=new m_(this.observer,this.config,t);return this.decrypt(n,s)}decrypt(e,t){return new Promise(r=>{const{audioTrack:n,videoTrack:s}=e;n.samples&&n.segmentCodec==="aac"?t.decryptAacSamples(n.samples,0,()=>{s.samples?t.decryptAvcSamples(s.samples,0,0,()=>{r(e)}):r(e)}):s.samples&&t.decryptAvcSamples(s.samples,0,0,()=>{r(e)})})}destroy(){this.observer&&this.observer.removeAllListeners(),this.config=this.logger=this.observer=null,this.aacOverFlow=this.videoParser=this.remainderData=this.sampleAes=null,this._videoTrack=this._audioTrack=this._id3Track=this._txtTrack=void 0}parseAACPES(e,t){let r=0;const n=this.aacOverFlow;let s=t.data;if(n){this.aacOverFlow=null;const d=n.missing,p=n.sample.unit.byteLength;if(d===-1)s=pi(n.sample.unit,s);else{const g=p-d;n.sample.unit.set(s.subarray(0,d),g),e.samples.push(n.sample),r=n.missing}}let a,o;for(a=r,o=s.length;a<o-1&&!Qu(s,a);a++);if(a!==r){let d;const p=a<o-1;if(p?d=`AAC PES did not start with ADTS header,offset:${a}`:d="No ADTS header found in AAC PES",Ig(this.observer,new Error(d),p,this.logger),!p)return}Yb(e,this.observer,s,a,this.audioCodec);let l;if(t.pts!==void 0)l=t.pts;else if(n){const d=Xb(e.samplerate);l=n.sample.pts+d}else{this.logger.warn("[tsdemuxer]: AAC PES unknown PTS");return}let u=0,h;for(;a<o;)if(h=jb(e,s,a,l,u),a+=h.length,h.missing){this.aacOverFlow=h;break}else for(u++;a<o-1&&!Qu(s,a);a++);}parseMPEGPES(e,t){const r=t.data,n=r.length;let s=0,a=0;const o=t.pts;if(o===void 0){this.logger.warn("[tsdemuxer]: MPEG PES unknown PTS");return}for(;a<n;)if(eA(r,a)){const l=Qb(e,r,a,o,s);if(l)a+=l.length,s++;else break}else a++}parseAC3PES(e,t){{const r=t.data,n=t.pts;if(n===void 0){this.logger.warn("[tsdemuxer]: AC3 PES unknown PTS");return}const s=r.length;let a=0,o=0,l;for(;o<s&&(l=iA(e,r,o,n,a++))>0;)o+=l}}parseID3PES(e,t){if(t.pts===void 0){this.logger.warn("[tsdemuxer]: ID3 PES unknown PTS");return}const r=xt({},t,{type:this._videoTrack?ni.emsg:ni.audioId3,duration:Number.POSITIVE_INFINITY});e.samples.push(r)}}function Rg(i,e){return((i[e+1]&31)<<8)+i[e+2]}function y_(i,e){return(i[e+10]&31)<<8|i[e+11]}function v_(i,e,t,r,n,s){const a={audioPid:-1,videoPid:-1,id3Pid:-1,segmentVideoCodec:"avc",segmentAudioCodec:"aac"},o=(i[e+1]&15)<<8|i[e+2],l=e+3+o-4,u=(i[e+10]&15)<<8|i[e+11];for(e+=12+u;e<l;){const h=Rg(i,e),d=(i[e+3]&15)<<8|i[e+4];switch(i[e]){case 207:if(!r){Ng("ADTS AAC",s);break}case 15:a.audioPid===-1&&(a.audioPid=h);break;case 21:a.id3Pid===-1&&(a.id3Pid=h);break;case 219:if(!r){Ng("H.264",s);break}case 27:a.videoPid===-1&&(a.videoPid=h);break;case 3:case 4:!t.mpeg&&!t.mp3?s.log("MPEG audio found, not supported in this browser"):a.audioPid===-1&&(a.audioPid=h,a.segmentAudioCodec="mp3");break;case 193:if(!r){Ng("AC-3",s);break}case 129:t.ac3?a.audioPid===-1&&(a.audioPid=h,a.segmentAudioCodec="ac3"):s.log("AC-3 audio found, not supported in this browser");break;case 6:if(a.audioPid===-1&&d>0){let p=e+5,g=d;for(;g>2;){switch(i[p]){case 106:t.ac3!==!0?s.log("AC-3 audio found, not supported in this browser for now"):(a.audioPid=h,a.segmentAudioCodec="ac3");break}const v=i[p+1]+2;p+=v,g-=v}}break;case 194:case 135:return Ig(n,new Error("Unsupported EC-3 in M2TS found"),void 0,s),a;case 36:a.videoPid===-1&&(a.videoPid=h,a.segmentVideoCodec="hevc",s.log("HEVC in M2TS found"));break}e+=d+5}return a}function Ig(i,e,t,r){r.warn(`parsing error: ${e.message}`),i.emit(x.ERROR,x.ERROR,{type:Fe.MEDIA_ERROR,details:Q.FRAG_PARSING_ERROR,fatal:!1,levelRetry:t,error:e,reason:e.message})}function Ng(i,e){e.log(`${i} with AES-128-CBC encryption found in unencrypted stream`)}function qa(i,e){let t=0,r,n,s,a,o;const l=i.data;if(!i||i.size===0)return null;for(;l[0].length<19&&l.length>1;)l[0]=pi(l[0],l[1]),l.splice(1,1);if(r=l[0],(r[0]<<16)+(r[1]<<8)+r[2]===1){if(n=(r[4]<<8)+r[5],n&&n>i.size-6)return null;const h=r[7];h&192&&(a=(r[9]&14)*536870912+(r[10]&255)*4194304+(r[11]&254)*16384+(r[12]&255)*128+(r[13]&254)/2,h&64?(o=(r[14]&14)*536870912+(r[15]&255)*4194304+(r[16]&254)*16384+(r[17]&255)*128+(r[18]&254)/2,a-o>54e5&&(e.warn(`${Math.round((a-o)/9e4)}s delta between PTS and DTS, align them`),a=o)):o=a),s=r[8];let d=s+9;if(i.size<=d)return null;i.size-=d;const p=new Uint8Array(i.size);for(let g=0,m=l.length;g<m;g++){r=l[g];let v=r.byteLength;if(d)if(d>v){d-=v;continue}else r=r.subarray(d),v-=d,d=0;p.set(r,t),t+=v}return n&&(n-=s+3),{data:p,pts:a,dts:o,len:n}}return null}class E_{static getSilentFrame(e,t){switch(e){case"mp4a.40.2":if(t===1)return new Uint8Array([0,200,0,128,35,128]);if(t===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(t===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(t===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(t===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(t===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(t===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(t===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(t===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);break}}}const gs=Math.pow(2,32)-1;class z{static init(){z.types={avc1:[],avcC:[],hvc1:[],hvcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],dac3:[],"ac-3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};let e;for(e in z.types)z.types.hasOwnProperty(e)&&(z.types[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);const t=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),r=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);z.HDLR_TYPES={video:t,audio:r};const n=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),s=new Uint8Array([0,0,0,0,0,0,0,0]);z.STTS=z.STSC=z.STCO=s,z.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),z.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),z.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),z.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);const a=new Uint8Array([105,115,111,109]),o=new Uint8Array([97,118,99,49]),l=new Uint8Array([0,0,0,1]);z.FTYP=z.box(z.types.ftyp,a,l,a,o),z.DINF=z.box(z.types.dinf,z.box(z.types.dref,n))}static box(e,...t){let r=8,n=t.length;const s=n;for(;n--;)r+=t[n].byteLength;const a=new Uint8Array(r);for(a[0]=r>>24&255,a[1]=r>>16&255,a[2]=r>>8&255,a[3]=r&255,a.set(e,4),n=0,r=8;n<s;n++)a.set(t[n],r),r+=t[n].byteLength;return a}static hdlr(e){return z.box(z.types.hdlr,z.HDLR_TYPES[e])}static mdat(e){return z.box(z.types.mdat,e)}static mdhd(e,t){t*=e;const r=Math.floor(t/(gs+1)),n=Math.floor(t%(gs+1));return z.box(z.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,r>>24,r>>16&255,r>>8&255,r&255,n>>24,n>>16&255,n>>8&255,n&255,85,196,0,0]))}static mdia(e){return z.box(z.types.mdia,z.mdhd(e.timescale||0,e.duration||0),z.hdlr(e.type),z.minf(e))}static mfhd(e){return z.box(z.types.mfhd,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,e&255]))}static minf(e){return e.type==="audio"?z.box(z.types.minf,z.box(z.types.smhd,z.SMHD),z.DINF,z.stbl(e)):z.box(z.types.minf,z.box(z.types.vmhd,z.VMHD),z.DINF,z.stbl(e))}static moof(e,t,r){return z.box(z.types.moof,z.mfhd(e),z.traf(r,t))}static moov(e){let t=e.length;const r=[];for(;t--;)r[t]=z.trak(e[t]);return z.box.apply(null,[z.types.moov,z.mvhd(e[0].timescale||0,e[0].duration||0)].concat(r).concat(z.mvex(e)))}static mvex(e){let t=e.length;const r=[];for(;t--;)r[t]=z.trex(e[t]);return z.box.apply(null,[z.types.mvex,...r])}static mvhd(e,t){t*=e;const r=Math.floor(t/(gs+1)),n=Math.floor(t%(gs+1)),s=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,r>>24,r>>16&255,r>>8&255,r&255,n>>24,n>>16&255,n>>8&255,n&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return z.box(z.types.mvhd,s)}static sdtp(e){const t=e.samples||[],r=new Uint8Array(4+t.length);let n,s;for(n=0;n<t.length;n++)s=t[n].flags,r[n+4]=s.dependsOn<<4|s.isDependedOn<<2|s.hasRedundancy;return z.box(z.types.sdtp,r)}static stbl(e){return z.box(z.types.stbl,z.stsd(e),z.box(z.types.stts,z.STTS),z.box(z.types.stsc,z.STSC),z.box(z.types.stsz,z.STSZ),z.box(z.types.stco,z.STCO))}static avc1(e){let t=[],r=[],n,s,a;for(n=0;n<e.sps.length;n++)s=e.sps[n],a=s.byteLength,t.push(a>>>8&255),t.push(a&255),t=t.concat(Array.prototype.slice.call(s));for(n=0;n<e.pps.length;n++)s=e.pps[n],a=s.byteLength,r.push(a>>>8&255),r.push(a&255),r=r.concat(Array.prototype.slice.call(s));const o=z.box(z.types.avcC,new Uint8Array([1,t[3],t[4],t[5],255,224|e.sps.length].concat(t).concat([e.pps.length]).concat(r))),l=e.width,u=e.height,h=e.pixelRatio[0],d=e.pixelRatio[1];return z.box(z.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,l>>8&255,l&255,u>>8&255,u&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),o,z.box(z.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),z.box(z.types.pasp,new Uint8Array([h>>24,h>>16&255,h>>8&255,h&255,d>>24,d>>16&255,d>>8&255,d&255])))}static esds(e){const t=e.config;return new Uint8Array([0,0,0,0,3,25,0,1,0,4,17,64,21,0,0,0,0,0,0,0,0,0,0,0,5,2,...t,6,1,2])}static audioStsd(e){const t=e.samplerate||0;return new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount||0,0,16,0,0,0,0,t>>8&255,t&255,0,0])}static mp4a(e){return z.box(z.types.mp4a,z.audioStsd(e),z.box(z.types.esds,z.esds(e)))}static mp3(e){return z.box(z.types[".mp3"],z.audioStsd(e))}static ac3(e){return z.box(z.types["ac-3"],z.audioStsd(e),z.box(z.types.dac3,e.config))}static stsd(e){const{segmentCodec:t}=e;if(e.type==="audio"){if(t==="aac")return z.box(z.types.stsd,z.STSD,z.mp4a(e));if(t==="ac3"&&e.config)return z.box(z.types.stsd,z.STSD,z.ac3(e));if(t==="mp3"&&e.codec==="mp3")return z.box(z.types.stsd,z.STSD,z.mp3(e))}else if(e.pps&&e.sps){if(t==="avc")return z.box(z.types.stsd,z.STSD,z.avc1(e));if(t==="hevc"&&e.vps)return z.box(z.types.stsd,z.STSD,z.hvc1(e))}else throw new Error("video track missing pps or sps");throw new Error(`unsupported ${e.type} segment codec (${t}/${e.codec})`)}static tkhd(e){const t=e.id,r=(e.duration||0)*(e.timescale||0),n=e.width||0,s=e.height||0,a=Math.floor(r/(gs+1)),o=Math.floor(r%(gs+1));return z.box(z.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,t&255,0,0,0,0,a>>24,a>>16&255,a>>8&255,a&255,o>>24,o>>16&255,o>>8&255,o&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,n>>8&255,n&255,0,0,s>>8&255,s&255,0,0]))}static traf(e,t){const r=z.sdtp(e),n=e.id,s=Math.floor(t/(gs+1)),a=Math.floor(t%(gs+1));return z.box(z.types.traf,z.box(z.types.tfhd,new Uint8Array([0,0,0,0,n>>24,n>>16&255,n>>8&255,n&255])),z.box(z.types.tfdt,new Uint8Array([1,0,0,0,s>>24,s>>16&255,s>>8&255,s&255,a>>24,a>>16&255,a>>8&255,a&255])),z.trun(e,r.length+16+20+8+16+8+8),r)}static trak(e){return e.duration=e.duration||4294967295,z.box(z.types.trak,z.tkhd(e),z.mdia(e))}static trex(e){const t=e.id;return z.box(z.types.trex,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,t&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}static trun(e,t){const r=e.samples||[],n=r.length,s=12+16*n,a=new Uint8Array(s);let o,l,u,h,d,p;for(t+=8+s,a.set([e.type==="video"?1:0,0,15,1,n>>>24&255,n>>>16&255,n>>>8&255,n&255,t>>>24&255,t>>>16&255,t>>>8&255,t&255],0),o=0;o<n;o++)l=r[o],u=l.duration,h=l.size,d=l.flags,p=l.cts,a.set([u>>>24&255,u>>>16&255,u>>>8&255,u&255,h>>>24&255,h>>>16&255,h>>>8&255,h&255,d.isLeading<<2|d.dependsOn,d.isDependedOn<<6|d.hasRedundancy<<4|d.paddingValue<<1|d.isNonSync,d.degradPrio&61440,d.degradPrio&15,p>>>24&255,p>>>16&255,p>>>8&255,p&255],12+16*o);return z.box(z.types.trun,a)}static initSegment(e){z.types||z.init();const t=z.moov(e);return pi(z.FTYP,t)}static hvc1(e){const t=e.params,r=[e.vps,e.sps,e.pps],n=4,s=new Uint8Array([1,t.general_profile_space<<6|(t.general_tier_flag?32:0)|t.general_profile_idc,t.general_profile_compatibility_flags[0],t.general_profile_compatibility_flags[1],t.general_profile_compatibility_flags[2],t.general_profile_compatibility_flags[3],t.general_constraint_indicator_flags[0],t.general_constraint_indicator_flags[1],t.general_constraint_indicator_flags[2],t.general_constraint_indicator_flags[3],t.general_constraint_indicator_flags[4],t.general_constraint_indicator_flags[5],t.general_level_idc,240|t.min_spatial_segmentation_idc>>8,255&t.min_spatial_segmentation_idc,252|t.parallelismType,252|t.chroma_format_idc,248|t.bit_depth_luma_minus8,248|t.bit_depth_chroma_minus8,0,parseInt(t.frame_rate.fps),n-1|t.temporal_id_nested<<2|t.num_temporal_layers<<3|(t.frame_rate.fixed?64:0),r.length]);let a=s.length;for(let m=0;m<r.length;m+=1){a+=3;for(let v=0;v<r[m].length;v+=1)a+=2+r[m][v].length}const o=new Uint8Array(a);o.set(s,0),a=s.length;const l=r.length-1;for(let m=0;m<r.length;m+=1){o.set(new Uint8Array([32+m|(m===l?128:0),0,r[m].length]),a),a+=3;for(let v=0;v<r[m].length;v+=1)o.set(new Uint8Array([r[m][v].length>>8,r[m][v].length&255]),a),a+=2,o.set(r[m][v],a),a+=r[m][v].length}const u=z.box(z.types.hvcC,o),h=e.width,d=e.height,p=e.pixelRatio[0],g=e.pixelRatio[1];return z.box(z.types.hvc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,h>>8&255,h&255,d>>8&255,d&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),u,z.box(z.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),z.box(z.types.pasp,new Uint8Array([p>>24,p>>16&255,p>>8&255,p&255,g>>24,g>>16&255,g>>8&255,g&255])))}}z.types=void 0,z.HDLR_TYPES=void 0,z.STTS=void 0,z.STSC=void 0,z.STCO=void 0,z.STSZ=void 0,z.VMHD=void 0,z.SMHD=void 0,z.STSD=void 0,z.FTYP=void 0,z.DINF=void 0;const lA=9e4;function Cg(i,e,t=1,r=!1){const n=i*e*t;return r?Math.round(n):n}function b_(i,e,t=1,r=!1){return Cg(i,e,1/t,r)}function al(i,e=!1){return Cg(i,1e3,1/lA,e)}function A_(i,e=1){return Cg(i,lA,1/e)}const S_=10*1e3,x_=1024,T_=1152,D_=1536;let Va=null,wg=null;function uA(i,e,t,r){return{duration:e,size:t,cts:r,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:i?2:1,isNonSync:i?0:1}}}class tc{constructor(e,t,r,n){if(this.logger=void 0,this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=null,this._initDTS=null,this.nextAvcDts=null,this.nextAudioPts=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.videoTrackConfig=void 0,this.observer=e,this.config=t,this.typeSupported=r,this.logger=n,this.ISGenerated=!1,Va===null){const a=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);Va=a?parseInt(a[1]):0}if(wg===null){const s=navigator.userAgent.match(/Safari\/(\d+)/i);wg=s?parseInt(s[1]):0}}destroy(){this.config=this.videoTrackConfig=this._initPTS=this._initDTS=null}resetTimeStamp(e){this.logger.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=e}resetNextTimestamp(){this.logger.log("[mp4-remuxer]: reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1}resetInitSegment(){this.logger.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1,this.videoTrackConfig=void 0}getVideoStartPts(e){let t=!1;const r=e[0].pts,n=e.reduce((s,a)=>{let o=a.pts,l=o-s;return l<-4294967296&&(t=!0,o=mi(o,r),l=o-s),l>0?s:o},r);return t&&this.logger.debug("PTS rollover detected"),n}remux(e,t,r,n,s,a,o,l){let u,h,d,p,g,m,v=s,E=s;const A=e.pid>-1,D=t.pid>-1,R=t.samples.length,_=e.samples.length>0,F=o&&R>0||R>1;if((!A||_)&&(!D||F)||this.ISGenerated||o){if(this.ISGenerated){var C,M,L,I;const X=this.videoTrackConfig;(X&&(t.width!==X.width||t.height!==X.height||((C=t.pixelRatio)==null?void 0:C[0])!==((M=X.pixelRatio)==null?void 0:M[0])||((L=t.pixelRatio)==null?void 0:L[1])!==((I=X.pixelRatio)==null?void 0:I[1]))||!X&&F||this.nextAudioPts===null&&_)&&this.resetInitSegment()}this.ISGenerated||(d=this.generateIS(e,t,s,a));const U=this.isVideoContiguous;let q=-1,$;if(F&&(q=R_(t.samples),!U&&this.config.forceKeyFrameOnDiscontinuity))if(m=!0,q>0){this.logger.warn(`[mp4-remuxer]: Dropped ${q} out of ${R} video samples due to a missing keyframe`);const X=this.getVideoStartPts(t.samples);t.samples=t.samples.slice(q),t.dropped+=q,E+=(t.samples[0].pts-X)/t.inputTimeScale,$=E}else q===-1&&(this.logger.warn(`[mp4-remuxer]: No keyframe found out of ${R} video samples`),m=!1);if(this.ISGenerated){if(_&&F){const X=this.getVideoStartPts(t.samples),se=(mi(e.samples[0].pts,X)-X)/t.inputTimeScale;v+=Math.max(0,se),E+=Math.max(0,-se)}if(_){if(e.samplerate||(this.logger.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),d=this.generateIS(e,t,s,a)),h=this.remuxAudio(e,v,this.isAudioContiguous,a,D||F||l===ke.AUDIO?E:void 0),F){const X=h?h.endPTS-h.startPTS:0;t.inputTimeScale||(this.logger.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),d=this.generateIS(e,t,s,a)),u=this.remuxVideo(t,E,U,X)}}else F&&(u=this.remuxVideo(t,E,U,0));u&&(u.firstKeyFrame=q,u.independent=q!==-1,u.firstKeyFramePTS=$)}}return this.ISGenerated&&this._initPTS&&this._initDTS&&(r.samples.length&&(g=cA(r,s,this._initPTS,this._initDTS)),n.samples.length&&(p=hA(n,s,this._initPTS))),{audio:h,video:u,initSegment:d,independent:m,text:p,id3:g}}generateIS(e,t,r,n){const s=e.samples,a=t.samples,o=this.typeSupported,l={},u=this._initPTS;let h=!u||n,d="audio/mp4",p,g,m,v;if(h&&(p=g=1/0),e.config&&s.length){switch(e.timescale=e.samplerate,e.segmentCodec){case"mp3":o.mpeg?(d="audio/mpeg",e.codec=""):o.mp3&&(e.codec="mp3");break;case"ac3":e.codec="ac-3";break}l.audio={id:"audio",container:d,codec:e.codec,initSegment:e.segmentCodec==="mp3"&&o.mpeg?new Uint8Array(0):z.initSegment([e]),metadata:{channelCount:e.channelCount}},h&&(v=e.id,m=e.inputTimeScale,!u||m!==u.timescale?p=g=s[0].pts-Math.round(m*r):h=!1)}if(t.sps&&t.pps&&a.length){if(t.timescale=t.inputTimeScale,l.video={id:"main",container:"video/mp4",codec:t.codec,initSegment:z.initSegment([t]),metadata:{width:t.width,height:t.height}},h)if(v=t.id,m=t.inputTimeScale,!u||m!==u.timescale){const E=this.getVideoStartPts(a),A=Math.round(m*r);g=Math.min(g,mi(a[0].dts,E)-A),p=Math.min(p,E-A)}else h=!1;this.videoTrackConfig={width:t.width,height:t.height,pixelRatio:t.pixelRatio}}if(Object.keys(l).length)return this.ISGenerated=!0,h?(this._initPTS={baseTime:p,timescale:m},this._initDTS={baseTime:g,timescale:m}):p=m=void 0,{tracks:l,initPTS:p,timescale:m,trackId:v}}remuxVideo(e,t,r,n){const s=e.inputTimeScale,a=e.samples,o=[],l=a.length,u=this._initPTS;let h=this.nextAvcDts,d=8,p=this.videoSampleDuration,g,m,v=Number.POSITIVE_INFINITY,E=Number.NEGATIVE_INFINITY,A=!1;if(!r||h===null){const H=t*s,J=a[0].pts-mi(a[0].dts,a[0].pts);Va&&h!==null&&Math.abs(H-J-h)<15e3?r=!0:h=H-J}const D=u.baseTime*s/u.timescale;for(let H=0;H<l;H++){const J=a[H];J.pts=mi(J.pts-D,h),J.dts=mi(J.dts-D,h),J.dts<a[H>0?H-1:H].dts&&(A=!0)}A&&a.sort(function(H,J){const ve=H.dts-J.dts,fe=H.pts-J.pts;return ve||fe}),g=a[0].dts,m=a[a.length-1].dts;const R=m-g,_=R?Math.round(R/(l-1)):p||e.inputTimeScale/30;if(r){const H=g-h,J=H>_,ve=H<-1;if((J||ve)&&(J?this.logger.warn(`${(e.segmentCodec||"").toUpperCase()}: ${al(H,!0)} ms (${H}dts) hole between fragments detected at ${t.toFixed(3)}`):this.logger.warn(`${(e.segmentCodec||"").toUpperCase()}: ${al(-H,!0)} ms (${H}dts) overlapping between fragments detected at ${t.toFixed(3)}`),!ve||h>=a[0].pts||Va)){g=h;const fe=a[0].pts-H;if(J)a[0].dts=g,a[0].pts=fe;else{let De=!0;for(let Ie=0;Ie<a.length&&!(a[Ie].dts>fe&&De);Ie++){const we=a[Ie].pts;if(a[Ie].dts-=H,a[Ie].pts-=H,Ie<a.length-1){const Ue=a[Ie+1].pts,$e=a[Ie].pts,et=Ue<=$e,it=Ue<=we;De=et==it}}}this.logger.log(`Video: Initial PTS/DTS adjusted: ${al(fe,!0)}/${al(g,!0)}, delta: ${al(H,!0)} ms`)}}g=Math.max(0,g);let F=0,w=0,C=g;for(let H=0;H<l;H++){const J=a[H],ve=J.units,fe=ve.length;let De=0;for(let Ie=0;Ie<fe;Ie++)De+=ve[Ie].data.length;w+=De,F+=fe,J.length=De,J.dts<C?(J.dts=C,C+=_/4|0||1):C=J.dts,v=Math.min(J.pts,v),E=Math.max(J.pts,E)}m=a[l-1].dts;const M=w+4*F+8;let L;try{L=new Uint8Array(M)}catch(H){this.observer.emit(x.ERROR,x.ERROR,{type:Fe.MUX_ERROR,details:Q.REMUX_ALLOC_ERROR,fatal:!1,error:H,bytes:M,reason:`fail allocating video mdat ${M}`});return}const I=new DataView(L.buffer);I.setUint32(0,M),L.set(z.types.mdat,4);let U=!1,q=Number.POSITIVE_INFINITY,$=Number.POSITIVE_INFINITY,X=Number.NEGATIVE_INFINITY,ne=Number.NEGATIVE_INFINITY;for(let H=0;H<l;H++){const J=a[H],ve=J.units;let fe=0;for(let we=0,Ue=ve.length;we<Ue;we++){const $e=ve[we],et=$e.data,it=$e.data.byteLength;I.setUint32(d,it),d+=4,L.set(et,d),d+=it,fe+=4+it}let De;if(H<l-1)p=a[H+1].dts-J.dts,De=a[H+1].pts-J.pts;else{const we=this.config,Ue=H>0?J.dts-a[H-1].dts:_;if(De=H>0?J.pts-a[H-1].pts:_,we.stretchShortVideoTrack&&this.nextAudioPts!==null){const $e=Math.floor(we.maxBufferHole*s),et=(n?v+n*s:this.nextAudioPts)-J.pts;et>$e?(p=et-Ue,p<0?p=Ue:U=!0,this.logger.log(`[mp4-remuxer]: It is approximately ${et/90} ms to the next segment; using duration ${p/90} ms for the last video frame.`)):p=Ue}else p=Ue}const Ie=Math.round(J.pts-J.dts);q=Math.min(q,p),X=Math.max(X,p),$=Math.min($,De),ne=Math.max(ne,De),o.push(uA(J.key,p,fe,Ie))}if(o.length){if(Va){if(Va<70){const H=o[0].flags;H.dependsOn=2,H.isNonSync=0}}else if(wg&&ne-$<X-q&&_/X<.025&&o[0].cts===0){this.logger.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");let H=g;for(let J=0,ve=o.length;J<ve;J++){const fe=H+o[J].duration,De=H+o[J].cts;if(J<ve-1){const Ie=fe+o[J+1].cts;o[J].duration=Ie-De}else o[J].duration=J?o[J-1].duration:_;o[J].cts=0,H=fe}}}p=U||!p?_:p,this.nextAvcDts=h=m+p,this.videoSampleDuration=p,this.isVideoContiguous=!0;const ie={data1:z.moof(e.sequenceNumber++,g,xt(e,{samples:o})),data2:L,startPTS:v/s,endPTS:(E+p)/s,startDTS:g/s,endDTS:h/s,type:"video",hasAudio:!1,hasVideo:!0,nb:o.length,dropped:e.dropped};return e.samples=[],e.dropped=0,ie}getSamplesPerFrame(e){switch(e.segmentCodec){case"mp3":return T_;case"ac3":return D_;default:return x_}}remuxAudio(e,t,r,n,s){const a=e.inputTimeScale,o=e.samplerate?e.samplerate:a,l=a/o,u=this.getSamplesPerFrame(e),h=u*l,d=this._initPTS,p=e.segmentCodec==="mp3"&&this.typeSupported.mpeg,g=[],m=s!==void 0;let v=e.samples,E=p?0:8,A=this.nextAudioPts||-1;const D=t*a,R=d.baseTime*a/d.timescale;if(this.isAudioContiguous=r=r||v.length&&A>0&&(n&&Math.abs(D-A)<9e3||Math.abs(mi(v[0].pts-R,D)-A)<20*h),v.forEach(function(se){se.pts=mi(se.pts-R,D)}),!r||A<0){if(v=v.filter(se=>se.pts>=0),!v.length)return;s===0?A=0:n&&!m?A=Math.max(0,D):A=v[0].pts}if(e.segmentCodec==="aac"){const se=this.config.maxAudioFramesDrift;for(let ce=0,ie=A;ce<v.length;ce++){const H=v[ce],J=H.pts,ve=J-ie,fe=Math.abs(1e3*ve/a);if(ve<=-se*h&&m)ce===0&&(this.logger.warn(`Audio frame @ ${(J/a).toFixed(3)}s overlaps nextAudioPts by ${Math.round(1e3*ve/a)} ms.`),this.nextAudioPts=A=ie=J);else if(ve>=se*h&&fe<S_&&m){let De=Math.round(ve/h);ie=J-De*h,ie<0&&(De--,ie+=h),ce===0&&(this.nextAudioPts=A=ie),this.logger.warn(`[mp4-remuxer]: Injecting ${De} audio frame @ ${(ie/a).toFixed(3)}s due to ${Math.round(1e3*ve/a)} ms gap.`);for(let Ie=0;Ie<De;Ie++){const we=Math.max(ie,0);let Ue=E_.getSilentFrame(e.parsedCodec||e.manifestCodec||e.codec,e.channelCount);Ue||(this.logger.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),Ue=H.unit.subarray()),v.splice(ce,0,{unit:Ue,pts:we}),ie+=h,ce++}}H.pts=ie,ie+=h}}let _=null,F=null,w,C=0,M=v.length;for(;M--;)C+=v[M].unit.byteLength;for(let se=0,ce=v.length;se<ce;se++){const ie=v[se],H=ie.unit;let J=ie.pts;if(F!==null){const fe=g[se-1];fe.duration=Math.round((J-F)/l)}else if(r&&e.segmentCodec==="aac"&&(J=A),_=J,C>0){C+=E;try{w=new Uint8Array(C)}catch(fe){this.observer.emit(x.ERROR,x.ERROR,{type:Fe.MUX_ERROR,details:Q.REMUX_ALLOC_ERROR,fatal:!1,error:fe,bytes:C,reason:`fail allocating audio mdat ${C}`});return}p||(new DataView(w.buffer).setUint32(0,C),w.set(z.types.mdat,4))}else return;w.set(H,E);const ve=H.byteLength;E+=ve,g.push(uA(!0,u,ve,0)),F=J}const L=g.length;if(!L)return;const I=g[g.length-1];this.nextAudioPts=A=F+l*I.duration;const U=p?new Uint8Array(0):z.moof(e.sequenceNumber++,_/l,xt({},e,{samples:g}));e.samples=[];const q=_/a,$=A/a,ne={data1:U,data2:w,startPTS:q,endPTS:$,startDTS:q,endDTS:$,type:"audio",hasAudio:!0,hasVideo:!1,nb:L};return this.isAudioContiguous=!0,ne}}function mi(i,e){let t;if(e===null)return i;for(e<i?t=-8589934592:t=8589934592;Math.abs(i-e)>4294967296;)i+=t;return i}function R_(i){for(let e=0;e<i.length;e++)if(i[e].key)return e;return-1}function cA(i,e,t,r){const n=i.samples.length;if(!n)return;const s=i.inputTimeScale;for(let o=0;o<n;o++){const l=i.samples[o];l.pts=mi(l.pts-t.baseTime*s/t.timescale,e*s)/s,l.dts=mi(l.dts-r.baseTime*s/r.timescale,e*s)/s}const a=i.samples;return i.samples=[],{samples:a}}function hA(i,e,t){const r=i.samples.length;if(!r)return;const n=i.inputTimeScale;for(let a=0;a<r;a++){const o=i.samples[a];o.pts=mi(o.pts-t.baseTime*n/t.timescale,e*n)/n}i.samples.sort((a,o)=>a.pts-o.pts);const s=i.samples;return i.samples=[],{samples:s}}class I_{constructor(e,t,r,n){this.logger=void 0,this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=null,this.initTracks=void 0,this.lastEndTime=null,this.isVideoContiguous=!1,this.logger=n}destroy(){}resetTimeStamp(e){this.initPTS=e,this.lastEndTime=null}resetNextTimestamp(){this.isVideoContiguous=!1,this.lastEndTime=null}resetInitSegment(e,t,r,n){this.audioCodec=t,this.videoCodec=r,this.generateInitSegment(Aw(e,n)),this.emitInitSegment=!0}generateInitSegment(e){let{audioCodec:t,videoCodec:r}=this;if(!(e!=null&&e.byteLength)){this.initTracks=void 0,this.initData=void 0;return}const n=this.initData=OE(e);n.audio&&(t=dA(n.audio,Nt.AUDIO,this.logger)),n.video&&(r=dA(n.video,Nt.VIDEO,this.logger));const s={};n.audio&&n.video?s.audiovideo={container:"video/mp4",codec:t+","+r,supplemental:n.video.supplemental,initSegment:e,id:"main"}:n.audio?s.audio={container:"audio/mp4",codec:t,initSegment:e,id:"audio"}:n.video?s.video={container:"video/mp4",codec:r,supplemental:n.video.supplemental,initSegment:e,id:"main"}:this.logger.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=s}remux(e,t,r,n,s,a){var o,l;let{initPTS:u,lastEndTime:h}=this;const d={audio:void 0,video:void 0,text:n,id3:r,initSegment:void 0};Ce(h)||(h=this.lastEndTime=s||0);const p=t.samples;if(!(p!=null&&p.length))return d;const g={initPTS:void 0,timescale:void 0,trackId:void 0};let m=this.initData;if((o=m)!=null&&o.length||(this.generateInitSegment(p),m=this.initData),!((l=m)!=null&&l.length))return this.logger.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),d;this.emitInitSegment&&(g.tracks=this.initTracks,this.emitInitSegment=!1);const v=Sw(p,m,this.logger),E=m.audio?v[m.audio.id]:null,A=m.video?v[m.video.id]:null,D=rc(A,1/0),R=rc(E,1/0),_=rc(A,0,!0),F=rc(E,0,!0);let w,C=s,M=0;if(E&&(!A||!u&&R<D||u&&u.trackId===m.audio.id)?(g.trackId=m.audio.id,w=E,M=F-R):A&&(g.trackId=m.video.id,w=A,M=_-D),w){const se=w.timescale;C=w.start/se,g.timescale=se,u||(g.initPTS=w.start-s*se,this.initPTS=u={baseTime:g.initPTS,timescale:se,trackId:g.trackId})}(a||!u)&&(N_(u,C,s,M)||g.timescale!==u.timescale)&&(g.initPTS=C-s,u&&u.timescale===1&&this.logger.warn(`Adjusting initPTS @${s} from ${u.baseTime/u.timescale} to ${g.initPTS}`),this.initPTS=u={baseTime:g.initPTS,timescale:1});const L=e?C-u.baseTime/u.timescale:h;xw(m,p,u.baseTime/u.timescale);const I=L+M;M>0?this.lastEndTime=I:(this.logger.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());const U=!!m.audio,q=!!m.video;let $="";U&&($+="audio"),q&&($+="video");const X={data1:p,startPTS:L,startDTS:L,endPTS:I,endDTS:I,type:$,hasAudio:U,hasVideo:q,nb:1,dropped:0};d.audio=U&&!q?X:void 0,d.video=q?X:void 0;const ne=A==null?void 0:A.sampleCount;if(ne){const se=A.keyFrameIndex,ce=se!==-1;X.nb=ne,X.dropped=se===0||this.isVideoContiguous?0:ce?se:ne,X.independent=ce,X.firstKeyFrame=se,ce&&A.keyFrameStart&&(X.firstKeyFramePTS=A.keyFrameStart-u.baseTime/u.timescale),this.isVideoContiguous||(d.independent=ce),this.isVideoContiguous||(this.isVideoContiguous=ce),X.dropped&&this.logger.warn(`fmp4 does not start with IDR: firstIDR ${se}/${ne} dropped: ${X.dropped} pts: ${X.firstKeyFramePTS||"NA"}`)}return d.initSegment=g,d.id3=cA(r,s,u,u),n.samples.length&&(d.text=hA(n,s,u)),d}}function rc(i,e,t=!1){return(i==null?void 0:i.start)!==void 0?(i.start+(t?i.duration:0))/i.timescale:e}function N_(i,e,t,r){if(i===null)return!0;const n=Math.max(r,1),s=e-i.baseTime/i.timescale;return Math.abs(s-t)>n}function dA(i,e,t){const r=i==null?void 0:i.codec;return r&&r.length>4?r:e===Nt.AUDIO?r==="ec-3"||r==="ac-3"||r==="alac"?r:r==="fLaC"||r==="Opus"?Ou(r,!1):(t.warn(`Unhandled audio codec "${r}" in mp4 MAP`),r||"mp4a"):(t.warn(`Unhandled video codec "${r}" in mp4 MAP`),r||"avc1")}let _n;try{_n=self.performance.now.bind(self.performance)}catch{_n=Date.now}const ic=[{demux:p_,remux:I_},{demux:fs,remux:tc},{demux:h_,remux:tc},{demux:f_,remux:tc}];ic.splice(2,0,{demux:d_,remux:tc});class fA{constructor(e,t,r,n,s,a){this.asyncResult=!1,this.logger=void 0,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=e,this.typeSupported=t,this.config=r,this.id=s,this.logger=a}configure(e){this.transmuxConfig=e,this.decrypter&&this.decrypter.reset()}push(e,t,r,n){const s=r.transmuxing;s.executeStart=_n();let a=new Uint8Array(e);const{currentTransmuxState:o,transmuxConfig:l}=this;n&&(this.currentTransmuxState=n);const{contiguous:u,discontinuity:h,trackSwitch:d,accurateTimeOffset:p,timeOffset:g,initSegmentChange:m}=n||o,{audioCodec:v,videoCodec:E,defaultInitPts:A,duration:D,initSegmentData:R}=l,_=C_(a,t);if(_&&$a(_.method)){const M=this.getDecrypter(),L=ug(_.method);if(M.isSync()){let I=M.softwareDecrypt(a,_.key.buffer,_.iv.buffer,L);if(r.part>-1){const q=M.flush();I=q&&q.buffer}if(!I)return s.executeEnd=_n(),Lg(r);a=new Uint8Array(I)}else return this.asyncResult=!0,this.decryptionPromise=M.webCryptoDecrypt(a,_.key.buffer,_.iv.buffer,L).then(I=>{const U=this.push(I,null,r);return this.decryptionPromise=null,U}),this.decryptionPromise}const F=this.needsProbing(h,d);if(F){const M=this.configureTransmuxer(a);if(M)return this.logger.warn(`[transmuxer] ${M.message}`),this.observer.emit(x.ERROR,x.ERROR,{type:Fe.MEDIA_ERROR,details:Q.FRAG_PARSING_ERROR,fatal:!1,error:M,reason:M.message}),s.executeEnd=_n(),Lg(r)}(h||d||m||F)&&this.resetInitSegment(R,v,E,D,t),(h||m||F)&&this.resetInitialTimestamp(A),u||this.resetContiguity();const w=this.transmux(a,_,g,p,r);this.asyncResult=ol(w);const C=this.currentTransmuxState;return C.contiguous=!0,C.discontinuity=!1,C.trackSwitch=!1,s.executeEnd=_n(),w}flush(e){const t=e.transmuxing;t.executeStart=_n();const{decrypter:r,currentTransmuxState:n,decryptionPromise:s}=this;if(s)return this.asyncResult=!0,s.then(()=>this.flush(e));const a=[],{timeOffset:o}=n;if(r){const d=r.flush();d&&a.push(this.push(d.buffer,null,e))}const{demuxer:l,remuxer:u}=this;if(!l||!u){t.executeEnd=_n();const d=[Lg(e)];return this.asyncResult?Promise.resolve(d):d}const h=l.flush(o);return ol(h)?(this.asyncResult=!0,h.then(d=>(this.flushRemux(a,d,e),a))):(this.flushRemux(a,h,e),this.asyncResult?Promise.resolve(a):a)}flushRemux(e,t,r){const{audioTrack:n,videoTrack:s,id3Track:a,textTrack:o}=t,{accurateTimeOffset:l,timeOffset:u}=this.currentTransmuxState;this.logger.log(`[transmuxer.ts]: Flushed ${this.id} sn: ${r.sn}${r.part>-1?" part: "+r.part:""} of ${this.id===ke.MAIN?"level":"track"} ${r.level}`);const h=this.remuxer.remux(n,s,a,o,u,l,!0,this.id);e.push({remuxResult:h,chunkMeta:r}),r.transmuxing.executeEnd=_n()}resetInitialTimestamp(e){const{demuxer:t,remuxer:r}=this;!t||!r||(t.resetTimeStamp(e),r.resetTimeStamp(e))}resetContiguity(){const{demuxer:e,remuxer:t}=this;!e||!t||(e.resetContiguity(),t.resetNextTimestamp())}resetInitSegment(e,t,r,n,s){const{demuxer:a,remuxer:o}=this;!a||!o||(a.resetInitSegment(e,t,r,n),o.resetInitSegment(e,t,r,s))}destroy(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)}transmux(e,t,r,n,s){let a;return t&&t.method==="SAMPLE-AES"?a=this.transmuxSampleAes(e,t,r,n,s):a=this.transmuxUnencrypted(e,r,n,s),a}transmuxUnencrypted(e,t,r,n){const{audioTrack:s,videoTrack:a,id3Track:o,textTrack:l}=this.demuxer.demux(e,t,!1,!this.config.progressive);return{remuxResult:this.remuxer.remux(s,a,o,l,t,r,!1,this.id),chunkMeta:n}}transmuxSampleAes(e,t,r,n,s){return this.demuxer.demuxSampleAes(e,t,r).then(a=>({remuxResult:this.remuxer.remux(a.audioTrack,a.videoTrack,a.id3Track,a.textTrack,r,n,!1,this.id),chunkMeta:s}))}configureTransmuxer(e){const{config:t,observer:r,typeSupported:n}=this;let s;for(let d=0,p=ic.length;d<p;d++){var a;if((a=ic[d].demux)!=null&&a.probe(e,this.logger)){s=ic[d];break}}if(!s)return new Error("Failed to find demuxer by probing fragment data");const o=this.demuxer,l=this.remuxer,u=s.remux,h=s.demux;(!l||!(l instanceof u))&&(this.remuxer=new u(r,t,n,this.logger)),(!o||!(o instanceof h))&&(this.demuxer=new h(r,t,n,this.logger),this.probe=h.probe)}needsProbing(e,t){return!this.demuxer||!this.remuxer||e||t}getDecrypter(){let e=this.decrypter;return e||(e=this.decrypter=new ag(this.config)),e}}function C_(i,e){let t=null;return i.byteLength>0&&(e==null?void 0:e.key)!=null&&e.iv!==null&&e.method!=null&&(t=e),t}const Lg=i=>({remuxResult:{},chunkMeta:i});function ol(i){return"then"in i&&i.then instanceof Function}class w_{constructor(e,t,r,n,s){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=e,this.videoCodec=t,this.initSegmentData=r,this.duration=n,this.defaultInitPts=s||null}}class L_{constructor(e,t,r,n,s,a){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=e,this.contiguous=t,this.accurateTimeOffset=r,this.trackSwitch=n,this.timeOffset=s,this.initSegmentChange=a}}let gA=0;class pA{constructor(e,t,r,n){this.error=null,this.hls=void 0,this.id=void 0,this.instanceNo=gA++,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0,this.onWorkerMessage=l=>{const u=l.data,h=this.hls;if(!(!h||!(u!=null&&u.event)||u.instanceNo!==this.instanceNo))switch(u.event){case"init":{var d;const p=(d=this.workerContext)==null?void 0:d.objectURL;p&&self.URL.revokeObjectURL(p);break}case"transmuxComplete":{this.handleTransmuxComplete(u.data);break}case"flush":{this.onFlush(u.data);break}case"workerLog":{h.logger[u.data.logType]&&h.logger[u.data.logType](u.data.message);break}default:{u.data=u.data||{},u.data.frag=this.frag,u.data.part=this.part,u.data.id=this.id,h.trigger(u.event,u.data);break}}},this.onWorkerError=l=>{if(!this.hls)return;const u=new Error(`${l.message}  (${l.filename}:${l.lineno})`);this.hls.config.enableWorker=!1,this.hls.logger.warn(`Error in "${this.id}" Web Worker, fallback to inline`),this.hls.trigger(x.ERROR,{type:Fe.OTHER_ERROR,details:Q.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:u})};const s=e.config;this.hls=e,this.id=t,this.useWorker=!!s.enableWorker,this.onTransmuxComplete=r,this.onFlush=n;const a=(l,u)=>{u=u||{},u.frag=this.frag||void 0,l===x.ERROR&&(u=u,u.parent=this.id,u.part=this.part,this.error=u.error),this.hls.trigger(l,u)};this.observer=new Eg,this.observer.on(x.FRAG_DECRYPTED,a),this.observer.on(x.ERROR,a);const o=HE(s.preferManagedMediaSource);if(this.useWorker&&typeof Worker<"u"){const l=this.hls.logger;if(s.workerPath||FL()){try{s.workerPath?(l.log(`loading Web Worker ${s.workerPath} for "${t}"`),this.workerContext=UL(s.workerPath)):(l.log(`injecting Web Worker for "${t}"`),this.workerContext=BL());const{worker:h}=this.workerContext;h.addEventListener("message",this.onWorkerMessage),h.addEventListener("error",this.onWorkerError),h.postMessage({instanceNo:this.instanceNo,cmd:"init",typeSupported:o,id:t,config:Gt(s)})}catch(h){l.warn(`Error setting up "${t}" Web Worker, fallback to inline`,h),this.terminateWorker(),this.error=null,this.transmuxer=new fA(this.observer,o,s,"",t,e.logger)}return}}this.transmuxer=new fA(this.observer,o,s,"",t,e.logger)}reset(){if(this.frag=null,this.part=null,this.workerContext){const e=this.instanceNo;this.instanceNo=gA++;const t=this.hls.config,r=HE(t.preferManagedMediaSource);this.workerContext.worker.postMessage({instanceNo:this.instanceNo,cmd:"reset",resetNo:e,typeSupported:r,id:this.id,config:Gt(t)})}}terminateWorker(){if(this.workerContext){const{worker:e}=this.workerContext;this.workerContext=null,e.removeEventListener("message",this.onWorkerMessage),e.removeEventListener("error",this.onWorkerError),$L(this.hls.config.workerPath)}}destroy(){if(this.workerContext)this.terminateWorker(),this.onWorkerMessage=this.onWorkerError=null;else{const t=this.transmuxer;t&&(t.destroy(),this.transmuxer=null)}const e=this.observer;e&&e.removeAllListeners(),this.frag=null,this.part=null,this.observer=null,this.hls=null}push(e,t,r,n,s,a,o,l,u,h){var d,p;u.transmuxing.start=self.performance.now();const{instanceNo:g,transmuxer:m}=this,v=a?a.start:s.start,E=s.decryptdata,A=this.frag,D=!(A&&s.cc===A.cc),R=!(A&&u.level===A.level),_=A?u.sn-A.sn:-1,F=this.part?u.part-this.part.index:-1,w=_===0&&u.id>1&&u.id===(A==null?void 0:A.stats.chunkCount),C=!R&&(_===1||_===0&&(F===1||w&&F<=0)),M=self.performance.now();(R||_||s.stats.parsing.start===0)&&(s.stats.parsing.start=M),a&&(F||!C)&&(a.stats.parsing.start=M);const L=!(A&&((d=s.initSegment)==null?void 0:d.url)===((p=A.initSegment)==null?void 0:p.url)),I=new L_(D,C,l,R,v,L);if(!C||D||L){this.hls.logger.log(`[transmuxer-interface]: Starting new transmux session for ${s.type} sn: ${u.sn}${u.part>-1?" part: "+u.part:""} ${this.id===ke.MAIN?"level":"track"}: ${u.level} id: ${u.id}
        discontinuity: ${D}
        trackSwitch: ${R}
        contiguous: ${C}
        accurateTimeOffset: ${l}
        timeOffset: ${v}
        initSegmentChange: ${L}`);const U=new w_(r,n,t,o,h);this.configureTransmuxer(U)}if(this.frag=s,this.part=a,this.workerContext)this.workerContext.worker.postMessage({instanceNo:g,cmd:"demux",data:e,decryptdata:E,chunkMeta:u,state:I},e instanceof ArrayBuffer?[e]:[]);else if(m){const U=m.push(e,E,u,I);ol(U)?U.then(q=>{this.handleTransmuxComplete(q)}).catch(q=>{this.transmuxerError(q,u,"transmuxer-interface push error")}):this.handleTransmuxComplete(U)}}flush(e){e.transmuxing.start=self.performance.now();const{instanceNo:t,transmuxer:r}=this;if(this.workerContext)this.workerContext.worker.postMessage({instanceNo:t,cmd:"flush",chunkMeta:e});else if(r){const n=r.flush(e);ol(n)?n.then(s=>{this.handleFlushResult(s,e)}).catch(s=>{this.transmuxerError(s,e,"transmuxer-interface flush error")}):this.handleFlushResult(n,e)}}transmuxerError(e,t,r){this.hls&&(this.error=e,this.hls.trigger(x.ERROR,{type:Fe.MEDIA_ERROR,details:Q.FRAG_PARSING_ERROR,chunkMeta:t,frag:this.frag||void 0,part:this.part||void 0,fatal:!1,error:e,err:e,reason:r}))}handleFlushResult(e,t){e.forEach(r=>{this.handleTransmuxComplete(r)}),this.onFlush(t)}configureTransmuxer(e){const{instanceNo:t,transmuxer:r}=this;this.workerContext?this.workerContext.worker.postMessage({instanceNo:t,cmd:"configure",config:e}):r&&r.configure(e)}handleTransmuxComplete(e){e.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(e)}}const mA=100;class __ extends yg{constructor(e,t,r){super(e,t,r,"audio-stream-controller",ke.AUDIO),this.mainAnchor=null,this.mainFragLoading=null,this.audioOnly=!1,this.bufferedTrack=null,this.switchingTrack=null,this.trackId=-1,this.waitingData=null,this.mainDetails=null,this.flushing=!1,this.bufferFlushed=!1,this.cachedTrackLoadedData=null,this.registerListeners()}onHandlerDestroying(){this.unregisterListeners(),super.onHandlerDestroying(),this.resetItem()}resetItem(){this.mainDetails=this.mainAnchor=this.mainFragLoading=this.bufferedTrack=this.switchingTrack=this.waitingData=this.cachedTrackLoadedData=null}registerListeners(){super.registerListeners();const{hls:e}=this;e.on(x.LEVEL_LOADED,this.onLevelLoaded,this),e.on(x.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.on(x.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(x.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(x.BUFFER_RESET,this.onBufferReset,this),e.on(x.BUFFER_CREATED,this.onBufferCreated,this),e.on(x.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(x.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(x.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(x.FRAG_LOADING,this.onFragLoading,this),e.on(x.FRAG_BUFFERED,this.onFragBuffered,this)}unregisterListeners(){const{hls:e}=this;e&&(super.unregisterListeners(),e.off(x.LEVEL_LOADED,this.onLevelLoaded,this),e.off(x.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.off(x.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(x.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(x.BUFFER_RESET,this.onBufferReset,this),e.off(x.BUFFER_CREATED,this.onBufferCreated,this),e.off(x.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(x.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(x.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(x.FRAG_LOADING,this.onFragLoading,this),e.off(x.FRAG_BUFFERED,this.onFragBuffered,this))}onInitPtsFound(e,{frag:t,id:r,initPTS:n,timescale:s}){if(r===ke.MAIN){const a=t.cc,o=this.fragCurrent;if(this.initPTS[a]={baseTime:n,timescale:s},this.log(`InitPTS for cc: ${a} found from main: ${n}/${s}`),this.mainAnchor=t,this.state===le.WAITING_INIT_PTS){const l=this.waitingData;(!l&&!this.loadingParts||l&&l.frag.cc!==a)&&this.syncWithAnchor(t,l==null?void 0:l.frag)}else!this.hls.hasEnoughToStart&&o&&o.cc!==a?(o.abortRequests(),this.syncWithAnchor(t,o)):this.state===le.IDLE&&this.tick()}}getLoadPosition(){return!this.startFragRequested&&this.nextLoadPosition>=0?this.nextLoadPosition:super.getLoadPosition()}syncWithAnchor(e,t){var r;const n=((r=this.mainFragLoading)==null?void 0:r.frag)||null;if(t&&(n==null?void 0:n.cc)===t.cc)return;const s=(n||e).cc,a=this.getLevelDetails(),o=this.getLoadPosition(),l=nb(a,s,o);l&&(this.log(`Waiting fragment cc (${t==null?void 0:t.cc}) cancelled because video is at cc ${e.cc}`),this.startFragRequested=!1,this.nextLoadPosition=l.start,this.resetLoadingState(),this.state===le.IDLE&&this.doTickIdle())}startLoad(e,t){if(!this.levels){this.startPosition=e,this.state=le.STOPPED;return}const r=this.lastCurrentTime;this.stopLoad(),this.setInterval(mA),r>0&&e===-1?(this.log(`Override startPosition with lastCurrentTime @${r.toFixed(3)}`),e=r,this.state=le.IDLE):this.state=le.WAITING_TRACK,this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick()}doTick(){switch(this.state){case le.IDLE:this.doTickIdle();break;case le.WAITING_TRACK:{const{levels:t,trackId:r}=this,n=t==null?void 0:t[r],s=n==null?void 0:n.details;if(s&&!this.waitForLive(n)){if(this.waitForCdnTuneIn(s))break;this.state=le.WAITING_INIT_PTS}break}case le.FRAG_LOADING_WAITING_RETRY:{var e;const t=performance.now(),r=this.retryDate;if(!r||t>=r||(e=this.media)!=null&&e.seeking){const{levels:n,trackId:s}=this;this.log("RetryDate reached, switch back to IDLE state"),this.resetStartWhenNotLoaded((n==null?void 0:n[s])||null),this.state=le.IDLE}break}case le.WAITING_INIT_PTS:{const t=this.waitingData;if(t){const{frag:r,part:n,cache:s,complete:a}=t,o=this.mainAnchor;if(this.initPTS[r.cc]!==void 0){this.waitingData=null,this.state=le.FRAG_LOADING;const l=s.flush().buffer,u={frag:r,part:n,payload:l,networkDetails:null};this._handleFragmentLoadProgress(u),a&&super._handleFragmentLoadComplete(u)}else o&&o.cc!==t.frag.cc&&this.syncWithAnchor(o,t.frag)}else this.state=le.IDLE}}this.onTickEnd()}resetLoadingState(){const e=this.waitingData;e&&(this.fragmentTracker.removeFragment(e.frag),this.waitingData=null),super.resetLoadingState()}onTickEnd(){const{media:e}=this;e!=null&&e.readyState&&(this.lastCurrentTime=e.currentTime)}doTickIdle(){var e;const{hls:t,levels:r,media:n,trackId:s}=this,a=t.config;if(!this.buffering||!n&&!this.primaryPrefetch&&(this.startFragRequested||!a.startFragPrefetch)||!(r!=null&&r[s]))return;const o=r[s],l=o.details;if(!l||this.waitForLive(o)||this.waitForCdnTuneIn(l)){this.state=le.WAITING_TRACK,this.startFragRequested=!1;return}const u=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&u&&(this.bufferFlushed=!1,this.afterBufferFlushed(u,Nt.AUDIO,ke.AUDIO));const h=this.getFwdBufferInfo(u,ke.AUDIO);if(h===null)return;if(!this.switchingTrack&&this._streamEnded(h,l)){t.trigger(x.BUFFER_EOS,{type:"audio"}),this.state=le.ENDED;return}const d=h.len,p=t.maxBufferLength,g=l.fragments,m=g[0].start,v=this.getLoadPosition(),E=this.flushing?v:h.end;if(this.switchingTrack&&n){const R=v;l.PTSKnown&&R<m&&(h.end>m||h.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),n.currentTime=m+.05)}if(d>=p&&!this.switchingTrack&&E<g[g.length-1].start)return;let A=this.getNextFragment(E,l);if(A&&this.isLoopLoading(A,E)&&(A=this.getNextFragmentLoopLoading(A,l,h,ke.MAIN,p)),!A){this.bufferFlushed=!0;return}let D=((e=this.mainFragLoading)==null?void 0:e.frag)||null;if(!this.audioOnly&&this.startFragRequested&&D&&pr(A)&&!A.endList&&(!l.live||!this.loadingParts&&E<this.hls.liveSyncPosition)&&(this.fragmentTracker.getState(D)===nr.OK&&(this.mainFragLoading=D=null),D&&pr(D))){if(A.start>D.end){const _=this.fragmentTracker.getFragAtPos(E,ke.MAIN);_&&_.end>D.end&&(D=_,this.mainFragLoading={frag:_,targetBufferTime:null})}if(A.start>D.end)return}this.loadFragment(A,o,E)}onMediaDetaching(e,t){this.bufferFlushed=this.flushing=!1,super.onMediaDetaching(e,t)}onAudioTracksUpdated(e,{audioTracks:t}){this.resetTransmuxer(),this.levels=t.map(r=>new Qo(r))}onAudioTrackSwitching(e,t){const r=!!t.url;this.trackId=t.id;const{fragCurrent:n}=this;n&&(n.abortRequests(),this.removeUnbufferedFrags(n.start)),this.resetLoadingState(),r?(this.switchingTrack=t,this.flushAudioIfNeeded(t),this.state!==le.STOPPED&&(this.setInterval(mA),this.state=le.IDLE,this.tick())):(this.resetTransmuxer(),this.switchingTrack=null,this.bufferedTrack=t,this.clearInterval())}onManifestLoading(){super.onManifestLoading(),this.bufferFlushed=this.flushing=this.audioOnly=!1,this.resetItem(),this.trackId=-1}onLevelLoaded(e,t){this.mainDetails=t.details;const r=this.cachedTrackLoadedData;r&&(this.cachedTrackLoadedData=null,this.onAudioTrackLoaded(x.AUDIO_TRACK_LOADED,r))}onAudioTrackLoaded(e,t){var r;const{levels:n}=this,{details:s,id:a,groupId:o,track:l}=t;if(!n){this.warn(`Audio tracks reset while loading track ${a} "${l.name}" of "${o}"`);return}const u=this.mainDetails;if(!u||s.endCC>u.endCC||u.expired){this.cachedTrackLoadedData=t,this.state!==le.STOPPED&&(this.state=le.WAITING_TRACK);return}this.cachedTrackLoadedData=null,this.log(`Audio track ${a} "${l.name}" of "${o}" loaded [${s.startSN},${s.endSN}]${s.lastPartSn?`[part-${s.lastPartSn}-${s.lastPartIndex}]`:""},duration:${s.totalduration}`);const h=n[a];let d=0;if(s.live||(r=h.details)!=null&&r.live){if(this.checkLiveUpdate(s),s.deltaUpdateFailed)return;if(h.details){var p;d=this.alignPlaylists(s,h.details,(p=this.levelLastLoaded)==null?void 0:p.details)}s.alignedSliding||($b(s,u),s.alignedSliding||zu(s,u),d=s.fragmentStart)}h.details=s,this.levelLastLoaded=h,this.startFragRequested||this.setStartPosition(u,d),this.hls.trigger(x.AUDIO_TRACK_UPDATED,{details:s,id:a,groupId:t.groupId}),this.state===le.WAITING_TRACK&&!this.waitForCdnTuneIn(s)&&(this.state=le.IDLE),this.tick()}_handleFragmentLoadProgress(e){var t;const r=e.frag,{part:n,payload:s}=e,{config:a,trackId:o,levels:l}=this;if(!l){this.warn(`Audio tracks were reset while fragment load was in progress. Fragment ${r.sn} of level ${r.level} will not be buffered`);return}const u=l[o];if(!u){this.warn("Audio track is undefined on fragment load progress");return}const h=u.details;if(!h){this.warn("Audio track details undefined on fragment load progress"),this.removeUnbufferedFrags(r.start);return}const d=a.defaultAudioCodec||u.audioCodec||"mp4a.40.2";let p=this.transmuxer;p||(p=this.transmuxer=new pA(this.hls,ke.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));const g=this.initPTS[r.cc],m=(t=r.initSegment)==null?void 0:t.data;if(g!==void 0){const E=n?n.index:-1,A=E!==-1,D=new og(r.level,r.sn,r.stats.chunkCount,s.byteLength,E,A);p.push(s,m,d,"",r,n,h.totalduration,!1,D,g)}else{this.log(`Unknown video PTS for cc ${r.cc}, waiting for video PTS before demuxing audio frag ${r.sn} of [${h.startSN} ,${h.endSN}],track ${o}`);const{cache:v}=this.waitingData=this.waitingData||{frag:r,part:n,cache:new qb,complete:!1};v.push(new Uint8Array(s)),this.state!==le.STOPPED&&(this.state=le.WAITING_INIT_PTS)}}_handleFragmentLoadComplete(e){if(this.waitingData){this.waitingData.complete=!0;return}super._handleFragmentLoadComplete(e)}onBufferReset(){this.mediaBuffer=null}onBufferCreated(e,t){this.bufferFlushed=this.flushing=!1;const r=t.tracks.audio;r&&(this.mediaBuffer=r.buffer||null)}onFragLoading(e,t){!this.audioOnly&&t.frag.type===ke.MAIN&&pr(t.frag)&&(this.mainFragLoading=t,this.state===le.IDLE&&this.tick())}onFragBuffered(e,t){const{frag:r,part:n}=t;if(r.type!==ke.AUDIO){!this.audioOnly&&r.type===ke.MAIN&&!r.elementaryStreams.video&&!r.elementaryStreams.audiovideo&&(this.audioOnly=!0,this.mainFragLoading=null);return}if(this.fragContextChanged(r)){this.warn(`Fragment ${r.sn}${n?" p: "+n.index:""} of level ${r.level} finished buffering, but was aborted. state: ${this.state}, audioSwitch: ${this.switchingTrack?this.switchingTrack.name:"false"}`);return}if(pr(r)){this.fragPrevious=r;const s=this.switchingTrack;s&&(this.bufferedTrack=s,this.switchingTrack=null,this.hls.trigger(x.AUDIO_TRACK_SWITCHED,Et({},s)))}this.fragBufferedComplete(r,n),this.media&&this.tick()}onError(e,t){var r;if(t.fatal){this.state=le.ERROR;return}switch(t.details){case Q.FRAG_GAP:case Q.FRAG_PARSING_ERROR:case Q.FRAG_DECRYPT_ERROR:case Q.FRAG_LOAD_ERROR:case Q.FRAG_LOAD_TIMEOUT:case Q.KEY_LOAD_ERROR:case Q.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(ke.AUDIO,t);break;case Q.AUDIO_TRACK_LOAD_ERROR:case Q.AUDIO_TRACK_LOAD_TIMEOUT:case Q.LEVEL_PARSING_ERROR:!t.levelRetry&&this.state===le.WAITING_TRACK&&((r=t.context)==null?void 0:r.type)===lt.AUDIO_TRACK&&(this.state=le.IDLE);break;case Q.BUFFER_ADD_CODEC_ERROR:case Q.BUFFER_APPEND_ERROR:if(t.parent!=="audio")return;this.resetLoadingState();break;case Q.BUFFER_FULL_ERROR:if(t.parent!=="audio")return;this.reduceLengthAndFlushBuffer(t)&&(this.bufferedTrack=null,super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"));break;case Q.INTERNAL_EXCEPTION:this.recoverWorkerError(t);break}}onBufferFlushing(e,{type:t}){t!==Nt.VIDEO&&(this.flushing=!0)}onBufferFlushed(e,{type:t}){if(t!==Nt.VIDEO){this.flushing=!1,this.bufferFlushed=!0,this.state===le.ENDED&&(this.state=le.IDLE);const r=this.mediaBuffer||this.media;r&&(this.afterBufferFlushed(r,t,ke.AUDIO),this.tick())}}_handleTransmuxComplete(e){var t;const r="audio",{hls:n}=this,{remuxResult:s,chunkMeta:a}=e,o=this.getCurrentContext(a);if(!o){this.resetWhenMissingContext(a);return}const{frag:l,part:u,level:h}=o,{details:d}=h,{audio:p,text:g,id3:m,initSegment:v}=s;if(this.fragContextChanged(l)||!d){this.fragmentTracker.removeFragment(l);return}if(this.state=le.PARSING,this.switchingTrack&&p&&this.completeAudioSwitch(this.switchingTrack),v!=null&&v.tracks){const E=l.initSegment||l;this._bufferInitSegment(h,v.tracks,E,a),n.trigger(x.FRAG_PARSING_INIT_SEGMENT,{frag:E,id:r,tracks:v.tracks})}if(p){const{startPTS:E,endPTS:A,startDTS:D,endDTS:R}=p;u&&(u.elementaryStreams[Nt.AUDIO]={startPTS:E,endPTS:A,startDTS:D,endDTS:R}),l.setElementaryStreamInfo(Nt.AUDIO,E,A,D,R),this.bufferFragmentData(p,l,u,a)}if(m!=null&&(t=m.samples)!=null&&t.length){const E=xt({id:r,frag:l,details:d},m);n.trigger(x.FRAG_PARSING_METADATA,E)}if(g){const E=xt({id:r,frag:l,details:d},g);n.trigger(x.FRAG_PARSING_USERDATA,E)}}_bufferInitSegment(e,t,r,n){if(this.state!==le.PARSING||(t.video&&delete t.video,t.audiovideo&&delete t.audiovideo,!t.audio))return;const s=t.audio;s.id=ke.AUDIO;const a=e.audioCodec;this.log(`Init audio buffer, container:${s.container}, codecs[level/parsed]=[${a}/${s.codec}]`),a&&a.split(",").length===1&&(s.levelCodec=a),this.hls.trigger(x.BUFFER_CODECS,t);const o=s.initSegment;if(o!=null&&o.byteLength){const l={type:"audio",frag:r,part:null,chunkMeta:n,parent:r.type,data:o};this.hls.trigger(x.BUFFER_APPENDING,l)}this.tickImmediate()}loadFragment(e,t,r){const n=this.fragmentTracker.getState(e);if(this.switchingTrack||n===nr.NOT_LOADED||n===nr.PARTIAL){var s;if(!pr(e))this._loadInitSegment(e,t);else if((s=t.details)!=null&&s.live&&!this.initPTS[e.cc]){this.log(`Waiting for video PTS in continuity counter ${e.cc} of live stream before loading audio fragment ${e.sn} of level ${this.trackId}`),this.state=le.WAITING_INIT_PTS;const a=this.mainDetails;a&&a.fragmentStart!==t.details.fragmentStart&&zu(t.details,a)}else super.loadFragment(e,t,r)}else this.clearTrackerIfNeeded(e)}flushAudioIfNeeded(e){if(this.media&&this.bufferedTrack){const{name:t,lang:r,assocLang:n,characteristics:s,audioCodec:a,channels:o}=this.bufferedTrack;Ys({name:t,lang:r,assocLang:n,characteristics:s,audioCodec:a,channels:o},e,Xs)||($u(e.url,this.hls)?(this.log("Switching audio track : flushing all audio"),super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"),this.bufferedTrack=null):this.bufferedTrack=e)}}completeAudioSwitch(e){const{hls:t}=this;this.flushAudioIfNeeded(e),this.bufferedTrack=e,this.switchingTrack=null,t.trigger(x.AUDIO_TRACK_SWITCHED,Et({},e))}}class _g extends Cn{constructor(e,t){super(t,e.logger),this.hls=void 0,this.canLoad=!1,this.timer=-1,this.hls=e}destroy(){this.clearTimer(),this.hls=this.log=this.warn=null}clearTimer(){this.timer!==-1&&(self.clearTimeout(this.timer),this.timer=-1)}startLoad(){this.canLoad=!0,this.loadPlaylist()}stopLoad(){this.canLoad=!1,this.clearTimer()}switchParams(e,t,r){const n=t==null?void 0:t.renditionReports;if(n){let s=-1;for(let a=0;a<n.length;a++){const o=n[a];let l;try{l=new self.URL(o.URI,t.url).href}catch(u){this.warn(`Could not construct new URL for Rendition Report: ${u}`),l=o.URI||""}if(l===e){s=a;break}else l===e.substring(0,l.length)&&(s=a)}if(s!==-1){const a=n[s],o=parseInt(a["LAST-MSN"])||(t==null?void 0:t.lastPartSn);let l=parseInt(a["LAST-PART"])||(t==null?void 0:t.lastPartIndex);if(this.hls.config.lowLatencyMode){const h=Math.min(t.age-t.partTarget,t.targetduration);l>=0&&h>t.partTarget&&(l+=1)}const u=r&&zE(r);return new JE(o,l>=0?l:void 0,u)}}}loadPlaylist(e){this.clearTimer()}loadingPlaylist(e,t){this.clearTimer()}shouldLoadPlaylist(e){return this.canLoad&&!!e&&!!e.url&&(!e.details||e.details.live)}getUrlWithDirectives(e,t){if(t)try{return t.addDirectives(e)}catch(r){this.warn(`Could not construct new URL with HLS Delivery Directives: ${r}`)}return e}playlistLoaded(e,t,r){const{details:n,stats:s}=t,a=self.performance.now(),o=s.loading.first?Math.max(0,a-s.loading.first):0;n.advancedDateTime=Date.now()-o;const l=this.hls.config.timelineOffset;if(l!==n.appliedTimelineOffset){const h=Math.max(l||0,0);n.appliedTimelineOffset=h,n.fragments.forEach(d=>{d.start=d.playlistOffset+h})}if(n.live||r!=null&&r.live){const h="levelInfo"in t?t.levelInfo:t.track;if(n.reloaded(r),r&&n.fragments.length>0){IL(r,n);const D=n.playlistParsingError;if(D){this.warn(D);const R=this.hls;if(!R.config.ignorePlaylistParsingErrors){var u;const{networkDetails:_}=t;R.trigger(x.ERROR,{type:Fe.NETWORK_ERROR,details:Q.LEVEL_PARSING_ERROR,fatal:!1,url:n.url,error:D,reason:D.message,level:t.level||void 0,parent:(u=n.fragments[0])==null?void 0:u.type,networkDetails:_,stats:s});return}n.playlistParsingError=null}}n.requestScheduled===-1&&(n.requestScheduled=s.loading.start);const d=this.hls.mainForwardBufferInfo,p=d?d.end-d.len:0,g=(n.edge-p)*1e3,m=Mb(n,g);if(n.requestScheduled+m<a?n.requestScheduled=a:n.requestScheduled+=m,this.log(`live playlist ${e} ${n.advanced?"REFRESHED "+n.lastPartSn+"-"+n.lastPartIndex:n.updated?"UPDATED":"MISSED"}`),!this.canLoad||!n.live)return;let v,E,A;if(n.canBlockReload&&n.endSN&&n.advanced){const D=this.hls.config.lowLatencyMode,R=n.lastPartSn,_=n.endSN,F=n.lastPartIndex,w=F!==-1,C=R===_;w?C?(E=_+1,A=D?0:F):(E=R,A=D?F+1:n.maxPartIndex):E=_+1;const M=n.age,L=M+n.ageHeader;let I=Math.min(L-n.partTarget,n.targetduration*1.5);if(I>0){if(L>n.targetduration*3)this.log(`Playlist last advanced ${M.toFixed(2)}s ago. Omitting segment and part directives.`),E=void 0,A=void 0;else if(r!=null&&r.tuneInGoal&&L-n.partTarget>r.tuneInGoal)this.warn(`CDN Tune-in goal increased from: ${r.tuneInGoal} to: ${I} with playlist age: ${n.age}`),I=0;else{const U=Math.floor(I/n.targetduration);if(E+=U,A!==void 0){const q=Math.round(I%n.targetduration/n.partTarget);A+=q}this.log(`CDN Tune-in age: ${n.ageHeader}s last advanced ${M.toFixed(2)}s goal: ${I} skip sn ${U} to part ${A}`)}n.tuneInGoal=I}if(v=this.getDeliveryDirectives(n,t.deliveryDirectives,E,A),D||!C){n.requestScheduled=a,this.loadingPlaylist(h,v);return}}else(n.canBlockReload||n.canSkipUntil)&&(v=this.getDeliveryDirectives(n,t.deliveryDirectives,E,A));v&&E!==void 0&&n.canBlockReload&&(n.requestScheduled=s.loading.first+Math.max(m-o*2,m/2)),this.scheduleLoading(h,v,n)}else this.clearTimer()}scheduleLoading(e,t,r){const n=r||e.details;if(!n){this.loadingPlaylist(e,t);return}const s=self.performance.now(),a=n.requestScheduled;if(s>=a){this.loadingPlaylist(e,t);return}const o=a-s;this.log(`reload live playlist ${e.name||e.bitrate+"bps"} in ${Math.round(o)} ms`),this.clearTimer(),this.timer=self.setTimeout(()=>this.loadingPlaylist(e,t),o)}getDeliveryDirectives(e,t,r,n){let s=zE(e);return t!=null&&t.skip&&e.deltaUpdateFailed&&(r=t.msn,n=t.part,s=Uu.No),new JE(r,n,s)}checkRetry(e){const t=e.details,r=Gu(e),n=e.errorAction,{action:s,retryCount:a=0,retryConfig:o}=n||{},l=!!n&&!!o&&(s===Rr.RetryRequest||!n.resolved&&s===Rr.SendAlternateToPenaltyBox);if(l){var u;if(a>=o.maxNumRetry)return!1;if(r&&(u=e.context)!=null&&u.deliveryDirectives)this.warn(`Retrying playlist loading ${a+1}/${o.maxNumRetry} after "${t}" without delivery-directives`),this.loadPlaylist();else{const h=sg(o,a);this.clearTimer(),this.timer=self.setTimeout(()=>this.loadPlaylist(),h),this.warn(`Retrying playlist loading ${a+1}/${o.maxNumRetry} after "${t}" in ${h}ms`)}e.levelRetry=!0,n.resolved=!0}return l}}function yA(i,e){if(i.length!==e.length)return!1;for(let t=0;t<i.length;t++)if(!ll(i[t].attrs,e[t].attrs))return!1;return!0}function ll(i,e,t){const r=i["STABLE-RENDITION-ID"];return r&&!t?r===e["STABLE-RENDITION-ID"]:!(t||["LANGUAGE","NAME","CHARACTERISTICS","AUTOSELECT","DEFAULT","FORCED","ASSOC-LANGUAGE"]).some(n=>i[n]!==e[n])}function Mg(i,e){return e.label.toLowerCase()===i.name.toLowerCase()&&(!e.language||e.language.toLowerCase()===(i.lang||"").toLowerCase())}class M_ extends _g{constructor(e){super(e,"audio-track-controller"),this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.registerListeners()}registerListeners(){const{hls:e}=this;e.on(x.MANIFEST_LOADING,this.onManifestLoading,this),e.on(x.MANIFEST_PARSED,this.onManifestParsed,this),e.on(x.LEVEL_LOADING,this.onLevelLoading,this),e.on(x.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(x.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(x.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(x.MANIFEST_LOADING,this.onManifestLoading,this),e.off(x.MANIFEST_PARSED,this.onManifestParsed,this),e.off(x.LEVEL_LOADING,this.onLevelLoading,this),e.off(x.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(x.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(x.ERROR,this.onError,this)}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,super.destroy()}onManifestLoading(){this.tracks=[],this.tracksInGroup=[],this.groupIds=null,this.currentTrack=null,this.trackId=-1,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.audioTracks||[]}onAudioTrackLoaded(e,t){const{id:r,groupId:n,details:s}=t,a=this.tracksInGroup[r];if(!a||a.groupId!==n){this.warn(`Audio track with id:${r} and group:${n} not found in active group ${a==null?void 0:a.groupId}`);return}const o=a.details;a.details=t.details,this.log(`Audio track ${r} "${a.name}" lang:${a.lang} group:${n} loaded [${s.startSN}-${s.endSN}]`),r===this.trackId&&this.playlistLoaded(r,t,o)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!t)return;const r=t.audioGroups||null,n=this.groupIds;let s=this.currentTrack;if(!r||(n==null?void 0:n.length)!==(r==null?void 0:r.length)||r!=null&&r.some(o=>(n==null?void 0:n.indexOf(o))===-1)){this.groupIds=r,this.trackId=-1,this.currentTrack=null;const o=this.tracks.filter(p=>!r||r.indexOf(p.groupId)!==-1);if(o.length)this.selectDefaultTrack&&!o.some(p=>p.default)&&(this.selectDefaultTrack=!1),o.forEach((p,g)=>{p.id=g});else if(!s&&!this.tracksInGroup.length)return;this.tracksInGroup=o;const l=this.hls.config.audioPreference;if(!s&&l){const p=an(l,o,Xs);if(p>-1)s=o[p];else{const g=an(l,this.tracks);s=this.tracks[g]}}let u=this.findTrackId(s);u===-1&&s&&(u=this.findTrackId(null));const h={audioTracks:o};this.log(`Updating audio tracks, ${o.length} track(s) found in group(s): ${r==null?void 0:r.join(",")}`),this.hls.trigger(x.AUDIO_TRACKS_UPDATED,h);const d=this.trackId;if(u!==-1&&d===-1)this.setAudioTrack(u);else if(o.length&&d===-1){var a;const p=new Error(`No audio track selected for current audio group-ID(s): ${(a=this.groupIds)==null?void 0:a.join(",")} track count: ${o.length}`);this.warn(p.message),this.hls.trigger(x.ERROR,{type:Fe.MEDIA_ERROR,details:Q.AUDIO_TRACK_LOAD_ERROR,fatal:!0,error:p})}}}onError(e,t){t.fatal||!t.context||t.context.type===lt.AUDIO_TRACK&&t.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(t.context.groupId)!==-1)&&this.checkRetry(t)}get allAudioTracks(){return this.tracks}get audioTracks(){return this.tracksInGroup}get audioTrack(){return this.trackId}set audioTrack(e){this.selectDefaultTrack=!1,this.setAudioTrack(e)}setAudioOption(e){const t=this.hls;if(t.config.audioPreference=e,e){const r=this.allAudioTracks;if(this.selectDefaultTrack=!1,r.length){const n=this.currentTrack;if(n&&Ys(e,n,Xs))return n;const s=an(e,this.tracksInGroup,Xs);if(s>-1){const a=this.tracksInGroup[s];return this.setAudioTrack(s),a}else if(n){let a=t.loadLevel;a===-1&&(a=t.firstAutoLevel);const o=Yw(e,t.levels,r,a,Xs);if(o===-1)return null;t.nextLoadLevel=o}if(e.channels||e.audioCodec){const a=an(e,r);if(a>-1)return r[a]}}}return null}setAudioTrack(e){const t=this.tracksInGroup;if(e<0||e>=t.length){this.warn(`Invalid audio track id: ${e}`);return}this.selectDefaultTrack=!1;const r=this.currentTrack,n=t[e],s=n.details&&!n.details.live;if(e===this.trackId&&n===r&&s||(this.log(`Switching to audio-track ${e} "${n.name}" lang:${n.lang} group:${n.groupId} channels:${n.channels}`),this.trackId=e,this.currentTrack=n,this.hls.trigger(x.AUDIO_TRACK_SWITCHING,Et({},n)),s))return;const a=this.switchParams(n.url,r==null?void 0:r.details,n.details);this.loadPlaylist(a)}findTrackId(e){const t=this.tracksInGroup;for(let r=0;r<t.length;r++){const n=t[r];if(!(this.selectDefaultTrack&&!n.default)&&(!e||Ys(e,n,Xs)))return r}if(e){const{name:r,lang:n,assocLang:s,characteristics:a,audioCodec:o,channels:l}=e;for(let u=0;u<t.length;u++){const h=t[u];if(Ys({name:r,lang:n,assocLang:s,characteristics:a,audioCodec:o,channels:l},h,Xs))return u}for(let u=0;u<t.length;u++){const h=t[u];if(ll(e.attrs,h.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return u}for(let u=0;u<t.length;u++){const h=t[u];if(ll(e.attrs,h.attrs,["LANGUAGE"]))return u}}return-1}loadPlaylist(e){super.loadPlaylist();const t=this.currentTrack;this.shouldLoadPlaylist(t)&&$u(t.url,this.hls)&&this.scheduleLoading(t,e)}loadingPlaylist(e,t){super.loadingPlaylist(e,t);const r=e.id,n=e.groupId,s=this.getUrlWithDirectives(e.url,t),a=e.details,o=a==null?void 0:a.age;this.log(`Loading audio-track ${r} "${e.name}" lang:${e.lang} group:${n}${(t==null?void 0:t.msn)!==void 0?" at sn "+t.msn+" part "+t.part:""}${o&&a.live?" age "+o.toFixed(1)+(a.type&&" "+a.type||""):""} ${s}`),this.hls.trigger(x.AUDIO_TRACK_LOADING,{url:s,id:r,groupId:n,deliveryDirectives:t||null,track:e})}}class P_{constructor(e){this.tracks=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.tracks=e}destroy(){this.tracks=this.queues=null}append(e,t,r){if(this.queues===null||this.tracks===null)return;const n=this.queues[t];n.push(e),n.length===1&&!r&&this.executeNext(t)}appendBlocker(e){return new Promise(t=>{const r={label:"async-blocker",execute:t,onStart:()=>{},onComplete:()=>{},onError:()=>{}};this.append(r,e)})}prependBlocker(e){return new Promise(t=>{if(this.queues){const r={label:"async-blocker-prepend",execute:t,onStart:()=>{},onComplete:()=>{},onError:()=>{}};this.queues[e].unshift(r)}})}removeBlockers(){this.queues!==null&&[this.queues.video,this.queues.audio,this.queues.audiovideo].forEach(e=>{var t;const r=(t=e[0])==null?void 0:t.label;(r==="async-blocker"||r==="async-blocker-prepend")&&(e[0].execute(),e.splice(0,1))})}unblockAudio(e){if(this.queues===null)return;this.queues.audio[0]===e&&this.shiftAndExecuteNext("audio")}executeNext(e){if(this.queues===null||this.tracks===null)return;const t=this.queues[e];if(t.length){const n=t[0];try{n.execute()}catch(s){var r;if(n.onError(s),this.queues===null||this.tracks===null)return;const a=(r=this.tracks[e])==null?void 0:r.buffer;a!=null&&a.updating||this.shiftAndExecuteNext(e)}}}shiftAndExecuteNext(e){this.queues!==null&&(this.queues[e].shift(),this.executeNext(e))}current(e){var t;return((t=this.queues)==null?void 0:t[e][0])||null}toString(){const{queues:e,tracks:t}=this;return e===null||t===null?"<destroyed>":`
${this.list("video")}
${this.list("audio")}
${this.list("audiovideo")}}`}list(e){var t,r;return(t=this.queues)!=null&&t[e]||(r=this.tracks)!=null&&r[e]?`${e}: (${this.listSbInfo(e)}) ${this.listOps(e)}`:""}listSbInfo(e){var t;const r=(t=this.tracks)==null?void 0:t[e],n=r==null?void 0:r.buffer;return n?`SourceBuffer${n.updating?" updating":""}${r.ended?" ended":""}${r.ending?" ending":""}`:"none"}listOps(e){var t;return((t=this.queues)==null?void 0:t[e].map(r=>r.label).join(", "))||""}}const vA=/(avc[1234]|hvc1|hev1|dvh[1e]|vp09|av01)(?:\.[^.,]+)+/,EA="HlsJsTrackRemovedError";class k_ extends Error{constructor(e){super(e),this.name=EA}}class O_ extends Cn{constructor(e,t){super("buffer-controller",e.logger),this.hls=void 0,this.fragmentTracker=void 0,this.details=null,this._objectUrl=null,this.operationQueue=null,this.bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.blockedAudioAppend=null,this.lastVideoAppendEnd=0,this.appendSource=void 0,this.transferData=void 0,this.overrides=void 0,this.appendErrors={audio:0,video:0,audiovideo:0},this.tracks={},this.sourceBuffers=[[null,null],[null,null]],this._onEndStreaming=r=>{var n;this.hls&&((n=this.mediaSource)==null?void 0:n.readyState)==="open"&&this.hls.pauseBuffering()},this._onStartStreaming=r=>{this.hls&&this.hls.resumeBuffering()},this._onMediaSourceOpen=r=>{const{media:n,mediaSource:s}=this;r&&this.log("Media source opened"),!(!n||!s)&&(s.removeEventListener("sourceopen",this._onMediaSourceOpen),n.removeEventListener("emptied",this._onMediaEmptied),this.updateDuration(),this.hls.trigger(x.MEDIA_ATTACHED,{media:n,mediaSource:s}),this.mediaSource!==null&&this.checkPendingTracks())},this._onMediaSourceClose=()=>{this.log("Media source closed")},this._onMediaSourceEnded=()=>{this.log("Media source ended")},this._onMediaEmptied=()=>{const{mediaSrc:r,_objectUrl:n}=this;r!==n&&this.error(`Media element src was set while attaching MediaSource (${n} > ${r})`)},this.hls=e,this.fragmentTracker=t,this.appendSource=hw(hs(e.config.preferManagedMediaSource)),this.initTracks(),this.registerListeners()}hasSourceTypes(){return Object.keys(this.tracks).length>0}destroy(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.transferData=this.overrides=void 0,this.operationQueue&&(this.operationQueue.destroy(),this.operationQueue=null),this.hls=this.fragmentTracker=null,this._onMediaSourceOpen=this._onMediaSourceClose=null,this._onMediaSourceEnded=null,this._onStartStreaming=this._onEndStreaming=null}registerListeners(){const{hls:e}=this;e.on(x.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(x.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(x.MANIFEST_LOADING,this.onManifestLoading,this),e.on(x.MANIFEST_PARSED,this.onManifestParsed,this),e.on(x.BUFFER_RESET,this.onBufferReset,this),e.on(x.BUFFER_APPENDING,this.onBufferAppending,this),e.on(x.BUFFER_CODECS,this.onBufferCodecs,this),e.on(x.BUFFER_EOS,this.onBufferEos,this),e.on(x.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(x.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(x.FRAG_PARSED,this.onFragParsed,this),e.on(x.FRAG_CHANGED,this.onFragChanged,this),e.on(x.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(x.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(x.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(x.MANIFEST_LOADING,this.onManifestLoading,this),e.off(x.MANIFEST_PARSED,this.onManifestParsed,this),e.off(x.BUFFER_RESET,this.onBufferReset,this),e.off(x.BUFFER_APPENDING,this.onBufferAppending,this),e.off(x.BUFFER_CODECS,this.onBufferCodecs,this),e.off(x.BUFFER_EOS,this.onBufferEos,this),e.off(x.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(x.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(x.FRAG_PARSED,this.onFragParsed,this),e.off(x.FRAG_CHANGED,this.onFragChanged,this),e.off(x.ERROR,this.onError,this)}transferMedia(){const{media:e,mediaSource:t}=this;if(!e)return null;const r={};if(this.operationQueue){const s=this.isUpdating();s||this.operationQueue.removeBlockers();const a=this.isQueued();(s||a)&&this.warn(`Transfering MediaSource with${a?" operations in queue":""}${s?" updating SourceBuffer(s)":""} ${this.operationQueue}`),this.operationQueue.destroy()}const n=this.transferData;return!this.sourceBufferCount&&n&&n.mediaSource===t?xt(r,n.tracks):this.sourceBuffers.forEach(s=>{const[a]=s;a&&(r[a]=xt({},this.tracks[a]),this.removeBuffer(a)),s[0]=s[1]=null}),{media:e,mediaSource:t,tracks:r}}initTracks(){const e={};this.sourceBuffers=[[null,null],[null,null]],this.tracks=e,this.resetQueue(),this.resetAppendErrors(),this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.lastVideoAppendEnd=0}onManifestLoading(){this.bufferCodecEventsTotal=0,this.details=null}onManifestParsed(e,t){var r;let n=2;(t.audio&&!t.video||!t.altAudio)&&(n=1),this.bufferCodecEventsTotal=n,this.log(`${n} bufferCodec event(s) expected.`),(r=this.transferData)!=null&&r.mediaSource&&this.sourceBufferCount&&n&&this.bufferCreated()}onMediaAttaching(e,t){const r=this.media=t.media,n=hs(this.appendSource);if(this.transferData=this.overrides=void 0,r&&n){const s=!!t.mediaSource;(s||t.overrides)&&(this.transferData=t,this.overrides=t.overrides);const a=this.mediaSource=t.mediaSource||new n;if(this.assignMediaSource(a),s)this._objectUrl=r.src,this.attachTransferred();else{const o=this._objectUrl=self.URL.createObjectURL(a);if(this.appendSource)try{r.removeAttribute("src");const l=self.ManagedMediaSource;r.disableRemotePlayback=r.disableRemotePlayback||l&&a instanceof l,bA(r),F_(r,o),r.load()}catch{r.src=o}else r.src=o}r.addEventListener("emptied",this._onMediaEmptied)}}assignMediaSource(e){var t,r;this.log(`${((t=this.transferData)==null?void 0:t.mediaSource)===e?"transferred":"created"} media source: ${(r=e.constructor)==null?void 0:r.name}`),e.addEventListener("sourceopen",this._onMediaSourceOpen),e.addEventListener("sourceended",this._onMediaSourceEnded),e.addEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(e.addEventListener("startstreaming",this._onStartStreaming),e.addEventListener("endstreaming",this._onEndStreaming))}attachTransferred(){const e=this.media,t=this.transferData;if(!t||!e)return;const r=this.tracks,n=t.tracks,s=n?Object.keys(n):null,a=s?s.length:0,o=()=>{this.media&&this.mediaSourceOpenOrEnded&&this._onMediaSourceOpen()};if(n&&s&&a){if(!this.tracksReady){this.hls.config.startFragPrefetch=!0,this.log("attachTransferred: waiting for SourceBuffer track info");return}if(this.log(`attachTransferred: (bufferCodecEventsTotal ${this.bufferCodecEventsTotal})
required tracks: ${Gt(r,(l,u)=>l==="initSegment"?void 0:u)};
transfer tracks: ${Gt(n,(l,u)=>l==="initSegment"?void 0:u)}}`),!NE(n,r)){t.mediaSource=null,t.tracks=void 0;const l=e.currentTime,u=this.details,h=Math.max(l,(u==null?void 0:u.fragments[0].start)||0);if(h-l>1){this.log(`attachTransferred: waiting for playback to reach new tracks start time ${l} -> ${h}`);return}this.warn(`attachTransferred: resetting MediaSource for incompatible tracks ("${Object.keys(n)}"->"${Object.keys(r)}") start time: ${h} currentTime: ${l}`),this.onMediaDetaching(x.MEDIA_DETACHING,{}),this.onMediaAttaching(x.MEDIA_ATTACHING,t),e.currentTime=h;return}this.transferData=void 0,s.forEach(l=>{const u=l,h=n[u];if(h){const d=h.buffer;if(d){const p=this.fragmentTracker,g=h.id;if(p.hasFragments(g)||p.hasParts(g)){const E=Xe.getBuffered(d);p.detectEvictedFragments(u,E,g,null,!0)}const m=Pg(u),v=[u,d];this.sourceBuffers[m]=v,d.updating&&this.operationQueue&&this.operationQueue.prependBlocker(u),this.trackSourceBuffer(u,h)}}}),o(),this.bufferCreated()}else this.log("attachTransferred: MediaSource w/o SourceBuffers"),o()}get mediaSourceOpenOrEnded(){var e;const t=(e=this.mediaSource)==null?void 0:e.readyState;return t==="open"||t==="ended"}onMediaDetaching(e,t){const r=!!t.transferMedia;this.transferData=this.overrides=void 0;const{media:n,mediaSource:s,_objectUrl:a}=this;if(s){if(this.log(`media source ${r?"transferring":"detaching"}`),r)this.sourceBuffers.forEach(([o])=>{o&&this.removeBuffer(o)}),this.resetQueue();else{if(this.mediaSourceOpenOrEnded){const o=s.readyState==="open";try{const l=s.sourceBuffers;for(let u=l.length;u--;)o&&l[u].abort(),s.removeSourceBuffer(l[u]);o&&s.endOfStream()}catch(l){this.warn(`onMediaDetaching: ${l.message} while calling endOfStream`)}}this.sourceBufferCount&&this.onBufferReset()}s.removeEventListener("sourceopen",this._onMediaSourceOpen),s.removeEventListener("sourceended",this._onMediaSourceEnded),s.removeEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(s.removeEventListener("startstreaming",this._onStartStreaming),s.removeEventListener("endstreaming",this._onEndStreaming)),this.mediaSource=null,this._objectUrl=null}n&&(n.removeEventListener("emptied",this._onMediaEmptied),r||(a&&self.URL.revokeObjectURL(a),this.mediaSrc===a?(n.removeAttribute("src"),this.appendSource&&bA(n),n.load()):this.warn("media|source.src was changed by a third party - skip cleanup")),this.media=null),this.hls.trigger(x.MEDIA_DETACHED,t)}onBufferReset(){this.sourceBuffers.forEach(([e])=>{e&&this.resetBuffer(e)}),this.initTracks()}resetBuffer(e){var t;const r=(t=this.tracks[e])==null?void 0:t.buffer;if(this.removeBuffer(e),r)try{var n;(n=this.mediaSource)!=null&&n.sourceBuffers.length&&this.mediaSource.removeSourceBuffer(r)}catch(s){this.warn(`onBufferReset ${e}`,s)}delete this.tracks[e]}removeBuffer(e){this.removeBufferListeners(e),this.sourceBuffers[Pg(e)]=[null,null];const t=this.tracks[e];t&&(t.buffer=void 0)}resetQueue(){this.operationQueue&&this.operationQueue.destroy(),this.operationQueue=new P_(this.tracks)}onBufferCodecs(e,t){const r=this.tracks,n=Object.keys(t);this.log(`BUFFER_CODECS: "${n}" (current SB count ${this.sourceBufferCount})`);const s="audiovideo"in t&&(r.audio||r.video)||r.audiovideo&&("audio"in t||"video"in t),a=!s&&this.sourceBufferCount&&this.media&&n.some(o=>!r[o]);if(s||a){this.warn(`Unsupported transition between "${Object.keys(r)}" and "${n}" SourceBuffers`);return}n.forEach(o=>{var l,u,h;const d=t[o],{id:p,codec:g,levelCodec:m,container:v,metadata:E,supplemental:A}=d;let D=r[o];const R=(l=this.transferData)==null||(u=l.tracks)==null?void 0:u[o],_=R!=null&&R.buffer?R:D,F=(_==null?void 0:_.pendingCodec)||(_==null?void 0:_.codec),w=_==null?void 0:_.levelCodec;D||(D=r[o]={buffer:void 0,listeners:[],codec:g,supplemental:A,container:v,levelCodec:m,metadata:E,id:p});const C=Fu(F,w),M=C==null?void 0:C.replace(vA,"$1");let L=Fu(g,m);const I=(h=L)==null?void 0:h.replace(vA,"$1");L&&C&&M!==I&&(o.slice(0,5)==="audio"&&(L=Ou(L,this.appendSource)),this.log(`switching codec ${F} to ${L}`),L!==(D.pendingCodec||D.codec)&&(D.pendingCodec=L),D.container=v,this.appendChangeType(o,v,L))}),(this.tracksReady||this.sourceBufferCount)&&(t.tracks=this.sourceBufferTracks),!this.sourceBufferCount&&this.mediaSourceOpenOrEnded&&this.checkPendingTracks()}get sourceBufferTracks(){return Object.keys(this.tracks).reduce((e,t)=>{const r=this.tracks[t];return e[t]={id:r.id,container:r.container,codec:r.codec,levelCodec:r.levelCodec},e},{})}appendChangeType(e,t,r){const n=`${t};codecs=${r}`,s={label:`change-type=${n}`,execute:()=>{const a=this.tracks[e];if(a){const o=a.buffer;o!=null&&o.changeType&&(this.log(`changing ${e} sourceBuffer type to ${n}`),o.changeType(n),a.codec=r,a.container=t)}this.shiftAndExecuteNext(e)},onStart:()=>{},onComplete:()=>{},onError:a=>{this.warn(`Failed to change ${e} SourceBuffer type`,a)}};this.append(s,e,this.isPending(this.tracks[e]))}blockAudio(e){var t;const r=e.start,n=r+e.duration*.05;if(((t=this.fragmentTracker.getAppendedFrag(r,ke.MAIN))==null?void 0:t.gap)===!0)return;const a={label:"block-audio",execute:()=>{var o;const l=this.tracks.video;(this.lastVideoAppendEnd>n||l!=null&&l.buffer&&Xe.isBuffered(l.buffer,n)||((o=this.fragmentTracker.getAppendedFrag(n,ke.MAIN))==null?void 0:o.gap)===!0)&&(this.blockedAudioAppend=null,this.shiftAndExecuteNext("audio"))},onStart:()=>{},onComplete:()=>{},onError:o=>{this.warn("Error executing block-audio operation",o)}};this.blockedAudioAppend={op:a,frag:e},this.append(a,"audio",!0)}unblockAudio(){const{blockedAudioAppend:e,operationQueue:t}=this;e&&t&&(this.blockedAudioAppend=null,t.unblockAudio(e.op))}onBufferAppending(e,t){const{tracks:r}=this,{data:n,type:s,parent:a,frag:o,part:l,chunkMeta:u}=t,h=u.buffering[s],d=o.sn,p=self.performance.now();h.start=p;const g=o.stats.buffering,m=l?l.stats.buffering:null;g.start===0&&(g.start=p),m&&m.start===0&&(m.start=p);const v=r.audio;let E=!1;s==="audio"&&(v==null?void 0:v.container)==="audio/mpeg"&&(E=!this.lastMpegAudioChunk||u.id===1||this.lastMpegAudioChunk.sn!==u.sn,this.lastMpegAudioChunk=u);const A=this.tracks.video,D=A==null?void 0:A.buffer;if(D&&d!=="initSegment"){const F=l||o,w=this.blockedAudioAppend;if(s==="audio"&&a!=="main"&&!this.blockedAudioAppend){const M=F.start+F.duration*.05,L=D.buffered,I=this.currentOp("video");!L.length&&!I?this.blockAudio(F):!I&&!Xe.isBuffered(D,M)&&this.lastVideoAppendEnd<M&&this.blockAudio(F)}else if(s==="video"){const C=F.end;if(w){const M=w.frag.start;(C>M||C<this.lastVideoAppendEnd||Xe.isBuffered(D,M))&&this.unblockAudio()}this.lastVideoAppendEnd=C}}const R=(l||o).start,_={label:`append-${s}`,execute:()=>{if(h.executeStart=self.performance.now(),E){const F=this.tracks[s];if(F){const w=F.buffer;if(w){const C=R-w.timestampOffset;Math.abs(C)>=.1&&(this.log(`Updating audio SourceBuffer timestampOffset to ${R} (delta: ${C}) sn: ${d})`),w.timestampOffset=R)}}}this.appendExecutor(n,s)},onStart:()=>{},onComplete:()=>{const F=self.performance.now();h.executeEnd=h.end=F,g.first===0&&(g.first=F),m&&m.first===0&&(m.first=F);const w={};this.sourceBuffers.forEach(([C,M])=>{C&&(w[C]=Xe.getBuffered(M))}),this.appendErrors[s]=0,s==="audio"||s==="video"?this.appendErrors.audiovideo=0:(this.appendErrors.audio=0,this.appendErrors.video=0),this.hls.trigger(x.BUFFER_APPENDED,{type:s,frag:o,part:l,chunkMeta:u,parent:o.type,timeRanges:w})},onError:F=>{var w;const C={type:Fe.MEDIA_ERROR,parent:o.type,details:Q.BUFFER_APPEND_ERROR,sourceBufferName:s,frag:o,part:l,chunkMeta:u,error:F,err:F,fatal:!1},M=(w=this.media)==null?void 0:w.error;if(F.code===DOMException.QUOTA_EXCEEDED_ERR)C.details=Q.BUFFER_FULL_ERROR;else if(F.code===DOMException.INVALID_STATE_ERR&&this.mediaSourceOpenOrEnded&&!M)C.errorAction=Zo(!0);else if(F.name===EA&&this.sourceBufferCount===0)C.errorAction=Zo(!0);else{const L=++this.appendErrors[s];this.warn(`Failed ${L}/${this.hls.config.appendErrorMaxRetry} times to append segment in "${s}" sourceBuffer (${M||"no media error"})`),(L>=this.hls.config.appendErrorMaxRetry||M)&&(C.fatal=!0)}this.hls.trigger(x.ERROR,C)}};this.append(_,s,this.isPending(this.tracks[s]))}getFlushOp(e,t,r){return this.log(`queuing "${e}" remove ${t}-${r}`),{label:"remove",execute:()=>{this.removeExecutor(e,t,r)},onStart:()=>{},onComplete:()=>{this.hls.trigger(x.BUFFER_FLUSHED,{type:e})},onError:n=>{this.warn(`Failed to remove ${t}-${r} from "${e}" SourceBuffer`,n)}}}onBufferFlushing(e,t){const{type:r,startOffset:n,endOffset:s}=t;r?this.append(this.getFlushOp(r,n,s),r):this.sourceBuffers.forEach(([a])=>{a&&this.append(this.getFlushOp(a,n,s),a)})}onFragParsed(e,t){const{frag:r,part:n}=t,s=[],a=n?n.elementaryStreams:r.elementaryStreams;a[Nt.AUDIOVIDEO]?s.push("audiovideo"):(a[Nt.AUDIO]&&s.push("audio"),a[Nt.VIDEO]&&s.push("video"));const o=()=>{const l=self.performance.now();r.stats.buffering.end=l,n&&(n.stats.buffering.end=l);const u=n?n.stats:r.stats;this.hls.trigger(x.FRAG_BUFFERED,{frag:r,part:n,stats:u,id:r.type})};s.length===0&&this.warn(`Fragments must have at least one ElementaryStreamType set. type: ${r.type} level: ${r.level} sn: ${r.sn}`),this.blockBuffers(o,s).catch(l=>{this.warn(`Fragment buffered callback ${l}`),this.stepOperationQueue(this.sourceBufferTypes)})}onFragChanged(e,t){this.trimBuffers()}get bufferedToEnd(){return this.sourceBufferCount>0&&!this.sourceBuffers.some(([e])=>{var t,r;return e&&(!((t=this.tracks[e])!=null&&t.ended)||((r=this.tracks[e])==null?void 0:r.ending))})}onBufferEos(e,t){var r;this.sourceBuffers.forEach(([a])=>{if(a){const o=this.tracks[a];(!t.type||t.type===a)&&(o.ending=!0,o.ended||(o.ended=!0,this.log(`${a} buffer reached EOS`)))}});const n=((r=this.overrides)==null?void 0:r.endOfStream)!==!1;this.sourceBufferCount>0&&!this.sourceBuffers.some(([a])=>{var o;return a&&!((o=this.tracks[a])!=null&&o.ended)})&&(n?(this.log("Queueing EOS"),this.blockUntilOpen(()=>{this.tracksEnded();const{mediaSource:a}=this;if(!a||a.readyState!=="open"){a&&this.log(`Could not call mediaSource.endOfStream(). mediaSource.readyState: ${a.readyState}`);return}this.log("Calling mediaSource.endOfStream()"),a.endOfStream(),this.hls.trigger(x.BUFFERED_TO_END,void 0)})):(this.tracksEnded(),this.hls.trigger(x.BUFFERED_TO_END,void 0)))}tracksEnded(){this.sourceBuffers.forEach(([e])=>{if(e!==null){const t=this.tracks[e];t&&(t.ending=!1)}})}onLevelUpdated(e,{details:t}){t.fragments.length&&(this.details=t,this.updateDuration())}updateDuration(){const e=this.getDurationAndRange();e&&this.blockUntilOpen(()=>this.updateMediaSource(e))}onError(e,t){if(t.details===Q.BUFFER_APPEND_ERROR&&t.frag){var r;const n=(r=t.errorAction)==null?void 0:r.nextAutoLevel;Ce(n)&&n!==t.frag.level&&this.resetAppendErrors()}}resetAppendErrors(){this.appendErrors={audio:0,video:0,audiovideo:0}}trimBuffers(){const{hls:e,details:t,media:r}=this;if(!r||t===null||!this.sourceBufferCount)return;const n=e.config,s=r.currentTime,a=t.levelTargetDuration,o=t.live&&n.liveBackBufferLength!==null?n.liveBackBufferLength:n.backBufferLength;if(Ce(o)&&o>=0){const l=Math.max(o,a),u=Math.floor(s/a)*a-l;this.flushBackBuffer(s,a,u)}if(Ce(n.frontBufferFlushThreshold)&&n.frontBufferFlushThreshold>0){const l=Math.max(n.maxBufferLength,n.frontBufferFlushThreshold),u=Math.max(l,a),h=Math.floor(s/a)*a+u;this.flushFrontBuffer(s,a,h)}}flushBackBuffer(e,t,r){this.sourceBuffers.forEach(([n,s])=>{if(s){const o=Xe.getBuffered(s);if(o.length>0&&r>o.start(0)){var a;this.hls.trigger(x.BACK_BUFFER_REACHED,{bufferEnd:r});const l=this.tracks[n];if((a=this.details)!=null&&a.live)this.hls.trigger(x.LIVE_BACK_BUFFER_REACHED,{bufferEnd:r});else if(l!=null&&l.ended){this.log(`Cannot flush ${n} back buffer while SourceBuffer is in ended state`);return}this.hls.trigger(x.BUFFER_FLUSHING,{startOffset:0,endOffset:r,type:n})}}})}flushFrontBuffer(e,t,r){this.sourceBuffers.forEach(([n,s])=>{if(s){const a=Xe.getBuffered(s),o=a.length;if(o<2)return;const l=a.start(o-1),u=a.end(o-1);if(r>l||e>=l&&e<=u)return;this.hls.trigger(x.BUFFER_FLUSHING,{startOffset:l,endOffset:1/0,type:n})}})}getDurationAndRange(){var e;const{details:t,mediaSource:r}=this;if(!t||!this.media||(r==null?void 0:r.readyState)!=="open")return null;const n=t.edge;if(t.live&&this.hls.config.liveDurationInfinity){if(t.fragments.length&&t.live&&r.setLiveSeekableRange){const u=Math.max(0,t.fragmentStart),h=Math.max(u,n);return{duration:1/0,start:u,end:h}}return{duration:1/0}}const s=(e=this.overrides)==null?void 0:e.duration;if(s)return Ce(s)?{duration:s}:null;const a=this.media.duration,o=Ce(r.duration)?r.duration:0;return n>o&&n>a||!Ce(a)?{duration:n}:null}updateMediaSource({duration:e,start:t,end:r}){const n=this.mediaSource;!this.media||!n||n.readyState!=="open"||(n.duration!==e&&(Ce(e)&&this.log(`Updating MediaSource duration to ${e.toFixed(3)}`),n.duration=e),t!==void 0&&r!==void 0&&(this.log(`MediaSource duration is set to ${n.duration}. Setting seekable range to ${t}-${r}.`),n.setLiveSeekableRange(t,r)))}get tracksReady(){const e=this.pendingTrackCount;return e>0&&(e>=this.bufferCodecEventsTotal||this.isPending(this.tracks.audiovideo))}checkPendingTracks(){const{bufferCodecEventsTotal:e,pendingTrackCount:t,tracks:r}=this;if(this.log(`checkPendingTracks (pending: ${t} codec events expected: ${e}) ${Gt(r)}`),this.tracksReady){var n;const s=(n=this.transferData)==null?void 0:n.tracks;s&&Object.keys(s).length?this.attachTransferred():this.createSourceBuffers()}}bufferCreated(){if(this.sourceBufferCount){const e={};this.sourceBuffers.forEach(([t,r])=>{if(t){const n=this.tracks[t];e[t]={buffer:r,container:n.container,codec:n.codec,supplemental:n.supplemental,levelCodec:n.levelCodec,id:n.id,metadata:n.metadata}}}),this.hls.trigger(x.BUFFER_CREATED,{tracks:e}),this.log(`SourceBuffers created. Running queue: ${this.operationQueue}`),this.sourceBuffers.forEach(([t])=>{this.executeNext(t)})}else{const e=new Error("could not create source buffer for media codec(s)");this.hls.trigger(x.ERROR,{type:Fe.MEDIA_ERROR,details:Q.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error:e,reason:e.message})}}createSourceBuffers(){const{tracks:e,sourceBuffers:t,mediaSource:r}=this;if(!r)throw new Error("createSourceBuffers called when mediaSource was null");for(const s in e){const a=s,o=e[a];if(this.isPending(o)){const l=this.getTrackCodec(o,a),u=`${o.container};codecs=${l}`;o.codec=l,this.log(`creating sourceBuffer(${u})${this.currentOp(a)?" Queued":""} ${Gt(o)}`);try{const h=r.addSourceBuffer(u),d=Pg(a),p=[a,h];t[d]=p,o.buffer=h}catch(h){var n;this.error(`error while trying to add sourceBuffer: ${h.message}`),this.shiftAndExecuteNext(a),(n=this.operationQueue)==null||n.removeBlockers(),delete this.tracks[a],this.hls.trigger(x.ERROR,{type:Fe.MEDIA_ERROR,details:Q.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:h,sourceBufferName:a,mimeType:u,parent:o.id});return}this.trackSourceBuffer(a,o)}}this.bufferCreated()}getTrackCodec(e,t){const r=e.supplemental;let n=e.codec;r&&(t==="video"||t==="audiovideo")&&rg(r,"video")&&(n=Mw(n,r));const s=Fu(n,e.levelCodec);return s?t.slice(0,5)==="audio"?Ou(s,this.appendSource):s:""}trackSourceBuffer(e,t){const r=t.buffer;if(!r)return;const n=this.getTrackCodec(t,e);this.tracks[e]={buffer:r,codec:n,container:t.container,levelCodec:t.levelCodec,supplemental:t.supplemental,metadata:t.metadata,id:t.id,listeners:[]},this.removeBufferListeners(e),this.addBufferListener(e,"updatestart",this.onSBUpdateStart),this.addBufferListener(e,"updateend",this.onSBUpdateEnd),this.addBufferListener(e,"error",this.onSBUpdateError),this.appendSource&&this.addBufferListener(e,"bufferedchange",(s,a)=>{const o=a.removedRanges;o!=null&&o.length&&this.hls.trigger(x.BUFFER_FLUSHED,{type:s})})}get mediaSrc(){var e,t;const r=((e=this.media)==null||(t=e.querySelector)==null?void 0:t.call(e,"source"))||this.media;return r==null?void 0:r.src}onSBUpdateStart(e){const t=this.currentOp(e);t&&t.onStart()}onSBUpdateEnd(e){var t;if(((t=this.mediaSource)==null?void 0:t.readyState)==="closed"){this.resetBuffer(e);return}const r=this.currentOp(e);r&&(r.onComplete(),this.shiftAndExecuteNext(e))}onSBUpdateError(e,t){var r;const n=new Error(`${e} SourceBuffer error. MediaSource readyState: ${(r=this.mediaSource)==null?void 0:r.readyState}`);this.error(`${n}`,t),this.hls.trigger(x.ERROR,{type:Fe.MEDIA_ERROR,details:Q.BUFFER_APPENDING_ERROR,sourceBufferName:e,error:n,fatal:!1});const s=this.currentOp(e);s&&s.onError(n)}removeExecutor(e,t,r){const{media:n,mediaSource:s}=this,a=this.tracks[e],o=a==null?void 0:a.buffer;if(!n||!s||!o){this.warn(`Attempting to remove from the ${e} SourceBuffer, but it does not exist`),this.shiftAndExecuteNext(e);return}const l=Ce(n.duration)?n.duration:1/0,u=Ce(s.duration)?s.duration:1/0,h=Math.max(0,t),d=Math.min(r,l,u);d>h&&(!a.ending||a.ended)?(a.ended=!1,this.log(`Removing [${h},${d}] from the ${e} SourceBuffer`),o.remove(h,d)):this.shiftAndExecuteNext(e)}appendExecutor(e,t){const r=this.tracks[t],n=r==null?void 0:r.buffer;if(!n)throw new k_(`Attempting to append to the ${t} SourceBuffer, but it does not exist`);r.ending=!1,r.ended=!1,n.appendBuffer(e)}blockUntilOpen(e){if(this.isUpdating()||this.isQueued())this.blockBuffers(e).catch(t=>{this.warn(`SourceBuffer blocked callback ${t}`),this.stepOperationQueue(this.sourceBufferTypes)});else try{e()}catch(t){this.warn(`Callback run without blocking ${this.operationQueue} ${t}`)}}isUpdating(){return this.sourceBuffers.some(([e,t])=>e&&t.updating)}isQueued(){return this.sourceBuffers.some(([e])=>e&&!!this.currentOp(e))}isPending(e){return!!e&&!e.buffer}blockBuffers(e,t=this.sourceBufferTypes){if(!t.length)return this.log("Blocking operation requested, but no SourceBuffers exist"),Promise.resolve().then(e);const{operationQueue:r}=this,n=t.map(a=>this.appendBlocker(a));return t.length>1&&!!this.blockedAudioAppend&&this.unblockAudio(),Promise.all(n).then(a=>{r===this.operationQueue&&(e(),this.stepOperationQueue(this.sourceBufferTypes))})}stepOperationQueue(e){e.forEach(t=>{var r;const n=(r=this.tracks[t])==null?void 0:r.buffer;!n||n.updating||this.shiftAndExecuteNext(t)})}append(e,t,r){this.operationQueue&&this.operationQueue.append(e,t,r)}appendBlocker(e){if(this.operationQueue)return this.operationQueue.appendBlocker(e)}currentOp(e){return this.operationQueue?this.operationQueue.current(e):null}executeNext(e){e&&this.operationQueue&&this.operationQueue.executeNext(e)}shiftAndExecuteNext(e){this.operationQueue&&this.operationQueue.shiftAndExecuteNext(e)}get pendingTrackCount(){return Object.keys(this.tracks).reduce((e,t)=>e+(this.isPending(this.tracks[t])?1:0),0)}get sourceBufferCount(){return this.sourceBuffers.reduce((e,[t])=>e+(t?1:0),0)}get sourceBufferTypes(){return this.sourceBuffers.map(([e])=>e).filter(e=>!!e)}addBufferListener(e,t,r){const n=this.tracks[e];if(!n)return;const s=n.buffer;if(!s)return;const a=r.bind(this,e);n.listeners.push({event:t,listener:a}),s.addEventListener(t,a)}removeBufferListeners(e){const t=this.tracks[e];if(!t)return;const r=t.buffer;r&&(t.listeners.forEach(n=>{r.removeEventListener(n.event,n.listener)}),t.listeners.length=0)}}function bA(i){const e=i.querySelectorAll("source");[].slice.call(e).forEach(t=>{i.removeChild(t)})}function F_(i,e){const t=self.document.createElement("source");t.type="video/mp4",t.src=e,i.appendChild(t)}function Pg(i){return i==="audio"?1:0}class kg{constructor(e){this.hls=void 0,this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.clientRect=void 0,this.streamController=void 0,this.hls=e,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}setStreamController(e){this.streamController=e}destroy(){this.hls&&this.unregisterListener(),this.timer&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null}registerListeners(){const{hls:e}=this;e.on(x.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.on(x.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(x.MANIFEST_PARSED,this.onManifestParsed,this),e.on(x.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(x.BUFFER_CODECS,this.onBufferCodecs,this),e.on(x.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListener(){const{hls:e}=this;e.off(x.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.off(x.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(x.MANIFEST_PARSED,this.onManifestParsed,this),e.off(x.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(x.BUFFER_CODECS,this.onBufferCodecs,this),e.off(x.MEDIA_DETACHING,this.onMediaDetaching,this)}onFpsDropLevelCapping(e,t){const r=this.hls.levels[t.droppedLevel];this.isLevelAllowed(r)&&this.restrictedLevels.push({bitrate:r.bitrate,height:r.height,width:r.width})}onMediaAttaching(e,t){this.media=t.media instanceof HTMLVideoElement?t.media:null,this.clientRect=null,this.timer&&this.hls.levels.length&&this.detectPlayerSize()}onManifestParsed(e,t){const r=this.hls;this.restrictedLevels=[],this.firstLevel=t.firstLevel,r.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onLevelsUpdated(e,t){this.timer&&Ce(this.autoLevelCapping)&&this.detectPlayerSize()}onBufferCodecs(e,t){this.hls.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onMediaDetaching(){this.stopCapping(),this.media=null}detectPlayerSize(){if(this.media){if(this.mediaHeight<=0||this.mediaWidth<=0){this.clientRect=null;return}const e=this.hls.levels;if(e.length){const t=this.hls,r=this.getMaxLevel(e.length-1);r!==this.autoLevelCapping&&t.logger.log(`Setting autoLevelCapping to ${r}: ${e[r].height}p@${e[r].bitrate} for media ${this.mediaWidth}x${this.mediaHeight}`),t.autoLevelCapping=r,t.autoLevelEnabled&&t.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}}getMaxLevel(e){const t=this.hls.levels;if(!t.length)return-1;const r=t.filter((n,s)=>this.isLevelAllowed(n)&&s<=e);return this.clientRect=null,kg.getMaxLevelByMediaSize(r,this.mediaWidth,this.mediaHeight)}startCapping(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}stopCapping(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)}getDimensions(){if(this.clientRect)return this.clientRect;const e=this.media,t={width:0,height:0};if(e){const r=e.getBoundingClientRect();t.width=r.width,t.height=r.height,!t.width&&!t.height&&(t.width=r.right-r.left||e.width||0,t.height=r.bottom-r.top||e.height||0)}return this.clientRect=t,t}get mediaWidth(){return this.getDimensions().width*this.contentScaleFactor}get mediaHeight(){return this.getDimensions().height*this.contentScaleFactor}get contentScaleFactor(){let e=1;if(!this.hls.config.ignoreDevicePixelRatio)try{e=self.devicePixelRatio}catch{}return Math.min(e,this.hls.config.maxDevicePixelRatio)}isLevelAllowed(e){return!this.restrictedLevels.some(r=>e.bitrate===r.bitrate&&e.width===r.width&&e.height===r.height)}static getMaxLevelByMediaSize(e,t,r){if(!(e!=null&&e.length))return-1;const n=(o,l)=>l?o.width!==l.width||o.height!==l.height:!0;let s=e.length-1;const a=Math.max(t,r);for(let o=0;o<e.length;o+=1){const l=e[o];if((l.width>=a||l.height>=a)&&n(l,e[o+1])){s=o;break}}return s}}const Wr={MANIFEST:"m",AUDIO:"a",VIDEO:"v",MUXED:"av",INIT:"i",CAPTION:"c",TIMED_TEXT:"tt",KEY:"k",OTHER:"o"},B_={HLS:"h"},ul={OBJECT:"CMCD-Object",REQUEST:"CMCD-Request",SESSION:"CMCD-Session",STATUS:"CMCD-Status"},U_={[ul.OBJECT]:["br","d","ot","tb"],[ul.REQUEST]:["bl","dl","mtp","nor","nrr","su"],[ul.SESSION]:["cid","pr","sf","sid","st","v"],[ul.STATUS]:["bs","rtp"]};class Ha{constructor(e,t){Array.isArray(e)&&(e=e.map(r=>r instanceof Ha?r:new Ha(r))),this.value=e,this.params=t}}const $_="Dict";function G_(i){return Array.isArray(i)?JSON.stringify(i):i instanceof Map?"Map{}":i instanceof Set?"Set{}":typeof i=="object"?JSON.stringify(i):String(i)}function q_(i,e,t,r){return new Error(`failed to ${i} "${G_(e)}" as ${t}`,{cause:r})}function un(i,e,t){return q_("serialize",i,e,t)}class AA{constructor(e){this.description=e}}const SA="Bare Item",V_="Boolean";function H_(i){if(typeof i!="boolean")throw un(i,V_);return i?"?1":"?0"}function K_(i){return btoa(String.fromCharCode(...i))}const W_="Byte Sequence";function Y_(i){if(ArrayBuffer.isView(i)===!1)throw un(i,W_);return`:${K_(i)}:`}const X_="Integer";function j_(i){return i<-999999999999999||999999999999999<i}function xA(i){if(j_(i))throw un(i,X_);return i.toString()}function z_(i){return`@${xA(i.getTime()/1e3)}`}function TA(i,e){if(i<0)return-TA(-i,e);const t=Math.pow(10,e);if(Math.abs(i*t%1-.5)<Number.EPSILON){const n=Math.floor(i*t);return(n%2===0?n:n+1)/t}else return Math.round(i*t)/t}const J_="Decimal";function Q_(i){const e=TA(i,3);if(Math.floor(Math.abs(e)).toString().length>12)throw un(i,J_);const t=e.toString();return t.includes(".")?t:`${t}.0`}const Z_="String",eM=/[\x00-\x1f\x7f]+/;function tM(i){if(eM.test(i))throw un(i,Z_);return`"${i.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`}function rM(i){return i.description||i.toString().slice(7,-1)}const iM="Token";function DA(i){const e=rM(i);if(/^([a-zA-Z*])([!#$%&'*+\-.^_`|~\w:/]*)$/.test(e)===!1)throw un(e,iM);return e}function Og(i){switch(typeof i){case"number":if(!Ce(i))throw un(i,SA);return Number.isInteger(i)?xA(i):Q_(i);case"string":return tM(i);case"symbol":return DA(i);case"boolean":return H_(i);case"object":if(i instanceof Date)return z_(i);if(i instanceof Uint8Array)return Y_(i);if(i instanceof AA)return DA(i);default:throw un(i,SA)}}const nM="Key";function Fg(i){if(/^[a-z*][a-z0-9\-_.*]*$/.test(i)===!1)throw un(i,nM);return i}function Bg(i){return i==null?"":Object.entries(i).map(([e,t])=>t===!0?`;${Fg(e)}`:`;${Fg(e)}=${Og(t)}`).join("")}function RA(i){return i instanceof Ha?`${Og(i.value)}${Bg(i.params)}`:Og(i)}function sM(i){return`(${i.value.map(RA).join(" ")})${Bg(i.params)}`}function aM(i,e={whitespace:!0}){if(typeof i!="object")throw un(i,$_);const t=i instanceof Map?i.entries():Object.entries(i),r=e!=null&&e.whitespace?" ":"";return Array.from(t).map(([n,s])=>{s instanceof Ha||(s=new Ha(s));let a=Fg(n);return s.value===!0?a+=Bg(s.params):(a+="=",Array.isArray(s.value)?a+=sM(s):a+=RA(s)),a}).join(`,${r}`)}function oM(i,e){return aM(i,e)}function lM(i){return i==="ot"||i==="sf"||i==="st"}function uM(i){return typeof i=="number"?Ce(i):i!=null&&i!==""&&i!==!1}function cM(i,e){const t=new URL(i),r=new URL(e);if(t.origin!==r.origin)return i;const n=t.pathname.split("/").slice(1),s=r.pathname.split("/").slice(1,-1);for(;n[0]===s[0];)n.shift(),s.shift();for(;s.length;)s.shift(),n.unshift("..");return n.join("/")}const nc=i=>Math.round(i),hM=(i,e)=>(e!=null&&e.baseUrl&&(i=cM(i,e.baseUrl)),encodeURIComponent(i)),sc=i=>nc(i/100)*100,dM={br:nc,d:nc,bl:sc,dl:sc,mtp:sc,nor:hM,rtp:sc,tb:nc};function fM(i,e){const t={};if(i==null||typeof i!="object")return t;const r=Object.keys(i).sort(),n=xt({},dM,e==null?void 0:e.formatters),s=e==null?void 0:e.filter;return r.forEach(a=>{if(s!=null&&s(a))return;let o=i[a];const l=n[a];l&&(o=l(o,e)),!(a==="v"&&o===1)&&(a=="pr"&&o===1||uM(o)&&(lM(a)&&typeof o=="string"&&(o=new AA(o)),t[a]=o))}),t}function IA(i,e={}){return i?oM(fM(i,e),xt({whitespace:!1},e)):""}function gM(i,e={}){const t={};if(!i)return t;const r=Object.entries(i),n=Object.entries(U_).concat(Object.entries((e==null?void 0:e.customHeaderMap)||{})),s=r.reduce((a,o)=>{var l,u;const[h,d]=o,p=((l=n.find(g=>g[1].includes(h)))===null||l===void 0?void 0:l[0])||ul.REQUEST;return(u=a[p])!==null&&u!==void 0||(a[p]={}),a[p][h]=d,a},{});return Object.entries(s).reduce((a,[o,l])=>(a[o]=IA(l,e),a),t)}function pM(i,e,t){return xt(i,gM(e,t))}const mM="CMCD";function yM(i,e={}){if(!i)return"";const t=IA(i,e);return`${mM}=${encodeURIComponent(t)}`}const NA=/CMCD=[^&#]+/;function vM(i,e,t){const r=yM(e,t);if(!r)return i;if(NA.test(i))return i.replace(NA,r);const n=i.includes("?")?"&":"?";return`${i}${n}${r}`}class EM{constructor(e){this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.includeKeys=void 0,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=()=>{this.initialized&&(this.starved=!0),this.buffering=!0},this.onPlaying=()=>{this.initialized||(this.initialized=!0),this.buffering=!1},this.applyPlaylistData=n=>{try{this.apply(n,{ot:Wr.MANIFEST,su:!this.initialized})}catch(s){this.hls.logger.warn("Could not generate manifest CMCD data.",s)}},this.applyFragmentData=n=>{try{const{frag:s,part:a}=n,o=this.hls.levels[s.level],l=this.getObjectType(s),u={d:(a||s).duration*1e3,ot:l};(l===Wr.VIDEO||l===Wr.AUDIO||l==Wr.MUXED)&&(u.br=o.bitrate/1e3,u.tb=this.getTopBandwidth(l)/1e3,u.bl=this.getBufferLength(l));const h=a?this.getNextPart(a):this.getNextFrag(s);h!=null&&h.url&&h.url!==s.url&&(u.nor=h.url),this.apply(n,u)}catch(s){this.hls.logger.warn("Could not generate segment CMCD data.",s)}},this.hls=e;const t=this.config=e.config,{cmcd:r}=t;r!=null&&(t.pLoader=this.createPlaylistLoader(),t.fLoader=this.createFragmentLoader(),this.sid=r.sessionId||e.sessionId,this.cid=r.contentId,this.useHeaders=r.useHeaders===!0,this.includeKeys=r.includeKeys,this.registerListeners())}registerListeners(){const e=this.hls;e.on(x.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(x.MEDIA_DETACHED,this.onMediaDetached,this),e.on(x.BUFFER_CREATED,this.onBufferCreated,this)}unregisterListeners(){const e=this.hls;e.off(x.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(x.MEDIA_DETACHED,this.onMediaDetached,this),e.off(x.BUFFER_CREATED,this.onBufferCreated,this)}destroy(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null,this.onWaiting=this.onPlaying=this.media=null}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)}onMediaDetached(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)}onBufferCreated(e,t){var r,n;this.audioBuffer=(r=t.tracks.audio)==null?void 0:r.buffer,this.videoBuffer=(n=t.tracks.video)==null?void 0:n.buffer}createData(){var e;return{v:1,sf:B_.HLS,sid:this.sid,cid:this.cid,pr:(e=this.media)==null?void 0:e.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}}apply(e,t={}){xt(t,this.createData());const r=t.ot===Wr.INIT||t.ot===Wr.VIDEO||t.ot===Wr.MUXED;this.starved&&r&&(t.bs=!0,t.su=!0,this.starved=!1),t.su==null&&(t.su=this.buffering);const{includeKeys:n}=this;n&&(t=Object.keys(t).reduce((a,o)=>(n.includes(o)&&(a[o]=t[o]),a),{}));const s={baseUrl:e.url};this.useHeaders?(e.headers||(e.headers={}),pM(e.headers,t,s)):e.url=vM(e.url,t,s)}getNextFrag(e){var t;const r=(t=this.hls.levels[e.level])==null?void 0:t.details;if(r){const n=e.sn-r.startSN;return r.fragments[n+1]}}getNextPart(e){var t,r;const{index:n,fragment:s}=e,a=(t=this.hls.levels[s.level])==null||(r=t.details)==null?void 0:r.partList;if(a){const{sn:o}=s;for(let l=a.length-1;l>=0;l--){const u=a[l];if(u.index===n&&u.fragment.sn===o)return a[l+1]}}}getObjectType(e){const{type:t}=e;if(t==="subtitle")return Wr.TIMED_TEXT;if(e.sn==="initSegment")return Wr.INIT;if(t==="audio")return Wr.AUDIO;if(t==="main")return this.hls.audioTracks.length?Wr.VIDEO:Wr.MUXED}getTopBandwidth(e){let t=0,r;const n=this.hls;if(e===Wr.AUDIO)r=n.audioTracks;else{const s=n.maxAutoLevel,a=s>-1?s+1:n.levels.length;r=n.levels.slice(0,a)}return r.forEach(s=>{s.bitrate>t&&(t=s.bitrate)}),t>0?t:NaN}getBufferLength(e){const t=this.media,r=e===Wr.AUDIO?this.audioBuffer:this.videoBuffer;return!r||!t?NaN:Xe.bufferInfo(r,t.currentTime,this.config.maxBufferHole).len*1e3}createPlaylistLoader(){const{pLoader:e}=this.config,t=this.applyPlaylistData,r=e||this.config.loader;return class{constructor(s){this.loader=void 0,this.loader=new r(s)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(s,a,o){t(s),this.loader.load(s,a,o)}}}createFragmentLoader(){const{fLoader:e}=this.config,t=this.applyFragmentData,r=e||this.config.loader;return class{constructor(s){this.loader=void 0,this.loader=new r(s)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(s,a,o){t(s),this.loader.load(s,a,o)}}}}const bM=3e5;class AM extends Cn{constructor(e){super("content-steering",e.logger),this.hls=void 0,this.loader=null,this.uri=null,this.pathwayId=".",this._pathwayPriority=null,this.timeToLoad=300,this.reloadTimer=-1,this.updated=0,this.started=!1,this.enabled=!0,this.levels=null,this.audioTracks=null,this.subtitleTracks=null,this.penalizedPathways={},this.hls=e,this.registerListeners()}registerListeners(){const e=this.hls;e.on(x.MANIFEST_LOADING,this.onManifestLoading,this),e.on(x.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(x.MANIFEST_PARSED,this.onManifestParsed,this),e.on(x.ERROR,this.onError,this)}unregisterListeners(){const e=this.hls;e&&(e.off(x.MANIFEST_LOADING,this.onManifestLoading,this),e.off(x.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(x.MANIFEST_PARSED,this.onManifestParsed,this),e.off(x.ERROR,this.onError,this))}pathways(){return(this.levels||[]).reduce((e,t)=>(e.indexOf(t.pathwayId)===-1&&e.push(t.pathwayId),e),[])}get pathwayPriority(){return this._pathwayPriority}set pathwayPriority(e){this.updatePathwayPriority(e)}startLoad(){if(this.started=!0,this.clearTimeout(),this.enabled&&this.uri){if(this.updated){const e=this.timeToLoad*1e3-(performance.now()-this.updated);if(e>0){this.scheduleRefresh(this.uri,e);return}}this.loadSteeringManifest(this.uri)}}stopLoad(){this.started=!1,this.loader&&(this.loader.destroy(),this.loader=null),this.clearTimeout()}clearTimeout(){this.reloadTimer!==-1&&(self.clearTimeout(this.reloadTimer),this.reloadTimer=-1)}destroy(){this.unregisterListeners(),this.stopLoad(),this.hls=null,this.levels=this.audioTracks=this.subtitleTracks=null}removeLevel(e){const t=this.levels;t&&(this.levels=t.filter(r=>r!==e))}onManifestLoading(){this.stopLoad(),this.enabled=!0,this.timeToLoad=300,this.updated=0,this.uri=null,this.pathwayId=".",this.levels=this.audioTracks=this.subtitleTracks=null}onManifestLoaded(e,t){const{contentSteering:r}=t;r!==null&&(this.pathwayId=r.pathwayId,this.uri=r.uri,this.started&&this.startLoad())}onManifestParsed(e,t){this.audioTracks=t.audioTracks,this.subtitleTracks=t.subtitleTracks}onError(e,t){const{errorAction:r}=t;if((r==null?void 0:r.action)===Rr.SendAlternateToPenaltyBox&&r.flags===Li.MoveAllAlternatesMatchingHost){const n=this.levels;let s=this._pathwayPriority,a=this.pathwayId;if(t.context){const{groupId:o,pathwayId:l,type:u}=t.context;o&&n?a=this.getPathwayForGroupId(o,u,a):l&&(a=l)}a in this.penalizedPathways||(this.penalizedPathways[a]=performance.now()),!s&&n&&(s=this.pathways()),s&&s.length>1&&(this.updatePathwayPriority(s),r.resolved=this.pathwayId!==a),r.resolved||this.warn(`Could not resolve ${t.details} ("${t.error.message}") with content-steering for Pathway: ${a} levels: ${n&&n.length} priorities: ${Gt(s)} penalized: ${Gt(this.penalizedPathways)}`)}}filterParsedLevels(e){this.levels=e;let t=this.getLevelsForPathway(this.pathwayId);if(t.length===0){const r=e[0].pathwayId;this.log(`No levels found in Pathway ${this.pathwayId}. Setting initial Pathway to "${r}"`),t=this.getLevelsForPathway(r),this.pathwayId=r}return t.length!==e.length&&this.log(`Found ${t.length}/${e.length} levels in Pathway "${this.pathwayId}"`),t}getLevelsForPathway(e){return this.levels===null?[]:this.levels.filter(t=>e===t.pathwayId)}updatePathwayPriority(e){this._pathwayPriority=e;let t;const r=this.penalizedPathways,n=performance.now();Object.keys(r).forEach(s=>{n-r[s]>bM&&delete r[s]});for(let s=0;s<e.length;s++){const a=e[s];if(a in r)continue;if(a===this.pathwayId)return;const o=this.hls.nextLoadLevel,l=this.hls.levels[o];if(t=this.getLevelsForPathway(a),t.length>0){this.log(`Setting Pathway to "${a}"`),this.pathwayId=a,Fb(t),this.hls.trigger(x.LEVELS_UPDATED,{levels:t});const u=this.hls.levels[o];l&&u&&this.levels&&(u.attrs["STABLE-VARIANT-ID"]!==l.attrs["STABLE-VARIANT-ID"]&&u.bitrate!==l.bitrate&&this.log(`Unstable Pathways change from bitrate ${l.bitrate} to ${u.bitrate}`),this.hls.nextLoadLevel=o);break}}}getPathwayForGroupId(e,t,r){const n=this.getLevelsForPathway(r).concat(this.levels||[]);for(let s=0;s<n.length;s++)if(t===lt.AUDIO_TRACK&&n[s].hasAudioGroup(e)||t===lt.SUBTITLE_TRACK&&n[s].hasSubtitleGroup(e))return n[s].pathwayId;return r}clonePathways(e){const t=this.levels;if(!t)return;const r={},n={};e.forEach(s=>{const{ID:a,"BASE-ID":o,"URI-REPLACEMENT":l}=s;if(t.some(h=>h.pathwayId===a))return;const u=this.getLevelsForPathway(o).map(h=>{const d=new Ht(h.attrs);d["PATHWAY-ID"]=a;const p=d.AUDIO&&`${d.AUDIO}_clone_${a}`,g=d.SUBTITLES&&`${d.SUBTITLES}_clone_${a}`;p&&(r[d.AUDIO]=p,d.AUDIO=p),g&&(n[d.SUBTITLES]=g,d.SUBTITLES=g);const m=wA(h.uri,d["STABLE-VARIANT-ID"],"PER-VARIANT-URIS",l),v=new Qo({attrs:d,audioCodec:h.audioCodec,bitrate:h.bitrate,height:h.height,name:h.name,url:m,videoCodec:h.videoCodec,width:h.width});if(h.audioGroups)for(let E=1;E<h.audioGroups.length;E++)v.addGroupId("audio",`${h.audioGroups[E]}_clone_${a}`);if(h.subtitleGroups)for(let E=1;E<h.subtitleGroups.length;E++)v.addGroupId("text",`${h.subtitleGroups[E]}_clone_${a}`);return v});t.push(...u),CA(this.audioTracks,r,l,a),CA(this.subtitleTracks,n,l,a)})}loadSteeringManifest(e){const t=this.hls.config,r=t.loader;this.loader&&this.loader.destroy(),this.loader=new r(t);let n;try{n=new self.URL(e)}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest URI: ${e}`);return}if(n.protocol!=="data:"){const h=(this.hls.bandwidthEstimate||t.abrEwmaDefaultEstimate)|0;n.searchParams.set("_HLS_pathway",this.pathwayId),n.searchParams.set("_HLS_throughput",""+h)}const s={responseType:"json",url:n.href},a=t.steeringManifestLoadPolicy.default,o=a.errorRetry||a.timeoutRetry||{},l={loadPolicy:a,timeout:a.maxLoadTimeMs,maxRetry:o.maxNumRetry||0,retryDelay:o.retryDelayMs||0,maxRetryDelay:o.maxRetryDelayMs||0},u={onSuccess:(h,d,p,g)=>{this.log(`Loaded steering manifest: "${n}"`);const m=h.data;if((m==null?void 0:m.VERSION)!==1){this.log(`Steering VERSION ${m.VERSION} not supported!`);return}this.updated=performance.now(),this.timeToLoad=m.TTL;const{"RELOAD-URI":v,"PATHWAY-CLONES":E,"PATHWAY-PRIORITY":A}=m;if(v)try{this.uri=new self.URL(v,n).href}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest RELOAD-URI: ${v}`);return}this.scheduleRefresh(this.uri||p.url),E&&this.clonePathways(E);const D={steeringManifest:m,url:n.toString()};this.hls.trigger(x.STEERING_MANIFEST_LOADED,D),A&&this.updatePathwayPriority(A)},onError:(h,d,p,g)=>{if(this.log(`Error loading steering manifest: ${h.code} ${h.text} (${d.url})`),this.stopLoad(),h.code===410){this.enabled=!1,this.log(`Steering manifest ${d.url} no longer available`);return}let m=this.timeToLoad*1e3;if(h.code===429){const v=this.loader;if(typeof(v==null?void 0:v.getResponseHeader)=="function"){const E=v.getResponseHeader("Retry-After");E&&(m=parseFloat(E)*1e3)}this.log(`Steering manifest ${d.url} rate limited`);return}this.scheduleRefresh(this.uri||d.url,m)},onTimeout:(h,d,p)=>{this.log(`Timeout loading steering manifest (${d.url})`),this.scheduleRefresh(this.uri||d.url)}};this.log(`Requesting steering manifest: ${n}`),this.loader.load(s,l,u)}scheduleRefresh(e,t=this.timeToLoad*1e3){this.clearTimeout(),this.reloadTimer=self.setTimeout(()=>{var r;const n=(r=this.hls)==null?void 0:r.media;if(n&&!n.ended){this.loadSteeringManifest(e);return}this.scheduleRefresh(e,this.timeToLoad*1e3)},t)}}function CA(i,e,t,r){i&&Object.keys(e).forEach(n=>{const s=i.filter(a=>a.groupId===n).map(a=>{const o=xt({},a);return o.details=void 0,o.attrs=new Ht(o.attrs),o.url=o.attrs.URI=wA(a.url,a.attrs["STABLE-RENDITION-ID"],"PER-RENDITION-URIS",t),o.groupId=o.attrs["GROUP-ID"]=e[n],o.attrs["PATHWAY-ID"]=r,o});i.push(...s)})}function wA(i,e,t,r){const{HOST:n,PARAMS:s,[t]:a}=r;let o;e&&(o=a==null?void 0:a[e],o&&(i=o));const l=new self.URL(i);return n&&!o&&(l.host=n),s&&Object.keys(s).sort().forEach(u=>{u&&l.searchParams.set(u,s[u])}),l.href}function si(i,e,t){yi(i,e,t),i.addEventListener(e,t)}function yi(i,e,t){i.removeEventListener(e,t)}class Ka extends Cn{constructor(e){super("eme",e.logger),this.hls=void 0,this.config=void 0,this.media=null,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.mediaKeys=null,this.setMediaKeysQueue=Ka.CDMCleanupPromise?[Ka.CDMCleanupPromise]:[],this.onMediaEncrypted=t=>{const{initDataType:r,initData:n}=t,s=`"${t.type}" event: init data type: "${r}"`;if(this.debug(s),n!==null){if(!this.keyFormatPromise){let a=Object.keys(this.keySystemAccessPromises);a.length||(a=el(this.config));const o=a.map(Xu).filter(l=>!!l);this.keyFormatPromise=this.getKeyFormatPromise(o)}this.keyFormatPromise.then(a=>{const o=Wu(a);let l,u;if(r==="sinf"){if(o!==bt.FAIRPLAY){this.warn(`Ignoring unexpected "${t.type}" event with init data type: "${r}" for selected key-system ${o}`);return}const m=ir(new Uint8Array(n));try{const v=cg(JSON.parse(m).sinf),E=FE(v);if(!E)throw new Error("'schm' box missing or not cbcs/cenc with schi > tenc");l=new Uint8Array(E.subarray(8,24)),u=bt.FAIRPLAY}catch(v){this.warn(`${s} Failed to parse sinf: ${v}`);return}}else{if(o!==bt.WIDEVINE&&o!==bt.PLAYREADY){this.warn(`Ignoring unexpected "${t.type}" event with init data type: "${r}" for selected key-system ${o}`);return}const m=Cw(n),v=m.filter(A=>!!A.systemId&&dg(A.systemId)===o);v.length>1&&this.warn(`${s} Using first of ${v.length} pssh found for selected key-system ${o}`);const E=v[0];if(!E){m.length===0||m.some(A=>!A.systemId)?this.warn(`${s} contains incomplete or invalid pssh data`):this.log(`ignoring ${s} for ${m.map(A=>dg(A.systemId)).join(",")} pssh data in favor of playlist keys`);return}if(u=dg(E.systemId),E.version===0&&E.data)if(u===bt.WIDEVINE){const A=E.data.length-22;l=new Uint8Array(E.data.subarray(A,A+16))}else u===bt.PLAYREADY&&(l=Eb(E.data))}if(!u||!l)return;const h=rn.hexDump(l),{keyIdToKeySessionPromise:d,mediaKeySessions:p}=this;let g=d[h];for(let m=0;m<p.length;m++){const v=p[m],E=v.decryptdata;if(!E.keyId)continue;const A=rn.hexDump(E.keyId);if(h===A||E.uri.replace(/-/g,"").indexOf(h)!==-1){if(g=d[A],E.pssh)break;delete d[A],E.pssh=new Uint8Array(n),E.keyId=l,g=d[h]=g.then(()=>this.generateRequestWithPreferredKeySession(v,r,n,"encrypted-event-key-match")),g.catch(D=>this.handleError(D));break}}if(!g){if(u!==o){this.log(`Ignoring "${t.type}" event with ${u} init data for selected key-system ${o}`);return}g=d[h]=this.getKeySystemSelectionPromise([u]).then(({keySystem:m,mediaKeys:v})=>{var E;this.throwIfDestroyed();const A=new tl("ISO-23001-7",h,(E=Xu(m))!=null?E:"");return A.pssh=new Uint8Array(n),A.keyId=l,this.attemptSetMediaKeys(m,v).then(()=>{this.throwIfDestroyed();const D=this.createMediaKeySessionContext({decryptdata:A,keySystem:m,mediaKeys:v});return this.generateRequestWithPreferredKeySession(D,r,n,"encrypted-event-no-match")})}),g.catch(m=>this.handleError(m))}})}},this.onWaitingForKey=t=>{this.log(`"${t.type}" event`)},this.hls=e,this.config=e.config,this.registerListeners()}destroy(){this.onDestroying(),this.onMediaDetached();const e=this.config;e.requestMediaKeySystemAccessFunc=null,e.licenseXhrSetup=e.licenseResponseCallback=void 0,e.drmSystems=e.drmSystemOptions={},this.hls=this.config=this.keyIdToKeySessionPromise=null,this.onMediaEncrypted=this.onWaitingForKey=null}registerListeners(){this.hls.on(x.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(x.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(x.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(x.MANIFEST_LOADED,this.onManifestLoaded,this),this.hls.on(x.DESTROYING,this.onDestroying,this)}unregisterListeners(){this.hls.off(x.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(x.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(x.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(x.MANIFEST_LOADED,this.onManifestLoaded,this),this.hls.off(x.DESTROYING,this.onDestroying,this)}getLicenseServerUrl(e){const{drmSystems:t,widevineLicenseUrl:r}=this.config,n=t[e];if(n)return n.licenseUrl;if(e===bt.WIDEVINE&&r)return r}getLicenseServerUrlOrThrow(e){const t=this.getLicenseServerUrl(e);if(t===void 0)throw new Error(`no license server URL configured for key-system "${e}"`);return t}getServerCertificateUrl(e){const{drmSystems:t}=this.config,r=t[e];if(r)return r.serverCertificateUrl;this.log(`No Server Certificate in config.drmSystems["${e}"]`)}attemptKeySystemAccess(e){const t=this.hls.levels,r=(a,o,l)=>!!a&&l.indexOf(a)===o,n=t.map(a=>a.audioCodec).filter(r),s=t.map(a=>a.videoCodec).filter(r);return n.length+s.length===0&&s.push("avc1.42e01e"),new Promise((a,o)=>{const l=u=>{const h=u.shift();this.getMediaKeysPromise(h,n,s).then(d=>a({keySystem:h,mediaKeys:d})).catch(d=>{u.length?l(u):d instanceof vi?o(d):o(new vi({type:Fe.KEY_SYSTEM_ERROR,details:Q.KEY_SYSTEM_NO_ACCESS,error:d,fatal:!0},d.message))})};l(e)})}requestMediaKeySystemAccess(e,t){const{requestMediaKeySystemAccessFunc:r}=this.config;if(typeof r!="function"){let n=`Configured requestMediaKeySystemAccess is not a function ${r}`;return vb===null&&self.location.protocol==="http:"&&(n=`navigator.requestMediaKeySystemAccess is not available over insecure protocol ${location.protocol}`),Promise.reject(new Error(n))}return r(e,t)}getMediaKeysPromise(e,t,r){const n=EL(e,t,r,this.config.drmSystemOptions),s=this.keySystemAccessPromises[e];let a=s==null?void 0:s.keySystemAccess;if(!a){this.log(`Requesting encrypted media "${e}" key-system access with config: ${Gt(n)}`),a=this.requestMediaKeySystemAccess(e,n);const o=this.keySystemAccessPromises[e]={keySystemAccess:a};return a.catch(l=>{this.log(`Failed to obtain access to key-system "${e}": ${l}`)}),a.then(l=>{this.log(`Access for key-system "${l.keySystem}" obtained`);const u=this.fetchServerCertificate(e);return this.log(`Create media-keys for "${e}"`),o.mediaKeys=l.createMediaKeys().then(h=>(this.log(`Media-keys created for "${e}"`),o.hasMediaKeys=!0,u.then(d=>d?this.setMediaKeysServerCertificate(h,e,d):h))),o.mediaKeys.catch(h=>{this.error(`Failed to create media-keys for "${e}"}: ${h}`)}),o.mediaKeys})}return a.then(()=>s.mediaKeys)}createMediaKeySessionContext({decryptdata:e,keySystem:t,mediaKeys:r}){this.log(`Creating key-system session "${t}" keyId: ${rn.hexDump(e.keyId||[])}`);const n=r.createSession(),s={decryptdata:e,keySystem:t,mediaKeys:r,mediaKeysSession:n,keyStatus:"status-pending"};return this.mediaKeySessions.push(s),s}renewKeySession(e){const t=e.decryptdata;if(t.pssh){const r=this.createMediaKeySessionContext(e),n=this.getKeyIdString(t),s="cenc";this.keyIdToKeySessionPromise[n]=this.generateRequestWithPreferredKeySession(r,s,t.pssh.buffer,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(e)}getKeyIdString(e){if(!e)throw new Error("Could not read keyId of undefined decryptdata");if(e.keyId===null)throw new Error("keyId is null");return rn.hexDump(e.keyId)}updateKeySession(e,t){var r;const n=e.mediaKeysSession;return this.log(`Updating key-session "${n.sessionId}" for keyID ${rn.hexDump(((r=e.decryptdata)==null?void 0:r.keyId)||[])}
      } (data length: ${t&&t.byteLength})`),n.update(t)}getSelectedKeySystemFormats(){return Object.keys(this.keySystemAccessPromises).map(e=>({keySystem:e,hasMediaKeys:this.keySystemAccessPromises[e].hasMediaKeys})).filter(({hasMediaKeys:e})=>!!e).map(({keySystem:e})=>Xu(e)).filter(e=>!!e)}getKeySystemAccess(e){return this.getKeySystemSelectionPromise(e).then(({keySystem:t,mediaKeys:r})=>this.attemptSetMediaKeys(t,r))}selectKeySystem(e){return new Promise((t,r)=>this.getKeySystemSelectionPromise(e).then(({keySystem:n})=>{const s=Xu(n);s?t(s):r(new Error(`Unable to find format for key-system "${n}"`))}).catch(r))}selectKeySystemFormat(e){const t=Object.keys(e.levelkeys||{});return this.keyFormatPromise||(this.log(`Selecting key-system from fragment (sn: ${e.sn} ${e.type}: ${e.level}) key formats ${t.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(t)),this.keyFormatPromise}getKeyFormatPromise(e){const t=el(this.config),r=e.map(Wu).filter(n=>!!n&&t.indexOf(n)!==-1);return this.selectKeySystem(r)}loadKey(e){const t=e.keyInfo.decryptdata,r=this.getKeyIdString(t),n=`(keyId: ${r} format: "${t.keyFormat}" method: ${t.method} uri: ${t.uri})`;this.log(`Starting session for key ${n}`);let s=this.keyIdToKeySessionPromise[r];return s||(s=this.getKeySystemForKeyPromise(t).then(({keySystem:o,mediaKeys:l})=>(this.throwIfDestroyed(),this.log(`Handle encrypted media sn: ${e.frag.sn} ${e.frag.type}: ${e.frag.level} using key ${n}`),this.attemptSetMediaKeys(o,l).then(()=>(this.throwIfDestroyed(),this.createMediaKeySessionContext({keySystem:o,mediaKeys:l,decryptdata:t}))))),(this.keyIdToKeySessionPromise[r]=s.then(o=>{const l="cenc",u=t.pssh?t.pssh.buffer:null;return this.generateRequestWithPreferredKeySession(o,l,u,"playlist-key")})).catch(o=>this.handleError(o))),s}throwIfDestroyed(e="Invalid state"){if(!this.hls)throw new Error("invalid state")}handleError(e){this.hls&&(this.error(e.message),e instanceof vi?this.hls.trigger(x.ERROR,e.data):this.hls.trigger(x.ERROR,{type:Fe.KEY_SYSTEM_ERROR,details:Q.KEY_SYSTEM_NO_KEYS,error:e,fatal:!0}))}getKeySystemForKeyPromise(e){const t=this.getKeyIdString(e),r=this.keyIdToKeySessionPromise[t];if(!r){const n=Wu(e.keyFormat),s=n?[n]:el(this.config);return this.attemptKeySystemAccess(s)}return r}getKeySystemSelectionPromise(e){if(e.length||(e=el(this.config)),e.length===0)throw new vi({type:Fe.KEY_SYSTEM_ERROR,details:Q.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},`Missing key-system license configuration options ${Gt({drmSystems:this.config.drmSystems})}`);return this.attemptKeySystemAccess(e)}attemptSetMediaKeys(e,t){if(this.mediaKeys===t)return Promise.resolve();const r=this.setMediaKeysQueue.slice();this.log(`Setting media-keys for "${e}"`);const n=Promise.all(r).then(()=>{if(!this.media)throw this.mediaKeys=null,new Error("Attempted to set mediaKeys without media element attached");return this.media.setMediaKeys(t)});return this.mediaKeys=t,this.setMediaKeysQueue.push(n),n.then(()=>{this.log(`Media-keys set for "${e}"`),r.push(n),this.setMediaKeysQueue=this.setMediaKeysQueue.filter(s=>r.indexOf(s)===-1)})}generateRequestWithPreferredKeySession(e,t,r,n){var s,a;const o=(s=this.config.drmSystems)==null||(a=s[e.keySystem])==null?void 0:a.generateRequest;if(o)try{const m=o.call(this.hls,t,r,e);if(!m)throw new Error("Invalid response from configured generateRequest filter");t=m.initDataType,r=m.initData?m.initData:null,e.decryptdata.pssh=r?new Uint8Array(r):null}catch(m){var l;if(this.warn(m.message),(l=this.hls)!=null&&l.config.debug)throw m}if(r===null)return this.log(`Skipping key-session request for "${n}" (no initData)`),Promise.resolve(e);const u=this.getKeyIdString(e.decryptdata);this.log(`Generating key-session request for "${n}": ${u} (init data type: ${t} length: ${r?r.byteLength:null})`);const h=new Eg,d=e._onmessage=m=>{const v=e.mediaKeysSession;if(!v){h.emit("error",new Error("invalid state"));return}const{messageType:E,message:A}=m;this.log(`"${E}" message event for session "${v.sessionId}" message size: ${A.byteLength}`),E==="license-request"||E==="license-renewal"?this.renewLicense(e,A).catch(D=>{h.eventNames().length?h.emit("error",D):this.handleError(D)}):E==="license-release"?e.keySystem===bt.FAIRPLAY&&(this.updateKeySession(e,hg("acknowledged")),this.removeSession(e)):this.warn(`unhandled media key message type "${E}"`)},p=e._onkeystatuseschange=m=>{if(!e.mediaKeysSession){h.emit("error",new Error("invalid state"));return}this.onKeyStatusChange(e);const E=e.keyStatus;h.emit("keyStatus",E),E==="expired"&&(this.warn(`${e.keySystem} expired for key ${u}`),this.renewKeySession(e))};si(e.mediaKeysSession,"message",d),si(e.mediaKeysSession,"keystatuseschange",p);const g=new Promise((m,v)=>{h.on("error",v),h.on("keyStatus",E=>{E.startsWith("usable")?m():E==="output-restricted"?v(new vi({type:Fe.KEY_SYSTEM_ERROR,details:Q.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED,fatal:!1},"HDCP level output restricted")):E==="internal-error"?v(new vi({type:Fe.KEY_SYSTEM_ERROR,details:Q.KEY_SYSTEM_STATUS_INTERNAL_ERROR,fatal:!0},`key status changed to "${E}"`)):E==="expired"?v(new Error("key expired while generating request")):this.warn(`unhandled key status change "${E}"`)})});return e.mediaKeysSession.generateRequest(t,r).then(()=>{var m;this.log(`Request generated for key-session "${(m=e.mediaKeysSession)==null?void 0:m.sessionId}" keyId: ${u}`)}).catch(m=>{throw new vi({type:Fe.KEY_SYSTEM_ERROR,details:Q.KEY_SYSTEM_NO_SESSION,error:m,fatal:!1},`Error generating key-session request: ${m}`)}).then(()=>g).catch(m=>{throw h.removeAllListeners(),this.removeSession(e),m}).then(()=>(h.removeAllListeners(),e))}onKeyStatusChange(e){e.mediaKeysSession.keyStatuses.forEach((t,r)=>{if(typeof r=="string"&&typeof t=="object"){const n=r;r=t,t=n}this.log(`key status change "${t}" for keyStatuses keyId: ${rn.hexDump("buffer"in r?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):new Uint8Array(r))} session keyId: ${rn.hexDump(new Uint8Array(e.decryptdata.keyId||[]))} uri: ${e.decryptdata.uri}`),e.keyStatus=t})}fetchServerCertificate(e){const t=this.config,r=t.loader,n=new r(t),s=this.getServerCertificateUrl(e);return s?(this.log(`Fetching server certificate for "${e}"`),new Promise((a,o)=>{const l={responseType:"arraybuffer",url:s},u=t.certLoadPolicy.default,h={loadPolicy:u,timeout:u.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},d={onSuccess:(p,g,m,v)=>{a(p.data)},onError:(p,g,m,v)=>{o(new vi({type:Fe.KEY_SYSTEM_ERROR,details:Q.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:m,response:Et({url:l.url,data:void 0},p)},`"${e}" certificate request failed (${s}). Status: ${p.code} (${p.text})`))},onTimeout:(p,g,m)=>{o(new vi({type:Fe.KEY_SYSTEM_ERROR,details:Q.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:m,response:{url:l.url,data:void 0}},`"${e}" certificate request timed out (${s})`))},onAbort:(p,g,m)=>{o(new Error("aborted"))}};n.load(l,h,d)})):Promise.resolve()}setMediaKeysServerCertificate(e,t,r){return new Promise((n,s)=>{e.setServerCertificate(r).then(a=>{this.log(`setServerCertificate ${a?"success":"not supported by CDM"} (${r==null?void 0:r.byteLength}) on "${t}"`),n(e)}).catch(a=>{s(new vi({type:Fe.KEY_SYSTEM_ERROR,details:Q.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:a,fatal:!0},a.message))})})}renewLicense(e,t){return this.requestLicense(e,new Uint8Array(t)).then(r=>this.updateKeySession(e,new Uint8Array(r)).catch(n=>{throw new vi({type:Fe.KEY_SYSTEM_ERROR,details:Q.KEY_SYSTEM_SESSION_UPDATE_FAILED,error:n,fatal:!0},n.message)}))}unpackPlayReadyKeyMessage(e,t){const r=String.fromCharCode.apply(null,new Uint16Array(t.buffer));if(!r.includes("PlayReadyKeyMessage"))return e.setRequestHeader("Content-Type","text/xml; charset=utf-8"),t;const n=new DOMParser().parseFromString(r,"application/xml"),s=n.querySelectorAll("HttpHeader");if(s.length>0){let h;for(let d=0,p=s.length;d<p;d++){var a,o;h=s[d];const g=(a=h.querySelector("name"))==null?void 0:a.textContent,m=(o=h.querySelector("value"))==null?void 0:o.textContent;g&&m&&e.setRequestHeader(g,m)}}const l=n.querySelector("Challenge"),u=l==null?void 0:l.textContent;if(!u)throw new Error("Cannot find <Challenge> in key message");return hg(atob(u))}setupLicenseXHR(e,t,r,n){const s=this.config.licenseXhrSetup;return s?Promise.resolve().then(()=>{if(!r.decryptdata)throw new Error("Key removed");return s.call(this.hls,e,t,r,n)}).catch(a=>{if(!r.decryptdata)throw a;return e.open("POST",t,!0),s.call(this.hls,e,t,r,n)}).then(a=>(e.readyState||e.open("POST",t,!0),{xhr:e,licenseChallenge:a||n})):(e.open("POST",t,!0),Promise.resolve({xhr:e,licenseChallenge:n}))}requestLicense(e,t){const r=this.config.keyLoadPolicy.default;return new Promise((n,s)=>{const a=this.getLicenseServerUrlOrThrow(e.keySystem);this.log(`Sending license request to URL: ${a}`);const o=new XMLHttpRequest;o.responseType="arraybuffer",o.onreadystatechange=()=>{if(!this.hls||!e.mediaKeysSession)return s(new Error("invalid state"));if(o.readyState===4)if(o.status===200){this._requestLicenseFailureCount=0;let l=o.response;this.log(`License received ${l instanceof ArrayBuffer?l.byteLength:l}`);const u=this.config.licenseResponseCallback;if(u)try{l=u.call(this.hls,o,a,e)}catch(h){this.error(h)}n(l)}else{const l=r.errorRetry,u=l?l.maxNumRetry:0;if(this._requestLicenseFailureCount++,this._requestLicenseFailureCount>u||o.status>=400&&o.status<500)s(new vi({type:Fe.KEY_SYSTEM_ERROR,details:Q.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0,networkDetails:o,response:{url:a,data:void 0,code:o.status,text:o.statusText}},`License Request XHR failed (${a}). Status: ${o.status} (${o.statusText})`));else{const h=u-this._requestLicenseFailureCount+1;this.warn(`Retrying license request, ${h} attempts left`),this.requestLicense(e,t).then(n,s)}}},e.licenseXhr&&e.licenseXhr.readyState!==XMLHttpRequest.DONE&&e.licenseXhr.abort(),e.licenseXhr=o,this.setupLicenseXHR(o,a,e,t).then(({xhr:l,licenseChallenge:u})=>{e.keySystem==bt.PLAYREADY&&(u=this.unpackPlayReadyKeyMessage(l,u)),l.send(u)})})}onDestroying(){this.unregisterListeners(),this._clear()}onMediaAttached(e,t){if(!this.config.emeEnabled)return;const r=t.media;this.media=r,si(r,"encrypted",this.onMediaEncrypted),si(r,"waitingforkey",this.onWaitingForKey)}onMediaDetached(){const e=this.media;e&&(yi(e,"encrypted",this.onMediaEncrypted),yi(e,"waitingforkey",this.onWaitingForKey),this.media=null,this.mediaKeys=null)}_clear(){var e;if(this._requestLicenseFailureCount=0,this.keyIdToKeySessionPromise={},!this.mediaKeys&&!this.mediaKeySessions.length)return;const t=this.media,r=this.mediaKeySessions.slice();this.mediaKeySessions=[],this.mediaKeys=null,tl.clearKeyUriToKeyIdMap();const n=r.length;Ka.CDMCleanupPromise=Promise.all(r.map(s=>this.removeSession(s)).concat(t==null||(e=t.setMediaKeys(null))==null?void 0:e.catch(s=>{var a;this.log(`Could not clear media keys: ${s}`),(a=this.hls)==null||a.trigger(x.ERROR,{type:Fe.OTHER_ERROR,details:Q.KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR,fatal:!1,error:new Error(`Could not clear media keys: ${s}`)})}))).catch(s=>{var a;this.log(`Could not close sessions and clear media keys: ${s}`),(a=this.hls)==null||a.trigger(x.ERROR,{type:Fe.OTHER_ERROR,details:Q.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,fatal:!1,error:new Error(`Could not close sessions and clear media keys: ${s}`)})}).then(()=>{n&&this.log("finished closing key sessions and clearing media keys")})}onManifestLoading(){this.keyFormatPromise=null}onManifestLoaded(e,{sessionKeys:t}){if(!(!t||!this.config.emeEnabled)&&!this.keyFormatPromise){const r=t.reduce((n,s)=>(n.indexOf(s.keyFormat)===-1&&n.push(s.keyFormat),n),[]);this.log(`Selecting key-system from session-keys ${r.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(r)}}removeSession(e){const{mediaKeysSession:t,licenseXhr:r}=e;if(t){this.log(`Remove licenses and keys and close session ${t.sessionId}`),e._onmessage&&(t.removeEventListener("message",e._onmessage),e._onmessage=void 0),e._onkeystatuseschange&&(t.removeEventListener("keystatuseschange",e._onkeystatuseschange),e._onkeystatuseschange=void 0),r&&r.readyState!==XMLHttpRequest.DONE&&r.abort(),e.mediaKeysSession=e.decryptdata=e.licenseXhr=void 0;const n=this.mediaKeySessions.indexOf(e);n>-1&&this.mediaKeySessions.splice(n,1);const{drmSystemOptions:s}=this.config;return(AL(s)?new Promise((o,l)=>{self.setTimeout(()=>l(new Error("MediaKeySession.remove() timeout")),8e3),t.remove().then(o)}):Promise.resolve()).catch(o=>{var l;this.log(`Could not remove session: ${o}`),(l=this.hls)==null||l.trigger(x.ERROR,{type:Fe.OTHER_ERROR,details:Q.KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR,fatal:!1,error:new Error(`Could not remove session: ${o}`)})}).then(()=>t.close()).catch(o=>{var l;this.log(`Could not close session: ${o}`),(l=this.hls)==null||l.trigger(x.ERROR,{type:Fe.OTHER_ERROR,details:Q.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,fatal:!1,error:new Error(`Could not close session: ${o}`)})})}}}Ka.CDMCleanupPromise=void 0;class vi extends Error{constructor(e,t){super(t),this.data=void 0,e.error||(e.error=new Error(t)),this.data=e,e.err=e.error}}class SM{constructor(e){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=e,this.registerListeners()}setStreamController(e){this.streamController=e}registerListeners(){this.hls.on(x.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.on(x.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListeners(){this.hls.off(x.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.off(x.MEDIA_DETACHING,this.onMediaDetaching,this)}destroy(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null}onMediaAttaching(e,t){const r=this.hls.config;if(r.capLevelOnFPSDrop){const n=t.media instanceof self.HTMLVideoElement?t.media:null;this.media=n,n&&typeof n.getVideoPlaybackQuality=="function"&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),r.fpsDroppedMonitoringPeriod)}}onMediaDetaching(){this.media=null}checkFPS(e,t,r){const n=performance.now();if(t){if(this.lastTime){const s=n-this.lastTime,a=r-this.lastDroppedFrames,o=t-this.lastDecodedFrames,l=1e3*a/s,u=this.hls;if(u.trigger(x.FPS_DROP,{currentDropped:a,currentDecoded:o,totalDroppedFrames:r}),l>0&&a>u.config.fpsDroppedMonitoringThreshold*o){let h=u.currentLevel;u.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+h),h>0&&(u.autoLevelCapping===-1||u.autoLevelCapping>=h)&&(h=h-1,u.trigger(x.FPS_DROP_LEVEL_CAPPING,{level:h,droppedLevel:u.currentLevel}),u.autoLevelCapping=h,this.streamController.nextLevelSwitch())}}this.lastTime=n,this.lastDroppedFrames=r,this.lastDecodedFrames=t}}checkFPSInterval(){const e=this.media;if(e)if(this.isVideoPlaybackQualityAvailable){const t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)}}function LA(i,e){let t;try{t=new Event("addtrack")}catch{t=document.createEvent("Event"),t.initEvent("addtrack",!1,!1)}t.track=i,e.dispatchEvent(t)}function _A(i,e){const t=i.mode;if(t==="disabled"&&(i.mode="hidden"),i.cues&&!i.cues.getCueById(e.id))try{if(i.addCue(e),!i.cues.getCueById(e.id))throw new Error(`addCue is failed for: ${e}`)}catch(r){mt.debug(`[texttrack-utils]: ${r}`);try{const n=new self.TextTrackCue(e.startTime,e.endTime,e.text);n.id=e.id,i.addCue(n)}catch(n){mt.debug(`[texttrack-utils]: Legacy TextTrackCue fallback failed: ${n}`)}}t==="disabled"&&(i.mode=t)}function Wa(i,e){const t=i.mode;if(t==="disabled"&&(i.mode="hidden"),i.cues)for(let r=i.cues.length;r--;)e&&i.cues[r].removeEventListener("enter",e),i.removeCue(i.cues[r]);t==="disabled"&&(i.mode=t)}function Ug(i,e,t,r){const n=i.mode;if(n==="disabled"&&(i.mode="hidden"),i.cues&&i.cues.length>0){const s=TM(i.cues,e,t);for(let a=0;a<s.length;a++)(!r||r(s[a]))&&i.removeCue(s[a])}n==="disabled"&&(i.mode=n)}function xM(i,e){if(e<=i[0].startTime)return 0;const t=i.length-1;if(e>i[t].endTime)return-1;let r=0,n=t,s;for(;r<=n;)if(s=Math.floor((n+r)/2),e<i[s].startTime)n=s-1;else if(e>i[s].startTime&&r<t)r=s+1;else return s;return i[r].startTime-e<e-i[n].startTime?r:n}function TM(i,e,t){const r=[],n=xM(i,e);if(n>-1)for(let s=n,a=i.length;s<a;s++){const o=i[s];if(o.startTime>=e&&o.endTime<=t)r.push(o);else if(o.startTime>t)return r}return r}function ac(i){const e=[];for(let t=0;t<i.length;t++){const r=i[t];(r.kind==="subtitles"||r.kind==="captions")&&r.label&&e.push(i[t])}return e}class DM extends _g{constructor(e){super(e,"subtitle-track-controller"),this.media=null,this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.queuedDefaultTrack=-1,this.useTextTrackPolling=!1,this.subtitlePollingInterval=-1,this._subtitleDisplay=!0,this.asyncPollTrackChange=()=>this.pollTrackChange(0),this.onTextTracksChanged=()=>{if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!this.media||!this.hls.config.renderTextTracksNatively)return;let t=null;const r=ac(this.media.textTracks);for(let s=0;s<r.length;s++)if(r[s].mode==="hidden")t=r[s];else if(r[s].mode==="showing"){t=r[s];break}const n=this.findTrackForTextTrack(t);this.subtitleTrack!==n&&this.setSubtitleTrack(n)},this.registerListeners()}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,this.onTextTracksChanged=this.asyncPollTrackChange=null,super.destroy()}get subtitleDisplay(){return this._subtitleDisplay}set subtitleDisplay(e){this._subtitleDisplay=e,this.trackId>-1&&this.toggleTrackModes()}registerListeners(){const{hls:e}=this;e.on(x.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(x.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(x.MANIFEST_LOADING,this.onManifestLoading,this),e.on(x.MANIFEST_PARSED,this.onManifestParsed,this),e.on(x.LEVEL_LOADING,this.onLevelLoading,this),e.on(x.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(x.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(x.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(x.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(x.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(x.MANIFEST_LOADING,this.onManifestLoading,this),e.off(x.MANIFEST_PARSED,this.onManifestParsed,this),e.off(x.LEVEL_LOADING,this.onLevelLoading,this),e.off(x.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(x.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(x.ERROR,this.onError,this)}onMediaAttached(e,t){this.media=t.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))}pollTrackChange(e){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.onTextTracksChanged,e)}onMediaDetaching(e,t){const r=this.media;if(!r)return;const n=!!t.transferMedia;if(self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||r.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),this.subtitleTrack=-1,this.media=null,n)return;ac(r.textTracks).forEach(a=>{Wa(a)})}onManifestLoading(){this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.subtitleTracks}onSubtitleTrackLoaded(e,t){const{id:r,groupId:n,details:s}=t,a=this.tracksInGroup[r];if(!a||a.groupId!==n){this.warn(`Subtitle track with id:${r} and group:${n} not found in active group ${a==null?void 0:a.groupId}`);return}const o=a.details;a.details=t.details,this.log(`Subtitle track ${r} "${a.name}" lang:${a.lang} group:${n} loaded [${s.startSN}-${s.endSN}]`),r===this.trackId&&this.playlistLoaded(r,t,o)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!t)return;const r=t.subtitleGroups||null,n=this.groupIds;let s=this.currentTrack;if(!r||(n==null?void 0:n.length)!==(r==null?void 0:r.length)||r!=null&&r.some(a=>(n==null?void 0:n.indexOf(a))===-1)){this.groupIds=r,this.trackId=-1,this.currentTrack=null;const a=this.tracks.filter(h=>!r||r.indexOf(h.groupId)!==-1);if(a.length)this.selectDefaultTrack&&!a.some(h=>h.default)&&(this.selectDefaultTrack=!1),a.forEach((h,d)=>{h.id=d});else if(!s&&!this.tracksInGroup.length)return;this.tracksInGroup=a;const o=this.hls.config.subtitlePreference;if(!s&&o){this.selectDefaultTrack=!1;const h=an(o,a);if(h>-1)s=a[h];else{const d=an(o,this.tracks);s=this.tracks[d]}}let l=this.findTrackId(s);l===-1&&s&&(l=this.findTrackId(null));const u={subtitleTracks:a};this.log(`Updating subtitle tracks, ${a.length} track(s) found in "${r==null?void 0:r.join(",")}" group-id`),this.hls.trigger(x.SUBTITLE_TRACKS_UPDATED,u),l!==-1&&this.trackId===-1&&this.setSubtitleTrack(l)}}findTrackId(e){const t=this.tracksInGroup,r=this.selectDefaultTrack;for(let n=0;n<t.length;n++){const s=t[n];if(!(r&&!s.default||!r&&!e)&&(!e||Ys(s,e)))return n}if(e){for(let n=0;n<t.length;n++){const s=t[n];if(ll(e.attrs,s.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return n}for(let n=0;n<t.length;n++){const s=t[n];if(ll(e.attrs,s.attrs,["LANGUAGE"]))return n}}return-1}findTrackForTextTrack(e){if(e){const t=this.tracksInGroup;for(let r=0;r<t.length;r++){const n=t[r];if(Mg(n,e))return r}}return-1}onError(e,t){t.fatal||!t.context||t.context.type===lt.SUBTITLE_TRACK&&t.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(t.context.groupId)!==-1)&&this.checkRetry(t)}get allSubtitleTracks(){return this.tracks}get subtitleTracks(){return this.tracksInGroup}get subtitleTrack(){return this.trackId}set subtitleTrack(e){this.selectDefaultTrack=!1,this.setSubtitleTrack(e)}setSubtitleOption(e){if(this.hls.config.subtitlePreference=e,e){if(e.id===-1)return this.setSubtitleTrack(-1),null;const t=this.allSubtitleTracks;if(this.selectDefaultTrack=!1,t.length){const r=this.currentTrack;if(r&&Ys(e,r))return r;const n=an(e,this.tracksInGroup);if(n>-1){const s=this.tracksInGroup[n];return this.setSubtitleTrack(n),s}else{if(r)return null;{const s=an(e,t);if(s>-1)return t[s]}}}}return null}loadPlaylist(e){super.loadPlaylist(),this.shouldLoadPlaylist(this.currentTrack)&&this.scheduleLoading(this.currentTrack,e)}loadingPlaylist(e,t){super.loadingPlaylist(e,t);const r=e.id,n=e.groupId,s=this.getUrlWithDirectives(e.url,t),a=e.details,o=a==null?void 0:a.age;this.log(`Loading subtitle ${r} "${e.name}" lang:${e.lang} group:${n}${(t==null?void 0:t.msn)!==void 0?" at sn "+t.msn+" part "+t.part:""}${o&&a.live?" age "+o.toFixed(1)+(a.type&&" "+a.type||""):""} ${s}`),this.hls.trigger(x.SUBTITLE_TRACK_LOADING,{url:s,id:r,groupId:n,deliveryDirectives:t||null,track:e})}toggleTrackModes(){const{media:e}=this;if(!e)return;const t=ac(e.textTracks),r=this.currentTrack;let n;if(r&&(n=t.filter(s=>Mg(r,s))[0],n||this.warn(`Unable to find subtitle TextTrack with name "${r.name}" and language "${r.lang}"`)),[].slice.call(t).forEach(s=>{s.mode!=="disabled"&&s!==n&&(s.mode="disabled")}),n){const s=this.subtitleDisplay?"showing":"hidden";n.mode!==s&&(n.mode=s)}}setSubtitleTrack(e){const t=this.tracksInGroup;if(!this.media){this.queuedDefaultTrack=e;return}if(e<-1||e>=t.length||!Ce(e)){this.warn(`Invalid subtitle track id: ${e}`);return}this.selectDefaultTrack=!1;const r=this.currentTrack,n=t[e]||null;if(this.trackId=e,this.currentTrack=n,this.toggleTrackModes(),!n){this.hls.trigger(x.SUBTITLE_TRACK_SWITCH,{id:e});return}const s=!!n.details&&!n.details.live;if(e===this.trackId&&n===r&&s)return;this.log(`Switching to subtitle-track ${e}`+(n?` "${n.name}" lang:${n.lang} group:${n.groupId}`:""));const{id:a,groupId:o="",name:l,type:u,url:h}=n;this.hls.trigger(x.SUBTITLE_TRACK_SWITCH,{id:a,groupId:o,name:l,type:u,url:h});const d=this.switchParams(n.url,r==null?void 0:r.details,n.details);this.loadPlaylist(d)}}function RM(){try{return crypto.randomUUID()}catch{try{const e=URL.createObjectURL(new Blob),t=e.toString();return URL.revokeObjectURL(e),t.slice(t.lastIndexOf("/")+1)}catch{let t=new Date().getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,n=>{const s=(t+Math.random()*16)%16|0;return t=Math.floor(t/16),(n=="x"?s:s&3|8).toString(16)})}}}function cl(i){let e=5381,t=i.length;for(;t;)e=e*33^i.charCodeAt(--t);return(e>>>0).toString()}const Ya=.025;let oc=function(i){return i[i.Point=0]="Point",i[i.Range=1]="Range",i}({});function IM(i,e,t){return`${i.identifier}-${t+1}-${cl(e)}`}class NM{constructor(e,t){this.base=void 0,this._duration=null,this._timelineStart=null,this.appendInPlaceDisabled=void 0,this.appendInPlaceStarted=void 0,this.dateRange=void 0,this.hasPlayed=!1,this.cumulativeDuration=0,this.resumeOffset=NaN,this.playoutLimit=NaN,this.restrictions={skip:!1,jump:!1},this.snapOptions={out:!1,in:!1},this.assetList=[],this.assetListLoader=void 0,this.assetListResponse=null,this.resumeAnchor=void 0,this.error=void 0,this.resetOnResume=void 0,this.base=t,this.dateRange=e,this.setDateRange(e)}setDateRange(e){this.dateRange=e,this.resumeOffset=e.attr.optionalFloat("X-RESUME-OFFSET",this.resumeOffset),this.playoutLimit=e.attr.optionalFloat("X-PLAYOUT-LIMIT",this.playoutLimit),this.restrictions=e.attr.enumeratedStringList("X-RESTRICT",this.restrictions),this.snapOptions=e.attr.enumeratedStringList("X-SNAP",this.snapOptions)}reset(){var e;this.appendInPlaceStarted=!1,(e=this.assetListLoader)==null||e.destroy(),this.assetListLoader=void 0,this.supplementsPrimary||(this.assetListResponse=null,this.assetList=[],this._duration=null)}isAssetPastPlayoutLimit(e){var t;if(e>0&&e>=this.assetList.length)return!0;const r=this.playoutLimit;return e<=0||isNaN(r)?!1:r===0?!0:(((t=this.assetList[e])==null?void 0:t.startOffset)||0)>r}findAssetIndex(e){return this.assetList.indexOf(e)}get identifier(){return this.dateRange.id}get startDate(){return this.dateRange.startDate}get startTime(){const e=this.dateRange.startTime;if(this.snapOptions.out){const t=this.dateRange.tagAnchor;if(t)return $g(e,t)}return e}get startOffset(){return this.cue.pre?0:this.startTime}get startIsAligned(){if(this.startTime===0||this.snapOptions.out)return!0;const e=this.dateRange.tagAnchor;if(e){const t=this.dateRange.startTime,r=$g(t,e);return t-r<.1}return!1}get resumptionOffset(){const e=this.resumeOffset,t=Ce(e)?e:this.duration;return this.cumulativeDuration+t}get resumeTime(){const e=this.startOffset+this.resumptionOffset;if(this.snapOptions.in){const t=this.resumeAnchor;if(t)return $g(e,t)}return e}get appendInPlace(){return this.appendInPlaceStarted?!0:this.appendInPlaceDisabled?!1:!!(!this.cue.once&&!this.cue.pre&&this.startIsAligned&&(isNaN(this.playoutLimit)&&isNaN(this.resumeOffset)||this.resumeOffset&&this.duration&&Math.abs(this.resumeOffset-this.duration)<Ya))}set appendInPlace(e){if(this.appendInPlaceStarted){this.resetOnResume=!e;return}this.appendInPlaceDisabled=!e}get timelineStart(){return this._timelineStart!==null?this._timelineStart:this.startTime}set timelineStart(e){this._timelineStart=e}get duration(){const e=this.playoutLimit;let t;return this._duration!==null?t=this._duration:this.dateRange.duration?t=this.dateRange.duration:t=this.dateRange.plannedDuration||0,!isNaN(e)&&e<t&&(t=e),t}set duration(e){this._duration=e}get cue(){return this.dateRange.cue}get timelineOccupancy(){return this.dateRange.attr["X-TIMELINE-OCCUPIES"]==="RANGE"?oc.Range:oc.Point}get supplementsPrimary(){return this.dateRange.attr["X-TIMELINE-STYLE"]==="PRIMARY"}get contentMayVary(){return this.dateRange.attr["X-CONTENT-MAY-VARY"]!=="NO"}get assetUrl(){return this.dateRange.attr["X-ASSET-URI"]}get assetListUrl(){return this.dateRange.attr["X-ASSET-LIST"]}get baseUrl(){return this.base.url}get assetListLoaded(){return this.assetList.length>0||this.assetListResponse!==null}toString(){return CM(this)}}function $g(i,e){return i-e.start<e.duration/2&&!(Math.abs(i-(e.start+e.duration))<Ya)?e.start:e.start+e.duration}function MA(i,e,t){const r=new self.URL(i,t);return r.protocol!=="data:"&&r.searchParams.set("_HLS_primary_id",e),r}function Gg(i,e){for(;(t=i.assetList[++e])!=null&&t.error;)var t;return e}function CM(i){return`["${i.identifier}" ${i.cue.pre?"<pre>":i.cue.post?"<post>":""}${i.timelineStart.toFixed(2)}-${i.resumeTime.toFixed(2)}]`}function Xa(i){const e=i.timelineStart,t=i.duration||0;return`["${i.identifier}" ${e.toFixed(2)}-${(e+t).toFixed(2)}]`}class wM{constructor(e,t,r,n){this.hls=void 0,this.interstitial=void 0,this.assetItem=void 0,this.tracks=null,this.hasDetails=!1,this.mediaAttached=null,this._currentTime=void 0,this._bufferedEosTime=void 0,this.checkPlayout=()=>{this.reachedPlayout(this.currentTime)&&this.hls.trigger(x.PLAYOUT_LIMIT_REACHED,{})};const s=this.hls=new e(t);this.interstitial=r,this.assetItem=n;let a=n.uri;try{a=MA(a,t.primarySessionId).href}catch{}s.loadSource(a);const o=()=>{this.hasDetails=!0};s.once(x.LEVEL_LOADED,o),s.once(x.AUDIO_TRACK_LOADED,o),s.once(x.SUBTITLE_TRACK_LOADED,o),s.on(x.MEDIA_ATTACHING,(l,{media:u})=>{this.removeMediaListeners(),this.mediaAttached=u,this.interstitial.playoutLimit&&(u.addEventListener("timeupdate",this.checkPlayout),this.appendInPlace&&s.on(x.BUFFER_APPENDED,()=>{const d=this.bufferedEnd;this.reachedPlayout(d)&&(this._bufferedEosTime=d,s.trigger(x.BUFFERED_TO_END,void 0))}))})}get appendInPlace(){var e;return((e=this.interstitial)==null?void 0:e.appendInPlace)||!1}bufferedInPlaceToEnd(e){var t;if(!this.appendInPlace)return!1;if((t=this.hls)!=null&&t.bufferedToEnd)return!0;if(!e||!this._bufferedEosTime)return!1;const r=this.timelineOffset,n=Xe.bufferInfo(e,r,0);return this.getAssetTime(n.end)>=this._bufferedEosTime-.02}reachedPlayout(e){const r=this.interstitial.playoutLimit;return this.startOffset+e>=r}get destroyed(){var e;return!((e=this.hls)!=null&&e.userConfig)}get assetId(){return this.assetItem.identifier}get interstitialId(){return this.assetItem.parentIdentifier}get media(){var e;return((e=this.hls)==null?void 0:e.media)||null}get bufferedEnd(){const e=this.media||this.mediaAttached;if(!e)return this._bufferedEosTime?this._bufferedEosTime:this.currentTime;const t=Xe.bufferInfo(e,e.currentTime,.001);return this.getAssetTime(t.end)}get currentTime(){const e=this.media||this.mediaAttached;return e?this.getAssetTime(e.currentTime):this._currentTime||0}get duration(){const e=this.assetItem.duration;return e||0}get remaining(){const e=this.duration;return e?Math.max(0,e-this.currentTime):0}get startOffset(){return this.assetItem.startOffset}get timelineOffset(){var e;return((e=this.hls)==null?void 0:e.config.timelineOffset)||0}set timelineOffset(e){const t=this.timelineOffset;if(e!==t){const r=e-t;if(Math.abs(r)>11111111111111112e-21){if(this.hasDetails)throw new Error("Cannot set timelineOffset after playlists are loaded");this.hls.config.timelineOffset=e}}}getAssetTime(e){const t=this.timelineOffset,r=this.duration;return Math.min(Math.max(0,e-t),r)}removeMediaListeners(){const e=this.mediaAttached;e&&(this._currentTime=e.currentTime,this.bufferSnapShot(),e.removeEventListener("timeupdate",this.checkPlayout))}bufferSnapShot(){if(this.mediaAttached){var e;(e=this.hls)!=null&&e.bufferedToEnd&&(this._bufferedEosTime=this.bufferedEnd)}}destroy(){this.removeMediaListeners(),this.hls.destroy(),this.hls=this.interstitial=null,this.tracks=this.mediaAttached=this.checkPlayout=null}attachMedia(e){this.hls.attachMedia(e)}detachMedia(){this.removeMediaListeners(),this.mediaAttached=null,this.hls.detachMedia()}resumeBuffering(){this.hls.resumeBuffering()}pauseBuffering(){this.hls.pauseBuffering()}transferMedia(){return this.bufferSnapShot(),this.hls.transferMedia()}resetDetails(){const e=this.hls;if(this.hasDetails){e.stopLoad();const t=r=>delete r.details;e.levels.forEach(t),e.allAudioTracks.forEach(t),e.allSubtitleTracks.forEach(t),this.hasDetails=!1}}on(e,t,r){this.hls.on(e,t)}once(e,t,r){this.hls.once(e,t)}off(e,t,r){this.hls.off(e,t)}toString(){var e;return`HlsAssetPlayer: ${Xa(this.assetItem)} ${(e=this.hls)==null?void 0:e.sessionId} ${this.appendInPlace?"append-in-place":""}`}}const PA=.033;class LM extends Cn{constructor(e,t){super("interstitials-sched",t),this.onScheduleUpdate=void 0,this.eventMap={},this.events=null,this.items=null,this.durations={primary:0,playout:0,integrated:0},this.onScheduleUpdate=e}destroy(){this.reset(),this.onScheduleUpdate=null}reset(){this.eventMap={},this.setDurations(0,0,0),this.events&&this.events.forEach(e=>e.reset()),this.events=this.items=null}resetErrorsInRange(e,t){return this.events?this.events.reduce((r,n)=>e<=n.startOffset&&t>n.startOffset?(delete n.error,r+1):r,0):0}get duration(){const e=this.items;return e?e[e.length-1].end:0}get length(){return this.items?this.items.length:0}getEvent(e){return e&&this.eventMap[e]||null}hasEvent(e){return e in this.eventMap}findItemIndex(e,t){if(e.event)return this.findEventIndex(e.event.identifier);let r=-1;e.nextEvent?r=this.findEventIndex(e.nextEvent.identifier)-1:e.previousEvent&&(r=this.findEventIndex(e.previousEvent.identifier)+1);const n=this.items;if(n)for(n[r]||(t===void 0&&(t=e.start),r=this.findItemIndexAtTime(t));r>=0&&(s=n[r])!=null&&s.event;){var s;r--}return r}findItemIndexAtTime(e,t){const r=this.items;if(r)for(let n=0;n<r.length;n++){let s=r[n];if(t&&t!=="primary"&&(s=s[t]),e===s.start||e>s.start&&e<s.end)return n}return-1}findJumpRestrictedIndex(e,t){const r=this.items;if(r)for(let n=e;n<=t&&r[n];n++){const s=r[n].event;if(s!=null&&s.restrictions.jump&&!s.appendInPlace)return n}return-1}findEventIndex(e){const t=this.items;if(t)for(let n=t.length;n--;){var r;if(((r=t[n].event)==null?void 0:r.identifier)===e)return n}return-1}findAssetIndex(e,t){const r=e.assetList,n=r.length;if(n>1)for(let s=0;s<n;s++){const a=r[s];if(!a.error){const o=a.timelineStart;if(t===o||t>o&&t<o+(a.duration||0))return s}}return 0}get assetIdAtEnd(){var e,t;const r=(e=this.items)==null||(t=e[this.length-1])==null?void 0:t.event;if(r){const n=r.assetList,s=n[n.length-1];if(s)return s.identifier}return null}parseInterstitialDateRanges(e,t){const r=e.main.details,{dateRanges:n}=r,s=this.events,a=this.parseDateRanges(n,{url:r.url},t),o=Object.keys(n),l=s?s.filter(u=>!o.includes(u.identifier)):[];a.length&&a.sort((u,h)=>{const d=u.cue.pre,p=u.cue.post,g=h.cue.pre,m=h.cue.post;if(d&&!g)return-1;if(g&&!d||p&&!m)return 1;if(m&&!p)return-1;if(!d&&!g&&!p&&!m){const v=u.startTime,E=h.startTime;if(v!==E)return v-E}return u.dateRange.tagOrder-h.dateRange.tagOrder}),this.events=a,l.forEach(u=>{this.removeEvent(u)}),this.updateSchedule(e,l)}updateSchedule(e,t=[]){const r=this.events||[];if(r.length||t.length||this.length<2){const n=this.items,s=this.parseSchedule(r,e);(t.length||(n==null?void 0:n.length)!==s.length||s.some((o,l)=>Math.abs(o.playout.start-n[l].playout.start)>.005||Math.abs(o.playout.end-n[l].playout.end)>.005))&&(this.items=s,this.onScheduleUpdate(t,n))}}parseDateRanges(e,t,r){const n=[],s=Object.keys(e);for(let a=0;a<s.length;a++){const o=s[a],l=e[o];if(l.isInterstitial){let u=this.eventMap[o];u?u.setDateRange(l):(u=new NM(l,t),this.eventMap[o]=u,r===!1&&(u.appendInPlace=r)),n.push(u)}}return n}parseSchedule(e,t){const r=[],n=t.main.details,s=n.live?1/0:n.edge;let a=0;if(e=e.filter(l=>!l.error&&!(l.cue.once&&l.hasPlayed)),e.length){this.resolveOffsets(e,t);let l=0,u=0;if(e.forEach((h,d)=>{const p=h.cue.pre,g=h.cue.post,m=e[d-1]||null,v=h.appendInPlace,E=g?s:h.startOffset,A=h.duration,D=h.timelineOccupancy===oc.Range?A:0,R=h.resumptionOffset,_=(m==null?void 0:m.startTime)===E,F=E+h.cumulativeDuration;let w=v?F+A:E+R;if(p||!g&&E<=0){const M=u;u+=D,h.timelineStart=F;const L=a;a+=A,r.push({event:h,start:F,end:w,playout:{start:L,end:a},integrated:{start:M,end:u}})}else if(E<=s){if(!_){const I=E-l;if(I>PA){const U=l,q=u;u+=I;const $=a;a+=I;const X={previousEvent:e[d-1]||null,nextEvent:h,start:U,end:U+I,playout:{start:$,end:a},integrated:{start:q,end:u}};r.push(X)}else I>0&&m&&(m.cumulativeDuration+=I,r[r.length-1].end=E)}g&&(w=F),h.timelineStart=F;const M=u;u+=D;const L=a;a+=A,r.push({event:h,start:F,end:w,playout:{start:L,end:a},integrated:{start:M,end:u}})}else return;const C=h.resumeTime;g||C>s?l=s:l=C}),l<s){var o;const h=l,d=u,p=s-l;u+=p;const g=a;a+=p,r.push({previousEvent:((o=r[r.length-1])==null?void 0:o.event)||null,nextEvent:null,start:l,end:h+p,playout:{start:g,end:a},integrated:{start:d,end:u}})}this.setDurations(s,a,u)}else r.push({previousEvent:null,nextEvent:null,start:0,end:s,playout:{start:0,end:s},integrated:{start:0,end:s}}),this.setDurations(s,s,s);return r}setDurations(e,t,r){this.durations={primary:e,playout:t,integrated:r}}resolveOffsets(e,t){const r=t.main.details,n=r.live?1/0:r.edge;let s=0,a=-1;e.forEach((o,l)=>{const u=o.cue.pre,h=o.cue.post,d=u?0:h?n:o.startTime;this.updateAssetDurations(o),a===d?o.cumulativeDuration=s:(s=0,a=d),!h&&o.snapOptions.in&&(o.resumeAnchor=js(null,r.fragments,o.startOffset+o.resumptionOffset,0,0)||void 0),o.appendInPlace&&!o.appendInPlaceStarted&&(this.primaryCanResumeInPlaceAt(o,t)||(o.appendInPlace=!1)),!o.appendInPlace&&l+1<e.length&&e[l+1].startTime-e[l].resumeTime<PA&&(e[l+1].appendInPlace=!1,e[l+1].appendInPlace&&this.warn(`Could not change append strategy for abutting event ${o}`));const g=Ce(o.resumeOffset)?o.resumeOffset:o.duration;s+=g})}primaryCanResumeInPlaceAt(e,t){const r=e.resumeTime,n=e.startTime+e.resumptionOffset;return Math.abs(r-n)>Ya?(this.log(`"${e.identifier}" resumption ${r} not aligned with estimated timeline end ${n}`),!1):t?!Object.keys(t).some(a=>{const o=t[a].details,l=o.edge;if(r>=l)return this.log(`"${e.identifier}" resumption ${r} past ${a} playlist end ${l}`),!1;const u=js(null,o.fragments,r);if(!u)return this.log(`"${e.identifier}" resumption ${r} does not align with any fragments in ${a} playlist (${o.fragStart}-${o.fragmentEnd})`),!0;const h=a==="audio"?.175:0;return Math.abs(u.start-r)<Ya+h||Math.abs(u.end-r)<Ya+h?!1:(this.log(`"${e.identifier}" resumption ${r} not aligned with ${a} fragment bounds (${u.start}-${u.end} sn: ${u.sn} cc: ${u.cc})`),!0)}):(this.log(`"${e.identifier}" resumption ${r} can not be aligned with media (none selected)`),!1)}updateAssetDurations(e){if(!e.assetListLoaded)return;const t=e.timelineStart;let r=0,n=!1,s=!1;e.assetList.forEach((a,o)=>{const l=t+r;a.startOffset=r,a.timelineStart=l,n||(n=a.duration===null),s||(s=!!a.error);const u=a.error?0:a.duration||0;r+=u}),n&&!s?e.duration=Math.max(r,e.duration):e.duration=r}removeEvent(e){e.reset(),delete this.eventMap[e.identifier]}}function ps(i){return`[${i.event?'"'+i.event.identifier+'"':"primary"}: ${i.start.toFixed(2)}-${i.end.toFixed(2)}]`}class _M{constructor(e){this.hls=void 0,this.hls=e}destroy(){this.hls=null}loadAssetList(e,t){const r=e.assetListUrl;let n;try{n=MA(r,this.hls.sessionId,e.baseUrl)}catch(p){const g=this.assignAssetListError(e,Q.ASSET_LIST_LOAD_ERROR,p,r);this.hls.trigger(x.ERROR,g);return}t&&n.protocol!=="data:"&&n.searchParams.set("_HLS_start_offset",""+t);const s=this.hls.config,a=s.loader,o=new a(s),l={responseType:"json",url:n.href},u=s.interstitialAssetListLoadPolicy.default,h={loadPolicy:u,timeout:u.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},d={onSuccess:(p,g,m,v)=>{const E=p.data,A=E==null?void 0:E.ASSETS;if(!Array.isArray(A)){const D=this.assignAssetListError(e,Q.ASSET_LIST_PARSING_ERROR,new Error("Invalid interstitial asset list"),m.url,g,v);this.hls.trigger(x.ERROR,D);return}e.assetListResponse=E,this.hls.trigger(x.ASSET_LIST_LOADED,{event:e,assetListResponse:E,networkDetails:v})},onError:(p,g,m,v)=>{const E=this.assignAssetListError(e,Q.ASSET_LIST_LOAD_ERROR,new Error(`Error loading X-ASSET-LIST: HTTP status ${p.code} ${p.text} (${g.url})`),g.url,v,m);this.hls.trigger(x.ERROR,E)},onTimeout:(p,g,m)=>{const v=this.assignAssetListError(e,Q.ASSET_LIST_LOAD_TIMEOUT,new Error(`Timeout loading X-ASSET-LIST (${g.url})`),g.url,p,m);this.hls.trigger(x.ERROR,v)}};return o.load(l,h,d),this.hls.trigger(x.ASSET_LIST_LOADING,{event:e}),o}assignAssetListError(e,t,r,n,s,a){return e.error=r,{type:Fe.NETWORK_ERROR,details:t,fatal:!1,interstitial:e,url:n,error:r,networkDetails:a,stats:s}}}function kA(i){i==null||i.play().catch(()=>{})}class MM extends Cn{constructor(e,t){super("interstitials",e.logger),this.HlsPlayerClass=void 0,this.hls=void 0,this.assetListLoader=void 0,this.mediaSelection=null,this.altSelection=null,this.media=null,this.detachedData=null,this.requiredTracks=null,this.manager=null,this.playerQueue=[],this.bufferedPos=-1,this.timelinePos=-1,this.schedule=void 0,this.playingItem=null,this.bufferingItem=null,this.waitingItem=null,this.endedItem=null,this.playingAsset=null,this.endedAsset=null,this.bufferingAsset=null,this.shouldPlay=!1,this.onPlay=()=>{this.shouldPlay=!0},this.onPause=()=>{this.shouldPlay=!1},this.onSeeking=()=>{const r=this.currentTime;if(r===void 0||this.playbackDisabled)return;const n=r-this.timelinePos;if(Math.abs(n)<1/7056e5)return;const a=n<=-.01;this.timelinePos=r,this.bufferedPos=r;const o=this.playingItem;if(!o){this.checkBuffer();return}if(a&&this.schedule.resetErrorsInRange(r,r-n)&&this.updateSchedule(),this.checkBuffer(),a&&r<o.start||r>=o.end){var l;const p=this.schedule.findItemIndexAtTime(this.timelinePos);if(!this.isInterstitial(o)&&(l=this.media)!=null&&l.paused&&(this.shouldPlay=!1),!a){const g=this.findItemIndex(o);if(p>g){const m=this.schedule.findJumpRestrictedIndex(g+1,p);if(m>g){this.setSchedulePosition(m);return}}}this.setSchedulePosition(p);return}const u=this.playingAsset;if(!u){if(this.playingLastItem&&this.isInterstitial(o)){const p=o.event.assetList[0];p&&(this.endedItem=this.playingItem,this.playingItem=null,this.setScheduleToAssetAtTime(r,p))}return}const h=u.timelineStart,d=u.duration||0;(a&&r<h||r>=h+d)&&this.setScheduleToAssetAtTime(r,u)},this.onTimeupdate=()=>{const r=this.currentTime;if(r===void 0||this.playbackDisabled)return;if(r>this.timelinePos)this.timelinePos=r,r>this.bufferedPos&&this.checkBuffer();else return;const n=this.playingItem;if(!n||this.playingLastItem)return;if(r>=n.end){this.timelinePos=n.end;const o=this.findItemIndex(n);this.setSchedulePosition(o+1)}const s=this.playingAsset;if(!s)return;const a=s.timelineStart+(s.duration||0);r>=a&&this.setScheduleToAssetAtTime(r,s)},this.onScheduleUpdate=(r,n)=>{const s=this.schedule,a=this.playingItem,o=s.events||[],l=s.items||[],u=s.durations,h=r.map(m=>m.identifier),d=!!(o.length||h.length);(d||n)&&this.log(`INTERSTITIALS_UPDATED (${o.length}): ${o}
Schedule: ${l.map(m=>ps(m))} pos: ${this.timelinePos}`),h.length&&this.log(`Removed events ${h}`),this.playerQueue.forEach(m=>{if(m.interstitial.appendInPlace){const v=m.assetItem.timelineStart,E=m.timelineOffset-v;if(E)try{m.timelineOffset=v}catch(A){Math.abs(E)>Ya&&this.warn(`${A} ("${m.assetId}" ${m.timelineOffset}->${v})`)}}});let p=null;if(a){const m=this.updateItem(a,this.timelinePos);this.itemsMatch(a,m)&&(this.playingItem=m,this.waitingItem=this.endedItem=null,p=()=>this.trimInPlace(m,a))}else this.waitingItem=this.updateItem(this.waitingItem),this.endedItem=this.updateItem(this.endedItem);const g=this.bufferingItem;if(g){const m=this.updateItem(g,this.bufferedPos);this.itemsMatch(g,m)?(this.bufferingItem=m,p||(p=()=>this.trimInPlace(m,g))):g.event&&(this.bufferingItem=this.playingItem,this.clearInterstitial(g.event,null))}if(r.forEach(m=>{m.assetList.forEach(v=>{this.clearAssetPlayer(v.identifier,null)})}),d||n){if(this.hls.trigger(x.INTERSTITIALS_UPDATED,{events:o.slice(0),schedule:l.slice(0),durations:u,removedIds:h}),this.isInterstitial(a)&&h.includes(a.event.identifier)){this.warn(`Interstitial "${a.event.identifier}" removed while playing`),this.primaryFallback(a.event);return}p&&p(),this.checkBuffer()}},this.hls=e,this.HlsPlayerClass=t,this.assetListLoader=new _M(e),this.schedule=new LM(this.onScheduleUpdate,e.logger),this.registerListeners()}registerListeners(){const e=this.hls;e.on(x.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(x.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(x.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(x.MANIFEST_LOADING,this.onManifestLoading,this),e.on(x.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(x.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(x.AUDIO_TRACK_UPDATED,this.onAudioTrackUpdated,this),e.on(x.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(x.SUBTITLE_TRACK_UPDATED,this.onSubtitleTrackUpdated,this),e.on(x.EVENT_CUE_ENTER,this.onInterstitialCueEnter,this),e.on(x.ASSET_LIST_LOADED,this.onAssetListLoaded,this),e.on(x.BUFFER_APPENDED,this.onBufferAppended,this),e.on(x.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(x.BUFFERED_TO_END,this.onBufferedToEnd,this),e.on(x.MEDIA_ENDED,this.onMediaEnded,this),e.on(x.ERROR,this.onError,this),e.on(x.DESTROYING,this.onDestroying,this)}unregisterListeners(){const e=this.hls;e&&(e.off(x.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(x.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(x.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(x.MANIFEST_LOADING,this.onManifestLoading,this),e.off(x.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(x.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(x.AUDIO_TRACK_UPDATED,this.onAudioTrackUpdated,this),e.off(x.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(x.SUBTITLE_TRACK_UPDATED,this.onSubtitleTrackUpdated,this),e.off(x.EVENT_CUE_ENTER,this.onInterstitialCueEnter,this),e.off(x.ASSET_LIST_LOADED,this.onAssetListLoaded,this),e.off(x.BUFFER_CODECS,this.onBufferCodecs,this),e.off(x.BUFFER_APPENDED,this.onBufferAppended,this),e.off(x.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(x.BUFFERED_TO_END,this.onBufferedToEnd,this),e.off(x.MEDIA_ENDED,this.onMediaEnded,this),e.off(x.ERROR,this.onError,this),e.off(x.DESTROYING,this.onDestroying,this))}startLoad(){this.resumeBuffering()}stopLoad(){this.pauseBuffering()}resumeBuffering(){var e;(e=this.getBufferingPlayer())==null||e.resumeBuffering()}pauseBuffering(){var e;(e=this.getBufferingPlayer())==null||e.pauseBuffering()}destroy(){this.unregisterListeners(),this.stopLoad(),this.assetListLoader&&this.assetListLoader.destroy(),this.emptyPlayerQueue(),this.clearScheduleState(),this.schedule&&this.schedule.destroy(),this.media=this.detachedData=this.mediaSelection=this.requiredTracks=this.altSelection=this.manager=null,this.hls=this.HlsPlayerClass=this.schedule=this.log=null,this.assetListLoader=null,this.onPlay=this.onPause=this.onSeeking=this.onTimeupdate=null,this.onScheduleUpdate=null}onDestroying(){const e=this.primaryMedia||this.media;e&&this.removeMediaListeners(e)}removeMediaListeners(e){yi(e,"play",this.onPlay),yi(e,"pause",this.onPause),yi(e,"seeking",this.onSeeking),yi(e,"timeupdate",this.onTimeupdate)}onMediaAttaching(e,t){const r=this.media=t.media;si(r,"seeking",this.onSeeking),si(r,"timeupdate",this.onTimeupdate),si(r,"play",this.onPlay),si(r,"pause",this.onPause)}onMediaAttached(e,t){const r=this.effectivePlayingItem,n=this.detachedData;if(this.detachedData=null,r===null)this.checkStart();else if(!n){this.clearScheduleState();const s=this.findItemIndex(r);this.setSchedulePosition(s)}}clearScheduleState(){this.playingItem=this.bufferingItem=this.waitingItem=this.endedItem=this.playingAsset=this.endedAsset=this.bufferingAsset=null}onMediaDetaching(e,t){const r=!!t.transferMedia,n=this.media;if(this.media=null,!r&&(n&&this.removeMediaListeners(n),this.detachedData)){const s=this.getBufferingPlayer();s&&(this.playingAsset=this.endedAsset=this.bufferingAsset=this.bufferingItem=this.waitingItem=this.detachedData=null,s.detachMedia()),this.shouldPlay=!1}}get interstitialsManager(){if(!this.manager){if(!this.hls)return null;const e=this,t=()=>e.bufferingItem||e.waitingItem,r=d=>d&&e.getAssetPlayer(d.identifier),n=(d,p,g,m,v)=>{if(d){let E=d[p].start;const A=d.event;if(A){if(p==="playout"||A.timelineOccupancy!==oc.Point){const D=r(g);(D==null?void 0:D.interstitial)===A&&(E+=D.assetItem.startOffset+D[v])}}else{const D=m==="bufferedPos"?a():e[m];E+=D-d.start}return E}return 0},s=(d,p)=>{if(d!==0&&p!=="primary"&&e.schedule.length){var g;const m=e.schedule.findItemIndexAtTime(d),v=(g=e.schedule.items)==null?void 0:g[m];if(v){const E=v[p].start-v.start;return d+E}}return d},a=()=>{const d=e.bufferedPos;return d===Number.MAX_VALUE?o("primary"):Math.max(d,0)},o=d=>{var p;return(p=e.primaryDetails)!=null&&p.live?e.primaryDetails.edge:e.schedule.durations[d]},l=(d,p)=>{var g,m;const v=e.effectivePlayingItem;if(v!=null&&(g=v.event)!=null&&g.restrictions.skip)return;e.log(`seek to ${d} "${p}"`);const E=e.effectivePlayingItem,A=e.schedule.findItemIndexAtTime(d,p),D=(m=e.schedule.items)==null?void 0:m[A],R=e.getBufferingPlayer(),_=R==null?void 0:R.interstitial,F=_==null?void 0:_.appendInPlace,w=E&&e.itemsMatch(E,D);if(E&&(F||w)){const M=r(e.playingAsset),L=(M==null?void 0:M.media)||e.primaryMedia;if(L){const I=p==="primary"?L.currentTime:n(E,p,e.playingAsset,"timelinePos","currentTime"),U=d-I,q=(F?I:L.currentTime)+U;if(q>=0&&(!M||F||q<=M.duration)){L.currentTime=q;return}}}if(D){let M=d;if(p!=="primary"){const I=D[p].start,U=d-I;M=D.start+U}const L=!e.isInterstitial(D);if((!e.isInterstitial(E)||E.event.appendInPlace)&&(L||D.event.appendInPlace)){const I=e.media||(F?R==null?void 0:R.media:null);I&&(I.currentTime=M)}else if(E){const I=e.findItemIndex(E);if(A>I){const q=e.schedule.findJumpRestrictedIndex(I+1,A);if(q>I){e.setSchedulePosition(q);return}}let U=0;if(L)e.timelinePos=M,e.checkBuffer();else{var C;const q=D==null||(C=D.event)==null?void 0:C.assetList;if(q){const $=d-(D[p]||D).start;for(let X=q.length;X--;){const ne=q[X];if(ne.duration&&$>=ne.startOffset&&$<ne.startOffset+ne.duration){U=X;break}}}}e.setSchedulePosition(A,U)}}},u=()=>{const d=e.effectivePlayingItem;if(e.isInterstitial(d))return d;const p=t();return e.isInterstitial(p)?p:null},h={get currentTime(){const d=u(),p=e.effectivePlayingItem;return p&&p===d?n(p,"playout",e.effectivePlayingAsset,"timelinePos","currentTime")-p.playout.start:0},set currentTime(d){const p=u(),g=e.effectivePlayingItem;g&&g===p&&l(d+g.playout.start,"playout")},get duration(){const d=u();return d?d.playout.end-d.playout.start:0},get assetPlayers(){var d;const p=(d=u())==null?void 0:d.event.assetList;return p?p.map(g=>e.getAssetPlayer(g.identifier)):[]},get playingIndex(){var d;const p=(d=u())==null?void 0:d.event;return p&&e.effectivePlayingAsset?p.findAssetIndex(e.effectivePlayingAsset):-1},get scheduleItem(){return u()}};this.manager={get events(){var d,p;return((d=e.schedule)==null||(p=d.events)==null?void 0:p.slice(0))||[]},get schedule(){var d,p;return((d=e.schedule)==null||(p=d.items)==null?void 0:p.slice(0))||[]},get interstitialPlayer(){return u()?h:null},get playerQueue(){return e.playerQueue.slice(0)},get bufferingAsset(){return e.bufferingAsset},get bufferingItem(){return t()},get bufferingIndex(){const d=t();return e.findItemIndex(d)},get playingAsset(){return e.effectivePlayingAsset},get playingItem(){return e.effectivePlayingItem},get playingIndex(){const d=e.effectivePlayingItem;return e.findItemIndex(d)},primary:{get bufferedEnd(){return a()},get currentTime(){const d=e.timelinePos;return d>0?d:0},set currentTime(d){l(d,"primary")},get duration(){return o("primary")},get seekableStart(){var d;return((d=e.primaryDetails)==null?void 0:d.fragmentStart)||0}},integrated:{get bufferedEnd(){return n(t(),"integrated",e.bufferingAsset,"bufferedPos","bufferedEnd")},get currentTime(){return n(e.effectivePlayingItem,"integrated",e.effectivePlayingAsset,"timelinePos","currentTime")},set currentTime(d){l(d,"integrated")},get duration(){return o("integrated")},get seekableStart(){var d;return s(((d=e.primaryDetails)==null?void 0:d.fragmentStart)||0,"integrated")}},skip:()=>{const d=e.effectivePlayingItem,p=d==null?void 0:d.event;if(p&&!p.restrictions.skip){const g=e.findItemIndex(d);if(p.appendInPlace){const m=d.playout.start+d.event.duration;l(m+.001,"playout")}else e.advanceAfterAssetEnded(p,g,1/0)}}}}return this.manager}get effectivePlayingItem(){return this.waitingItem||this.playingItem||this.endedItem}get effectivePlayingAsset(){return this.playingAsset||this.endedAsset}get playingLastItem(){var e;const t=this.playingItem,r=(e=this.schedule)==null?void 0:e.items;return!this.playbackStarted||!t||!r?!1:this.findItemIndex(t)===r.length-1}get playbackStarted(){return this.effectivePlayingItem!==null}get currentTime(){var e,t,r;if(this.mediaSelection===null)return;const n=this.waitingItem||this.playingItem;if(this.isInterstitial(n)&&!n.event.appendInPlace)return;let s=this.media;!s&&(e=this.bufferingItem)!=null&&(t=e.event)!=null&&t.appendInPlace&&(s=this.primaryMedia);const a=(r=s)==null?void 0:r.currentTime;if(!(a===void 0||!Ce(a)))return a}get primaryMedia(){var e;return this.media||((e=this.detachedData)==null?void 0:e.media)||null}isInterstitial(e){return!!(e!=null&&e.event)}retreiveMediaSource(e,t){const r=this.getAssetPlayer(e);r&&this.transferMediaFromPlayer(r,t)}transferMediaFromPlayer(e,t){const r=e.interstitial.appendInPlace,n=e.media;if(r&&n===this.primaryMedia){if(this.bufferingAsset=null,(!t||this.isInterstitial(t)&&!t.event.appendInPlace)&&t&&n){this.detachedData={media:n};return}const s=e.transferMedia();this.log(`transfer MediaSource from ${e} ${Gt(s)}`),this.detachedData=s}else t&&n&&(this.shouldPlay||(this.shouldPlay=!n.paused))}transferMediaTo(e,t){var r,n;if(e.media===t)return;let s=null;const a=this.hls,o=e!==a,l=o&&e.interstitial.appendInPlace,u=(r=this.detachedData)==null?void 0:r.mediaSource;let h;if(a.media)l&&(s=a.transferMedia(),this.detachedData=s),h="Primary";else if(u){const g=this.getBufferingPlayer();g?(s=g.transferMedia(),h=`${g}`):h="detached MediaSource"}else h="detached media";if(!s){if(u)s=this.detachedData,this.log(`using detachedData: MediaSource ${Gt(s)}`);else if(!this.detachedData||a.media===t){const g=this.playerQueue;g.length>1&&g.forEach(m=>{if(o&&m.interstitial.appendInPlace!==l){const v=m.interstitial;this.clearInterstitial(m.interstitial,null),v.appendInPlace=!1,v.appendInPlace&&this.warn(`Could not change append strategy for queued assets ${v}`)}}),this.hls.detachMedia(),this.detachedData={media:t}}}const d=s&&"mediaSource"in s&&((n=s.mediaSource)==null?void 0:n.readyState)!=="closed",p=d&&s?s:t;if(this.log(`${d?"transfering MediaSource":"attaching media"} to ${o?e:"Primary"} from ${h}`),p===s){const g=o&&e.assetId===this.schedule.assetIdAtEnd;p.overrides={duration:this.schedule.duration,endOfStream:!o||g,cueRemoval:!o}}e.attachMedia(p)}onInterstitialCueEnter(){this.onTimeupdate()}checkStart(){const e=this.schedule,t=e.events;if(!t||this.playbackDisabled||!this.media)return;this.bufferedPos===-1&&(this.bufferedPos=0);const r=this.timelinePos,n=this.effectivePlayingItem;if(r===-1){const s=this.hls.startPosition;if(this.timelinePos=s,t.length&&t[0].cue.pre){const a=e.findEventIndex(t[0].identifier);this.setSchedulePosition(a)}else if(s>=0||!this.primaryLive){const a=this.timelinePos=s>0?s:0,o=e.findItemIndexAtTime(a);this.setSchedulePosition(o)}}else if(n&&!this.playingItem){const s=e.findItemIndex(n);this.setSchedulePosition(s)}}advanceAfterAssetEnded(e,t,r){const n=Gg(e,r);if(!e.isAssetPastPlayoutLimit(n))this.setSchedulePosition(t,n);else{const s=this.schedule.items;if(s){const a=t+1,o=s.length;if(a>=o){this.setSchedulePosition(-1);return}const l=e.resumeTime;this.timelinePos<l&&(this.timelinePos=l,this.checkBuffer()),this.setSchedulePosition(a)}}}setScheduleToAssetAtTime(e,t){const r=this.schedule,n=t.parentIdentifier,s=r.getEvent(n);if(s){const a=r.findEventIndex(n),o=r.findAssetIndex(s,e);this.advanceAfterAssetEnded(s,a,o-1)}}setSchedulePosition(e,t){const r=this.schedule.items;if(!r||this.playbackDisabled)return;this.log(`setSchedulePosition ${e}, ${t}`);const n=e>=0?r[e]:null,s=this.playingItem,a=this.playingLastItem;if(this.isInterstitial(s)){var o;const u=s.event,h=this.playingAsset,d=h==null?void 0:h.identifier,p=d?this.getAssetPlayer(d):null;if(p&&d&&(!this.eventItemsMatch(s,n)||t!==void 0&&d!==((o=u.assetList)==null?void 0:o[t].identifier))){var l;const g=u.findAssetIndex(h);this.log(`INTERSTITIAL_ASSET_ENDED ${g+1}/${u.assetList.length} ${Xa(h)}`),this.endedAsset=h,this.playingAsset=null,this.hls.trigger(x.INTERSTITIAL_ASSET_ENDED,{asset:h,assetListIndex:g,event:u,schedule:r.slice(0),scheduleIndex:e,player:p}),this.retreiveMediaSource(d,n),p.media&&!((l=this.detachedData)!=null&&l.mediaSource)&&p.detachMedia()}if(!this.eventItemsMatch(s,n)&&(this.endedItem=s,this.playingItem=null,this.log(`INTERSTITIAL_ENDED ${u} ${ps(s)}`),u.hasPlayed=!0,this.hls.trigger(x.INTERSTITIAL_ENDED,{event:u,schedule:r.slice(0),scheduleIndex:e}),u.cue.once)){this.updateSchedule();const g=this.schedule.items;if(n&&g){const m=this.schedule.findItemIndex(n);this.advanceSchedule(m,g,t,s,a)}return}}this.advanceSchedule(e,r,t,s,a)}advanceSchedule(e,t,r,n,s){const a=e>=0?t[e]:null,o=this.primaryMedia,l=this.playerQueue;if(l.length&&l.forEach(u=>{const h=u.interstitial,d=this.schedule.findEventIndex(h.identifier);(d<e||d>e+1)&&this.clearInterstitial(h,a)}),this.isInterstitial(a)){this.timelinePos=Math.min(Math.max(this.timelinePos,a.start),a.end);const u=a.event;if(r===void 0){r=this.schedule.findAssetIndex(u,this.timelinePos);const g=Gg(u,r-1);if(u.isAssetPastPlayoutLimit(g)){this.advanceAfterAssetEnded(u,e,r);return}r=g}const h=this.waitingItem;this.assetsBuffered(a,o)||this.setBufferingItem(a);let d=this.preloadAssets(u,r);if(this.eventItemsMatch(a,h||n)||(this.waitingItem=a,this.log(`INTERSTITIAL_STARTED ${ps(a)} ${u.appendInPlace?"append in place":""}`),this.hls.trigger(x.INTERSTITIAL_STARTED,{event:u,schedule:t.slice(0),scheduleIndex:e})),!u.assetListLoaded){this.log(`Waiting for ASSET-LIST to complete loading ${u}`);return}if(u.assetListLoader&&(u.assetListLoader.destroy(),u.assetListLoader=void 0),!o){this.log(`Waiting for attachMedia to start Interstitial ${u}`);return}this.waitingItem=this.endedItem=null,this.playingItem=a;const p=u.assetList[r];if(!p){const g=t[e+1],m=this.media;g&&m&&!this.isInterstitial(g)&&m.currentTime<g.start&&(m.currentTime=this.timelinePos=g.start),this.advanceAfterAssetEnded(u,e,r||0);return}if(d||(d=this.getAssetPlayer(p.identifier)),d===null||d.destroyed){const g=u.assetList.length;this.warn(`asset ${r+1}/${g} player destroyed ${u}`),d=this.createAssetPlayer(u,p,r)}if(!this.eventItemsMatch(a,this.bufferingItem)&&u.appendInPlace&&this.isAssetBuffered(p))return;this.startAssetPlayer(d,r,t,e,o),this.shouldPlay&&kA(d.media)}else a!==null?(this.resumePrimary(a,e,n),this.shouldPlay&&kA(this.hls.media)):s&&this.isInterstitial(n)&&(this.endedItem=null,this.playingItem=n,n.event.appendInPlace||this.attachPrimary(this.schedule.durations.primary,null))}get playbackDisabled(){return this.hls.config.enableInterstitialPlayback===!1}get primaryDetails(){var e,t;return(e=this.mediaSelection)==null||(t=e.main)==null?void 0:t.details}get primaryLive(){var e;return!!((e=this.primaryDetails)!=null&&e.live)}resumePrimary(e,t,r){var n;if(this.playingItem=e,this.playingAsset=this.endedAsset=null,this.waitingItem=this.endedItem=null,this.bufferedToItem(e),this.log(`resuming ${ps(e)}`),!((n=this.detachedData)!=null&&n.mediaSource)){let a=this.timelinePos;(a<e.start||a>=e.end)&&(a=this.getPrimaryResumption(e,t),this.timelinePos=a),this.attachPrimary(a,e)}if(!r)return;const s=this.schedule.items;s&&(this.log(`INTERSTITIALS_PRIMARY_RESUMED ${ps(e)}`),this.hls.trigger(x.INTERSTITIALS_PRIMARY_RESUMED,{schedule:s.slice(0),scheduleIndex:t}),this.checkBuffer())}getPrimaryResumption(e,t){const r=e.start;if(this.primaryLive){const n=this.primaryDetails;if(t===0)return this.hls.startPosition;if(n&&(r<n.fragmentStart||r>n.edge))return this.hls.liveSyncPosition||-1}return r}isAssetBuffered(e){const t=this.getAssetPlayer(e.identifier);return t!=null&&t.hls?t.hls.bufferedToEnd:Xe.bufferInfo(this.primaryMedia,this.timelinePos,0).end+1>=e.timelineStart+(e.duration||0)}attachPrimary(e,t,r){t?this.setBufferingItem(t):this.bufferingItem=this.playingItem,this.bufferingAsset=null;const n=this.primaryMedia;if(!n)return;const s=this.hls;s.media?this.checkBuffer():(this.transferMediaTo(s,n),r&&this.startLoadingPrimaryAt(e,r)),r||(this.timelinePos=e,this.startLoadingPrimaryAt(e,r))}startLoadingPrimaryAt(e,t){var r;const n=this.hls;!n.loadingEnabled||!n.media||Math.abs((((r=n.mainForwardBufferInfo)==null?void 0:r.start)||n.media.currentTime)-e)>.5?n.startLoad(e,t):n.bufferingEnabled||n.resumeBuffering()}onManifestLoading(){this.stopLoad(),this.schedule.reset(),this.emptyPlayerQueue(),this.clearScheduleState(),this.shouldPlay=!1,this.bufferedPos=this.timelinePos=-1,this.mediaSelection=this.altSelection=this.manager=this.requiredTracks=null,this.hls.off(x.BUFFER_CODECS,this.onBufferCodecs,this),this.hls.on(x.BUFFER_CODECS,this.onBufferCodecs,this)}onLevelUpdated(e,t){if(t.level===-1)return;const r=this.hls.levels[t.level],n=Et(Et({},this.mediaSelection||this.altSelection),{},{main:r});this.mediaSelection=n,this.schedule.parseInterstitialDateRanges(n,this.hls.config.interstitialAppendInPlace),!this.effectivePlayingItem&&this.schedule.items&&this.checkStart()}onAudioTrackUpdated(e,t){const r=this.hls.audioTracks[t.id],n=this.mediaSelection;if(!n){this.altSelection=Et(Et({},this.altSelection),{},{audio:r});return}const s=Et(Et({},n),{},{audio:r});this.mediaSelection=s}onSubtitleTrackUpdated(e,t){const r=this.hls.subtitleTracks[t.id],n=this.mediaSelection;if(!n){this.altSelection=Et(Et({},this.altSelection),{},{subtitles:r});return}const s=Et(Et({},n),{},{subtitles:r});this.mediaSelection=s}onAudioTrackSwitching(e,t){const r=eb(t);this.playerQueue.forEach(n=>n.hls.setAudioOption(t)||n.hls.setAudioOption(r))}onSubtitleTrackSwitch(e,t){const r=eb(t);this.playerQueue.forEach(n=>n.hls.setSubtitleOption(t)||t.id!==-1&&n.hls.setSubtitleOption(r))}onBufferCodecs(e,t){const r=t.tracks;r&&(this.requiredTracks=r)}onBufferAppended(e,t){this.checkBuffer()}onBufferFlushed(e,t){const r=this.playingItem;if(r&&!this.itemsMatch(r,this.bufferingItem)&&!this.isInterstitial(r)){const n=this.timelinePos;this.bufferedPos=n,this.checkBuffer()}}onBufferedToEnd(e){const t=this.schedule.events;if(this.bufferedPos<Number.MAX_VALUE&&t){for(let n=0;n<t.length;n++){const s=t[n];if(s.cue.post){var r;const a=this.schedule.findEventIndex(s.identifier),o=(r=this.schedule.items)==null?void 0:r[a];this.isInterstitial(o)&&this.eventItemsMatch(o,this.bufferingItem)&&this.bufferedToItem(o,0);break}}this.bufferedPos=Number.MAX_VALUE}}onMediaEnded(e){const t=this.playingItem;if(!this.playingLastItem&&t){const r=this.findItemIndex(t);this.setSchedulePosition(r+1)}else this.shouldPlay=!1}updateItem(e,t){const r=this.schedule.items;if(e&&r){const n=this.findItemIndex(e,t);return r[n]||null}return null}trimInPlace(e,t){if(this.isInterstitial(e)&&e.event.appendInPlace&&t.end-e.end>.25){e.event.assetList.forEach((s,a)=>{e.event.isAssetPastPlayoutLimit(a)&&this.clearAssetPlayer(s.identifier,null)});const r=e.end+.25,n=Xe.bufferInfo(this.primaryMedia,r,0);(n.end>r||(n.nextStart||0)>r)&&(this.attachPrimary(r,null),this.flushFrontBuffer(r))}}itemsMatch(e,t){return!!t&&(e===t||e.event&&t.event&&this.eventItemsMatch(e,t)||!e.event&&!t.event&&this.findItemIndex(e)===this.findItemIndex(t))}eventItemsMatch(e,t){var r;return!!t&&(e===t||e.event.identifier===((r=t.event)==null?void 0:r.identifier))}findItemIndex(e,t){return e?this.schedule.findItemIndex(e,t):-1}updateSchedule(){const e=this.mediaSelection;e&&this.schedule.updateSchedule(e,[])}checkBuffer(e){const t=this.schedule.items;if(!t)return;const r=Xe.bufferInfo(this.primaryMedia,this.timelinePos,0);e&&(this.bufferedPos=this.timelinePos),e||(e=r.len<1),this.updateBufferedPos(r.end,t,e)}updateBufferedPos(e,t,r){const n=this.schedule,s=this.bufferingItem;if(this.bufferedPos>e)return;if(t.length===1&&this.itemsMatch(t[0],s)){this.bufferedPos=e;return}const a=this.playingItem,o=this.findItemIndex(a);let l=n.findItemIndexAtTime(e);if(this.bufferedPos<e){var u,h;const d=this.findItemIndex(s),p=Math.min(d+1,t.length-1),g=t[p];if((l===-1&&s&&e>=s.end||(u=g.event)!=null&&u.appendInPlace&&e+.01>=g.start)&&(l=p),p-o>1&&(s==null||(h=s.event)==null?void 0:h.appendInPlace)===!1)return;if(this.bufferedPos=e,l>d&&l>o)this.bufferedToItem(g);else{const m=this.primaryDetails;this.primaryLive&&m&&e>m.edge-m.targetduration&&g.start<m.edge+this.hls.config.interstitialLiveLookAhead&&this.isInterstitial(g)&&this.preloadAssets(g.event,0)}}else r&&a&&!this.itemsMatch(a,s)&&(l===o?this.bufferedToItem(a):l===o+1&&this.bufferedToItem(t[l]))}assetsBuffered(e,t){return e.event.assetList.length===0?!1:!e.event.assetList.some(n=>{const s=this.getAssetPlayer(n.identifier);return!(s!=null&&s.bufferedInPlaceToEnd(t))})}setBufferingItem(e){const t=this.bufferingItem,r=this.schedule;if(this.itemsMatch(e,t))this.bufferingItem!==e&&(this.bufferingItem=e);else{const{items:n,events:s}=r;if(!n||!s)return t;const a=this.isInterstitial(e),o=this.getBufferingPlayer();this.bufferingItem=e,this.bufferedPos=Math.max(e.start,Math.min(e.end,this.timelinePos));const l=o?o.remaining:t?t.end-this.timelinePos:0;this.log(`INTERSTITIALS_BUFFERED_TO_BOUNDARY ${ps(e)}`+(t?` (${l.toFixed(2)} remaining)`:"")),this.playbackDisabled||(a?e.event.assetList.forEach(u=>{const h=this.getAssetPlayer(u.identifier);h&&h.resumeBuffering()}):(this.hls.resumeBuffering(),this.playerQueue.forEach(u=>u.pauseBuffering()))),this.hls.trigger(x.INTERSTITIALS_BUFFERED_TO_BOUNDARY,{events:s.slice(0),schedule:n.slice(0),bufferingIndex:this.findItemIndex(e),playingIndex:this.findItemIndex(this.playingItem)})}return t}bufferedToItem(e,t=0){const r=this.setBufferingItem(e);if(!this.playbackDisabled){if(this.isInterstitial(e))this.bufferedToEvent(e,t);else if(r!==null){this.bufferingAsset=null;const n=this.detachedData;n?n.mediaSource?this.attachPrimary(e.start,e,!0):this.preloadPrimary(e):this.preloadPrimary(e)}}}preloadPrimary(e){const t=this.findItemIndex(e),r=this.getPrimaryResumption(e,t);this.startLoadingPrimaryAt(r)}bufferedToEvent(e,t){const r=e.event,n=r.assetList.length===0&&!r.assetListLoader,s=r.cue.once;if(n||!s){const a=this.preloadAssets(r,t);if(a!=null&&a.interstitial.appendInPlace){const o=r.assetList[t],l=this.primaryMedia;o&&l&&this.bufferAssetPlayer(a,l)}}}preloadAssets(e,t){const r=e.assetUrl,n=e.assetList.length,s=n===0&&!e.assetListLoader,a=e.cue.once;if(s){const l=e.timelineStart;if(e.appendInPlace){var o;const p=this.playingItem;!this.isInterstitial(p)&&(p==null||(o=p.nextEvent)==null?void 0:o.identifier)===e.identifier&&this.flushFrontBuffer(l+.25)}let u,h=0;if(!this.playingItem&&this.primaryLive&&(h=this.hls.startPosition,h===-1&&(h=this.hls.liveSyncPosition||0)),h&&!(e.cue.pre||e.cue.post)){const p=h-l;p>0&&(u=Math.round(p*1e3)/1e3)}if(this.log(`Load interstitial asset ${t+1}/${r?1:n} ${e}${u?` live-start: ${h} start-offset: ${u}`:""}`),r)return this.createAsset(e,0,0,l,e.duration,r);const d=this.assetListLoader.loadAssetList(e,u);d&&(e.assetListLoader=d)}else if(!a&&n){for(let l=t;l<n;l++){const u=e.assetList[l],h=this.getAssetPlayerQueueIndex(u.identifier);(h===-1||this.playerQueue[h].destroyed)&&!u.error&&this.createAssetPlayer(e,u,l)}return this.getAssetPlayer(e.assetList[t].identifier)}return null}flushFrontBuffer(e){const t=this.requiredTracks;if(!t)return;this.log(`Removing front buffer starting at ${e}`),Object.keys(t).forEach(n=>{this.hls.trigger(x.BUFFER_FLUSHING,{startOffset:e,endOffset:1/0,type:n})})}getAssetPlayerQueueIndex(e){const t=this.playerQueue;for(let r=0;r<t.length;r++)if(e===t[r].assetId)return r;return-1}getAssetPlayer(e){const t=this.getAssetPlayerQueueIndex(e);return this.playerQueue[t]||null}getBufferingPlayer(){const{playerQueue:e,primaryMedia:t}=this;if(t){for(let r=0;r<e.length;r++)if(e[r].media===t)return e[r]}return null}createAsset(e,t,r,n,s,a){const o={parentIdentifier:e.identifier,identifier:IM(e,a,t),duration:s,startOffset:r,timelineStart:n,uri:a};return this.createAssetPlayer(e,o,t)}createAssetPlayer(e,t,r){const n=this.hls,s=n.userConfig;let a=s.videoPreference;const o=n.loadLevelObj||n.levels[n.currentLevel];(a||o)&&(a=xt({},a),o.videoCodec&&(a.videoCodec=o.videoCodec),o.videoRange&&(a.allowedVideoRanges=[o.videoRange]));const l=n.audioTracks[n.audioTrack],u=n.subtitleTracks[n.subtitleTrack];let h=0;if(this.primaryLive||e.appendInPlace){const R=this.timelinePos-t.timelineStart;if(R>1){const _=t.duration;_&&R<_&&(h=R)}}const d=t.identifier,p=Et(Et({},s),{},{autoStartLoad:!0,startFragPrefetch:!0,primarySessionId:n.sessionId,assetPlayerId:d,abrEwmaDefaultEstimate:n.bandwidthEstimate,interstitialsController:void 0,startPosition:h,liveDurationInfinity:!1,testBandwidth:!1,videoPreference:a,audioPreference:l||s.audioPreference,subtitlePreference:u||s.subtitlePreference});e.appendInPlace&&(e.appendInPlaceStarted=!0,t.timelineStart&&(p.timelineOffset=t.timelineStart));const g=p.cmcd;g!=null&&g.sessionId&&g.contentId&&(p.cmcd=xt({},g,{contentId:cl(t.uri)})),this.getAssetPlayer(d)&&this.warn(`Duplicate date range identifier ${e} and asset ${d}`);const m=new wM(this.HlsPlayerClass,p,e,t);this.playerQueue.push(m),e.assetList[r]=t;const v=R=>{if(R.live){const w=new Error(`Interstitials MUST be VOD assets ${e}`),C={fatal:!0,type:Fe.OTHER_ERROR,details:Q.INTERSTITIAL_ASSET_ITEM_ERROR,error:w};this.handleAssetItemError(C,e,this.schedule.findEventIndex(e.identifier),r,w.message);return}const _=R.edge-R.fragmentStart,F=t.duration;(F===null||_>F)&&(this.log(`Interstitial asset "${d}" duration change ${F} > ${_}`),t.duration=_,this.updateSchedule())};m.on(x.LEVEL_UPDATED,(R,{details:_})=>v(_)),m.on(x.LEVEL_PTS_UPDATED,(R,{details:_})=>v(_));const E=(R,_)=>{const F=this.getAssetPlayer(d);if(F&&_.tracks){F.off(x.BUFFER_CODECS,E),F.tracks=_.tracks;const w=this.primaryMedia;this.bufferingAsset===F.assetItem&&w&&!F.media&&this.bufferAssetPlayer(F,w)}};m.on(x.BUFFER_CODECS,E);const A=()=>{var R;const _=this.getAssetPlayer(d);if(this.log(`buffered to end of asset ${_}`),!_)return;const F=this.schedule.findEventIndex(e.identifier),w=(R=this.schedule.items)==null?void 0:R[F];if(this.isInterstitial(w)){const M=e.findAssetIndex(t),L=Gg(e,M);if(!e.isAssetPastPlayoutLimit(L))this.bufferedToItem(w,L);else{var C;const I=(C=this.schedule.items)==null?void 0:C[F+1];I&&this.bufferedToItem(I)}}};m.on(x.BUFFERED_TO_END,A);const D=R=>()=>{if(!this.getAssetPlayer(d))return;this.shouldPlay=!0;const F=this.schedule.findEventIndex(e.identifier);this.advanceAfterAssetEnded(e,F,R)};return m.once(x.MEDIA_ENDED,D(r)),m.once(x.PLAYOUT_LIMIT_REACHED,D(1/0)),m.on(x.ERROR,(R,_)=>{const F=this.getAssetPlayer(d);if(_.details===Q.BUFFER_STALLED_ERROR){if(F!=null&&F.media){const w=F.currentTime,C=F.duration-w;w&&e.appendInPlace&&C/F.media.playbackRate<.5?(this.log(`Advancing buffer past end of asset ${d} ${e} at ${F.media.currentTime}`),A()):(this.warn(`Stalled at ${w} of ${w+C} in asset ${d} ${e}`),this.onTimeupdate(),this.checkBuffer(!0))}return}this.handleAssetItemError(_,e,this.schedule.findEventIndex(e.identifier),r,`Asset player error ${_.error} ${e}`)}),m.on(x.DESTROYING,()=>{if(!this.getAssetPlayer(d))return;const _=new Error(`Asset player destroyed unexpectedly ${d}`),F={fatal:!0,type:Fe.OTHER_ERROR,details:Q.INTERSTITIAL_ASSET_ITEM_ERROR,error:_};this.handleAssetItemError(F,e,this.schedule.findEventIndex(e.identifier),r,_.message)}),this.log(`INTERSTITIAL_ASSET_PLAYER_CREATED ${Xa(t)}`),this.hls.trigger(x.INTERSTITIAL_ASSET_PLAYER_CREATED,{asset:t,assetListIndex:r,event:e,player:m}),m}clearInterstitial(e,t){e.assetList.forEach(r=>{this.clearAssetPlayer(r.identifier,t)}),e.reset()}resetAssetPlayer(e){const t=this.getAssetPlayerQueueIndex(e);if(t!==-1){this.log(`reset asset player "${e}" after error`);const r=this.playerQueue[t];this.transferMediaFromPlayer(r,null),r.resetDetails()}}clearAssetPlayer(e,t){const r=this.getAssetPlayerQueueIndex(e);if(r!==-1){this.log(`clear asset player "${e}" toSegment: ${t&&ps(t)}`);const n=this.playerQueue[r];this.transferMediaFromPlayer(n,t),this.playerQueue.splice(r,1),n.destroy()}}emptyPlayerQueue(){let e;for(;e=this.playerQueue.pop();)e.destroy();this.playerQueue=[]}startAssetPlayer(e,t,r,n,s){const{interstitial:a,assetItem:o,assetId:l}=e,u=a.assetList.length,h=this.playingAsset;this.endedAsset=null,this.playingAsset=o,(!h||h.identifier!==l)&&(h&&(this.clearAssetPlayer(h.identifier,r[n]),delete h.error),this.log(`INTERSTITIAL_ASSET_STARTED ${t+1}/${u} ${Xa(o)}`),this.hls.trigger(x.INTERSTITIAL_ASSET_STARTED,{asset:o,assetListIndex:t,event:a,schedule:r.slice(0),scheduleIndex:n,player:e})),this.bufferAssetPlayer(e,s)}bufferAssetPlayer(e,t){var r,n;const{interstitial:s,assetItem:a}=e,o=this.schedule.findEventIndex(s.identifier),l=(r=this.schedule.items)==null?void 0:r[o];if(!l)return;this.setBufferingItem(l),this.bufferingAsset=a;const u=this.getBufferingPlayer();if(u===e)return;const h=s.appendInPlace;if(h&&(u==null?void 0:u.interstitial.appendInPlace)===!1)return;const d=(u==null?void 0:u.tracks)||((n=this.detachedData)==null?void 0:n.tracks)||this.requiredTracks;if(h&&a!==this.playingAsset){if(!e.tracks)return;if(d&&!NE(d,e.tracks)){const p=new Error(`Asset ${Xa(a)} SourceBuffer tracks ('${Object.keys(e.tracks)}') are not compatible with primary content tracks ('${Object.keys(d)}')`),g={fatal:!0,type:Fe.OTHER_ERROR,details:Q.INTERSTITIAL_ASSET_ITEM_ERROR,error:p},m=s.findAssetIndex(a);this.handleAssetItemError(g,s,o,m,p.message);return}}this.transferMediaTo(e,t)}handleAssetItemError(e,t,r,n,s){if(e.details===Q.BUFFER_STALLED_ERROR)return;const a=t.assetList[n];this.warn(`INTERSTITIAL_ASSET_ERROR ${a&&Xa(a)} ${e.error}`);const o=a==null?void 0:a.identifier,l=this.getAssetPlayerQueueIndex(o),u=this.playerQueue[l]||null,h=this.schedule.items,d=xt({},e,{fatal:!1,errorAction:Zo(!0),asset:a,assetListIndex:n,event:t,schedule:h,scheduleIndex:r,player:u});if(this.hls.trigger(x.INTERSTITIAL_ASSET_ERROR,d),!e.fatal)return;const p=this.playingAsset,g=new Error(s);if(a&&(this.clearAssetPlayer(o,null),a.error=g),!t.assetList.some(m=>!m.error))t.error=g;else if(t.appendInPlace){for(let m=n;m<t.assetList.length;m++)this.resetAssetPlayer(t.assetList[m].identifier);this.updateSchedule()}t.error?this.primaryFallback(t):p&&p.identifier===o&&this.advanceAfterAssetEnded(t,r,n)}primaryFallback(e){const t=e.timelineStart,r=this.effectivePlayingItem;if(this.updateSchedule(),r){this.log(`Fallback to primary from event "${e.identifier}" start: ${t} pos: ${this.timelinePos} playing: ${r?ps(r):"<none>"} error: ${e.error}`);let n=this.timelinePos;n===-1&&(n=this.hls.startPosition);const s=this.updateItem(r,n);this.itemsMatch(r,s)&&this.clearInterstitial(e,null),e.appendInPlace&&(this.attachPrimary(t,null),this.flushFrontBuffer(t));const a=this.schedule.findItemIndexAtTime(n);this.setSchedulePosition(a)}else this.checkStart()}onAssetListLoaded(e,t){var r;const n=t.event,s=n.identifier,a=t.assetListResponse.ASSETS;if(!this.schedule.hasEvent(s))return;const o=n.timelineStart,l=n.duration;let u=0;a.forEach((m,v)=>{const E=parseFloat(m.DURATION);this.createAsset(n,v,u,o+u,E,m.URI),u+=E}),n.duration=u,this.log(`Loaded asset-list with duration: ${u} (was: ${l}) ${n}`);const h=this.waitingItem,d=(h==null?void 0:h.event.identifier)===s;this.updateSchedule();const p=(r=this.bufferingItem)==null?void 0:r.event;if(d){var g;const m=this.schedule.findEventIndex(s),v=(g=this.schedule.items)==null?void 0:g[m];if(v){if(!this.playingItem&&this.timelinePos>v.end&&this.schedule.findItemIndexAtTime(this.timelinePos)!==m){n.error=new Error(`Interstitial no longer within playback range ${this.timelinePos} ${n}`),this.primaryFallback(n);return}this.setBufferingItem(v)}this.setSchedulePosition(m)}else if((p==null?void 0:p.identifier)===s&&p.appendInPlace){const m=n.assetList[0],v=this.getAssetPlayer(m.identifier),E=this.primaryMedia;m&&v&&E&&this.bufferAssetPlayer(v,E)}}onError(e,t){switch(t.details){case Q.ASSET_LIST_PARSING_ERROR:case Q.ASSET_LIST_LOAD_ERROR:case Q.ASSET_LIST_LOAD_TIMEOUT:{const r=t.interstitial;r&&this.primaryFallback(r);break}case Q.BUFFER_STALLED_ERROR:{this.onTimeupdate(),this.checkBuffer(!0);break}}}}const OA=500;class PM extends yg{constructor(e,t,r){super(e,t,r,"subtitle-stream-controller",ke.SUBTITLE),this.currentTrackId=-1,this.tracksBuffered=[],this.mainDetails=null,this.registerListeners()}onHandlerDestroying(){this.unregisterListeners(),super.onHandlerDestroying(),this.mainDetails=null}registerListeners(){super.registerListeners();const{hls:e}=this;e.on(x.LEVEL_LOADED,this.onLevelLoaded,this),e.on(x.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(x.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(x.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(x.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.on(x.BUFFER_FLUSHING,this.onBufferFlushing,this)}unregisterListeners(){super.unregisterListeners();const{hls:e}=this;e.off(x.LEVEL_LOADED,this.onLevelLoaded,this),e.off(x.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(x.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(x.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(x.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.off(x.BUFFER_FLUSHING,this.onBufferFlushing,this)}startLoad(e,t){this.stopLoad(),this.state=le.IDLE,this.setInterval(OA),this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick()}onManifestLoading(){super.onManifestLoading(),this.mainDetails=null}onMediaDetaching(e,t){this.tracksBuffered=[],super.onMediaDetaching(e,t)}onLevelLoaded(e,t){this.mainDetails=t.details}onSubtitleFragProcessed(e,t){const{frag:r,success:n}=t;if(pr(r)&&(this.fragPrevious=r),this.state=le.IDLE,!n)return;const s=this.tracksBuffered[this.currentTrackId];if(!s)return;let a;const o=r.start;for(let u=0;u<s.length;u++)if(o>=s[u].start&&o<=s[u].end){a=s[u];break}const l=r.start+r.duration;a?a.end=l:(a={start:o,end:l},s.push(a)),this.fragmentTracker.fragBuffered(r),this.fragBufferedComplete(r,null),this.media&&this.tick()}onBufferFlushing(e,t){const{startOffset:r,endOffset:n}=t;if(r===0&&n!==Number.POSITIVE_INFINITY){const s=n-1;if(s<=0)return;t.endOffsetSubtitles=Math.max(0,s),this.tracksBuffered.forEach(a=>{for(let o=0;o<a.length;){if(a[o].end<=s){a.shift();continue}else if(a[o].start<s)a[o].start=s;else break;o++}}),this.fragmentTracker.removeFragmentsInRange(r,s,ke.SUBTITLE)}}onError(e,t){const r=t.frag;(r==null?void 0:r.type)===ke.SUBTITLE&&(t.details===Q.FRAG_GAP&&this.fragmentTracker.fragBuffered(r,!0),this.fragCurrent&&this.fragCurrent.abortRequests(),this.state!==le.STOPPED&&(this.state=le.IDLE))}onSubtitleTracksUpdated(e,{subtitleTracks:t}){if(this.levels&&yA(this.levels,t)){this.levels=t.map(r=>new Qo(r));return}this.tracksBuffered=[],this.levels=t.map(r=>{const n=new Qo(r);return this.tracksBuffered[n.id]=[],n}),this.fragmentTracker.removeFragmentsInRange(0,Number.POSITIVE_INFINITY,ke.SUBTITLE),this.fragPrevious=null,this.mediaBuffer=null}onSubtitleTrackSwitch(e,t){var r;if(this.currentTrackId=t.id,!((r=this.levels)!=null&&r.length)||this.currentTrackId===-1){this.clearInterval();return}const n=this.levels[this.currentTrackId];n!=null&&n.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,n&&this.state!==le.STOPPED&&this.setInterval(OA)}onSubtitleTrackLoaded(e,t){var r;const{currentTrackId:n,levels:s}=this,{details:a,id:o}=t;if(!s){this.warn(`Subtitle tracks were reset while loading level ${o}`);return}const l=s[o];if(o>=s.length||!l)return;this.log(`Subtitle track ${o} loaded [${a.startSN},${a.endSN}]${a.lastPartSn?`[part-${a.lastPartSn}-${a.lastPartIndex}]`:""},duration:${a.totalduration}`),this.mediaBuffer=this.mediaBufferTimeRanges;let u=0;if(a.live||(r=l.details)!=null&&r.live){const d=this.mainDetails;if(a.deltaUpdateFailed||!d)return;const p=d.fragments[0];if(!l.details)a.hasProgramDateTime&&d.hasProgramDateTime?(zu(a,d),u=a.fragmentStart):p&&(u=p.start,mg(a,u));else{var h;u=this.alignPlaylists(a,l.details,(h=this.levelLastLoaded)==null?void 0:h.details),u===0&&p&&(u=p.start,mg(a,u))}}l.details=a,this.levelLastLoaded=l,o===n&&(this.hls.trigger(x.SUBTITLE_TRACK_UPDATED,{details:a,id:o,groupId:t.groupId}),this.tick(),a.live&&!this.fragCurrent&&this.media&&this.state===le.IDLE&&(js(null,a.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),l.details=void 0)))}_handleFragmentLoadComplete(e){const{frag:t,payload:r}=e,n=t.decryptdata,s=this.hls;if(!this.fragContextChanged(t)&&r&&r.byteLength>0&&n!=null&&n.key&&n.iv&&$a(n.method)){const a=performance.now();this.decrypter.decrypt(new Uint8Array(r),n.key.buffer,n.iv.buffer,ug(n.method)).catch(o=>{throw s.trigger(x.ERROR,{type:Fe.MEDIA_ERROR,details:Q.FRAG_DECRYPT_ERROR,fatal:!1,error:o,reason:o.message,frag:t}),o}).then(o=>{const l=performance.now();s.trigger(x.FRAG_DECRYPTED,{frag:t,payload:o,stats:{tstart:a,tdecrypt:l}})}).catch(o=>{this.warn(`${o.name}: ${o.message}`),this.state=le.IDLE})}}doTick(){if(!this.media){this.state=le.IDLE;return}if(this.state===le.IDLE){const{currentTrackId:e,levels:t}=this,r=t==null?void 0:t[e];if(!r||!t.length||!r.details||this.waitForLive(r))return;const{config:n}=this,s=this.getLoadPosition(),a=Xe.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],s,n.maxBufferHole),{end:o,len:l}=a,u=r.details,h=this.hls.maxBufferLength+u.levelTargetDuration;if(l>h)return;const d=u.fragments,p=d.length,g=u.edge;let m=null;const v=this.fragPrevious;if(o<g){const D=n.maxFragLookUpTolerance,R=o>g-D?0:D;m=js(v,d,Math.max(d[0].start,o),R),!m&&v&&v.start<d[0].start&&(m=d[0])}else m=d[p-1];if(m=this.filterReplacedPrimary(m,r.details),!m)return;const E=m.sn-u.startSN,A=d[E-1];if(A&&A.cc===m.cc&&this.fragmentTracker.getState(A)===nr.NOT_LOADED&&(m=A),this.fragmentTracker.getState(m)===nr.NOT_LOADED){const D=this.mapToInitFragWhenRequired(m);D&&this.loadFragment(D,r,o)}}}loadFragment(e,t,r){pr(e)?super.loadFragment(e,t,r):this._loadInitSegment(e,t)}get mediaBufferTimeRanges(){return new kM(this.tracksBuffered[this.currentTrackId]||[])}}class kM{constructor(e){this.buffered=void 0;const t=(r,n,s)=>{if(n=n>>>0,n>s-1)throw new DOMException(`Failed to execute '${r}' on 'TimeRanges': The index provided (${n}) is greater than the maximum bound (${s})`);return e[n][r]};this.buffered={get length(){return e.length},end(r){return t("end",r,e.length)},start(r){return t("start",r,e.length)}}}}const OM={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},FA=i=>String.fromCharCode(OM[i]||i),_i=15,Mn=100,FM={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},BM={17:2,18:4,21:6,22:8,23:10,19:13,20:15},UM={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},$M={25:2,26:4,29:6,30:8,31:10,27:13,28:15},GM=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];class qM{constructor(){this.time=null,this.verboseLevel=0}log(e,t){if(this.verboseLevel>=e){const r=typeof t=="function"?t():t;mt.log(`${this.time} [${e}] ${r}`)}}}const zs=function(e){const t=[];for(let r=0;r<e.length;r++)t.push(e[r].toString(16));return t};class BA{constructor(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}reset(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}setStyles(e){const t=["foreground","underline","italics","background","flash"];for(let r=0;r<t.length;r++){const n=t[r];e.hasOwnProperty(n)&&(this[n]=e[n])}}isDefault(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash}equals(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash}copy(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash}toString(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}}class VM{constructor(){this.uchar=" ",this.penState=new BA}reset(){this.uchar=" ",this.penState.reset()}setChar(e,t){this.uchar=e,this.penState.copy(t)}setPenState(e){this.penState.copy(e)}equals(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)}copy(e){this.uchar=e.uchar,this.penState.copy(e.penState)}isEmpty(){return this.uchar===" "&&this.penState.isDefault()}}class HM{constructor(e){this.chars=[],this.pos=0,this.currPenState=new BA,this.cueStartTime=null,this.logger=void 0;for(let t=0;t<Mn;t++)this.chars.push(new VM);this.logger=e}equals(e){for(let t=0;t<Mn;t++)if(!this.chars[t].equals(e.chars[t]))return!1;return!0}copy(e){for(let t=0;t<Mn;t++)this.chars[t].copy(e.chars[t])}isEmpty(){let e=!0;for(let t=0;t<Mn;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e}setCursor(e){this.pos!==e&&(this.pos=e),this.pos<0?(this.logger.log(3,"Negative cursor position "+this.pos),this.pos=0):this.pos>Mn&&(this.logger.log(3,"Too large cursor position "+this.pos),this.pos=Mn)}moveCursor(e){const t=this.pos+e;if(e>1)for(let r=this.pos+1;r<t+1;r++)this.chars[r].setPenState(this.currPenState);this.setCursor(t)}backSpace(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}insertChar(e){e>=144&&this.backSpace();const t=FA(e);if(this.pos>=Mn){this.logger.log(0,()=>"Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!");return}this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1)}clearFromPos(e){let t;for(t=e;t<Mn;t++)this.chars[t].reset()}clear(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}clearToEndOfRow(){this.clearFromPos(this.pos)}getTextString(){const e=[];let t=!0;for(let r=0;r<Mn;r++){const n=this.chars[r].uchar;n!==" "&&(t=!1),e.push(n)}return t?"":e.join("")}setPenStyles(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)}}class qg{constructor(e){this.rows=[],this.currRow=_i-1,this.nrRollUpRows=null,this.lastOutputScreen=null,this.logger=void 0;for(let t=0;t<_i;t++)this.rows.push(new HM(e));this.logger=e}reset(){for(let e=0;e<_i;e++)this.rows[e].clear();this.currRow=_i-1}equals(e){let t=!0;for(let r=0;r<_i;r++)if(!this.rows[r].equals(e.rows[r])){t=!1;break}return t}copy(e){for(let t=0;t<_i;t++)this.rows[t].copy(e.rows[t])}isEmpty(){let e=!0;for(let t=0;t<_i;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e}backSpace(){this.rows[this.currRow].backSpace()}clearToEndOfRow(){this.rows[this.currRow].clearToEndOfRow()}insertChar(e){this.rows[this.currRow].insertChar(e)}setPen(e){this.rows[this.currRow].setPenStyles(e)}moveCursor(e){this.rows[this.currRow].moveCursor(e)}setCursor(e){this.logger.log(2,"setCursor: "+e),this.rows[this.currRow].setCursor(e)}setPAC(e){this.logger.log(2,()=>"pacData = "+Gt(e));let t=e.row-1;if(this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(let o=0;o<_i;o++)this.rows[o].clear();const s=this.currRow+1-this.nrRollUpRows,a=this.lastOutputScreen;if(a){const o=a.rows[s].cueStartTime,l=this.logger.time;if(o!==null&&l!==null&&o<l)for(let u=0;u<this.nrRollUpRows;u++)this.rows[t-this.nrRollUpRows+u+1].copy(a.rows[s+u])}}this.currRow=t;const r=this.rows[this.currRow];if(e.indent!==null){const s=e.indent,a=Math.max(s-1,0);r.setCursor(e.indent),e.color=r.chars[a].penState.foreground}const n={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(n)}setBkgData(e){this.logger.log(2,()=>"bkgData = "+Gt(e)),this.backSpace(),this.setPen(e),this.insertChar(32)}setRollUpRows(e){this.nrRollUpRows=e}rollUp(){if(this.nrRollUpRows===null){this.logger.log(3,"roll_up but nrRollUpRows not set yet");return}this.logger.log(1,()=>this.getDisplayText());const e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),this.logger.log(2,"Rolling up")}getDisplayText(e){e=e||!1;const t=[];let r="",n=-1;for(let s=0;s<_i;s++){const a=this.rows[s].getTextString();a&&(n=s+1,e?t.push("Row "+n+": '"+a+"'"):t.push(a.trim()))}return t.length>0&&(e?r="["+t.join(" | ")+"]":r=t.join(`
`)),r}getTextAndFormat(){return this.rows}}class UA{constructor(e,t,r){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new qg(r),this.nonDisplayedMemory=new qg(r),this.lastOutputScreen=new qg(r),this.currRollUpRow=this.displayedMemory.rows[_i-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=r}reset(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[_i-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}getHandler(){return this.outputFilter}setHandler(e){this.outputFilter=e}setPAC(e){this.writeScreen.setPAC(e)}setBkgData(e){this.writeScreen.setBkgData(e)}setMode(e){e!==this.mode&&(this.mode=e,this.logger.log(2,()=>"MODE="+e),this.mode==="MODE_POP-ON"?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!=="MODE_ROLL-UP"&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)}insertChars(e){for(let r=0;r<e.length;r++)this.writeScreen.insertChar(e[r]);const t=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(2,()=>t+": "+this.writeScreen.getDisplayText(!0)),(this.mode==="MODE_PAINT-ON"||this.mode==="MODE_ROLL-UP")&&(this.logger.log(1,()=>"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())}ccRCL(){this.logger.log(2,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}ccBS(){this.logger.log(2,"BS - BackSpace"),this.mode!=="MODE_TEXT"&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}ccAOF(){}ccAON(){}ccDER(){this.logger.log(2,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}ccRU(e){this.logger.log(2,"RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)}ccFON(){this.logger.log(2,"FON - Flash On"),this.writeScreen.setPen({flash:!0})}ccRDC(){this.logger.log(2,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}ccTR(){this.logger.log(2,"TR"),this.setMode("MODE_TEXT")}ccRTD(){this.logger.log(2,"RTD"),this.setMode("MODE_TEXT")}ccEDM(){this.logger.log(2,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)}ccCR(){this.logger.log(2,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)}ccENM(){this.logger.log(2,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}ccEOC(){if(this.logger.log(2,"EOC - End Of Caption"),this.mode==="MODE_POP-ON"){const e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,this.logger.log(1,()=>"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)}ccTO(e){this.logger.log(2,"TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)}ccMIDROW(e){const t={flash:!1};if(t.underline=e%2===1,t.italics=e>=46,t.italics)t.foreground="white";else{const r=Math.floor(e/2)-16,n=["white","green","blue","cyan","red","yellow","magenta"];t.foreground=n[r]}this.logger.log(2,"MIDROW: "+Gt(t)),this.writeScreen.setPen(t)}outputDataUpdate(e=!1){const t=this.logger.time;t!==null&&this.outputFilter&&(this.cueStartTime===null&&!this.displayedMemory.isEmpty()?this.cueStartTime=t:this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),e&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:t),this.lastOutputScreen.copy(this.displayedMemory))}cueSplitAtTime(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))}}class $A{constructor(e,t,r){this.channels=void 0,this.currentChannel=0,this.cmdHistory=WM(),this.logger=void 0;const n=this.logger=new qM;this.channels=[null,new UA(e,t,n),new UA(e+1,r,n)]}getHandler(e){return this.channels[e].getHandler()}setHandler(e,t){this.channels[e].setHandler(t)}addData(e,t){this.logger.time=e;for(let r=0;r<t.length;r+=2){const n=t[r]&127,s=t[r+1]&127;let a=!1,o=null;if(n===0&&s===0)continue;this.logger.log(3,()=>"["+zs([t[r],t[r+1]])+"] -> ("+zs([n,s])+")");const l=this.cmdHistory;if(n>=16&&n<=31){if(KM(n,s,l)){lc(null,null,l),this.logger.log(3,()=>"Repeated command ("+zs([n,s])+") is dropped");continue}lc(n,s,this.cmdHistory),a=this.parseCmd(n,s),a||(a=this.parseMidrow(n,s)),a||(a=this.parsePAC(n,s)),a||(a=this.parseBackgroundAttributes(n,s))}else lc(null,null,l);if(!a&&(o=this.parseChars(n,s),o)){const h=this.currentChannel;h&&h>0?this.channels[h].insertChars(o):this.logger.log(2,"No channel found yet. TEXT-MODE?")}!a&&!o&&this.logger.log(2,()=>"Couldn't parse cleaned data "+zs([n,s])+" orig: "+zs([t[r],t[r+1]]))}}parseCmd(e,t){const r=(e===20||e===28||e===21||e===29)&&t>=32&&t<=47,n=(e===23||e===31)&&t>=33&&t<=35;if(!(r||n))return!1;const s=e===20||e===21||e===23?1:2,a=this.channels[s];return e===20||e===21||e===28||e===29?t===32?a.ccRCL():t===33?a.ccBS():t===34?a.ccAOF():t===35?a.ccAON():t===36?a.ccDER():t===37?a.ccRU(2):t===38?a.ccRU(3):t===39?a.ccRU(4):t===40?a.ccFON():t===41?a.ccRDC():t===42?a.ccTR():t===43?a.ccRTD():t===44?a.ccEDM():t===45?a.ccCR():t===46?a.ccENM():t===47&&a.ccEOC():a.ccTO(t-32),this.currentChannel=s,!0}parseMidrow(e,t){let r=0;if((e===17||e===25)&&t>=32&&t<=47){if(e===17?r=1:r=2,r!==this.currentChannel)return this.logger.log(0,"Mismatch channel in midrow parsing"),!1;const n=this.channels[r];return n?(n.ccMIDROW(t),this.logger.log(3,()=>"MIDROW ("+zs([e,t])+")"),!0):!1}return!1}parsePAC(e,t){let r;const n=(e>=17&&e<=23||e>=25&&e<=31)&&t>=64&&t<=127,s=(e===16||e===24)&&t>=64&&t<=95;if(!(n||s))return!1;const a=e<=23?1:2;t>=64&&t<=95?r=a===1?FM[e]:UM[e]:r=a===1?BM[e]:$M[e];const o=this.channels[a];return o?(o.setPAC(this.interpretPAC(r,t)),this.currentChannel=a,!0):!1}interpretPAC(e,t){let r;const n={color:null,italics:!1,indent:null,underline:!1,row:e};return t>95?r=t-96:r=t-64,n.underline=(r&1)===1,r<=13?n.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(r/2)]:r<=15?(n.italics=!0,n.color="white"):n.indent=Math.floor((r-16)/2)*4,n}parseChars(e,t){let r,n=null,s=null;if(e>=25?(r=2,s=e-8):(r=1,s=e),s>=17&&s<=19){let a;s===17?a=t+80:s===18?a=t+112:a=t+144,this.logger.log(2,()=>"Special char '"+FA(a)+"' in channel "+r),n=[a]}else e>=32&&e<=127&&(n=t===0?[e]:[e,t]);return n&&this.logger.log(3,()=>"Char codes =  "+zs(n).join(",")),n}parseBackgroundAttributes(e,t){const r=(e===16||e===24)&&t>=32&&t<=47,n=(e===23||e===31)&&t>=45&&t<=47;if(!(r||n))return!1;let s;const a={};e===16||e===24?(s=Math.floor((t-32)/2),a.background=GM[s],t%2===1&&(a.background=a.background+"_semi")):t===45?a.background="transparent":(a.foreground="black",t===47&&(a.underline=!0));const o=e<=23?1:2;return this.channels[o].setBkgData(a),!0}reset(){for(let e=0;e<Object.keys(this.channels).length;e++){const t=this.channels[e];t&&t.reset()}lc(null,null,this.cmdHistory)}cueSplitAtTime(e){for(let t=0;t<this.channels.length;t++){const r=this.channels[t];r&&r.cueSplitAtTime(e)}}}function lc(i,e,t){t.a=i,t.b=e}function KM(i,e,t){return t.a===i&&t.b===e}function WM(){return{a:null,b:null}}var Vg=function(){if(Ku!=null&&Ku.VTTCue)return self.VTTCue;const i=["","lr","rl"],e=["start","middle","end","left","right"];function t(o,l){if(typeof l!="string"||!Array.isArray(o))return!1;const u=l.toLowerCase();return~o.indexOf(u)?u:!1}function r(o){return t(i,o)}function n(o){return t(e,o)}function s(o,...l){let u=1;for(;u<arguments.length;u++){const h=arguments[u];for(const d in h)o[d]=h[d]}return o}function a(o,l,u){const h=this,d={enumerable:!0};h.hasBeenReset=!1;let p="",g=!1,m=o,v=l,E=u,A=null,D="",R=!0,_="auto",F="start",w=50,C="middle",M=50,L="middle";Object.defineProperty(h,"id",s({},d,{get:function(){return p},set:function(I){p=""+I}})),Object.defineProperty(h,"pauseOnExit",s({},d,{get:function(){return g},set:function(I){g=!!I}})),Object.defineProperty(h,"startTime",s({},d,{get:function(){return m},set:function(I){if(typeof I!="number")throw new TypeError("Start time must be set to a number.");m=I,this.hasBeenReset=!0}})),Object.defineProperty(h,"endTime",s({},d,{get:function(){return v},set:function(I){if(typeof I!="number")throw new TypeError("End time must be set to a number.");v=I,this.hasBeenReset=!0}})),Object.defineProperty(h,"text",s({},d,{get:function(){return E},set:function(I){E=""+I,this.hasBeenReset=!0}})),Object.defineProperty(h,"region",s({},d,{get:function(){return A},set:function(I){A=I,this.hasBeenReset=!0}})),Object.defineProperty(h,"vertical",s({},d,{get:function(){return D},set:function(I){const U=r(I);if(U===!1)throw new SyntaxError("An invalid or illegal string was specified.");D=U,this.hasBeenReset=!0}})),Object.defineProperty(h,"snapToLines",s({},d,{get:function(){return R},set:function(I){R=!!I,this.hasBeenReset=!0}})),Object.defineProperty(h,"line",s({},d,{get:function(){return _},set:function(I){if(typeof I!="number"&&I!=="auto")throw new SyntaxError("An invalid number or illegal string was specified.");_=I,this.hasBeenReset=!0}})),Object.defineProperty(h,"lineAlign",s({},d,{get:function(){return F},set:function(I){const U=n(I);if(!U)throw new SyntaxError("An invalid or illegal string was specified.");F=U,this.hasBeenReset=!0}})),Object.defineProperty(h,"position",s({},d,{get:function(){return w},set:function(I){if(I<0||I>100)throw new Error("Position must be between 0 and 100.");w=I,this.hasBeenReset=!0}})),Object.defineProperty(h,"positionAlign",s({},d,{get:function(){return C},set:function(I){const U=n(I);if(!U)throw new SyntaxError("An invalid or illegal string was specified.");C=U,this.hasBeenReset=!0}})),Object.defineProperty(h,"size",s({},d,{get:function(){return M},set:function(I){if(I<0||I>100)throw new Error("Size must be between 0 and 100.");M=I,this.hasBeenReset=!0}})),Object.defineProperty(h,"align",s({},d,{get:function(){return L},set:function(I){const U=n(I);if(!U)throw new SyntaxError("An invalid or illegal string was specified.");L=U,this.hasBeenReset=!0}})),h.displayState=void 0}return a.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},a}();class YM{decode(e,t){if(!e)return"";if(typeof e!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}function GA(i){function e(r,n,s,a){return(r|0)*3600+(n|0)*60+(s|0)+parseFloat(a||0)}const t=i.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return t?parseFloat(t[2])>59?e(t[2],t[3],0,t[4]):e(t[1],t[2],t[3],t[4]):null}class XM{constructor(){this.values=Object.create(null)}set(e,t){!this.get(e)&&t!==""&&(this.values[e]=t)}get(e,t,r){return r?this.has(e)?this.values[e]:t[r]:this.has(e)?this.values[e]:t}has(e){return e in this.values}alt(e,t,r){for(let n=0;n<r.length;++n)if(t===r[n]){this.set(e,t);break}}integer(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))}percent(e,t){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(t)){const r=parseFloat(t);if(r>=0&&r<=100)return this.set(e,r),!0}return!1}}function qA(i,e,t,r){const n=r?i.split(r):[i];for(const s in n){if(typeof n[s]!="string")continue;const a=n[s].split(t);if(a.length!==2)continue;const o=a[0],l=a[1];e(o,l)}}const Hg=new Vg(0,0,""),uc=Hg.align==="middle"?"middle":"center";function jM(i,e,t){const r=i;function n(){const o=GA(i);if(o===null)throw new Error("Malformed timestamp: "+r);return i=i.replace(/^[^\sa-zA-Z-]+/,""),o}function s(o,l){const u=new XM;qA(o,function(p,g){let m;switch(p){case"region":for(let v=t.length-1;v>=0;v--)if(t[v].id===g){u.set(p,t[v].region);break}break;case"vertical":u.alt(p,g,["rl","lr"]);break;case"line":m=g.split(","),u.integer(p,m[0]),u.percent(p,m[0])&&u.set("snapToLines",!1),u.alt(p,m[0],["auto"]),m.length===2&&u.alt("lineAlign",m[1],["start",uc,"end"]);break;case"position":m=g.split(","),u.percent(p,m[0]),m.length===2&&u.alt("positionAlign",m[1],["start",uc,"end","line-left","line-right","auto"]);break;case"size":u.percent(p,g);break;case"align":u.alt(p,g,["start",uc,"end","left","right"]);break}},/:/,/\s/),l.region=u.get("region",null),l.vertical=u.get("vertical","");let h=u.get("line","auto");h==="auto"&&Hg.line===-1&&(h=-1),l.line=h,l.lineAlign=u.get("lineAlign","start"),l.snapToLines=u.get("snapToLines",!0),l.size=u.get("size",100),l.align=u.get("align",uc);let d=u.get("position","auto");d==="auto"&&Hg.position===50&&(d=l.align==="start"||l.align==="left"?0:l.align==="end"||l.align==="right"?100:50),l.position=d}function a(){i=i.replace(/^\s+/,"")}if(a(),e.startTime=n(),a(),i.slice(0,3)!=="-->")throw new Error("Malformed time stamp (time stamps must be separated by '-->'): "+r);i=i.slice(3),a(),e.endTime=n(),a(),s(i,e)}function VA(i){return i.replace(/<br(?: \/)?>/gi,`
`)}let zM=class{constructor(){this.state="INITIAL",this.buffer="",this.decoder=new YM,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}parse(e){const t=this;e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));function r(){let s=t.buffer,a=0;for(s=VA(s);a<s.length&&s[a]!=="\r"&&s[a]!==`
`;)++a;const o=s.slice(0,a);return s[a]==="\r"&&++a,s[a]===`
`&&++a,t.buffer=s.slice(a),o}function n(s){qA(s,function(a,o){},/:/)}try{let s="";if(t.state==="INITIAL"){if(!/\r\n|\n/.test(t.buffer))return this;s=r();const o=s.match(/^(ï»¿)?WEBVTT([ \t].*)?$/);if(!(o!=null&&o[0]))throw new Error("Malformed WebVTT signature.");t.state="HEADER"}let a=!1;for(;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(a?a=!1:s=r(),t.state){case"HEADER":/:/.test(s)?n(s):s||(t.state="ID");continue;case"NOTE":s||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(s)){t.state="NOTE";break}if(!s)continue;if(t.cue=new Vg(0,0,""),t.state="CUE",s.indexOf("-->")===-1){t.cue.id=s;continue}case"CUE":if(!t.cue){t.state="BADCUE";continue}try{jM(s,t.cue,t.regionList)}catch{t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":{const o=s.indexOf("-->")!==-1;if(!s||o&&(a=!0)){t.oncue&&t.cue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}if(t.cue===null)continue;t.cue.text&&(t.cue.text+=`
`),t.cue.text+=s}continue;case"BADCUE":s||(t.state="ID")}}}catch{t.state==="CUETEXT"&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state=t.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this}flush(){const e=this;try{if((e.cue||e.state==="HEADER")&&(e.buffer+=`

`,e.parse()),e.state==="INITIAL"||e.state==="BADWEBVTT")throw new Error("Malformed WebVTT signature.")}catch(t){e.onparsingerror&&e.onparsingerror(t)}return e.onflush&&e.onflush(),this}};const JM=/\r\n|\n\r|\n|\r/g,Kg=function(e,t,r=0){return e.slice(r,r+t.length)===t},QM=function(e){let t=parseInt(e.slice(-3));const r=parseInt(e.slice(-6,-4)),n=parseInt(e.slice(-9,-7)),s=e.length>9?parseInt(e.substring(0,e.indexOf(":"))):0;if(!Ce(t)||!Ce(r)||!Ce(n)||!Ce(s))throw Error(`Malformed X-TIMESTAMP-MAP: Local:${e}`);return t+=1e3*r,t+=60*1e3*n,t+=60*60*1e3*s,t};function Wg(i,e,t){return cl(i.toString())+cl(e.toString())+cl(t)}const ZM=function(e,t,r){let n=e[t],s=e[n.prevCC];if(!s||!s.new&&n.new){e.ccOffset=e.presentationOffset=n.start,n.new=!1;return}for(;(a=s)!=null&&a.new;){var a;e.ccOffset+=n.start-s.start,n.new=!1,n=s,s=e[n.prevCC]}e.presentationOffset=r};function eP(i,e,t,r,n,s,a){const o=new zM,l=ii(new Uint8Array(i)).trim().replace(JM,`
`).split(`
`),u=[],h=e?A_(e.baseTime,e.timescale):0;let d="00:00.000",p=0,g=0,m,v=!0;o.oncue=function(E){const A=t[r];let D=t.ccOffset;const R=(p-h)/9e4;if(A!=null&&A.new&&(g!==void 0?D=t.ccOffset=A.start:ZM(t,r,R)),R){if(!e){m=new Error("Missing initPTS for VTT MPEGTS");return}D=R-t.presentationOffset}const _=E.endTime-E.startTime,F=mi((E.startTime+D-g)*9e4,n*9e4)/9e4;E.startTime=Math.max(F,0),E.endTime=Math.max(F+_,0);const w=E.text.trim();E.text=decodeURIComponent(encodeURIComponent(w)),E.id||(E.id=Wg(E.startTime,E.endTime,w)),E.endTime>0&&u.push(E)},o.onparsingerror=function(E){m=E},o.onflush=function(){if(m){a(m);return}s(u)},l.forEach(E=>{if(v)if(Kg(E,"X-TIMESTAMP-MAP=")){v=!1,E.slice(16).split(",").forEach(A=>{Kg(A,"LOCAL:")?d=A.slice(6):Kg(A,"MPEGTS:")&&(p=parseInt(A.slice(7)))});try{g=QM(d)/1e3}catch(A){m=A}return}else E===""&&(v=!1);o.parse(E+`
`)}),o.flush()}const Yg="stpp.ttml.im1t",HA=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,KA=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,tP={left:"start",center:"center",right:"end",start:"start",end:"end"};function WA(i,e,t,r){const n=Qe(new Uint8Array(i),["mdat"]);if(n.length===0){r(new Error("Could not parse IMSC1 mdat"));return}const s=n.map(o=>ii(o)),a=b_(e.baseTime,1,e.timescale);try{s.forEach(o=>t(rP(o,a)))}catch(o){r(o)}}function rP(i,e){const n=new DOMParser().parseFromString(i,"text/xml").getElementsByTagName("tt")[0];if(!n)throw new Error("Invalid ttml");const s={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},a=Object.keys(s).reduce((d,p)=>(d[p]=n.getAttribute(`ttp:${p}`)||s[p],d),{}),o=n.getAttribute("xml:space")!=="preserve",l=YA(Xg(n,"styling","style")),u=YA(Xg(n,"layout","region")),h=Xg(n,"body","[begin]");return[].map.call(h,d=>{const p=XA(d,o);if(!p||!d.hasAttribute("begin"))return null;const g=zg(d.getAttribute("begin"),a),m=zg(d.getAttribute("dur"),a);let v=zg(d.getAttribute("end"),a);if(g===null)throw jA(d);if(v===null){if(m===null)throw jA(d);v=g+m}const E=new Vg(g-e,v-e,p);E.id=Wg(E.startTime,E.endTime,E.text);const A=u[d.getAttribute("region")],D=l[d.getAttribute("style")],R=iP(A,D,l),{textAlign:_}=R;if(_){const F=tP[_];F&&(E.lineAlign=F),E.align=_}return xt(E,R),E}).filter(d=>d!==null)}function Xg(i,e,t){const r=i.getElementsByTagName(e)[0];return r?[].slice.call(r.querySelectorAll(t)):[]}function YA(i){return i.reduce((e,t)=>{const r=t.getAttribute("xml:id");return r&&(e[r]=t),e},{})}function XA(i,e){return[].slice.call(i.childNodes).reduce((t,r,n)=>{var s;return r.nodeName==="br"&&n?t+`
`:(s=r.childNodes)!=null&&s.length?XA(r,e):e?t+r.textContent.trim().replace(/\s+/g," "):t+r.textContent},"")}function iP(i,e,t){const r="http://www.w3.org/ns/ttml#styling";let n=null;const s=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"],a=i!=null&&i.hasAttribute("style")?i.getAttribute("style"):null;return a&&t.hasOwnProperty(a)&&(n=t[a]),s.reduce((o,l)=>{const u=jg(e,r,l)||jg(i,r,l)||jg(n,r,l);return u&&(o[l]=u),o},{})}function jg(i,e,t){return i&&i.hasAttributeNS(e,t)?i.getAttributeNS(e,t):null}function jA(i){return new Error(`Could not parse ttml timestamp ${i}`)}function zg(i,e){if(!i)return null;let t=GA(i);return t===null&&(HA.test(i)?t=nP(i,e):KA.test(i)&&(t=sP(i,e))),t}function nP(i,e){const t=HA.exec(i),r=(t[4]|0)+(t[5]|0)/e.subFrameRate;return(t[1]|0)*3600+(t[2]|0)*60+(t[3]|0)+r/e.frameRate}function sP(i,e){const t=KA.exec(i),r=Number(t[1]);switch(t[2]){case"h":return r*3600;case"m":return r*60;case"ms":return r*1e3;case"f":return r/e.frameRate;case"t":return r/e.tickRate}return r}class cc{constructor(e,t){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=e,this.trackName=t}dispatchCue(){this.startTime!==null&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)}newCue(e,t,r){(this.startTime===null||this.startTime>e)&&(this.startTime=e),this.endTime=t,this.screen=r,this.timelineController.createCaptionsTrack(this.trackName)}reset(){this.cueRanges=[],this.startTime=null}}class aP{constructor(e){this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=QA(),this.captionsProperties=void 0,this.hls=e,this.config=e.config,this.Cues=e.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},e.on(x.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(x.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(x.MANIFEST_LOADING,this.onManifestLoading,this),e.on(x.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(x.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(x.FRAG_LOADING,this.onFragLoading,this),e.on(x.FRAG_LOADED,this.onFragLoaded,this),e.on(x.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.on(x.FRAG_DECRYPTED,this.onFragDecrypted,this),e.on(x.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(x.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.on(x.BUFFER_FLUSHING,this.onBufferFlushing,this)}destroy(){const{hls:e}=this;e.off(x.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(x.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(x.MANIFEST_LOADING,this.onManifestLoading,this),e.off(x.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(x.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(x.FRAG_LOADING,this.onFragLoading,this),e.off(x.FRAG_LOADED,this.onFragLoaded,this),e.off(x.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.off(x.FRAG_DECRYPTED,this.onFragDecrypted,this),e.off(x.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(x.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.off(x.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.media=null,this.cea608Parser1=this.cea608Parser2=void 0}initCea608Parsers(){const e=new cc(this,"textTrack1"),t=new cc(this,"textTrack2"),r=new cc(this,"textTrack3"),n=new cc(this,"textTrack4");this.cea608Parser1=new $A(1,e,t),this.cea608Parser2=new $A(3,r,n)}addCues(e,t,r,n,s){let a=!1;for(let o=s.length;o--;){const l=s[o],u=oP(l[0],l[1],t,r);if(u>=0&&(l[0]=Math.min(l[0],t),l[1]=Math.max(l[1],r),a=!0,u/(r-t)>.5))return}if(a||s.push([t,r]),this.config.renderTextTracksNatively){const o=this.captionsTracks[e];this.Cues.newCue(o,t,r,n)}else{const o=this.Cues.newCue(null,t,r,n);this.hls.trigger(x.CUES_PARSED,{type:"captions",cues:o,track:e})}}onInitPtsFound(e,{frag:t,id:r,initPTS:n,timescale:s}){const{unparsedVttFrags:a}=this;r===ke.MAIN&&(this.initPTS[t.cc]={baseTime:n,timescale:s}),a.length&&(this.unparsedVttFrags=[],a.forEach(o=>{this.onFragLoaded(x.FRAG_LOADED,o)}))}getExistingTrack(e,t){const{media:r}=this;if(r)for(let n=0;n<r.textTracks.length;n++){const s=r.textTracks[n];if(JA(s,{name:e,lang:t,characteristics:"transcribes-spoken-dialog,describes-music-and-sound"}))return s}return null}createCaptionsTrack(e){this.config.renderTextTracksNatively?this.createNativeTrack(e):this.createNonNativeTrack(e)}createNativeTrack(e){if(this.captionsTracks[e])return;const{captionsProperties:t,captionsTracks:r,media:n}=this,{label:s,languageCode:a}=t[e],o=this.getExistingTrack(s,a);if(o)r[e]=o,Wa(r[e]),LA(r[e],n);else{const l=this.createTextTrack("captions",s,a);l&&(l[e]=!0,r[e]=l)}}createNonNativeTrack(e){if(this.nonNativeCaptionsTracks[e])return;const t=this.captionsProperties[e];if(!t)return;const r=t.label,n={_id:e,label:r,kind:"captions",default:t.media?!!t.media.default:!1,closedCaptions:t.media};this.nonNativeCaptionsTracks[e]=n,this.hls.trigger(x.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[n]})}createTextTrack(e,t,r){const n=this.media;if(n)return n.addTextTrack(e,t,r)}onMediaAttaching(e,t){this.media=t.media,t.mediaSource||this._cleanTracks()}onMediaDetaching(e,t){const r=!!t.transferMedia;if(this.media=null,r)return;const{captionsTracks:n}=this;Object.keys(n).forEach(s=>{Wa(n[s]),delete n[s]}),this.nonNativeCaptionsTracks={}}onManifestLoading(){this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=QA(),this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())}_cleanTracks(){const{media:e}=this;if(!e)return;const t=e.textTracks;if(t)for(let r=0;r<t.length;r++)Wa(t[r])}onSubtitleTracksUpdated(e,t){const r=t.subtitleTracks||[],n=r.some(s=>s.textCodec===Yg);if(this.config.enableWebVTT||n&&this.config.enableIMSC1){if(yA(this.tracks,r)){this.tracks=r;return}if(this.textTracks=[],this.tracks=r,this.config.renderTextTracksNatively){const a=this.media,o=a?ac(a.textTracks):null;if(this.tracks.forEach((l,u)=>{let h;if(o){let d=null;for(let p=0;p<o.length;p++)if(o[p]&&JA(o[p],l)){d=o[p],o[p]=null;break}d&&(h=d)}if(h)Wa(h);else{const d=zA(l);h=this.createTextTrack(d,l.name,l.lang),h&&(h.mode="disabled")}h&&this.textTracks.push(h)}),o!=null&&o.length){const l=o.filter(u=>u!==null).map(u=>u.label);l.length&&this.hls.logger.warn(`Media element contains unused subtitle tracks: ${l.join(", ")}. Replace media element for each source to clear TextTracks and captions menu.`)}}else if(this.tracks.length){const a=this.tracks.map(o=>({label:o.name,kind:o.type.toLowerCase(),default:o.default,subtitleTrack:o}));this.hls.trigger(x.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:a})}}}onManifestLoaded(e,t){this.config.enableCEA708Captions&&t.captions&&t.captions.forEach(r=>{const n=/(?:CC|SERVICE)([1-4])/.exec(r.instreamId);if(!n)return;const s=`textTrack${n[1]}`,a=this.captionsProperties[s];a&&(a.label=r.name,r.lang&&(a.languageCode=r.lang),a.media=r)})}closedCaptionsForLevel(e){const t=this.hls.levels[e.level];return t==null?void 0:t.attrs["CLOSED-CAPTIONS"]}onFragLoading(e,t){if(this.enabled&&t.frag.type===ke.MAIN){var r,n;const{cea608Parser1:s,cea608Parser2:a,lastSn:o}=this,{cc:l,sn:u}=t.frag,h=(r=(n=t.part)==null?void 0:n.index)!=null?r:-1;s&&a&&(u!==o+1||u===o&&h!==this.lastPartIndex+1||l!==this.lastCc)&&(s.reset(),a.reset()),this.lastCc=l,this.lastSn=u,this.lastPartIndex=h}}onFragLoaded(e,t){const{frag:r,payload:n}=t;if(r.type===ke.SUBTITLE)if(n.byteLength){const s=r.decryptdata,a="stats"in t;if(s==null||!s.encrypted||a){const o=this.tracks[r.level],l=this.vttCCs;l[r.cc]||(l[r.cc]={start:r.start,prevCC:this.prevCC,new:!0},this.prevCC=r.cc),o&&o.textCodec===Yg?this._parseIMSC1(r,n):this._parseVTTs(t)}}else this.hls.trigger(x.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:r,error:new Error("Empty subtitle payload")})}_parseIMSC1(e,t){const r=this.hls;WA(t,this.initPTS[e.cc],n=>{this._appendCues(n,e.level),r.trigger(x.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})},n=>{r.logger.log(`Failed to parse IMSC1: ${n}`),r.trigger(x.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e,error:n})})}_parseVTTs(e){var t;const{frag:r,payload:n}=e,{initPTS:s,unparsedVttFrags:a}=this,o=s.length-1;if(!s[r.cc]&&o===-1){a.push(e);return}const l=this.hls,u=(t=r.initSegment)!=null&&t.data?pi(r.initSegment.data,new Uint8Array(n)).buffer:n;eP(u,this.initPTS[r.cc],this.vttCCs,r.cc,r.start,h=>{this._appendCues(h,r.level),l.trigger(x.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:r})},h=>{const d=h.message==="Missing initPTS for VTT MPEGTS";d?a.push(e):this._fallbackToIMSC1(r,n),l.logger.log(`Failed to parse VTT cue: ${h}`),!(d&&o>r.cc)&&l.trigger(x.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:r,error:h})})}_fallbackToIMSC1(e,t){const r=this.tracks[e.level];r.textCodec||WA(t,this.initPTS[e.cc],()=>{r.textCodec=Yg,this._parseIMSC1(e,t)},()=>{r.textCodec="wvtt"})}_appendCues(e,t){const r=this.hls;if(this.config.renderTextTracksNatively){const n=this.textTracks[t];if(!n||n.mode==="disabled")return;e.forEach(s=>_A(n,s))}else{const n=this.tracks[t];if(!n)return;const s=n.default?"default":"subtitles"+t;r.trigger(x.CUES_PARSED,{type:"subtitles",cues:e,track:s})}}onFragDecrypted(e,t){const{frag:r}=t;r.type===ke.SUBTITLE&&this.onFragLoaded(x.FRAG_LOADED,t)}onSubtitleTracksCleared(){this.tracks=[],this.captionsTracks={}}onFragParsingUserdata(e,t){if(!this.enabled||!this.config.enableCEA708Captions)return;const{frag:r,samples:n}=t;if(!(r.type===ke.MAIN&&this.closedCaptionsForLevel(r)==="NONE"))for(let s=0;s<n.length;s++){const a=n[s].bytes;if(a){this.cea608Parser1||this.initCea608Parsers();const o=this.extractCea608Data(a);this.cea608Parser1.addData(n[s].pts,o[0]),this.cea608Parser2.addData(n[s].pts,o[1])}}}onBufferFlushing(e,{startOffset:t,endOffset:r,endOffsetSubtitles:n,type:s}){const{media:a}=this;if(!(!a||a.currentTime<r)){if(!s||s==="video"){const{captionsTracks:o}=this;Object.keys(o).forEach(l=>Ug(o[l],t,r))}if(this.config.renderTextTracksNatively&&t===0&&n!==void 0){const{textTracks:o}=this;Object.keys(o).forEach(l=>Ug(o[l],t,n))}}}extractCea608Data(e){const t=[[],[]],r=e[0]&31;let n=2;for(let s=0;s<r;s++){const a=e[n++],o=127&e[n++],l=127&e[n++];if(o===0&&l===0)continue;if((4&a)!==0){const h=3&a;(h===0||h===1)&&(t[h].push(o),t[h].push(l))}}return t}}function zA(i){return i.characteristics&&/transcribes-spoken-dialog/gi.test(i.characteristics)&&/describes-music-and-sound/gi.test(i.characteristics)?"captions":"subtitles"}function JA(i,e){return!!i&&i.kind===zA(e)&&Mg(e,i)}function oP(i,e,t,r){return Math.min(e,r)-Math.max(i,t)}function QA(){return{ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}}}const lP=/\s/,uP={newCue(i,e,t,r){const n=[];let s,a,o,l,u;const h=self.VTTCue||self.TextTrackCue;for(let p=0;p<r.rows.length;p++)if(s=r.rows[p],o=!0,l=0,u="",!s.isEmpty()){var d;for(let v=0;v<s.chars.length;v++)lP.test(s.chars[v].uchar)&&o?l++:(u+=s.chars[v].uchar,o=!1);s.cueStartTime=e,e===t&&(t+=1e-4),l>=16?l--:l++;const g=VA(u.trim()),m=Wg(e,t,g);i!=null&&(d=i.cues)!=null&&d.getCueById(m)||(a=new h(e,t,g),a.id=m,a.line=p+1,a.align="left",a.position=10+Math.min(80,Math.floor(l*8/32)*10),n.push(a))}return i&&n.length&&(n.sort((p,g)=>p.line==="auto"||g.line==="auto"?0:p.line>8&&g.line>8?g.line-p.line:p.line-g.line),n.forEach(p=>_A(i,p))),n}};function cP(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch{}return!1}const hP=/(\d+)-(\d+)\/(\d+)/;class ZA{constructor(e){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=null,this.response=null,this.controller=void 0,this.context=null,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=e.fetchSetup||pP,this.controller=new self.AbortController,this.stats=new Jf}destroy(){this.loader=this.callbacks=this.context=this.config=this.request=null,this.abortInternal(),this.response=null,this.fetchSetup=this.controller=this.stats=null}abortInternal(){this.controller&&!this.stats.loading.end&&(this.stats.aborted=!0,this.controller.abort())}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)}load(e,t,r){const n=this.stats;if(n.loading.start)throw new Error("Loader can only be used once.");n.loading.start=self.performance.now();const s=dP(e,this.controller.signal),a=e.responseType==="arraybuffer",o=a?"byteLength":"length",{maxTimeToFirstByteMs:l,maxLoadTimeMs:u}=t.loadPolicy;this.context=e,this.config=t,this.callbacks=r,this.request=this.fetchSetup(e,s),self.clearTimeout(this.requestTimeout),t.timeout=l&&Ce(l)?l:u,this.requestTimeout=self.setTimeout(()=>{this.callbacks&&(this.abortInternal(),this.callbacks.onTimeout(n,e,this.response))},t.timeout),(ol(this.request)?this.request.then(self.fetch):self.fetch(this.request)).then(d=>{var p;this.response=this.loader=d;const g=Math.max(self.performance.now(),n.loading.start);if(self.clearTimeout(this.requestTimeout),t.timeout=u,this.requestTimeout=self.setTimeout(()=>{this.callbacks&&(this.abortInternal(),this.callbacks.onTimeout(n,e,this.response))},u-(g-n.loading.start)),!d.ok){const{status:v,statusText:E}=d;throw new mP(E||"fetch, bad network response",v,d)}n.loading.first=g,n.total=gP(d.headers)||n.total;const m=(p=this.callbacks)==null?void 0:p.onProgress;return m&&Ce(t.highWaterMark)?this.loadProgressively(d,n,e,t.highWaterMark,m):a?d.arrayBuffer():e.responseType==="json"?d.json():d.text()}).then(d=>{var p,g;const m=this.response;if(!m)throw new Error("loader destroyed");self.clearTimeout(this.requestTimeout),n.loading.end=Math.max(self.performance.now(),n.loading.first);const v=d[o];v&&(n.loaded=n.total=v);const E={url:m.url,data:d,code:m.status},A=(p=this.callbacks)==null?void 0:p.onProgress;A&&!Ce(t.highWaterMark)&&A(n,e,d,m),(g=this.callbacks)==null||g.onSuccess(E,n,e,m)}).catch(d=>{var p;if(self.clearTimeout(this.requestTimeout),n.aborted)return;const g=d&&d.code||0,m=d?d.message:null;(p=this.callbacks)==null||p.onError({code:g,text:m},e,d?d.details:null,n)})}getCacheAge(){let e=null;if(this.response){const t=this.response.headers.get("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.response?this.response.headers.get(e):null}loadProgressively(e,t,r,n=0,s){const a=new qb,o=e.body.getReader(),l=()=>o.read().then(u=>{if(u.done)return a.dataLength&&s(t,r,a.flush().buffer,e),Promise.resolve(new ArrayBuffer(0));const h=u.value,d=h.length;return t.loaded+=d,d<n||a.dataLength?(a.push(h),a.dataLength>=n&&s(t,r,a.flush().buffer,e)):s(t,r,h.buffer,e),l()}).catch(()=>Promise.reject());return l()}}function dP(i,e){const t={method:"GET",mode:"cors",credentials:"same-origin",signal:e,headers:new self.Headers(xt({},i.headers))};return i.rangeEnd&&t.headers.set("Range","bytes="+i.rangeStart+"-"+String(i.rangeEnd-1)),t}function fP(i){const e=hP.exec(i);if(e)return parseInt(e[2])-parseInt(e[1])+1}function gP(i){const e=i.get("Content-Range");if(e){const r=fP(e);if(Ce(r))return r}const t=i.get("Content-Length");if(t)return parseInt(t)}function pP(i,e){return new self.Request(i.url,e)}class mP extends Error{constructor(e,t,r){super(e),this.code=void 0,this.details=void 0,this.code=t,this.details=r}}const yP=/^age:\s*[\d.]+\s*$/im;class e2{constructor(e){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=null,this.loader=null,this.stats=void 0,this.xhrSetup=e&&e.xhrSetup||null,this.stats=new Jf,this.retryDelay=0}destroy(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null,this.context=null,this.xhrSetup=null}abortInternal(){const e=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),e&&(e.onreadystatechange=null,e.onprogress=null,e.readyState!==4&&(this.stats.aborted=!0,e.abort()))}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)}load(e,t,r){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=e,this.config=t,this.callbacks=r,this.loadInternal()}loadInternal(){const{config:e,context:t}=this;if(!e||!t)return;const r=this.loader=new self.XMLHttpRequest,n=this.stats;n.loading.first=0,n.loaded=0,n.aborted=!1;const s=this.xhrSetup;s?Promise.resolve().then(()=>{if(!(this.loader!==r||this.stats.aborted))return s(r,t.url)}).catch(a=>{if(!(this.loader!==r||this.stats.aborted))return r.open("GET",t.url,!0),s(r,t.url)}).then(()=>{this.loader!==r||this.stats.aborted||this.openAndSendXhr(r,t,e)}).catch(a=>{var o;(o=this.callbacks)==null||o.onError({code:r.status,text:a.message},t,r,n)}):this.openAndSendXhr(r,t,e)}openAndSendXhr(e,t,r){e.readyState||e.open("GET",t.url,!0);const n=t.headers,{maxTimeToFirstByteMs:s,maxLoadTimeMs:a}=r.loadPolicy;if(n)for(const o in n)e.setRequestHeader(o,n[o]);t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=t.responseType,self.clearTimeout(this.requestTimeout),r.timeout=s&&Ce(s)?s:a,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),r.timeout),e.send()}readystatechange(){const{context:e,loader:t,stats:r}=this;if(!e||!t)return;const n=t.readyState,s=this.config;if(!r.aborted&&n>=2&&(r.loading.first===0&&(r.loading.first=Math.max(self.performance.now(),r.loading.start),s.timeout!==s.loadPolicy.maxLoadTimeMs&&(self.clearTimeout(this.requestTimeout),s.timeout=s.loadPolicy.maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),s.loadPolicy.maxLoadTimeMs-(r.loading.first-r.loading.start)))),n===4)){self.clearTimeout(this.requestTimeout),t.onreadystatechange=null,t.onprogress=null;const u=t.status,h=t.responseType==="text"?t.responseText:null;if(u>=200&&u<300){const m=h??t.response;if(m!=null){var a,o;r.loading.end=Math.max(self.performance.now(),r.loading.first);const v=t.responseType==="arraybuffer"?m.byteLength:m.length;r.loaded=r.total=v,r.bwEstimate=r.total*8e3/(r.loading.end-r.loading.first);const E=(a=this.callbacks)==null?void 0:a.onProgress;E&&E(r,e,m,t);const A={url:t.responseURL,data:m,code:u};(o=this.callbacks)==null||o.onSuccess(A,r,e,t);return}}const d=s.loadPolicy.errorRetry,p=r.retry,g={url:e.url,data:void 0,code:u};if(qu(d,p,!1,g))this.retry(d);else{var l;mt.error(`${u} while loading ${e.url}`),(l=this.callbacks)==null||l.onError({code:u,text:t.statusText},e,t,r)}}}loadtimeout(){if(!this.config)return;const e=this.config.loadPolicy.timeoutRetry,t=this.stats.retry;if(qu(e,t,!0))this.retry(e);else{var r;mt.warn(`timeout while loading ${(r=this.context)==null?void 0:r.url}`);const n=this.callbacks;n&&(this.abortInternal(),n.onTimeout(this.stats,this.context,this.loader))}}retry(e){const{context:t,stats:r}=this;this.retryDelay=sg(e,r.retry),r.retry++,mt.warn(`${status?"HTTP Status "+status:"Timeout"} while loading ${t==null?void 0:t.url}, retrying ${r.retry}/${e.maxNumRetry} in ${this.retryDelay}ms`),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay)}loadprogress(e){const t=this.stats;t.loaded=e.loaded,e.lengthComputable&&(t.total=e.total)}getCacheAge(){let e=null;if(this.loader&&yP.test(this.loader.getAllResponseHeaders())){const t=this.loader.getResponseHeader("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.loader&&new RegExp(`^${e}:\\s*[\\d.]+\\s*$`,"im").test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(e):null}}const vP={maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null},EP=Et(Et({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,maxDevicePixelRatio:Number.POSITIVE_INFINITY,preferManagedMediaSource:!0,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,frontBufferFlushThreshold:1/0,startOnSegmentBoundary:!1,maxBufferSize:60*1e3*1e3,maxFragLookUpTolerance:.25,maxBufferHole:.1,detectStallWithCurrentTimeMs:1250,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,nudgeOnVideoHole:!0,liveSyncMode:"edge",liveSyncDurationCount:3,liveSyncOnStallIncrease:1,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,ignorePlaylistParsingErrors:!1,loader:e2,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:Xw,bufferController:O_,capLevelController:kg,errorController:Zw,fpsController:SM,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrEwmaDefaultEstimateMax:5e6,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:vb,requireKeySystemAccessOnStart:!1,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableEmsgKLVMetadata:!1,enableID3MetadataCues:!0,enableInterstitialPlayback:!0,interstitialAppendInPlace:!0,interstitialLiveLookAhead:10,useMediaCapabilities:!0,preserveManualLevelOnError:!1,certLoadPolicy:{default:vP},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:1/0,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},interstitialAssetListLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:3e4,timeoutRetry:{maxNumRetry:0,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:0,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},bP()),{},{subtitleStreamController:PM,subtitleTrackController:DM,timelineController:aP,audioStreamController:__,audioTrackController:M_,emeController:Ka,cmcdController:EM,contentSteeringController:AM,interstitialsController:MM});function bP(){return{cueHandler:uP,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}}function AP(i,e,t){if((e.liveSyncDurationCount||e.liveMaxLatencyDurationCount)&&(e.liveSyncDuration||e.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(e.liveMaxLatencyDurationCount!==void 0&&(e.liveSyncDurationCount===void 0||e.liveMaxLatencyDurationCount<=e.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(e.liveMaxLatencyDuration!==void 0&&(e.liveSyncDuration===void 0||e.liveMaxLatencyDuration<=e.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');const r=Jg(i),n=["manifest","level","frag"],s=["TimeOut","MaxRetry","RetryDelay","MaxRetryTimeout"];return n.forEach(a=>{const o=`${a==="level"?"playlist":a}LoadPolicy`,l=e[o]===void 0,u=[];s.forEach(h=>{const d=`${a}Loading${h}`,p=e[d];if(p!==void 0&&l){u.push(d);const g=r[o].default;switch(e[o]={default:g},h){case"TimeOut":g.maxLoadTimeMs=p,g.maxTimeToFirstByteMs=p;break;case"MaxRetry":g.errorRetry.maxNumRetry=p,g.timeoutRetry.maxNumRetry=p;break;case"RetryDelay":g.errorRetry.retryDelayMs=p,g.timeoutRetry.retryDelayMs=p;break;case"MaxRetryTimeout":g.errorRetry.maxRetryDelayMs=p,g.timeoutRetry.maxRetryDelayMs=p;break}}}),u.length&&t.warn(`hls.js config: "${u.join('", "')}" setting(s) are deprecated, use "${o}": ${Gt(e[o])}`)}),Et(Et({},r),e)}function Jg(i){return i&&typeof i=="object"?Array.isArray(i)?i.map(Jg):Object.keys(i).reduce((e,t)=>(e[t]=Jg(i[t]),e),{}):i}function SP(i,e){const t=i.loader;t!==ZA&&t!==e2?(e.log("[config]: Custom loader detected, cannot enable progressive streaming"),i.progressive=!1):cP()&&(i.loader=ZA,i.progressive=!0,i.enableSoftwareAES=!0,e.log("[config]: Progressive streaming enabled, using FetchLoader"))}const hc=2,xP=.1,TP=.05,DP=100;class RP extends hb{constructor(e,t){super("gap-controller",e.logger),this.hls=null,this.fragmentTracker=null,this.media=null,this.mediaSource=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.buffered={},this.lastCurrentTime=0,this.ended=0,this.waiting=0,this.onMediaPlaying=()=>{this.ended=0,this.waiting=0},this.onMediaWaiting=()=>{var r;(r=this.media)!=null&&r.seeking||(this.waiting=self.performance.now(),this.tick())},this.onMediaEnded=()=>{if(this.hls){var r;this.ended=((r=this.media)==null?void 0:r.currentTime)||1,this.hls.trigger(x.MEDIA_ENDED,{stalled:!1})}},this.hls=e,this.fragmentTracker=t,this.registerListeners()}registerListeners(){const{hls:e}=this;e&&(e.on(x.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(x.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(x.BUFFER_APPENDED,this.onBufferAppended,this))}unregisterListeners(){const{hls:e}=this;e&&(e.off(x.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(x.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(x.BUFFER_APPENDED,this.onBufferAppended,this))}destroy(){super.destroy(),this.unregisterListeners(),this.media=this.hls=this.fragmentTracker=null,this.mediaSource=void 0}onMediaAttached(e,t){this.setInterval(DP),this.mediaSource=t.mediaSource;const r=this.media=t.media;si(r,"playing",this.onMediaPlaying),si(r,"waiting",this.onMediaWaiting),si(r,"ended",this.onMediaEnded)}onMediaDetaching(e,t){this.clearInterval();const{media:r}=this;r&&(yi(r,"playing",this.onMediaPlaying),yi(r,"waiting",this.onMediaWaiting),yi(r,"ended",this.onMediaEnded),this.media=null),this.mediaSource=void 0}onBufferAppended(e,t){this.buffered=t.timeRanges}get hasBuffered(){return Object.keys(this.buffered).length>0}tick(){var e;if(!((e=this.media)!=null&&e.readyState)||!this.hasBuffered)return;const t=this.media.currentTime;this.poll(t,this.lastCurrentTime),this.lastCurrentTime=t}poll(e,t){var r,n;const s=(r=this.hls)==null?void 0:r.config;if(!s)return;const a=this.media;if(!a)return;const{seeking:o}=a,l=this.seeking&&!o,u=!this.seeking&&o,h=a.paused&&!o||a.ended||a.playbackRate===0;if(this.seeking=o,e!==t){t&&(this.ended=0),this.moved=!0,o||(this.nudgeRetry=0,s.nudgeOnVideoHole&&!h&&e>t&&this.nudgeOnVideoHole(e,t)),this.waiting===0&&this.stallResolved(e);return}if(u||l){l&&this.stallResolved(e);return}if(h){this.nudgeRetry=0,this.stallResolved(e),!this.ended&&a.ended&&this.hls&&(this.ended=e||1,this.hls.trigger(x.MEDIA_ENDED,{stalled:!1}));return}if(!Xe.getBuffered(a).length){this.nudgeRetry=0;return}const d=Xe.bufferInfo(a,e,0),p=d.nextStart||0,g=this.fragmentTracker;if(o&&g&&this.hls){const w=t2(this.hls.inFlightFragments,e),C=d.len>hc,M=!p||w||p-e>hc&&!g.getPartialFragment(e);if(C||M)return;this.moved=!1}const m=(n=this.hls)==null?void 0:n.latestLevelDetails;if(!this.moved&&this.stalled!==null&&g){if(!(d.len>0)&&!p)return;const C=Math.max(p,d.start||0)-e,L=!!(m!=null&&m.live)?m.targetduration*2:hc,I=g.getPartialFragment(e);if(C>0&&(C<=L||I)){a.paused||this._trySkipBufferHole(I);return}}const v=s.detectStallWithCurrentTimeMs,E=self.performance.now(),A=this.waiting;let D=this.stalled;if(D===null)if(A>0&&E-A<v)D=this.stalled=A;else{this.stalled=E;return}const R=E-D;if(!o&&(R>=v||A)&&this.hls){var _;if(((_=this.mediaSource)==null?void 0:_.readyState)==="ended"&&!(m!=null&&m.live)&&Math.abs(e-((m==null?void 0:m.edge)||0))<1){if(this.ended)return;this.ended=e||1,this.hls.trigger(x.MEDIA_ENDED,{stalled:!0});return}if(this._reportStall(d),!this.media||!this.hls)return}const F=Xe.bufferInfo(a,e,s.maxBufferHole);this._tryFixBufferStall(F,R,e)}stallResolved(e){const t=this.stalled;if(t&&this.hls&&(this.stalled=null,this.stallReported)){const r=self.performance.now()-t;this.log(`playback not stuck anymore @${e}, after ${Math.round(r)}ms`),this.stallReported=!1,this.waiting=0,this.hls.trigger(x.STALL_RESOLVED,{})}}nudgeOnVideoHole(e,t){var r;const n=this.buffered.video;if(this.hls&&this.media&&this.fragmentTracker&&(r=this.buffered.audio)!=null&&r.length&&n&&n.length>1&&e>n.end(0)){const s=Xe.bufferedInfo(Xe.timeRangesToArray(this.buffered.audio),e,0);if(s.len>1&&t>=s.start){const a=Xe.timeRangesToArray(n),o=Xe.bufferedInfo(a,t,0).bufferedIndex;if(o>-1&&o<a.length-1){const l=Xe.bufferedInfo(a,e,0).bufferedIndex,u=a[o].end,h=a[o+1].start;if((l===-1||l>o)&&h-u<1&&e-u<2){const d=new Error(`nudging playhead to flush pipeline after video hole. currentTime: ${e} hole: ${u} -> ${h} buffered index: ${l}`);this.warn(d.message),this.media.currentTime+=1e-6;const p=this.fragmentTracker.getPartialFragment(e)||void 0,g=Xe.bufferInfo(this.media,e,0);this.hls.trigger(x.ERROR,{type:Fe.MEDIA_ERROR,details:Q.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:d,reason:d.message,frag:p,buffer:g.len,bufferInfo:g})}}}}}_tryFixBufferStall(e,t,r){var n,s;const{fragmentTracker:a,media:o}=this,l=(n=this.hls)==null?void 0:n.config;if(!o||!a||!l)return;const u=(s=this.hls)==null?void 0:s.latestLevelDetails,h=a.getPartialFragment(r);if((h||u!=null&&u.live&&r<u.fragmentStart)&&(this._trySkipBufferHole(h)||!this.media))return;const d=e.buffered,p=this.adjacentTraversal(e,r);(d&&d.length>1&&e.len>l.maxBufferHole||e.nextStart&&(e.nextStart-r<l.maxBufferHole||p))&&(t>l.highBufferWatchdogPeriod*1e3||this.waiting)&&(this.warn("Trying to nudge playhead over buffer-hole"),this._tryNudgeBuffer(e))}adjacentTraversal(e,t){const r=this.fragmentTracker,n=e.nextStart;if(r&&n){const s=r.getFragAtPos(t,ke.MAIN),a=r.getFragAtPos(n,ke.MAIN);if(s&&a)return a.sn-s.sn<2}return!1}_reportStall(e){const{hls:t,media:r,stallReported:n,stalled:s}=this;if(!n&&s!==null&&r&&t){this.stallReported=!0;const a=new Error(`Playback stalling at @${r.currentTime} due to low buffer (${Gt(e)})`);this.warn(a.message),t.trigger(x.ERROR,{type:Fe.MEDIA_ERROR,details:Q.BUFFER_STALLED_ERROR,fatal:!1,error:a,buffer:e.len,bufferInfo:e,stalled:{start:s}})}}_trySkipBufferHole(e){var t;const{fragmentTracker:r,media:n}=this,s=(t=this.hls)==null?void 0:t.config;if(!n||!r||!s)return 0;const a=n.currentTime,o=Xe.bufferInfo(n,a,0),l=a<o.start?o.start:o.nextStart;if(l&&this.hls){const h=o.len<=s.maxBufferHole,d=o.len>0&&o.len<1&&n.readyState<3,p=l-a;if(p>0&&(h||d)){if(p>s.maxBufferHole){let m=!1;if(a===0){const v=r.getAppendedFrag(0,ke.MAIN);v&&l<v.end&&(m=!0)}if(!m){const v=e||r.getAppendedFrag(a,ke.MAIN);if(v){var u;if(!((u=this.hls.loadLevelObj)!=null&&u.details)||t2(this.hls.inFlightFragments,l))return 0;let A=!1,D=v.end;for(;D<l;){const R=r.getPartialFragment(D);if(R)D+=R.duration;else{A=!0;break}}if(A)return 0}}}const g=Math.max(l+TP,a+xP);if(this.warn(`skipping hole, adjusting currentTime from ${a} to ${g}`),this.moved=!0,n.currentTime=g,!(e!=null&&e.gap)){const m=new Error(`fragment loaded with buffer holes, seeking from ${a} to ${g}`);this.hls.trigger(x.ERROR,{type:Fe.MEDIA_ERROR,details:Q.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:m,reason:m.message,frag:e||void 0,buffer:o.len,bufferInfo:o})}return g}}return 0}_tryNudgeBuffer(e){const{hls:t,media:r,nudgeRetry:n}=this,s=t==null?void 0:t.config;if(!r||!s)return 0;const a=r.currentTime;if(this.nudgeRetry++,n<s.nudgeMaxRetry){const o=a+(n+1)*s.nudgeOffset,l=new Error(`Nudging 'currentTime' from ${a} to ${o}`);this.warn(l.message),r.currentTime=o,t.trigger(x.ERROR,{type:Fe.MEDIA_ERROR,details:Q.BUFFER_NUDGE_ON_STALL,error:l,fatal:!1,buffer:e.len,bufferInfo:e})}else{const o=new Error(`Playhead still not moving while enough data buffered @${a} after ${s.nudgeMaxRetry} nudges`);this.error(o.message),t.trigger(x.ERROR,{type:Fe.MEDIA_ERROR,details:Q.BUFFER_STALLED_ERROR,error:o,fatal:!0,buffer:e.len,bufferInfo:e})}}}function t2(i,e){const t=r2(i.main);if(t&&t.start<=e)return t;const r=r2(i.audio);return r&&r.start<=e?r:null}function r2(i){if(!i)return null;switch(i.state){case le.IDLE:case le.STOPPED:case le.ENDED:case le.ERROR:return null}return i.frag}const IP=.25;function Qg(){if(!(typeof self>"u"))return self.VTTCue||self.TextTrackCue}function i2(i,e,t,r,n){let s=new i(e,t,"");try{s.value=r,n&&(s.type=n)}catch{s=new i(e,t,Gt(n?Et({type:n},r):r))}return s}const dc=(()=>{const i=Qg();try{i&&new i(0,Number.POSITIVE_INFINITY,"")}catch{return Number.MAX_VALUE}return Number.POSITIVE_INFINITY})();function NP(i){return Uint8Array.from(i.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer}class CP{constructor(e){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.removeCues=!0,this.onEventCueEnter=()=>{this.hls&&this.hls.trigger(x.EVENT_CUE_ENTER,{})},this.hls=e,this._registerListeners()}destroy(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=this.onEventCueEnter=null}_registerListeners(){const{hls:e}=this;e.on(x.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(x.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(x.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(x.MANIFEST_LOADING,this.onManifestLoading,this),e.on(x.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.on(x.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(x.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(x.LEVEL_PTS_UPDATED,this.onLevelPtsUpdated,this)}_unregisterListeners(){const{hls:e}=this;e.off(x.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(x.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(x.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(x.MANIFEST_LOADING,this.onManifestLoading,this),e.off(x.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.off(x.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(x.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(x.LEVEL_PTS_UPDATED,this.onLevelPtsUpdated,this)}onMediaAttaching(e,t){var r;this.media=t.media,((r=t.overrides)==null?void 0:r.cueRemoval)===!1&&(this.removeCues=!1)}onMediaAttached(){const e=this.hls.latestLevelDetails;e&&this.updateDateRangeCues(e)}onMediaDetaching(e,t){this.media=null,!t.transferMedia&&(this.id3Track&&(this.removeCues&&Wa(this.id3Track,this.onEventCueEnter),this.id3Track=null),this.dateRangeCuesAppended={})}onManifestLoading(){this.dateRangeCuesAppended={}}createTrack(e){const t=this.getID3Track(e.textTracks);return t.mode="hidden",t}getID3Track(e){if(this.media){for(let t=0;t<e.length;t++){const r=e[t];if(r.kind==="metadata"&&r.label==="id3")return LA(r,this.media),r}return this.media.addTextTrack("metadata","id3")}}onFragParsingMetadata(e,t){if(!this.media)return;const{hls:{config:{enableEmsgMetadataCues:r,enableID3MetadataCues:n}}}=this;if(!r&&!n)return;const{samples:s}=t;this.id3Track||(this.id3Track=this.createTrack(this.media));const a=Qg();if(a)for(let o=0;o<s.length;o++){const l=s[o].type;if(l===ni.emsg&&!r||!n)continue;const u=zb(s[o].data);if(u){const h=s[o].pts;let d=h+s[o].duration;d>dc&&(d=dc),d-h<=0&&(d=h+IP);for(let g=0;g<u.length;g++){const m=u[g];if(!Jb(m)){this.updateId3CueEnds(h,l);const v=i2(a,h,d,m,l);v&&this.id3Track.addCue(v)}}}}}updateId3CueEnds(e,t){var r;const n=(r=this.id3Track)==null?void 0:r.cues;if(n)for(let s=n.length;s--;){const a=n[s];a.type===t&&a.startTime<e&&a.endTime===dc&&(a.endTime=e)}}onBufferFlushing(e,{startOffset:t,endOffset:r,type:n}){const{id3Track:s,hls:a}=this;if(!a)return;const{config:{enableEmsgMetadataCues:o,enableID3MetadataCues:l}}=a;if(s&&(o||l)){let u;n==="audio"?u=h=>h.type===ni.audioId3&&l:n==="video"?u=h=>h.type===ni.emsg&&o:u=h=>h.type===ni.audioId3&&l||h.type===ni.emsg&&o,Ug(s,t,r,u)}}onLevelUpdated(e,{details:t}){this.updateDateRangeCues(t,!0)}onLevelPtsUpdated(e,t){Math.abs(t.drift)>.01&&this.updateDateRangeCues(t.details)}updateDateRangeCues(e,t){if(!this.media||!e.hasProgramDateTime||!this.hls.config.enableDateRangeMetadataCues)return;const{id3Track:r}=this,{dateRanges:n}=e,s=Object.keys(n);let a=this.dateRangeCuesAppended;if(r&&t){var o;if((o=r.cues)!=null&&o.length){const h=Object.keys(a).filter(d=>!s.includes(d));for(let d=h.length;d--;){const p=h[d],g=a[p].cues;delete a[p],Object.keys(g).forEach(m=>{try{const v=g[m];v.removeEventListener("enter",this.onEventCueEnter),r.removeCue(v)}catch{}})}}else a=this.dateRangeCuesAppended={}}const l=e.fragments[e.fragments.length-1];if(s.length===0||!Ce(l==null?void 0:l.programDateTime))return;this.id3Track||(this.id3Track=this.createTrack(this.media));const u=Qg();for(let h=0;h<s.length;h++){const d=s[h],p=n[d],g=p.startTime,m=a[d],v=(m==null?void 0:m.cues)||{};let E=(m==null?void 0:m.durationKnown)||!1,A=dc;const{duration:D,endDate:R}=p;if(R&&D!==null)A=g+D,E=!0;else if(p.endOnNext&&!E){const F=s.reduce((w,C)=>{if(C!==p.id){const M=n[C];if(M.class===p.class&&M.startDate>p.startDate&&(!w||p.startDate<w.startDate))return M}return w},null);F&&(A=F.startTime,E=!0)}const _=Object.keys(p.attr);for(let F=0;F<_.length;F++){const w=_[F];if(!dL(w))continue;const C=v[w];if(C)E&&!m.durationKnown?C.endTime=A:Math.abs(C.startTime-g)>.01&&(C.startTime=g,C.endTime=A);else if(u){let M=p.attr[w];fL(w)&&(M=NP(M));const I=i2(u,g,A,{key:w,data:M},ni.dateRange);I&&(I.id=d,this.id3Track.addCue(I),v[w]=I,this.hls.config.interstitialsController&&(w==="X-ASSET-LIST"||w==="X-ASSET-URL")&&I.addEventListener("enter",this.onEventCueEnter))}}a[d]={cues:v,dateRange:p,durationKnown:E}}}}class wP{constructor(e){this.hls=void 0,this.config=void 0,this.media=null,this.currentTime=0,this.stallCount=0,this._latency=null,this._targetLatencyUpdated=!1,this.onTimeupdate=()=>{const{media:t}=this,r=this.levelDetails;if(!t||!r)return;this.currentTime=t.currentTime;const n=this.computeLatency();if(n===null)return;this._latency=n;const{lowLatencyMode:s,maxLiveSyncPlaybackRate:a}=this.config;if(!s||a===1||!r.live)return;const o=this.targetLatency;if(o===null)return;const l=n-o,u=Math.min(this.maxLatency,o+r.targetduration);if(l<u&&l>.05&&this.forwardBufferLength>1){const d=Math.min(2,Math.max(1,a)),p=Math.round(2/(1+Math.exp(-.75*l-this.edgeStalled))*20)/20,g=Math.min(d,Math.max(1,p));this.changeMediaPlaybackRate(t,g)}else t.playbackRate!==1&&t.playbackRate!==0&&this.changeMediaPlaybackRate(t,1)},this.hls=e,this.config=e.config,this.registerListeners()}get levelDetails(){var e;return((e=this.hls)==null?void 0:e.latestLevelDetails)||null}get latency(){return this._latency||0}get maxLatency(){const{config:e}=this;if(e.liveMaxLatencyDuration!==void 0)return e.liveMaxLatencyDuration;const t=this.levelDetails;return t?e.liveMaxLatencyDurationCount*t.targetduration:0}get targetLatency(){const e=this.levelDetails;if(e===null||this.hls===null)return null;const{holdBack:t,partHoldBack:r,targetduration:n}=e,{liveSyncDuration:s,liveSyncDurationCount:a,lowLatencyMode:o}=this.config,l=this.hls.userConfig;let u=o&&r||t;(this._targetLatencyUpdated||l.liveSyncDuration||l.liveSyncDurationCount||u===0)&&(u=s!==void 0?s:a*n);const h=n;return u+Math.min(this.stallCount*this.config.liveSyncOnStallIncrease,h)}set targetLatency(e){this.stallCount=0,this.config.liveSyncDuration=e,this._targetLatencyUpdated=!0}get liveSyncPosition(){const e=this.estimateLiveEdge(),t=this.targetLatency;if(e===null||t===null)return null;const r=this.levelDetails;if(r===null)return null;const n=r.edge,s=e-t-this.edgeStalled,a=n-r.totalduration,o=n-(this.config.lowLatencyMode&&r.partTarget||r.targetduration);return Math.min(Math.max(a,s),o)}get drift(){const e=this.levelDetails;return e===null?1:e.drift}get edgeStalled(){const e=this.levelDetails;if(e===null)return 0;const t=(this.config.lowLatencyMode&&e.partTarget||e.targetduration)*3;return Math.max(e.age-t,0)}get forwardBufferLength(){const{media:e}=this,t=this.levelDetails;if(!e||!t)return 0;const r=e.buffered.length;return(r?e.buffered.end(r-1):t.edge)-this.currentTime}destroy(){this.unregisterListeners(),this.onMediaDetaching(),this.hls=null}registerListeners(){const{hls:e}=this;e&&(e.on(x.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(x.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(x.MANIFEST_LOADING,this.onManifestLoading,this),e.on(x.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(x.ERROR,this.onError,this))}unregisterListeners(){const{hls:e}=this;e&&(e.off(x.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(x.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(x.MANIFEST_LOADING,this.onManifestLoading,this),e.off(x.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(x.ERROR,this.onError,this))}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("timeupdate",this.onTimeupdate)}onMediaDetaching(){this.media&&(this.media.removeEventListener("timeupdate",this.onTimeupdate),this.media=null)}onManifestLoading(){this._latency=null,this.stallCount=0}onLevelUpdated(e,{details:t}){t.advanced&&this.onTimeupdate(),!t.live&&this.media&&this.media.removeEventListener("timeupdate",this.onTimeupdate)}onError(e,t){var r;t.details===Q.BUFFER_STALLED_ERROR&&(this.stallCount++,this.hls&&(r=this.levelDetails)!=null&&r.live&&this.hls.logger.warn("[latency-controller]: Stall detected, adjusting target latency"))}changeMediaPlaybackRate(e,t){var r,n;e.playbackRate!==t&&((r=this.hls)==null||r.logger.debug(`[latency-controller]: latency=${this.latency.toFixed(3)}, targetLatency=${(n=this.targetLatency)==null?void 0:n.toFixed(3)}, forwardBufferLength=${this.forwardBufferLength.toFixed(3)}: adjusting playback rate from ${e.playbackRate} to ${t}`),e.playbackRate=t)}estimateLiveEdge(){const e=this.levelDetails;return e===null?null:e.edge+e.age}computeLatency(){const e=this.estimateLiveEdge();return e===null?null:e-this.currentTime}}class LP extends _g{constructor(e,t){super(e,"level-controller"),this._levels=[],this._firstLevel=-1,this._maxAutoLevel=-1,this._startLevel=void 0,this.currentLevel=null,this.currentLevelIndex=-1,this.manualLevelIndex=-1,this.steering=void 0,this.onParsedComplete=void 0,this.steering=t,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(x.MANIFEST_LOADING,this.onManifestLoading,this),e.on(x.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(x.LEVEL_LOADED,this.onLevelLoaded,this),e.on(x.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(x.FRAG_BUFFERED,this.onFragBuffered,this),e.on(x.ERROR,this.onError,this)}_unregisterListeners(){const{hls:e}=this;e.off(x.MANIFEST_LOADING,this.onManifestLoading,this),e.off(x.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(x.LEVEL_LOADED,this.onLevelLoaded,this),e.off(x.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(x.FRAG_BUFFERED,this.onFragBuffered,this),e.off(x.ERROR,this.onError,this)}destroy(){this._unregisterListeners(),this.steering=null,this.resetLevels(),super.destroy()}stopLoad(){this._levels.forEach(t=>{t.loadError=0,t.fragmentError=0}),super.stopLoad()}resetLevels(){this._startLevel=void 0,this.manualLevelIndex=-1,this.currentLevelIndex=-1,this.currentLevel=null,this._levels=[],this._maxAutoLevel=-1}onManifestLoading(e,t){this.resetLevels()}onManifestLoaded(e,t){const r=this.hls.config.preferManagedMediaSource,n=[],s={},a={};let o=!1,l=!1,u=!1;t.levels.forEach(h=>{const d=h.attrs;let{audioCodec:p,videoCodec:g}=h;p&&(h.audioCodec=p=Ou(p,r)||void 0),g&&(g=h.videoCodec=Pw(g));const{width:m,height:v,unknownCodecs:E}=h;let A=E?E.length:0;if(E)for(let I=A;I--;){const U=E[I];this.isAudioSupported(U)?(h.audioCodec=p=p?`${p},${U}`:U,A--,Ba.audio[p.substring(0,4)]=2):this.isVideoSupported(U)&&(h.videoCodec=g=g?`${g},${U}`:U,A--,Ba.video[g.substring(0,4)]=2)}if(o||(o=!!(m&&v)),l||(l=!!g),u||(u=!!p),A||p&&!this.isAudioSupported(p)||g&&!this.isVideoSupported(g)){this.log(`Some or all CODECS not supported "${d.CODECS}"`);return}const{CODECS:D,"FRAME-RATE":R,"HDCP-LEVEL":_,"PATHWAY-ID":F,RESOLUTION:w,"VIDEO-RANGE":C}=d,L=`${`${F||"."}-`}${h.bitrate}-${w}-${R}-${D}-${C}-${_}`;if(s[L])if(s[L].uri!==h.url&&!h.attrs["PATHWAY-ID"]){const I=a[L]+=1;h.attrs["PATHWAY-ID"]=new Array(I+1).join(".");const U=this.createLevel(h);s[L]=U,n.push(U)}else s[L].addGroupId("audio",d.AUDIO),s[L].addGroupId("text",d.SUBTITLES);else{const I=this.createLevel(h);s[L]=I,a[L]=1,n.push(I)}}),this.filterAndSortMediaOptions(n,t,o,l,u)}createLevel(e){const t=new Qo(e),r=e.supplemental;if(r!=null&&r.videoCodec&&!this.isVideoSupported(r.videoCodec)){const n=new Error(`SUPPLEMENTAL-CODECS not supported "${r.videoCodec}"`);this.log(n.message),t.supportedResult=YE(n,[])}return t}isAudioSupported(e){return rg(e,"audio",this.hls.config.preferManagedMediaSource)}isVideoSupported(e){return rg(e,"video",this.hls.config.preferManagedMediaSource)}filterAndSortMediaOptions(e,t,r,n,s){let a=[],o=[],l=e;if((r||n)&&s&&(l=l.filter(({videoCodec:E,videoRange:A,width:D,height:R})=>(!!E||!!(D&&R))&&Uw(A))),l.length===0){Promise.resolve().then(()=>{if(this.hls){let E="no level with compatible codecs found in manifest",A=E;t.levels.length&&(A=`one or more CODECS in variant not supported: ${Gt(t.levels.map(R=>R.attrs.CODECS).filter((R,_,F)=>F.indexOf(R)===_))}`,this.warn(A),E+=` (${A})`);const D=new Error(E);this.hls.trigger(x.ERROR,{type:Fe.MEDIA_ERROR,details:Q.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:t.url,error:D,reason:A})}});return}t.audioTracks&&(a=t.audioTracks.filter(E=>!E.audioCodec||this.isAudioSupported(E.audioCodec)),n2(a)),t.subtitles&&(o=t.subtitles,n2(o));const u=l.slice(0);l.sort((E,A)=>{if(E.attrs["HDCP-LEVEL"]!==A.attrs["HDCP-LEVEL"])return(E.attrs["HDCP-LEVEL"]||"")>(A.attrs["HDCP-LEVEL"]||"")?1:-1;if(r&&E.height!==A.height)return E.height-A.height;if(E.frameRate!==A.frameRate)return E.frameRate-A.frameRate;if(E.videoRange!==A.videoRange)return Bu.indexOf(E.videoRange)-Bu.indexOf(A.videoRange);if(E.videoCodec!==A.videoCodec){const D=VE(E.videoCodec),R=VE(A.videoCodec);if(D!==R)return R-D}if(E.uri===A.uri&&E.codecSet!==A.codecSet){const D=ku(E.codecSet),R=ku(A.codecSet);if(D!==R)return R-D}return E.averageBitrate!==A.averageBitrate?E.averageBitrate-A.averageBitrate:0});let h=u[0];if(this.steering&&(l=this.steering.filterParsedLevels(l),l.length!==u.length)){for(let E=0;E<u.length;E++)if(u[E].pathwayId===l[0].pathwayId){h=u[E];break}}this._levels=l;for(let E=0;E<l.length;E++)if(l[E]===h){var d;this._firstLevel=E;const A=h.bitrate,D=this.hls.bandwidthEstimate;if(this.log(`manifest loaded, ${l.length} level(s) found, first bitrate: ${A}`),((d=this.hls.userConfig)==null?void 0:d.abrEwmaDefaultEstimate)===void 0){const R=Math.min(A,this.hls.config.abrEwmaDefaultEstimateMax);R>D&&D===this.hls.abrEwmaDefaultEstimate&&(this.hls.bandwidthEstimate=R)}break}const p=s&&!n,g=this.hls.config,m=!!(g.audioStreamController&&g.audioTrackController),v={levels:l,audioTracks:a,subtitleTracks:o,sessionData:t.sessionData,sessionKeys:t.sessionKeys,firstLevel:this._firstLevel,stats:t.stats,audio:s,video:n,altAudio:m&&!p&&a.some(E=>!!E.url)};this.hls.trigger(x.MANIFEST_PARSED,v)}get levels(){return this._levels.length===0?null:this._levels}get loadLevelObj(){return this.currentLevel}get level(){return this.currentLevelIndex}set level(e){const t=this._levels;if(t.length===0)return;if(e<0||e>=t.length){const h=new Error("invalid level idx"),d=e<0;if(this.hls.trigger(x.ERROR,{type:Fe.OTHER_ERROR,details:Q.LEVEL_SWITCH_ERROR,level:e,fatal:d,error:h,reason:h.message}),d)return;e=Math.min(e,t.length-1)}const r=this.currentLevelIndex,n=this.currentLevel,s=n?n.attrs["PATHWAY-ID"]:void 0,a=t[e],o=a.attrs["PATHWAY-ID"];if(this.currentLevelIndex=e,this.currentLevel=a,r===e&&n&&s===o)return;this.log(`Switching to level ${e} (${a.height?a.height+"p ":""}${a.videoRange?a.videoRange+" ":""}${a.codecSet?a.codecSet+" ":""}@${a.bitrate})${o?" with Pathway "+o:""} from level ${r}${s?" with Pathway "+s:""}`);const l={level:e,attrs:a.attrs,details:a.details,bitrate:a.bitrate,averageBitrate:a.averageBitrate,maxBitrate:a.maxBitrate,realBitrate:a.realBitrate,width:a.width,height:a.height,codecSet:a.codecSet,audioCodec:a.audioCodec,videoCodec:a.videoCodec,audioGroups:a.audioGroups,subtitleGroups:a.subtitleGroups,loaded:a.loaded,loadError:a.loadError,fragmentError:a.fragmentError,name:a.name,id:a.id,uri:a.uri,url:a.url,urlId:0,audioGroupIds:a.audioGroupIds,textGroupIds:a.textGroupIds};this.hls.trigger(x.LEVEL_SWITCHING,l);const u=a.details;if(!u||u.live){const h=this.switchParams(a.uri,n==null?void 0:n.details,u);this.loadPlaylist(h)}}get manualLevel(){return this.manualLevelIndex}set manualLevel(e){this.manualLevelIndex=e,this._startLevel===void 0&&(this._startLevel=e),e!==-1&&(this.level=e)}get firstLevel(){return this._firstLevel}set firstLevel(e){this._firstLevel=e}get startLevel(){if(this._startLevel===void 0){const e=this.hls.config.startLevel;return e!==void 0?e:this.hls.firstAutoLevel}return this._startLevel}set startLevel(e){this._startLevel=e}get pathways(){return this.steering?this.steering.pathways():[]}get pathwayPriority(){return this.steering?this.steering.pathwayPriority:null}set pathwayPriority(e){if(this.steering){const t=this.steering.pathways(),r=e.filter(n=>t.indexOf(n)!==-1);if(e.length<1){this.warn(`pathwayPriority ${e} should contain at least one pathway from list: ${t}`);return}this.steering.pathwayPriority=r}}onError(e,t){t.fatal||!t.context||t.context.type===lt.LEVEL&&t.context.level===this.level&&this.checkRetry(t)}onFragBuffered(e,{frag:t}){if(t!==void 0&&t.type===ke.MAIN){const r=t.elementaryStreams;if(!Object.keys(r).some(s=>!!r[s]))return;const n=this._levels[t.level];n!=null&&n.loadError&&(this.log(`Resetting level error count of ${n.loadError} on frag buffered`),n.loadError=0)}}onLevelLoaded(e,t){var r;const{level:n,details:s}=t,a=t.levelInfo;if(!a){var o;this.warn(`Invalid level index ${n}`),(o=t.deliveryDirectives)!=null&&o.skip&&(s.deltaUpdateFailed=!0);return}if(a===this.currentLevel||t.withoutMultiVariant){a.fragmentError===0&&(a.loadError=0);let l=a.details;l===t.details&&l.advanced&&(l=void 0),this.playlistLoaded(n,t,l)}else(r=t.deliveryDirectives)!=null&&r.skip&&(s.deltaUpdateFailed=!0)}loadPlaylist(e){super.loadPlaylist(),this.shouldLoadPlaylist(this.currentLevel)&&this.scheduleLoading(this.currentLevel,e)}loadingPlaylist(e,t){super.loadingPlaylist(e,t);const r=this.getUrlWithDirectives(e.uri,t),n=this.currentLevelIndex,s=e.attrs["PATHWAY-ID"],a=e.details,o=a==null?void 0:a.age;this.log(`Loading level index ${n}${(t==null?void 0:t.msn)!==void 0?" at sn "+t.msn+" part "+t.part:""}${s?" Pathway "+s:""}${o&&a.live?" age "+o.toFixed(1)+(a.type&&" "+a.type||""):""} ${r}`),this.hls.trigger(x.LEVEL_LOADING,{url:r,level:n,levelInfo:e,pathwayId:e.attrs["PATHWAY-ID"],id:0,deliveryDirectives:t||null})}get nextLoadLevel(){return this.manualLevelIndex!==-1?this.manualLevelIndex:this.hls.nextAutoLevel}set nextLoadLevel(e){this.level=e,this.manualLevelIndex===-1&&(this.hls.nextAutoLevel=e)}removeLevel(e){var t;if(this._levels.length===1)return;const r=this._levels.filter((s,a)=>a!==e?!0:(this.steering&&this.steering.removeLevel(s),s===this.currentLevel&&(this.currentLevel=null,this.currentLevelIndex=-1,s.details&&s.details.fragments.forEach(o=>o.level=-1)),!1));Fb(r),this._levels=r,this.currentLevelIndex>-1&&(t=this.currentLevel)!=null&&t.details&&(this.currentLevelIndex=this.currentLevel.details.fragments[0].level),this.manualLevelIndex>-1&&(this.manualLevelIndex=this.currentLevelIndex);const n=r.length-1;this._firstLevel=Math.min(this._firstLevel,n),this._startLevel&&(this._startLevel=Math.min(this._startLevel,n)),this.hls.trigger(x.LEVELS_UPDATED,{levels:r})}onLevelsUpdated(e,{levels:t}){this._levels=t}checkMaxAutoUpdated(){const{autoLevelCapping:e,maxAutoLevel:t,maxHdcpLevel:r}=this.hls;this._maxAutoLevel!==t&&(this._maxAutoLevel=t,this.hls.trigger(x.MAX_AUTO_LEVEL_UPDATED,{autoLevelCapping:e,levels:this.levels,maxAutoLevel:t,minAutoLevel:this.hls.minAutoLevel,maxHdcpLevel:r}))}}function n2(i){const e={};i.forEach(t=>{const r=t.groupId||"";t.id=e[r]=e[r]||0,e[r]++})}function s2(){return self.SourceBuffer||self.WebKitSourceBuffer}function a2(){if(!hs())return!1;const e=s2();return!e||e.prototype&&typeof e.prototype.appendBuffer=="function"&&typeof e.prototype.remove=="function"}function _P(){if(!a2())return!1;const i=hs();return typeof(i==null?void 0:i.isTypeSupported)=="function"&&(["avc1.42E01E,mp4a.40.2","av01.0.01M.08","vp09.00.50.08"].some(e=>i.isTypeSupported(Jo(e,"video")))||["mp4a.40.2","fLaC"].some(e=>i.isTypeSupported(Jo(e,"audio"))))}function MP(){var i;const e=s2();return typeof(e==null||(i=e.prototype)==null?void 0:i.changeType)=="function"}const PP=100;class kP extends yg{constructor(e,t,r){super(e,t,r,"stream-controller",ke.MAIN),this.audioCodecSwap=!1,this.level=-1,this._forceStartLoad=!1,this._hasEnoughToStart=!1,this.altAudio=0,this.audioOnly=!1,this.fragPlaying=null,this.fragLastKbps=0,this.couldBacktrack=!1,this.backtrackFragment=null,this.audioCodecSwitch=!1,this.videoBuffer=null,this.onMediaPlaying=()=>{this.tick()},this.onMediaSeeked=()=>{const n=this.media,s=n?n.currentTime:null;if(s===null||!Ce(s)||(this.log(`Media seeked to ${s.toFixed(3)}`),!this.getBufferedFrag(s)))return;const a=this.getFwdBufferInfoAtPos(n,s,ke.MAIN,0);if(a===null||a.len===0){this.warn(`Main forward buffer length at ${s} on "seeked" event ${a?a.len:"empty"})`);return}this.tick()},this.registerListeners()}registerListeners(){super.registerListeners();const{hls:e}=this;e.on(x.MANIFEST_PARSED,this.onManifestParsed,this),e.on(x.LEVEL_LOADING,this.onLevelLoading,this),e.on(x.LEVEL_LOADED,this.onLevelLoaded,this),e.on(x.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.on(x.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(x.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on(x.BUFFER_CREATED,this.onBufferCreated,this),e.on(x.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(x.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(x.FRAG_BUFFERED,this.onFragBuffered,this)}unregisterListeners(){super.unregisterListeners();const{hls:e}=this;e.off(x.MANIFEST_PARSED,this.onManifestParsed,this),e.off(x.LEVEL_LOADED,this.onLevelLoaded,this),e.off(x.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.off(x.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(x.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off(x.BUFFER_CREATED,this.onBufferCreated,this),e.off(x.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(x.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(x.FRAG_BUFFERED,this.onFragBuffered,this)}onHandlerDestroying(){this.onMediaPlaying=this.onMediaSeeked=null,this.unregisterListeners(),super.onHandlerDestroying()}startLoad(e,t){if(this.levels){const{lastCurrentTime:r,hls:n}=this;if(this.stopLoad(),this.setInterval(PP),this.level=-1,!this.startFragRequested){let s=n.startLevel;s===-1&&(n.config.testBandwidth&&this.levels.length>1?(s=0,this.bitrateTest=!0):s=n.firstAutoLevel),n.nextLoadLevel=s,this.level=n.loadLevel,this._hasEnoughToStart=!!t}r>0&&e===-1&&!t&&(this.log(`Override startPosition with lastCurrentTime @${r.toFixed(3)}`),e=r),this.state=le.IDLE,this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick()}else this._forceStartLoad=!0,this.state=le.STOPPED}stopLoad(){this._forceStartLoad=!1,super.stopLoad()}doTick(){switch(this.state){case le.WAITING_LEVEL:{const{levels:t,level:r}=this,n=t==null?void 0:t[r],s=n==null?void 0:n.details;if(s&&(!s.live||this.levelLastLoaded===n&&!this.waitForLive(n))){if(this.waitForCdnTuneIn(s))break;this.state=le.IDLE;break}else if(this.hls.nextLoadLevel!==this.level){this.state=le.IDLE;break}break}case le.FRAG_LOADING_WAITING_RETRY:{var e;const t=self.performance.now(),r=this.retryDate;if(!r||t>=r||(e=this.media)!=null&&e.seeking){const{levels:n,level:s}=this,a=n==null?void 0:n[s];this.resetStartWhenNotLoaded(a||null),this.state=le.IDLE}}break}this.state===le.IDLE&&this.doTickIdle(),this.onTickEnd()}onTickEnd(){var e;super.onTickEnd(),(e=this.media)!=null&&e.readyState&&this.media.seeking===!1&&(this.lastCurrentTime=this.media.currentTime),this.checkFragmentChanged()}doTickIdle(){const{hls:e,levelLastLoaded:t,levels:r,media:n}=this;if(t===null||!n&&!this.primaryPrefetch&&(this.startFragRequested||!e.config.startFragPrefetch)||this.altAudio&&this.audioOnly)return;const s=this.buffering?e.nextLoadLevel:e.loadLevel;if(!(r!=null&&r[s]))return;const a=r[s],o=this.getMainFwdBufferInfo();if(o===null)return;const l=this.getLevelDetails();if(l&&this._streamEnded(o,l)){const v={};this.altAudio===2&&(v.type="video"),this.hls.trigger(x.BUFFER_EOS,v),this.state=le.ENDED;return}if(!this.buffering)return;e.loadLevel!==s&&e.manualLevel===-1&&this.log(`Adapting to level ${s} from level ${this.level}`),this.level=e.nextLoadLevel=s;const u=a.details;if(!u||this.state===le.WAITING_LEVEL||this.waitForLive(a)){this.level=s,this.state=le.WAITING_LEVEL,this.startFragRequested=!1;return}const h=o.len,d=this.getMaxBufferLength(a.maxBitrate);if(h>=d)return;this.backtrackFragment&&this.backtrackFragment.start>o.end&&(this.backtrackFragment=null);const p=this.backtrackFragment?this.backtrackFragment.start:o.end;let g=this.getNextFragment(p,u);if(this.couldBacktrack&&!this.fragPrevious&&g&&pr(g)&&this.fragmentTracker.getState(g)!==nr.OK){var m;const E=((m=this.backtrackFragment)!=null?m:g).sn-u.startSN,A=u.fragments[E-1];A&&g.cc===A.cc&&(g=A,this.fragmentTracker.removeFragment(A))}else this.backtrackFragment&&o.len&&(this.backtrackFragment=null);if(g&&this.isLoopLoading(g,p)){if(!g.gap){const E=this.audioOnly&&!this.altAudio?Nt.AUDIO:Nt.VIDEO,A=(E===Nt.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;A&&this.afterBufferFlushed(A,E,ke.MAIN)}g=this.getNextFragmentLoopLoading(g,u,o,ke.MAIN,d)}g&&(g.initSegment&&!g.initSegment.data&&!this.bitrateTest&&(g=g.initSegment),this.loadFragment(g,a,p))}loadFragment(e,t,r){const n=this.fragmentTracker.getState(e);n===nr.NOT_LOADED||n===nr.PARTIAL?pr(e)?this.bitrateTest?(this.log(`Fragment ${e.sn} of level ${e.level} is being downloaded to test bitrate and will not be buffered`),this._loadBitrateTestFrag(e,t)):super.loadFragment(e,t,r):this._loadInitSegment(e,t):this.clearTrackerIfNeeded(e)}getBufferedFrag(e){return this.fragmentTracker.getBufferedFrag(e,ke.MAIN)}followingBufferedFrag(e){return e?this.getBufferedFrag(e.end+.5):null}immediateLevelSwitch(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}nextLevelSwitch(){const{levels:e,media:t}=this;if(t!=null&&t.readyState){let r;const n=this.getAppendedFrag(t.currentTime);n&&n.start>1&&this.flushMainBuffer(0,n.start-1);const s=this.getLevelDetails();if(s!=null&&s.live){const o=this.getMainFwdBufferInfo();if(!o||o.len<s.targetduration*2)return}if(!t.paused&&e){const o=this.hls.nextLoadLevel,l=e[o],u=this.fragLastKbps;u&&this.fragCurrent?r=this.fragCurrent.duration*l.maxBitrate/(1e3*u)+1:r=0}else r=0;const a=this.getBufferedFrag(t.currentTime+r);if(a){const o=this.followingBufferedFrag(a);if(o){this.abortCurrentFrag();const l=o.maxStartPTS?o.maxStartPTS:o.start,u=o.duration,h=Math.max(a.end,l+Math.min(Math.max(u-this.config.maxFragLookUpTolerance,u*(this.couldBacktrack?.5:.125)),u*(this.couldBacktrack?.75:.25)));this.flushMainBuffer(h,Number.POSITIVE_INFINITY)}}}}abortCurrentFrag(){const e=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,e&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.state){case le.KEY_LOADING:case le.FRAG_LOADING:case le.FRAG_LOADING_WAITING_RETRY:case le.PARSING:case le.PARSED:this.state=le.IDLE;break}this.nextLoadPosition=this.getLoadPosition()}flushMainBuffer(e,t){super.flushMainBuffer(e,t,this.altAudio===2?"video":null)}onMediaAttached(e,t){super.onMediaAttached(e,t);const r=t.media;si(r,"playing",this.onMediaPlaying),si(r,"seeked",this.onMediaSeeked)}onMediaDetaching(e,t){const{media:r}=this;r&&(yi(r,"playing",this.onMediaPlaying),yi(r,"seeked",this.onMediaSeeked)),this.videoBuffer=null,this.fragPlaying=null,super.onMediaDetaching(e,t),!t.transferMedia&&(this._hasEnoughToStart=!1)}onManifestLoading(){super.onManifestLoading(),this.log("Trigger BUFFER_RESET"),this.hls.trigger(x.BUFFER_RESET,void 0),this.couldBacktrack=!1,this.fragLastKbps=0,this.fragPlaying=this.backtrackFragment=null,this.altAudio=0,this.audioOnly=!1}onManifestParsed(e,t){let r=!1,n=!1;t.levels.forEach(s=>{const a=s.audioCodec;a&&(r=r||a.indexOf("mp4a.40.2")!==-1,n=n||a.indexOf("mp4a.40.5")!==-1)}),this.audioCodecSwitch=r&&n&&!MP(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=t.levels,this.startFragRequested=!1}onLevelLoading(e,t){const{levels:r}=this;if(!r||this.state!==le.IDLE)return;const n=t.levelInfo;(!n.details||n.details.live&&(this.levelLastLoaded!==n||n.details.expired)||this.waitForCdnTuneIn(n.details))&&(this.state=le.WAITING_LEVEL)}onLevelLoaded(e,t){var r;const{levels:n,startFragRequested:s}=this,a=t.level,o=t.details,l=o.totalduration;if(!n){this.warn(`Levels were reset while loading level ${a}`);return}this.log(`Level ${a} loaded [${o.startSN},${o.endSN}]${o.lastPartSn?`[part-${o.lastPartSn}-${o.lastPartIndex}]`:""}, cc [${o.startCC}, ${o.endCC}] duration:${l}`);const u=t.levelInfo,h=this.fragCurrent;h&&(this.state===le.FRAG_LOADING||this.state===le.FRAG_LOADING_WAITING_RETRY)&&h.level!==t.level&&h.loader&&this.abortCurrentFrag();let d=0;if(o.live||(r=u.details)!=null&&r.live){var p;if(this.checkLiveUpdate(o),o.deltaUpdateFailed)return;d=this.alignPlaylists(o,u.details,(p=this.levelLastLoaded)==null?void 0:p.details)}if(u.details=o,this.levelLastLoaded=u,s||this.setStartPosition(o,d),this.hls.trigger(x.LEVEL_UPDATED,{details:o,level:a}),this.state===le.WAITING_LEVEL){if(this.waitForCdnTuneIn(o))return;this.state=le.IDLE}s&&o.live&&this.synchronizeToLiveEdge(o),this.tick()}synchronizeToLiveEdge(e){const{config:t,media:r}=this;if(!r)return;const n=this.hls.liveSyncPosition,s=this.getLoadPosition(),a=e.fragmentStart,o=e.edge,l=s>=a-t.maxFragLookUpTolerance&&s<=o;if(n!==null&&r.duration>n&&(s<n||!l)){const h=t.liveMaxLatencyDuration!==void 0?t.liveMaxLatencyDuration:t.liveMaxLatencyDurationCount*e.targetduration;if((!l&&r.readyState<4||s<o-h)&&(this._hasEnoughToStart||(this.nextLoadPosition=n),r.readyState))if(this.warn(`Playback: ${s.toFixed(3)} is located too far from the end of live sliding playlist: ${o}, reset currentTime to : ${n.toFixed(3)}`),this.config.liveSyncMode==="buffered"){var u;const d=Xe.bufferInfo(r,n,0);if(!(d!=null&&(u=d.buffered)!=null&&u.length)){r.currentTime=n;return}if(d.start<=s){r.currentTime=n;return}const{nextStart:g}=Xe.bufferedInfo(d.buffered,s,0);g&&(r.currentTime=g)}else r.currentTime=n}}_handleFragmentLoadProgress(e){var t;const r=e.frag,{part:n,payload:s}=e,{levels:a}=this;if(!a){this.warn(`Levels were reset while fragment load was in progress. Fragment ${r.sn} of level ${r.level} will not be buffered`);return}const o=a[r.level];if(!o){this.warn(`Level ${r.level} not found on progress`);return}const l=o.details;if(!l){this.warn(`Dropping fragment ${r.sn} of level ${r.level} after level details were reset`),this.fragmentTracker.removeFragment(r);return}const u=o.videoCodec,h=l.PTSKnown||!l.live,d=(t=r.initSegment)==null?void 0:t.data,p=this._getAudioCodec(o),g=this.transmuxer=this.transmuxer||new pA(this.hls,ke.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),m=n?n.index:-1,v=m!==-1,E=new og(r.level,r.sn,r.stats.chunkCount,s.byteLength,m,v),A=this.initPTS[r.cc];g.push(s,d,p,u,r,n,l.totalduration,h,E,A)}onAudioTrackSwitching(e,t){const r=this.hls,n=this.altAudio===2;if($u(t.url,r))this.altAudio=1;else{if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;const a=this.fragCurrent;a&&(this.log("Switching to main audio track, cancel main fragment load"),a.abortRequests(),this.fragmentTracker.removeFragment(a)),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();if(n){this.fragmentTracker.removeAllFragments(),r.once(x.BUFFER_FLUSHED,()=>{var a;(a=this.hls)==null||a.trigger(x.AUDIO_TRACK_SWITCHED,t)}),r.trigger(x.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:null});return}r.trigger(x.AUDIO_TRACK_SWITCHED,t)}}onAudioTrackSwitched(e,t){const r=$u(t.url,this.hls);if(r){const n=this.videoBuffer;n&&this.mediaBuffer!==n&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=n)}this.altAudio=r?2:0,this.tick()}onBufferCreated(e,t){const r=t.tracks;let n,s,a=!1;for(const o in r){const l=r[o];if(l.id==="main"){if(s=o,n=l,o==="video"){const u=r[o];u&&(this.videoBuffer=u.buffer)}}else a=!0}a&&n?(this.log(`Alternate track found, use ${s}.buffered to schedule main fragment loading`),this.mediaBuffer=n.buffer):this.mediaBuffer=this.media}onFragBuffered(e,t){const{frag:r,part:n}=t,s=r.type===ke.MAIN;if(s){if(this.fragContextChanged(r)){this.warn(`Fragment ${r.sn}${n?" p: "+n.index:""} of level ${r.level} finished buffering, but was aborted. state: ${this.state}`),this.state===le.PARSED&&(this.state=le.IDLE);return}const o=n?n.stats:r.stats;this.fragLastKbps=Math.round(8*o.total/(o.buffering.end-o.loading.first)),pr(r)&&(this.fragPrevious=r),this.fragBufferedComplete(r,n)}const a=this.media;a&&(!this._hasEnoughToStart&&Xe.getBuffered(a).length&&(this._hasEnoughToStart=!0,this.seekToStartPos()),s&&this.tick())}get hasEnoughToStart(){return this._hasEnoughToStart}onError(e,t){var r;if(t.fatal){this.state=le.ERROR;return}switch(t.details){case Q.FRAG_GAP:case Q.FRAG_PARSING_ERROR:case Q.FRAG_DECRYPT_ERROR:case Q.FRAG_LOAD_ERROR:case Q.FRAG_LOAD_TIMEOUT:case Q.KEY_LOAD_ERROR:case Q.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(ke.MAIN,t);break;case Q.LEVEL_LOAD_ERROR:case Q.LEVEL_LOAD_TIMEOUT:case Q.LEVEL_PARSING_ERROR:!t.levelRetry&&this.state===le.WAITING_LEVEL&&((r=t.context)==null?void 0:r.type)===lt.LEVEL&&(this.state=le.IDLE);break;case Q.BUFFER_ADD_CODEC_ERROR:case Q.BUFFER_APPEND_ERROR:if(t.parent!=="main")return;this.resetLoadingState();break;case Q.BUFFER_FULL_ERROR:if(t.parent!=="main")return;this.reduceLengthAndFlushBuffer(t)&&this.flushMainBuffer(0,Number.POSITIVE_INFINITY);break;case Q.INTERNAL_EXCEPTION:this.recoverWorkerError(t);break}}onFragLoadEmergencyAborted(){this.state=le.IDLE,this._hasEnoughToStart||(this.startFragRequested=!1,this.nextLoadPosition=this.lastCurrentTime),this.tickImmediate()}onBufferFlushed(e,{type:t}){if(t!==Nt.AUDIO||!this.altAudio){const r=(t===Nt.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;r&&(this.afterBufferFlushed(r,t,ke.MAIN),this.tick())}}onLevelsUpdated(e,t){this.level>-1&&this.fragCurrent&&(this.level=this.fragCurrent.level,this.level===-1&&this.resetWhenMissingContext(this.fragCurrent)),this.levels=t.levels}swapAudioCodec(){this.audioCodecSwap=!this.audioCodecSwap}seekToStartPos(){const{media:e}=this;if(!e)return;const t=e.currentTime;let r=this.startPosition;if(r>=0&&t<r){if(e.seeking){this.log(`could not seek to ${r}, already seeking at ${t}`);return}const n=this.timelineOffset;n&&r&&(r+=n);const s=this.getLevelDetails(),a=Xe.getBuffered(e),o=a.length?a.start(0):0,l=o-r,u=Math.max(this.config.maxBufferHole,this.config.maxFragLookUpTolerance);(this.config.startOnSegmentBoundary||l>0&&(l<u||this.loadingParts&&l<2*((s==null?void 0:s.partTarget)||0)))&&(this.log(`adjusting start position by ${l} to match buffer start`),r+=l,this.startPosition=r),t<r&&(this.log(`seek to target start position ${r} from current time ${t} buffer start ${o}`),e.currentTime=r)}}_getAudioCodec(e){let t=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&t&&(this.log("Swapping audio codec"),t.indexOf("mp4a.40.5")!==-1?t="mp4a.40.2":t="mp4a.40.5"),t}_loadBitrateTestFrag(e,t){e.bitrateTest=!0,this._doFragLoad(e,t).then(r=>{const{hls:n}=this,s=r==null?void 0:r.frag;if(!s||this.fragContextChanged(s))return;t.fragmentError=0,this.state=le.IDLE,this.startFragRequested=!1,this.bitrateTest=!1;const a=s.stats;a.parsing.start=a.parsing.end=a.buffering.start=a.buffering.end=self.performance.now(),n.trigger(x.FRAG_LOADED,r),s.bitrateTest=!1})}_handleTransmuxComplete(e){var t;const r=this.playlistType,{hls:n}=this,{remuxResult:s,chunkMeta:a}=e,o=this.getCurrentContext(a);if(!o){this.resetWhenMissingContext(a);return}const{frag:l,part:u,level:h}=o,{video:d,text:p,id3:g,initSegment:m}=s,{details:v}=h,E=this.altAudio?void 0:s.audio;if(this.fragContextChanged(l)){this.fragmentTracker.removeFragment(l);return}if(this.state=le.PARSING,m){if(m!=null&&m.tracks){const R=l.initSegment||l;this._bufferInitSegment(h,m.tracks,R,a),n.trigger(x.FRAG_PARSING_INIT_SEGMENT,{frag:R,id:r,tracks:m.tracks})}const A=m.initPTS,D=m.timescale;Ce(A)&&(this.initPTS[l.cc]={baseTime:A,timescale:D},n.trigger(x.INIT_PTS_FOUND,{frag:l,id:r,initPTS:A,timescale:D}))}if(d&&v){E&&d.type==="audiovideo"&&this.logMuxedErr(l);const A=v.fragments[l.sn-1-v.startSN],D=l.sn===v.startSN,R=!A||l.cc>A.cc;if(s.independent!==!1){const{startPTS:_,endPTS:F,startDTS:w,endDTS:C}=d;if(u)u.elementaryStreams[d.type]={startPTS:_,endPTS:F,startDTS:w,endDTS:C};else if(d.firstKeyFrame&&d.independent&&a.id===1&&!R&&(this.couldBacktrack=!0),d.dropped&&d.independent){const M=this.getMainFwdBufferInfo(),L=(M?M.end:this.getLoadPosition())+this.config.maxBufferHole,I=d.firstKeyFramePTS?d.firstKeyFramePTS:_;if(!D&&L<I-this.config.maxBufferHole&&!R){this.backtrack(l);return}else R&&(l.gap=!0);l.setElementaryStreamInfo(d.type,l.start,F,l.start,C,!0)}else D&&_-(v.appliedTimelineOffset||0)>hc&&(l.gap=!0);l.setElementaryStreamInfo(d.type,_,F,w,C),this.backtrackFragment&&(this.backtrackFragment=l),this.bufferFragmentData(d,l,u,a,D||R)}else if(D||R)l.gap=!0;else{this.backtrack(l);return}}if(E){const{startPTS:A,endPTS:D,startDTS:R,endDTS:_}=E;u&&(u.elementaryStreams[Nt.AUDIO]={startPTS:A,endPTS:D,startDTS:R,endDTS:_}),l.setElementaryStreamInfo(Nt.AUDIO,A,D,R,_),this.bufferFragmentData(E,l,u,a)}if(v&&g!=null&&(t=g.samples)!=null&&t.length){const A={id:r,frag:l,details:v,samples:g.samples};n.trigger(x.FRAG_PARSING_METADATA,A)}if(v&&p){const A={id:r,frag:l,details:v,samples:p.samples};n.trigger(x.FRAG_PARSING_USERDATA,A)}}logMuxedErr(e){this.warn(`${pr(e)?"Media":"Init"} segment with muxed audiovideo where only video expected: ${e.url}`)}_bufferInitSegment(e,t,r,n){if(this.state!==le.PARSING)return;this.audioOnly=!!t.audio&&!t.video,this.altAudio&&!this.audioOnly&&(delete t.audio,t.audiovideo&&this.logMuxedErr(r));const{audio:s,video:a,audiovideo:o}=t;if(s){let u=Fu(s.codec,e.audioCodec);u==="mp4a"&&(u="mp4a.40.5");const h=navigator.userAgent.toLowerCase();if(this.audioCodecSwitch){u&&(u.indexOf("mp4a.40.5")!==-1?u="mp4a.40.2":u="mp4a.40.5");const d=s.metadata;d&&"channelCount"in d&&(d.channelCount||1)!==1&&h.indexOf("firefox")===-1&&(u="mp4a.40.5")}u&&u.indexOf("mp4a.40.5")!==-1&&h.indexOf("android")!==-1&&s.container!=="audio/mpeg"&&(u="mp4a.40.2",this.log(`Android: force audio codec to ${u}`)),e.audioCodec&&e.audioCodec!==u&&this.log(`Swapping manifest audio codec "${e.audioCodec}" for "${u}"`),s.levelCodec=u,s.id=ke.MAIN,this.log(`Init audio buffer, container:${s.container}, codecs[selected/level/parsed]=[${u||""}/${e.audioCodec||""}/${s.codec}]`),delete t.audiovideo}if(a){a.levelCodec=e.videoCodec,a.id=ke.MAIN;const u=a.codec;if((u==null?void 0:u.length)===4)switch(u){case"hvc1":case"hev1":a.codec="hvc1.1.6.L120.90";break;case"av01":a.codec="av01.0.04M.08";break;case"avc1":a.codec="avc1.42e01e";break}this.log(`Init video buffer, container:${a.container}, codecs[level/parsed]=[${e.videoCodec||""}/${u}]${a.codec!==u?" parsed-corrected="+a.codec:""}${a.supplemental?" supplemental="+a.supplemental:""}`),delete t.audiovideo}o&&(this.log(`Init audiovideo buffer, container:${o.container}, codecs[level/parsed]=[${e.codecs}/${o.codec}]`),delete t.video,delete t.audio);const l=Object.keys(t);if(l.length){if(this.hls.trigger(x.BUFFER_CODECS,t),!this.hls)return;l.forEach(u=>{const d=t[u].initSegment;d!=null&&d.byteLength&&this.hls.trigger(x.BUFFER_APPENDING,{type:u,data:d,frag:r,part:null,chunkMeta:n,parent:r.type})})}this.tickImmediate()}getMainFwdBufferInfo(){const e=this.mediaBuffer&&this.altAudio===2?this.mediaBuffer:this.media;return this.getFwdBufferInfo(e,ke.MAIN)}get maxBufferLength(){const{levels:e,level:t}=this,r=e==null?void 0:e[t];return r?this.getMaxBufferLength(r.maxBitrate):this.config.maxBufferLength}backtrack(e){this.couldBacktrack=!0,this.backtrackFragment=e,this.resetTransmuxer(),this.flushBufferGap(e),this.fragmentTracker.removeFragment(e),this.fragPrevious=null,this.nextLoadPosition=e.start,this.state=le.IDLE}checkFragmentChanged(){const e=this.media;let t=null;if(e&&e.readyState>1&&e.seeking===!1){const r=e.currentTime;if(Xe.isBuffered(e,r)?t=this.getAppendedFrag(r):Xe.isBuffered(e,r+.1)&&(t=this.getAppendedFrag(r+.1)),t){this.backtrackFragment=null;const n=this.fragPlaying,s=t.level;(!n||t.sn!==n.sn||n.level!==s)&&(this.fragPlaying=t,this.hls.trigger(x.FRAG_CHANGED,{frag:t}),(!n||n.level!==s)&&this.hls.trigger(x.LEVEL_SWITCHED,{level:s}))}}}get nextLevel(){const e=this.nextBufferedFrag;return e?e.level:-1}get currentFrag(){var e;if(this.fragPlaying)return this.fragPlaying;const t=((e=this.media)==null?void 0:e.currentTime)||this.lastCurrentTime;return Ce(t)?this.getAppendedFrag(t):null}get currentProgramDateTime(){var e;const t=((e=this.media)==null?void 0:e.currentTime)||this.lastCurrentTime;if(Ce(t)){const r=this.getLevelDetails(),n=this.currentFrag||(r?js(null,r.fragments,t):null);if(n){const s=n.programDateTime;if(s!==null){const a=s+(t-n.start)*1e3;return new Date(a)}}}return null}get currentLevel(){const e=this.currentFrag;return e?e.level:-1}get nextBufferedFrag(){const e=this.currentFrag;return e?this.followingBufferedFrag(e):null}get forceStartLoad(){return this._forceStartLoad}}class OP{constructor(e){this.config=void 0,this.keyUriToKeyInfo={},this.emeController=null,this.config=e}abort(e){for(const r in this.keyUriToKeyInfo){const n=this.keyUriToKeyInfo[r].loader;if(n){var t;if(e&&e!==((t=n.context)==null?void 0:t.frag.type))return;n.abort()}}}detach(){for(const e in this.keyUriToKeyInfo){const t=this.keyUriToKeyInfo[e];(t.mediaKeySessionContext||t.decryptdata.isCommonEncryption)&&delete this.keyUriToKeyInfo[e]}}destroy(){this.detach();for(const e in this.keyUriToKeyInfo){const t=this.keyUriToKeyInfo[e].loader;t&&t.destroy()}this.keyUriToKeyInfo={}}createKeyLoadError(e,t=Q.KEY_LOAD_ERROR,r,n,s){return new wn({type:Fe.NETWORK_ERROR,details:t,fatal:!1,frag:e,response:s,error:r,networkDetails:n})}loadClear(e,t){if(this.emeController&&this.config.emeEnabled&&!this.emeController.getSelectedKeySystemFormats().length){if(t.length){const{sn:r,cc:n}=e;for(let s=0;s<t.length;s++){const a=t[s];if(n<=a.cc&&(r==="initSegment"||a.sn==="initSegment"||r<a.sn))return this.emeController.selectKeySystemFormat(a).then(o=>{if(a.setKeyFormat(o),this.emeController&&this.config.requireKeySystemAccessOnStart){const l=Wu(o);if(l)return this.emeController.getKeySystemAccess([l])}})}}else if(this.config.requireKeySystemAccessOnStart){const r=el(this.config);if(r.length)return this.emeController.getKeySystemAccess(r)}}return null}load(e){return!e.decryptdata&&e.encrypted&&this.emeController&&this.config.emeEnabled?this.emeController.selectKeySystemFormat(e).then(t=>this.loadInternal(e,t)):this.loadInternal(e)}loadInternal(e,t){var r,n;t&&e.setKeyFormat(t);const s=e.decryptdata;if(!s){const u=new Error(t?`Expected frag.decryptdata to be defined after setting format ${t}`:"Missing decryption data on fragment in onKeyLoading");return Promise.reject(this.createKeyLoadError(e,Q.KEY_LOAD_ERROR,u))}const a=s.uri;if(!a)return Promise.reject(this.createKeyLoadError(e,Q.KEY_LOAD_ERROR,new Error(`Invalid key URI: "${a}"`)));let o=this.keyUriToKeyInfo[a];if((r=o)!=null&&r.decryptdata.key)return s.key=o.decryptdata.key,Promise.resolve({frag:e,keyInfo:o});if((n=o)!=null&&n.keyLoadPromise){var l;switch((l=o.mediaKeySessionContext)==null?void 0:l.keyStatus){case void 0:case"status-pending":case"usable":case"usable-in-future":return o.keyLoadPromise.then(u=>(s.key=u.keyInfo.decryptdata.key,{frag:e,keyInfo:o}))}}switch(o=this.keyUriToKeyInfo[a]={decryptdata:s,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},s.method){case"ISO-23001-7":case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return s.keyFormat==="identity"?this.loadKeyHTTP(o,e):this.loadKeyEME(o,e);case"AES-128":case"AES-256":case"AES-256-CTR":return this.loadKeyHTTP(o,e);default:return Promise.reject(this.createKeyLoadError(e,Q.KEY_LOAD_ERROR,new Error(`Key supplied with unsupported METHOD: "${s.method}"`)))}}loadKeyEME(e,t){const r={frag:t,keyInfo:e};if(this.emeController&&this.config.emeEnabled){const n=this.emeController.loadKey(r);if(n)return(e.keyLoadPromise=n.then(s=>(e.mediaKeySessionContext=s,r))).catch(s=>{throw e.keyLoadPromise=null,s})}return Promise.resolve(r)}loadKeyHTTP(e,t){const r=this.config,n=r.loader,s=new n(r);return t.keyLoader=e.loader=s,e.keyLoadPromise=new Promise((a,o)=>{const l={keyInfo:e,frag:t,responseType:"arraybuffer",url:e.decryptdata.uri},u=r.keyLoadPolicy.default,h={loadPolicy:u,timeout:u.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},d={onSuccess:(p,g,m,v)=>{const{frag:E,keyInfo:A,url:D}=m;if(!E.decryptdata||A!==this.keyUriToKeyInfo[D])return o(this.createKeyLoadError(E,Q.KEY_LOAD_ERROR,new Error("after key load, decryptdata unset or changed"),v));A.decryptdata.key=E.decryptdata.key=new Uint8Array(p.data),E.keyLoader=null,A.loader=null,a({frag:E,keyInfo:A})},onError:(p,g,m,v)=>{this.resetLoader(g),o(this.createKeyLoadError(t,Q.KEY_LOAD_ERROR,new Error(`HTTP Error ${p.code} loading key ${p.text}`),m,Et({url:l.url,data:void 0},p)))},onTimeout:(p,g,m)=>{this.resetLoader(g),o(this.createKeyLoadError(t,Q.KEY_LOAD_TIMEOUT,new Error("key loading timed out"),m))},onAbort:(p,g,m)=>{this.resetLoader(g),o(this.createKeyLoadError(t,Q.INTERNAL_ABORTED,new Error("key loading aborted"),m))}};s.load(l,h,d)})}resetLoader(e){const{frag:t,keyInfo:r,url:n}=e,s=r.loader;t.keyLoader===s&&(t.keyLoader=null,r.loader=null),delete this.keyUriToKeyInfo[n],s&&s.destroy()}}function o2(i){const{type:e}=i;switch(e){case lt.AUDIO_TRACK:return ke.AUDIO;case lt.SUBTITLE_TRACK:return ke.SUBTITLE;default:return ke.MAIN}}function Zg(i,e){let t=i.url;return(t===void 0||t.indexOf("data:")===0)&&(t=e.url),t}class FP{constructor(e){this.hls=void 0,this.loaders=Object.create(null),this.variableList=null,this.onManifestLoaded=this.checkAutostartLoad,this.hls=e,this.registerListeners()}startLoad(e){}stopLoad(){this.destroyInternalLoaders()}registerListeners(){const{hls:e}=this;e.on(x.MANIFEST_LOADING,this.onManifestLoading,this),e.on(x.LEVEL_LOADING,this.onLevelLoading,this),e.on(x.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.on(x.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this),e.on(x.LEVELS_UPDATED,this.onLevelsUpdated,this)}unregisterListeners(){const{hls:e}=this;e.off(x.MANIFEST_LOADING,this.onManifestLoading,this),e.off(x.LEVEL_LOADING,this.onLevelLoading,this),e.off(x.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.off(x.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this),e.off(x.LEVELS_UPDATED,this.onLevelsUpdated,this)}createInternalLoader(e){const t=this.hls.config,r=t.pLoader,n=t.loader,s=r||n,a=new s(t);return this.loaders[e.type]=a,a}getInternalLoader(e){return this.loaders[e.type]}resetInternalLoader(e){this.loaders[e]&&delete this.loaders[e]}destroyInternalLoaders(){for(const e in this.loaders){const t=this.loaders[e];t&&t.destroy(),this.resetInternalLoader(e)}}destroy(){this.variableList=null,this.unregisterListeners(),this.destroyInternalLoaders()}onManifestLoading(e,t){const{url:r}=t;this.variableList=null,this.load({id:null,level:0,responseType:"text",type:lt.MANIFEST,url:r,deliveryDirectives:null,levelOrTrack:null})}onLevelLoading(e,t){const{id:r,level:n,pathwayId:s,url:a,deliveryDirectives:o,levelInfo:l}=t;this.load({id:r,level:n,pathwayId:s,responseType:"text",type:lt.LEVEL,url:a,deliveryDirectives:o,levelOrTrack:l})}onAudioTrackLoading(e,t){const{id:r,groupId:n,url:s,deliveryDirectives:a,track:o}=t;this.load({id:r,groupId:n,level:null,responseType:"text",type:lt.AUDIO_TRACK,url:s,deliveryDirectives:a,levelOrTrack:o})}onSubtitleTrackLoading(e,t){const{id:r,groupId:n,url:s,deliveryDirectives:a,track:o}=t;this.load({id:r,groupId:n,level:null,responseType:"text",type:lt.SUBTITLE_TRACK,url:s,deliveryDirectives:a,levelOrTrack:o})}onLevelsUpdated(e,t){const r=this.loaders[lt.LEVEL];if(r){const n=r.context;n&&!t.levels.some(s=>s===n.levelOrTrack)&&(r.abort(),delete this.loaders[lt.LEVEL])}}load(e){var t;const r=this.hls.config;let n=this.getInternalLoader(e);if(n){const u=this.hls.logger,h=n.context;if(h&&h.levelOrTrack===e.levelOrTrack&&(h.url===e.url||h.deliveryDirectives&&!e.deliveryDirectives)){h.url===e.url?u.log(`[playlist-loader]: ignore ${e.url} ongoing request`):u.log(`[playlist-loader]: ignore ${e.url} in favor of ${h.url}`);return}u.log(`[playlist-loader]: aborting previous loader for type: ${e.type}`),n.abort()}let s;if(e.type===lt.MANIFEST?s=r.manifestLoadPolicy.default:s=xt({},r.playlistLoadPolicy.default,{timeoutRetry:null,errorRetry:null}),n=this.createInternalLoader(e),Ce((t=e.deliveryDirectives)==null?void 0:t.part)){let u;if(e.type===lt.LEVEL&&e.level!==null?u=this.hls.levels[e.level].details:e.type===lt.AUDIO_TRACK&&e.id!==null?u=this.hls.audioTracks[e.id].details:e.type===lt.SUBTITLE_TRACK&&e.id!==null&&(u=this.hls.subtitleTracks[e.id].details),u){const h=u.partTarget,d=u.targetduration;if(h&&d){const p=Math.max(h*3,d*.8)*1e3;s=xt({},s,{maxTimeToFirstByteMs:Math.min(p,s.maxTimeToFirstByteMs),maxLoadTimeMs:Math.min(p,s.maxTimeToFirstByteMs)})}}}const a=s.errorRetry||s.timeoutRetry||{},o={loadPolicy:s,timeout:s.maxLoadTimeMs,maxRetry:a.maxNumRetry||0,retryDelay:a.retryDelayMs||0,maxRetryDelay:a.maxRetryDelayMs||0},l={onSuccess:(u,h,d,p)=>{const g=this.getInternalLoader(d);this.resetInternalLoader(d.type);const m=u.data;if(m.indexOf("#EXTM3U")!==0){this.handleManifestParsingError(u,d,new Error("no EXTM3U delimiter"),p||null,h);return}h.parsing.start=performance.now(),on.isMediaPlaylist(m)||d.type!==lt.MANIFEST?this.handleTrackOrLevelPlaylist(u,h,d,p||null,g):this.handleMasterPlaylist(u,h,d,p)},onError:(u,h,d,p)=>{this.handleNetworkError(h,d,!1,u,p)},onTimeout:(u,h,d)=>{this.handleNetworkError(h,d,!0,void 0,u)}};n.load(e,o,l)}checkAutostartLoad(){if(!this.hls)return;const{config:{autoStartLoad:e,startPosition:t},forceStartLoad:r}=this.hls;(e||r)&&(this.hls.logger.log(`${e?"auto":"force"} startLoad with configured startPosition ${t}`),this.hls.startLoad(t))}handleMasterPlaylist(e,t,r,n){const s=this.hls,a=e.data,o=Zg(e,r),l=on.parseMasterPlaylist(a,o);if(l.playlistParsingError){this.handleManifestParsingError(e,r,l.playlistParsingError,n,t);return}const{contentSteering:u,levels:h,sessionData:d,sessionKeys:p,startTimeOffset:g,variableList:m}=l;this.variableList=m;const{AUDIO:v=[],SUBTITLES:E,"CLOSED-CAPTIONS":A}=on.parseMasterPlaylistMedia(a,o,l);v.length&&!v.some(R=>!R.url)&&h[0].audioCodec&&!h[0].attrs.AUDIO&&(this.hls.logger.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),v.unshift({type:"main",name:"main",groupId:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new Ht({}),bitrate:0,url:""})),s.trigger(x.MANIFEST_LOADED,{levels:h,audioTracks:v,subtitles:E,captions:A,contentSteering:u,url:o,stats:t,networkDetails:n,sessionData:d,sessionKeys:p,startTimeOffset:g,variableList:m})}handleTrackOrLevelPlaylist(e,t,r,n,s){const a=this.hls,{id:o,level:l,type:u}=r,h=Zg(e,r),d=Ce(l)?l:Ce(o)?o:0,p=o2(r),g=on.parseLevelPlaylist(e.data,h,d,p,0,this.variableList);if(u===lt.MANIFEST){const m={attrs:new Ht({}),bitrate:0,details:g,name:"",url:h};g.requestScheduled=t.loading.start+Mb(g,0),a.trigger(x.MANIFEST_LOADED,{levels:[m],audioTracks:[],url:h,stats:t,networkDetails:n,sessionData:null,sessionKeys:null,contentSteering:null,startTimeOffset:null,variableList:null})}t.parsing.end=performance.now(),r.levelDetails=g,this.handlePlaylistLoaded(g,e,t,r,n,s)}handleManifestParsingError(e,t,r,n,s){this.hls.trigger(x.ERROR,{type:Fe.NETWORK_ERROR,details:Q.MANIFEST_PARSING_ERROR,fatal:t.type===lt.MANIFEST,url:e.url,err:r,error:r,reason:r.message,response:e,context:t,networkDetails:n,stats:s})}handleNetworkError(e,t,r=!1,n,s){let a=`A network ${r?"timeout":"error"+(n?" (status "+n.code+")":"")} occurred while loading ${e.type}`;e.type===lt.LEVEL?a+=`: ${e.level} id: ${e.id}`:(e.type===lt.AUDIO_TRACK||e.type===lt.SUBTITLE_TRACK)&&(a+=` id: ${e.id} group-id: "${e.groupId}"`);const o=new Error(a);this.hls.logger.warn(`[playlist-loader]: ${a}`);let l=Q.UNKNOWN,u=!1;const h=this.getInternalLoader(e);switch(e.type){case lt.MANIFEST:l=r?Q.MANIFEST_LOAD_TIMEOUT:Q.MANIFEST_LOAD_ERROR,u=!0;break;case lt.LEVEL:l=r?Q.LEVEL_LOAD_TIMEOUT:Q.LEVEL_LOAD_ERROR,u=!1;break;case lt.AUDIO_TRACK:l=r?Q.AUDIO_TRACK_LOAD_TIMEOUT:Q.AUDIO_TRACK_LOAD_ERROR,u=!1;break;case lt.SUBTITLE_TRACK:l=r?Q.SUBTITLE_TRACK_LOAD_TIMEOUT:Q.SUBTITLE_LOAD_ERROR,u=!1;break}h&&this.resetInternalLoader(e.type);const d={type:Fe.NETWORK_ERROR,details:l,fatal:u,url:e.url,loader:h,context:e,error:o,networkDetails:t,stats:s};if(n){const p=(t==null?void 0:t.url)||e.url;d.response=Et({url:p,data:void 0},n)}this.hls.trigger(x.ERROR,d)}handlePlaylistLoaded(e,t,r,n,s,a){const o=this.hls,{type:l,level:u,id:h,groupId:d,deliveryDirectives:p}=n,g=Zg(t,n),m=o2(n),v=typeof n.level=="number"&&m===ke.MAIN?u:void 0;if(!e.fragments.length){const A=e.playlistParsingError=new Error("No Segments found in Playlist");o.trigger(x.ERROR,{type:Fe.NETWORK_ERROR,details:Q.LEVEL_EMPTY_ERROR,fatal:!1,url:g,error:A,reason:A.message,response:t,context:n,level:v,parent:m,networkDetails:s,stats:r});return}e.targetduration||(e.playlistParsingError=new Error("Missing Target Duration"));const E=e.playlistParsingError;if(E){if(this.hls.logger.warn(E),!o.config.ignorePlaylistParsingErrors){o.trigger(x.ERROR,{type:Fe.NETWORK_ERROR,details:Q.LEVEL_PARSING_ERROR,fatal:!1,url:g,error:E,reason:E.message,response:t,context:n,level:v,parent:m,networkDetails:s,stats:r});return}e.playlistParsingError=null}switch(e.live&&a&&(a.getCacheAge&&(e.ageHeader=a.getCacheAge()||0),(!a.getCacheAge||isNaN(e.ageHeader))&&(e.ageHeader=0)),l){case lt.MANIFEST:case lt.LEVEL:o.trigger(x.LEVEL_LOADED,{details:e,levelInfo:n.levelOrTrack||o.levels[0],level:v||0,id:h||0,stats:r,networkDetails:s,deliveryDirectives:p,withoutMultiVariant:l===lt.MANIFEST});break;case lt.AUDIO_TRACK:o.trigger(x.AUDIO_TRACK_LOADED,{details:e,track:n.levelOrTrack,id:h||0,groupId:d||"",stats:r,networkDetails:s,deliveryDirectives:p});break;case lt.SUBTITLE_TRACK:o.trigger(x.SUBTITLE_TRACK_LOADED,{details:e,track:n.levelOrTrack,id:h||0,groupId:d||"",stats:r,networkDetails:s,deliveryDirectives:p});break}}}class Mi{static get version(){return il}static isMSESupported(){return a2()}static isSupported(){return _P()}static getMediaSource(){return hs()}static get Events(){return x}static get MetadataSchema(){return ni}static get ErrorTypes(){return Fe}static get ErrorDetails(){return Q}static get DefaultConfig(){return Mi.defaultConfig?Mi.defaultConfig:EP}static set DefaultConfig(e){Mi.defaultConfig=e}constructor(e={}){this.config=void 0,this.userConfig=void 0,this.logger=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new Eg,this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioStreamController=void 0,this.subtititleStreamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.interstitialsController=void 0,this.gapController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this._url=null,this._sessionId=void 0,this.triggeringException=void 0,this.started=!1;const t=this.logger=cw(e.debug||!1,"Hls instance",e.assetPlayerId),r=this.config=AP(Mi.DefaultConfig,e,t);this.userConfig=e,r.progressive&&SP(r,t);const{abrController:n,bufferController:s,capLevelController:a,errorController:o,fpsController:l}=r,u=new o(this),h=this.abrController=new n(this),d=new eL(this),p=r.interstitialsController,g=p?this.interstitialsController=new p(this,Mi):null,m=this.bufferController=new s(this,d),v=this.capLevelController=new a(this),E=new l(this),A=new FP(this),D=r.contentSteeringController,R=D?new D(this):null,_=this.levelController=new LP(this,R),F=new CP(this),w=new OP(this.config),C=this.streamController=new kP(this,d,w),M=this.gapController=new RP(this,d);v.setStreamController(C),E.setStreamController(C);const L=[A,_,C];g&&L.splice(1,0,g),R&&L.splice(1,0,R),this.networkControllers=L;const I=[h,m,M,v,E,F,d];this.audioTrackController=this.createController(r.audioTrackController,L);const U=r.audioStreamController;U&&L.push(this.audioStreamController=new U(this,d,w)),this.subtitleTrackController=this.createController(r.subtitleTrackController,L);const q=r.subtitleStreamController;q&&L.push(this.subtititleStreamController=new q(this,d,w)),this.createController(r.timelineController,I),w.emeController=this.emeController=this.createController(r.emeController,I),this.cmcdController=this.createController(r.cmcdController,I),this.latencyController=this.createController(wP,I),this.coreComponents=I,L.push(u);const $=u.onErrorOut;typeof $=="function"&&this.on(x.ERROR,$,u),this.on(x.MANIFEST_LOADED,A.onManifestLoaded,A)}createController(e,t){if(e){const r=new e(this);return t&&t.push(r),r}return null}on(e,t,r=this){this._emitter.on(e,t,r)}once(e,t,r=this){this._emitter.once(e,t,r)}removeAllListeners(e){this._emitter.removeAllListeners(e)}off(e,t,r=this,n){this._emitter.off(e,t,r,n)}listeners(e){return this._emitter.listeners(e)}emit(e,t,r){return this._emitter.emit(e,t,r)}trigger(e,t){if(this.config.debug)return this.emit(e,e,t);try{return this.emit(e,e,t)}catch(r){if(this.logger.error("An internal error happened while handling event "+e+'. Error message: "'+r.message+'". Here is a stacktrace:',r),!this.triggeringException){this.triggeringException=!0;const n=e===x.ERROR;this.trigger(x.ERROR,{type:Fe.OTHER_ERROR,details:Q.INTERNAL_EXCEPTION,fatal:n,event:e,error:r}),this.triggeringException=!1}}return!1}listenerCount(e){return this._emitter.listenerCount(e)}destroy(){this.logger.log("destroy"),this.trigger(x.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this._url=null,this.networkControllers.forEach(t=>t.destroy()),this.networkControllers.length=0,this.coreComponents.forEach(t=>t.destroy()),this.coreComponents.length=0;const e=this.config;e.xhrSetup=e.fetchSetup=void 0,this.userConfig=null}attachMedia(e){if(!e||"media"in e&&!e.media){const s=new Error(`attachMedia failed: invalid argument (${e})`);this.trigger(x.ERROR,{type:Fe.OTHER_ERROR,details:Q.ATTACH_MEDIA_ERROR,fatal:!0,error:s});return}this.logger.log("attachMedia"),this._media&&(this.logger.warn("media must be detached before attaching"),this.detachMedia());const t="media"in e,r=t?e.media:e,n=t?e:{media:r};this._media=r,this.trigger(x.MEDIA_ATTACHING,n)}detachMedia(){this.logger.log("detachMedia"),this.trigger(x.MEDIA_DETACHING,{}),this._media=null}transferMedia(){this._media=null;const e=this.bufferController.transferMedia();return this.trigger(x.MEDIA_DETACHING,{transferMedia:e}),e}loadSource(e){this.stopLoad();const t=this.media,r=this._url,n=this._url=zf.buildAbsoluteURL(self.location.href,e,{alwaysNormalize:!0});this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.logger.log(`loadSource:${n}`),t&&r&&(r!==n||this.bufferController.hasSourceTypes())&&(this.detachMedia(),this.attachMedia(t)),this.trigger(x.MANIFEST_LOADING,{url:e})}get url(){return this._url}get hasEnoughToStart(){return this.streamController.hasEnoughToStart}get startPosition(){return this.streamController.startPositionValue}startLoad(e=-1,t){this.logger.log(`startLoad(${e+(t?", <skip seek to start>":"")})`),this.started=!0,this.resumeBuffering();for(let r=0;r<this.networkControllers.length&&(this.networkControllers[r].startLoad(e,t),!(!this.started||!this.networkControllers));r++);}stopLoad(){this.logger.log("stopLoad"),this.started=!1;for(let e=0;e<this.networkControllers.length&&(this.networkControllers[e].stopLoad(),!(this.started||!this.networkControllers));e++);}get loadingEnabled(){return this.started}get bufferingEnabled(){return this.streamController.bufferingEnabled}resumeBuffering(){this.bufferingEnabled||(this.logger.log("resume buffering"),this.networkControllers.forEach(e=>{e.resumeBuffering&&e.resumeBuffering()}))}pauseBuffering(){this.bufferingEnabled&&(this.logger.log("pause buffering"),this.networkControllers.forEach(e=>{e.pauseBuffering&&e.pauseBuffering()}))}get inFlightFragments(){const e={[ke.MAIN]:this.streamController.inFlightFrag};return this.audioStreamController&&(e[ke.AUDIO]=this.audioStreamController.inFlightFrag),this.subtititleStreamController&&(e[ke.SUBTITLE]=this.subtititleStreamController.inFlightFrag),e}swapAudioCodec(){this.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()}recoverMediaError(){this.logger.log("recoverMediaError");const e=this._media,t=e==null?void 0:e.currentTime;this.detachMedia(),e&&(this.attachMedia(e),t&&this.startLoad(t))}removeLevel(e){this.levelController.removeLevel(e)}get sessionId(){let e=this._sessionId;return e||(e=this._sessionId=RM()),e}get levels(){const e=this.levelController.levels;return e||[]}get latestLevelDetails(){return this.streamController.getLevelDetails()||null}get loadLevelObj(){return this.levelController.loadLevelObj}get currentLevel(){return this.streamController.currentLevel}set currentLevel(e){this.logger.log(`set currentLevel:${e}`),this.levelController.manualLevel=e,this.streamController.immediateLevelSwitch()}get nextLevel(){return this.streamController.nextLevel}set nextLevel(e){this.logger.log(`set nextLevel:${e}`),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}get loadLevel(){return this.levelController.level}set loadLevel(e){this.logger.log(`set loadLevel:${e}`),this.levelController.manualLevel=e}get nextLoadLevel(){return this.levelController.nextLoadLevel}set nextLoadLevel(e){this.levelController.nextLoadLevel=e}get firstLevel(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)}set firstLevel(e){this.logger.log(`set firstLevel:${e}`),this.levelController.firstLevel=e}get startLevel(){const e=this.levelController.startLevel;return e===-1&&this.abrController.forcedAutoLevel>-1?this.abrController.forcedAutoLevel:e}set startLevel(e){this.logger.log(`set startLevel:${e}`),e!==-1&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e}get capLevelToPlayerSize(){return this.config.capLevelToPlayerSize}set capLevelToPlayerSize(e){const t=!!e;t!==this.config.capLevelToPlayerSize&&(t?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=t)}get autoLevelCapping(){return this._autoLevelCapping}get bandwidthEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimate():NaN}set bandwidthEstimate(e){this.abrController.resetEstimator(e)}get abrEwmaDefaultEstimate(){const{bwEstimator:e}=this.abrController;return e?e.defaultEstimate:NaN}get ttfbEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimateTTFB():NaN}set autoLevelCapping(e){this._autoLevelCapping!==e&&(this.logger.log(`set autoLevelCapping:${e}`),this._autoLevelCapping=e,this.levelController.checkMaxAutoUpdated())}get maxHdcpLevel(){return this._maxHdcpLevel}set maxHdcpLevel(e){Bw(e)&&this._maxHdcpLevel!==e&&(this._maxHdcpLevel=e,this.levelController.checkMaxAutoUpdated())}get autoLevelEnabled(){return this.levelController.manualLevel===-1}get manualLevel(){return this.levelController.manualLevel}get minAutoLevel(){const{levels:e,config:{minAutoBitrate:t}}=this;if(!e)return 0;const r=e.length;for(let n=0;n<r;n++)if(e[n].maxBitrate>=t)return n;return 0}get maxAutoLevel(){const{levels:e,autoLevelCapping:t,maxHdcpLevel:r}=this;let n;if(t===-1&&e!=null&&e.length?n=e.length-1:n=t,r)for(let s=n;s--;){const a=e[s].attrs["HDCP-LEVEL"];if(a&&a<=r)return s}return n}get firstAutoLevel(){return this.abrController.firstAutoLevel}get nextAutoLevel(){return this.abrController.nextAutoLevel}set nextAutoLevel(e){this.abrController.nextAutoLevel=e}get playingDate(){return this.streamController.currentProgramDateTime}get mainForwardBufferInfo(){return this.streamController.getMainFwdBufferInfo()}get maxBufferLength(){return this.streamController.maxBufferLength}setAudioOption(e){var t;return((t=this.audioTrackController)==null?void 0:t.setAudioOption(e))||null}setSubtitleOption(e){var t;return((t=this.subtitleTrackController)==null?void 0:t.setSubtitleOption(e))||null}get allAudioTracks(){const e=this.audioTrackController;return e?e.allAudioTracks:[]}get audioTracks(){const e=this.audioTrackController;return e?e.audioTracks:[]}get audioTrack(){const e=this.audioTrackController;return e?e.audioTrack:-1}set audioTrack(e){const t=this.audioTrackController;t&&(t.audioTrack=e)}get allSubtitleTracks(){const e=this.subtitleTrackController;return e?e.allSubtitleTracks:[]}get subtitleTracks(){const e=this.subtitleTrackController;return e?e.subtitleTracks:[]}get subtitleTrack(){const e=this.subtitleTrackController;return e?e.subtitleTrack:-1}get media(){return this._media}set subtitleTrack(e){const t=this.subtitleTrackController;t&&(t.subtitleTrack=e)}get subtitleDisplay(){const e=this.subtitleTrackController;return e?e.subtitleDisplay:!1}set subtitleDisplay(e){const t=this.subtitleTrackController;t&&(t.subtitleDisplay=e)}get lowLatencyMode(){return this.config.lowLatencyMode}set lowLatencyMode(e){this.config.lowLatencyMode=e}get liveSyncPosition(){return this.latencyController.liveSyncPosition}get latency(){return this.latencyController.latency}get maxLatency(){return this.latencyController.maxLatency}get targetLatency(){return this.latencyController.targetLatency}set targetLatency(e){this.latencyController.targetLatency=e}get drift(){return this.latencyController.drift}get forceStartLoad(){return this.streamController.forceStartLoad}get pathways(){return this.levelController.pathways}get pathwayPriority(){return this.levelController.pathwayPriority}set pathwayPriority(e){this.levelController.pathwayPriority=e}get bufferedToEnd(){var e;return!!((e=this.bufferController)!=null&&e.bufferedToEnd)}get interstitialsManager(){var e;return((e=this.interstitialsController)==null?void 0:e.interstitialsManager)||null}getMediaDecodingInfo(e,t=this.allAudioTracks){const r=ZE(t);return jE(e,r,navigator.mediaCapabilities)}}Mi.defaultConfig=void 0;class l2{async getIsLive(e,t){const r=t.media;return r.duration===1/0?!0:r.readyState<2&&Number.isNaN(r.duration)?this.waitForMediaMetadataLoad(r).then(n=>this.processLoadedDurationForLiveDetection(n,r)):!1}async processLoadedDurationForLiveDetection(e,t){return Number.isNaN(e)?(console.warn("Setting video as non-live due to metadata loading timeout"),!1):this.detectDurationIncreaseAsLive(t)}async waitForMediaMetadataLoad(e){return new Promise(t=>{Le(e).one("loadedmetadata",()=>t(e.duration)),setTimeout(()=>{t(NaN)},3e3)})}async detectDurationIncreaseAsLive(e){const t=e.duration,r=es(100).pipe(lr(()=>e.duration),Tr(n=>n>t),ts(1),lr(()=>!0),P0({each:3e3,with:()=>(console.warn("Duration remained unchanged after 3 seconds, determined as non-live video"),or(!1))}),zl(()=>(console.warn("Exception occurred during duration-based live detection, fallback to non-live video"),or(!1))));return Oh(r)}}class u2{async getIsLive(e,t){if(!Mi.isSupported())return console.warn("HLS is not supported, falling back to duration-based live detection"),new l2().getIsLive(e,t);const r=t.getParam("m3u8Url");if(!r)throw console.error("M3U8 URL is required for M3U8-based live detection"),new Error("M3U8 URL parameter is missing");const n=new Mi;return n.loadSource(r),new Promise((s,a)=>{n.on(Mi.Events.LEVEL_LOADED,(o,l)=>{s(l.details.live)}),n.on(Mi.Events.ERROR,function(o,l){a(l)})}).catch(s=>new l2().getIsLive(e,t))}}class BP{getIsPrivate(e,t){if(!t.data)throw console.error("Context vo object is missing, unable to extract private video status using JSONPath"),Error("Context vo object is missing, unable to extract private video status using JSONPath");if(It.isEmpty(e.values))throw console.error("Private video extraction configuration is missing JSONPath values property",e),new Error("Private video extraction configuration is missing JSONPath values property");return Vt.extractBooleanByJsonPath(e.values,e.computeType,t.data)}}class UP{getChannelId(e,t){if(!t.data)throw console.error("Context vo object is missing, unable to extract channelId using JSONPath",t),Error("Context vo object is missing, unable to extract channelId using JSONPath");return Ji(t.data,e.value)}}class $P{extractDuration(e,t){if(!t.data)throw console.error("Context vo object is missing, unable to extract duration using JSONPath",t),Error("Context vo object is missing, unable to extract duration using JSONPath");return Number(Ji(t.data,e.value))}}class GP{extractSupportLanguage(e,t){if(!t.data)throw console.error("Context vo object is missing, unable to extract support language using JSONPath",t),Error("Context vo object is missing, unable to extract support language using JSONPath");return Ji(t.data,e.value)}}const Fn=class Fn{static isWeakPunctuation(e){return this.WEAK_PUNCTUATION.has(e)}static isPunctuation(e){return this.SENTENCE_ENDING_PUNCTUATION.has(e)}static endsWithPunctuation(e){if(!e||e.trim().length===0)return!1;const t=e.trim(),r=t.charAt(t.length-1);return Fn.isPunctuation(r)}static containsOnlyPunctuationAndSpaces(e){if(!e||e.trim().length===0)return!0;let t=!1;for(let r=0;r<e.length;r++){const n=e.charAt(r);if(n.trim().length!==0){if(Fn.isPunctuation(n)||Fn.isWeakPunctuation(n)||Fn.DECORATIVE_PUNCTUATION.has(n)){t=!0;continue}return!1}}return t}};re(Fn,"SENTENCE_ENDING_PUNCTUATION",new Set([".","!","?",";",":","。","！","？","；","：","…","‥","⋯","⋮","⋰","⋱","؟","؍","؎","؏","¿","¡","·","։","՜","՞","՟","׃","׆","ฯ","๚","๛","।","॥","‽","‼","⁇","⁈","⁉","⁏"])),re(Fn,"WEAK_PUNCTUATION",new Set([",","，",";","；",":","："])),re(Fn,"DECORATIVE_PUNCTUATION",new Set(['"',"'","“","”","‘","’","«","»","‹","›","「","」","『","』","《","》","〈","〉","（","）","(",")","【","】","[","]","{","}"]));let jt=Fn;var ep,c2;function qP(){if(c2)return ep;c2=1,ep=e;function i(r){return r instanceof Buffer?Buffer.from(r):new r.constructor(r.buffer.slice(),r.byteOffset,r.length)}function e(r){if(r=r||{},r.circles)return t(r);const n=new Map;if(n.set(Date,u=>new Date(u)),n.set(Map,(u,h)=>new Map(a(Array.from(u),h))),n.set(Set,(u,h)=>new Set(a(Array.from(u),h))),r.constructorHandlers)for(const u of r.constructorHandlers)n.set(u[0],u[1]);let s=null;return r.proto?l:o;function a(u,h){const d=Object.keys(u),p=new Array(d.length);for(let g=0;g<d.length;g++){const m=d[g],v=u[m];typeof v!="object"||v===null?p[m]=v:v.constructor!==Object&&(s=n.get(v.constructor))?p[m]=s(v,h):ArrayBuffer.isView(v)?p[m]=i(v):p[m]=h(v)}return p}function o(u){if(typeof u!="object"||u===null)return u;if(Array.isArray(u))return a(u,o);if(u.constructor!==Object&&(s=n.get(u.constructor)))return s(u,o);const h={};for(const d in u){if(Object.hasOwnProperty.call(u,d)===!1)continue;const p=u[d];typeof p!="object"||p===null?h[d]=p:p.constructor!==Object&&(s=n.get(p.constructor))?h[d]=s(p,o):ArrayBuffer.isView(p)?h[d]=i(p):h[d]=o(p)}return h}function l(u){if(typeof u!="object"||u===null)return u;if(Array.isArray(u))return a(u,l);if(u.constructor!==Object&&(s=n.get(u.constructor)))return s(u,l);const h={};for(const d in u){const p=u[d];typeof p!="object"||p===null?h[d]=p:p.constructor!==Object&&(s=n.get(p.constructor))?h[d]=s(p,l):ArrayBuffer.isView(p)?h[d]=i(p):h[d]=l(p)}return h}}function t(r){const n=[],s=[],a=new Map;if(a.set(Date,d=>new Date(d)),a.set(Map,(d,p)=>new Map(l(Array.from(d),p))),a.set(Set,(d,p)=>new Set(l(Array.from(d),p))),r.constructorHandlers)for(const d of r.constructorHandlers)a.set(d[0],d[1]);let o=null;return r.proto?h:u;function l(d,p){const g=Object.keys(d),m=new Array(g.length);for(let v=0;v<g.length;v++){const E=g[v],A=d[E];if(typeof A!="object"||A===null)m[E]=A;else if(A.constructor!==Object&&(o=a.get(A.constructor)))m[E]=o(A,p);else if(ArrayBuffer.isView(A))m[E]=i(A);else{const D=n.indexOf(A);D!==-1?m[E]=s[D]:m[E]=p(A)}}return m}function u(d){if(typeof d!="object"||d===null)return d;if(Array.isArray(d))return l(d,u);if(d.constructor!==Object&&(o=a.get(d.constructor)))return o(d,u);const p={};n.push(d),s.push(p);for(const g in d){if(Object.hasOwnProperty.call(d,g)===!1)continue;const m=d[g];if(typeof m!="object"||m===null)p[g]=m;else if(m.constructor!==Object&&(o=a.get(m.constructor)))p[g]=o(m,u);else if(ArrayBuffer.isView(m))p[g]=i(m);else{const v=n.indexOf(m);v!==-1?p[g]=s[v]:p[g]=u(m)}}return n.pop(),s.pop(),p}function h(d){if(typeof d!="object"||d===null)return d;if(Array.isArray(d))return l(d,h);if(d.constructor!==Object&&(o=a.get(d.constructor)))return o(d,h);const p={};n.push(d),s.push(p);for(const g in d){const m=d[g];if(typeof m!="object"||m===null)p[g]=m;else if(m.constructor!==Object&&(o=a.get(m.constructor)))p[g]=o(m,h);else if(ArrayBuffer.isView(m))p[g]=i(m);else{const v=n.indexOf(m);v!==-1?p[g]=s[v]:p[g]=h(m)}}return n.pop(),s.pop(),p}}return ep}var VP=qP();const h2=Vs(VP);/**
 * @name codsen-utils
 * @fileoverview Various utility functions
 * @version 1.6.7
 * @author Roy Revelt, Codsen Ltd
 * @license MIT
 * {@link https://codsen.com/os/codsen-utils/}
 */h2();function tp(i){if(i==null||typeof i!="object")return!1;let e=Object.getPrototypeOf(i);return e!==null&&e!==Object.prototype&&Object.getPrototypeOf(e)!==null?!1:!(Symbol.iterator in i)&&!(Symbol.toStringTag in i)}function ja(i){return typeof i=="string"}function ms(i){return Number.isSafeInteger(i)&&i>=0}function ys(i){return i!=null}function HP(i,e){return tp(i)&&ja(e)&&e in i}var KP=typeof global=="object"&&global&&global.Object===Object&&global,WP=typeof self=="object"&&self&&self.Object===Object&&self,rp=KP||WP||Function("return this")(),za=rp.Symbol,d2=Object.prototype,YP=d2.hasOwnProperty,XP=d2.toString,hl=za?za.toStringTag:void 0;function jP(i){var e=YP.call(i,hl),t=i[hl];try{i[hl]=void 0;var r=!0}catch{}var n=XP.call(i);return r&&(e?i[hl]=t:delete i[hl]),n}var zP=Object.prototype,JP=zP.toString;function QP(i){return JP.call(i)}var ZP="[object Null]",ek="[object Undefined]",f2=za?za.toStringTag:void 0;function g2(i){return i==null?i===void 0?ek:ZP:f2&&f2 in Object(i)?jP(i):QP(i)}function p2(i){return i!=null&&typeof i=="object"}var tk="[object Symbol]";function rk(i){return typeof i=="symbol"||p2(i)&&g2(i)==tk}function ik(i,e){for(var t=-1,r=i==null?0:i.length,n=Array(r);++t<r;)n[t]=e(i[t],t,i);return n}var nk=Array.isArray,m2=za?za.prototype:void 0,y2=m2?m2.toString:void 0;function ip(i){if(typeof i=="string")return i;if(nk(i))return ik(i,ip)+"";if(rk(i))return y2?y2.call(i):"";var e=i+"";return e=="0"&&1/i==-1/0?"-0":e}var sk=/\s/;function ak(i){for(var e=i.length;e--&&sk.test(i.charAt(e)););return e}var ok=/^\s+/;function lk(i){return i&&i.slice(0,ak(i)+1).replace(ok,"")}function v2(i){var e=typeof i;return i!=null&&(e=="object"||e=="function")}function E2(i){return i}var uk="[object AsyncFunction]",ck="[object Function]",hk="[object GeneratorFunction]",dk="[object Proxy]";function b2(i){if(!v2(i))return!1;var e=g2(i);return e==ck||e==hk||e==uk||e==dk}var np=rp["__core-js_shared__"],A2=function(){var i=/[^.]+$/.exec(np&&np.keys&&np.keys.IE_PROTO||"");return i?"Symbol(src)_1."+i:""}();function fk(i){return!!A2&&A2 in i}var gk=Function.prototype,pk=gk.toString;function mk(i){if(i!=null){try{return pk.call(i)}catch{}try{return i+""}catch{}}return""}var yk=/[\\^$.*+?()[\]{}|]/g,vk=/^\[object .+?Constructor\]$/,Ek=Function.prototype,bk=Object.prototype,Ak=Ek.toString,Sk=bk.hasOwnProperty,xk=RegExp("^"+Ak.call(Sk).replace(yk,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Tk(i){if(!v2(i)||fk(i))return!1;var e=b2(i)?xk:vk;return e.test(mk(i))}function Dk(i,e){return i==null?void 0:i[e]}function sp(i,e){var t=Dk(i,e);return Tk(t)?t:void 0}function Rk(i,e,t){switch(t.length){case 0:return i.call(e);case 1:return i.call(e,t[0]);case 2:return i.call(e,t[0],t[1]);case 3:return i.call(e,t[0],t[1],t[2])}return i.apply(e,t)}var Ik=800,Nk=16,Ck=Date.now;function wk(i){var e=0,t=0;return function(){var r=Ck(),n=Nk-(r-t);if(t=r,n>0){if(++e>=Ik)return arguments[0]}else e=0;return i.apply(void 0,arguments)}}function Lk(i){return function(){return i}}var S2=function(){try{var i=sp(Object,"defineProperty");return i({},"",{}),i}catch{}}(),_k=S2?function(i,e){return S2(i,"toString",{configurable:!0,enumerable:!1,value:Lk(e),writable:!0})}:E2,Mk=wk(_k);function Pk(i,e,t,r){for(var n=i.length,s=t+-1;++s<n;)if(e(i[s],s,i))return s;return-1}function kk(i){return i!==i}function Ok(i,e,t){for(var r=t-1,n=i.length;++r<n;)if(i[r]===e)return r;return-1}function ap(i,e,t){return e===e?Ok(i,e,t):Pk(i,kk,t)}function Fk(i,e){var t=i==null?0:i.length;return!!t&&ap(i,e,0)>-1}function Bk(i,e){return i===e||i!==i&&e!==e}var x2=Math.max;function Uk(i,e,t){return e=x2(e===void 0?i.length-1:e,0),function(){for(var r=arguments,n=-1,s=x2(r.length-e,0),a=Array(s);++n<s;)a[n]=r[e+n];n=-1;for(var o=Array(e+1);++n<e;)o[n]=r[n];return o[e]=t(a),Rk(i,this,o)}}function $k(i,e){return Mk(Uk(i,e,E2),i+"")}var Gk=9007199254740991;function qk(i){return typeof i=="number"&&i>-1&&i%1==0&&i<=Gk}function Vk(i){return i!=null&&qk(i.length)&&!b2(i)}var dl=sp(Object,"create");function Hk(){this.__data__=dl?dl(null):{},this.size=0}function Kk(i){var e=this.has(i)&&delete this.__data__[i];return this.size-=e?1:0,e}var Wk="__lodash_hash_undefined__",Yk=Object.prototype,Xk=Yk.hasOwnProperty;function jk(i){var e=this.__data__;if(dl){var t=e[i];return t===Wk?void 0:t}return Xk.call(e,i)?e[i]:void 0}var zk=Object.prototype,Jk=zk.hasOwnProperty;function Qk(i){var e=this.__data__;return dl?e[i]!==void 0:Jk.call(e,i)}var Zk="__lodash_hash_undefined__";function eO(i,e){var t=this.__data__;return this.size+=this.has(i)?0:1,t[i]=dl&&e===void 0?Zk:e,this}function Js(i){var e=-1,t=i==null?0:i.length;for(this.clear();++e<t;){var r=i[e];this.set(r[0],r[1])}}Js.prototype.clear=Hk,Js.prototype.delete=Kk,Js.prototype.get=jk,Js.prototype.has=Qk,Js.prototype.set=eO;function tO(){this.__data__=[],this.size=0}function fc(i,e){for(var t=i.length;t--;)if(Bk(i[t][0],e))return t;return-1}var rO=Array.prototype,iO=rO.splice;function nO(i){var e=this.__data__,t=fc(e,i);if(t<0)return!1;var r=e.length-1;return t==r?e.pop():iO.call(e,t,1),--this.size,!0}function sO(i){var e=this.__data__,t=fc(e,i);return t<0?void 0:e[t][1]}function aO(i){return fc(this.__data__,i)>-1}function oO(i,e){var t=this.__data__,r=fc(t,i);return r<0?(++this.size,t.push([i,e])):t[r][1]=e,this}function Ja(i){var e=-1,t=i==null?0:i.length;for(this.clear();++e<t;){var r=i[e];this.set(r[0],r[1])}}Ja.prototype.clear=tO,Ja.prototype.delete=nO,Ja.prototype.get=sO,Ja.prototype.has=aO,Ja.prototype.set=oO;var lO=sp(rp,"Map");function uO(){this.size=0,this.__data__={hash:new Js,map:new(lO||Ja),string:new Js}}function cO(i){var e=typeof i;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?i!=="__proto__":i===null}function gc(i,e){var t=i.__data__;return cO(e)?t[typeof e=="string"?"string":"hash"]:t.map}function hO(i){var e=gc(this,i).delete(i);return this.size-=e?1:0,e}function dO(i){return gc(this,i).get(i)}function fO(i){return gc(this,i).has(i)}function gO(i,e){var t=gc(this,i),r=t.size;return t.set(i,e),this.size+=t.size==r?0:1,this}function Qa(i){var e=-1,t=i==null?0:i.length;for(this.clear();++e<t;){var r=i[e];this.set(r[0],r[1])}}Qa.prototype.clear=uO,Qa.prototype.delete=hO,Qa.prototype.get=dO,Qa.prototype.has=fO,Qa.prototype.set=gO;function pO(i){return i==null?"":ip(i)}function mO(i,e,t){var r=-1,n=i.length;e<0&&(e=-e>n?0:n+e),t=t>n?n:t,t<0&&(t+=n),n=e>t?0:t-e>>>0,e>>>=0;for(var s=Array(n);++r<n;)s[r]=i[r+e];return s}function yO(i,e,t){var r=i.length;return t=t===void 0?r:t,!e&&t>=r?i:mO(i,e,t)}var vO="\\ud800-\\udfff",EO="\\u0300-\\u036f",bO="\\ufe20-\\ufe2f",AO="\\u20d0-\\u20ff",SO=EO+bO+AO,xO="\\ufe0e\\ufe0f",TO="\\u200d",DO=RegExp("["+TO+vO+SO+xO+"]");function RO(i){return DO.test(i)}function IO(i){return i.split("")}var T2="\\ud800-\\udfff",NO="\\u0300-\\u036f",CO="\\ufe20-\\ufe2f",wO="\\u20d0-\\u20ff",LO=NO+CO+wO,_O="\\ufe0e\\ufe0f",MO="["+T2+"]",op="["+LO+"]",lp="\\ud83c[\\udffb-\\udfff]",PO="(?:"+op+"|"+lp+")",D2="[^"+T2+"]",R2="(?:\\ud83c[\\udde6-\\uddff]){2}",I2="[\\ud800-\\udbff][\\udc00-\\udfff]",kO="\\u200d",N2=PO+"?",C2="["+_O+"]?",OO="(?:"+kO+"(?:"+[D2,R2,I2].join("|")+")"+C2+N2+")*",FO=C2+N2+OO,BO="(?:"+[D2+op+"?",op,R2,I2,MO].join("|")+")",UO=RegExp(lp+"(?="+lp+")|"+BO+FO,"g");function $O(i){return i.match(UO)||[]}function w2(i){return RO(i)?$O(i):IO(i)}var GO="__lodash_hash_undefined__";function qO(i){return this.__data__.set(i,GO),this}function VO(i){return this.__data__.has(i)}function pc(i){var e=-1,t=i==null?0:i.length;for(this.__data__=new Qa;++e<t;)this.add(i[e])}pc.prototype.add=pc.prototype.push=qO,pc.prototype.has=VO;function HO(i,e){return i.has(e)}function KO(i){return p2(i)&&Vk(i)}var WO=200;function YO(i,e,t,r){var n=-1,s=Fk,a=!0,o=i.length,l=[],u=e.length;if(!o)return l;e.length>=WO&&(s=HO,a=!1,e=new pc(e));e:for(;++n<o;){var h=i[n],d=h;if(h=h!==0?h:0,a&&d===d){for(var p=u;p--;)if(e[p]===d)continue e;l.push(h)}else s(e,d,r)||l.push(h)}return l}function XO(i,e){for(var t=i.length;t--&&ap(e,i[t],0)>-1;);return t}function jO(i,e){for(var t=-1,r=i.length;++t<r&&ap(e,i[t],0)>-1;);return t}function L2(i,e,t){if(i=pO(i),i&&e===void 0)return lk(i);if(!i||!(e=ip(e)))return i;var r=w2(i),n=w2(e),s=jO(r,n),a=XO(r,n)+1;return yO(r,s,a).join("")}var zO=$k(function(i,e){return KO(i)?YO(i,e):[]}),Za=function(){return Za=Object.assign||function(i){for(var e,t=1,r=arguments.length;t<r;t++){e=arguments[t];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(i[n]=e[n])}return i},Za.apply(this,arguments)},JO="~",QO="~~";function up(i,e){for(var t={},r={},n=i.split(QO),s=!1,a=0;n.length>a;a++){for(var o=n[a].split(JO),l=0;l<o.length;l+=2){var u=o[l],h=o[l+1],d="&"+u+";";t[d]=h,s&&(t["&"+u]=h),r[h]=d}s=!0}return e?{entities:Za(Za({},t),e.entities),characters:Za(Za({},r),e.characters)}:{entities:t,characters:r}}var cp={xml:/&(?:#\d+|#[xX][\da-fA-F]+|[0-9a-zA-Z]+);?/g,html4:/&notin;|&(?:nbsp|iexcl|cent|pound|curren|yen|brvbar|sect|uml|copy|ordf|laquo|not|shy|reg|macr|deg|plusmn|sup2|sup3|acute|micro|para|middot|cedil|sup1|ordm|raquo|frac14|frac12|frac34|iquest|Agrave|Aacute|Acirc|Atilde|Auml|Aring|AElig|Ccedil|Egrave|Eacute|Ecirc|Euml|Igrave|Iacute|Icirc|Iuml|ETH|Ntilde|Ograve|Oacute|Ocirc|Otilde|Ouml|times|Oslash|Ugrave|Uacute|Ucirc|Uuml|Yacute|THORN|szlig|agrave|aacute|acirc|atilde|auml|aring|aelig|ccedil|egrave|eacute|ecirc|euml|igrave|iacute|icirc|iuml|eth|ntilde|ograve|oacute|ocirc|otilde|ouml|divide|oslash|ugrave|uacute|ucirc|uuml|yacute|thorn|yuml|quot|amp|lt|gt|#\d+|#[xX][\da-fA-F]+|[0-9a-zA-Z]+);?/g,html5:/&centerdot;|&copysr;|&divideontimes;|&gtcc;|&gtcir;|&gtdot;|&gtlPar;|&gtquest;|&gtrapprox;|&gtrarr;|&gtrdot;|&gtreqless;|&gtreqqless;|&gtrless;|&gtrsim;|&ltcc;|&ltcir;|&ltdot;|&lthree;|&ltimes;|&ltlarr;|&ltquest;|&ltrPar;|&ltri;|&ltrie;|&ltrif;|&notin;|&notinE;|&notindot;|&notinva;|&notinvb;|&notinvc;|&notni;|&notniva;|&notnivb;|&notnivc;|&parallel;|&timesb;|&timesbar;|&timesd;|&(?:AElig|AMP|Aacute|Acirc|Agrave|Aring|Atilde|Auml|COPY|Ccedil|ETH|Eacute|Ecirc|Egrave|Euml|GT|Iacute|Icirc|Igrave|Iuml|LT|Ntilde|Oacute|Ocirc|Ograve|Oslash|Otilde|Ouml|QUOT|REG|THORN|Uacute|Ucirc|Ugrave|Uuml|Yacute|aacute|acirc|acute|aelig|agrave|amp|aring|atilde|auml|brvbar|ccedil|cedil|cent|copy|curren|deg|divide|eacute|ecirc|egrave|eth|euml|frac12|frac14|frac34|gt|iacute|icirc|iexcl|igrave|iquest|iuml|laquo|lt|macr|micro|middot|nbsp|not|ntilde|oacute|ocirc|ograve|ordf|ordm|oslash|otilde|ouml|para|plusmn|pound|quot|raquo|reg|sect|shy|sup1|sup2|sup3|szlig|thorn|times|uacute|ucirc|ugrave|uml|uuml|yacute|yen|yuml|#\d+|#[xX][\da-fA-F]+|[0-9a-zA-Z]+);?/g},eo={};eo.xml=up(`lt~<~gt~>~quot~"~apos~'~amp~&`),eo.html4=up(`apos~'~OElig~Œ~oelig~œ~Scaron~Š~scaron~š~Yuml~Ÿ~circ~ˆ~tilde~˜~ensp~ ~emsp~ ~thinsp~ ~zwnj~‌~zwj~‍~lrm~‎~rlm~‏~ndash~–~mdash~—~lsquo~‘~rsquo~’~sbquo~‚~ldquo~“~rdquo~”~bdquo~„~dagger~†~Dagger~‡~permil~‰~lsaquo~‹~rsaquo~›~euro~€~fnof~ƒ~Alpha~Α~Beta~Β~Gamma~Γ~Delta~Δ~Epsilon~Ε~Zeta~Ζ~Eta~Η~Theta~Θ~Iota~Ι~Kappa~Κ~Lambda~Λ~Mu~Μ~Nu~Ν~Xi~Ξ~Omicron~Ο~Pi~Π~Rho~Ρ~Sigma~Σ~Tau~Τ~Upsilon~Υ~Phi~Φ~Chi~Χ~Psi~Ψ~Omega~Ω~alpha~α~beta~β~gamma~γ~delta~δ~epsilon~ε~zeta~ζ~eta~η~theta~θ~iota~ι~kappa~κ~lambda~λ~mu~μ~nu~ν~xi~ξ~omicron~ο~pi~π~rho~ρ~sigmaf~ς~sigma~σ~tau~τ~upsilon~υ~phi~φ~chi~χ~psi~ψ~omega~ω~thetasym~ϑ~upsih~ϒ~piv~ϖ~bull~•~hellip~…~prime~′~Prime~″~oline~‾~frasl~⁄~weierp~℘~image~ℑ~real~ℜ~trade~™~alefsym~ℵ~larr~←~uarr~↑~rarr~→~darr~↓~harr~↔~crarr~↵~lArr~⇐~uArr~⇑~rArr~⇒~dArr~⇓~hArr~⇔~forall~∀~part~∂~exist~∃~empty~∅~nabla~∇~isin~∈~notin~∉~ni~∋~prod~∏~sum~∑~minus~−~lowast~∗~radic~√~prop~∝~infin~∞~ang~∠~and~∧~or~∨~cap~∩~cup~∪~int~∫~there4~∴~sim~∼~cong~≅~asymp~≈~ne~≠~equiv~≡~le~≤~ge~≥~sub~⊂~sup~⊃~nsub~⊄~sube~⊆~supe~⊇~oplus~⊕~otimes~⊗~perp~⊥~sdot~⋅~lceil~⌈~rceil~⌉~lfloor~⌊~rfloor~⌋~lang~〈~rang~〉~loz~◊~spades~♠~clubs~♣~hearts~♥~diams~♦~~nbsp~ ~iexcl~¡~cent~¢~pound~£~curren~¤~yen~¥~brvbar~¦~sect~§~uml~¨~copy~©~ordf~ª~laquo~«~not~¬~shy~­~reg~®~macr~¯~deg~°~plusmn~±~sup2~²~sup3~³~acute~´~micro~µ~para~¶~middot~·~cedil~¸~sup1~¹~ordm~º~raquo~»~frac14~¼~frac12~½~frac34~¾~iquest~¿~Agrave~À~Aacute~Á~Acirc~Â~Atilde~Ã~Auml~Ä~Aring~Å~AElig~Æ~Ccedil~Ç~Egrave~È~Eacute~É~Ecirc~Ê~Euml~Ë~Igrave~Ì~Iacute~Í~Icirc~Î~Iuml~Ï~ETH~Ð~Ntilde~Ñ~Ograve~Ò~Oacute~Ó~Ocirc~Ô~Otilde~Õ~Ouml~Ö~times~×~Oslash~Ø~Ugrave~Ù~Uacute~Ú~Ucirc~Û~Uuml~Ü~Yacute~Ý~THORN~Þ~szlig~ß~agrave~à~aacute~á~acirc~â~atilde~ã~auml~ä~aring~å~aelig~æ~ccedil~ç~egrave~è~eacute~é~ecirc~ê~euml~ë~igrave~ì~iacute~í~icirc~î~iuml~ï~eth~ð~ntilde~ñ~ograve~ò~oacute~ó~ocirc~ô~otilde~õ~ouml~ö~divide~÷~oslash~ø~ugrave~ù~uacute~ú~ucirc~û~uuml~ü~yacute~ý~thorn~þ~yuml~ÿ~quot~"~amp~&~lt~<~gt~>`),eo.html5=up('Abreve~Ă~Acy~А~Afr~𝔄~Amacr~Ā~And~⩓~Aogon~Ą~Aopf~𝔸~ApplyFunction~⁡~Ascr~𝒜~Assign~≔~Backslash~∖~Barv~⫧~Barwed~⌆~Bcy~Б~Because~∵~Bernoullis~ℬ~Bfr~𝔅~Bopf~𝔹~Breve~˘~Bscr~ℬ~Bumpeq~≎~CHcy~Ч~Cacute~Ć~Cap~⋒~CapitalDifferentialD~ⅅ~Cayleys~ℭ~Ccaron~Č~Ccirc~Ĉ~Cconint~∰~Cdot~Ċ~Cedilla~¸~CenterDot~·~Cfr~ℭ~CircleDot~⊙~CircleMinus~⊖~CirclePlus~⊕~CircleTimes~⊗~ClockwiseContourIntegral~∲~CloseCurlyDoubleQuote~”~CloseCurlyQuote~’~Colon~∷~Colone~⩴~Congruent~≡~Conint~∯~ContourIntegral~∮~Copf~ℂ~Coproduct~∐~CounterClockwiseContourIntegral~∳~Cross~⨯~Cscr~𝒞~Cup~⋓~CupCap~≍~DD~ⅅ~DDotrahd~⤑~DJcy~Ђ~DScy~Ѕ~DZcy~Џ~Darr~↡~Dashv~⫤~Dcaron~Ď~Dcy~Д~Del~∇~Dfr~𝔇~DiacriticalAcute~´~DiacriticalDot~˙~DiacriticalDoubleAcute~˝~DiacriticalGrave~`~DiacriticalTilde~˜~Diamond~⋄~DifferentialD~ⅆ~Dopf~𝔻~Dot~¨~DotDot~⃜~DotEqual~≐~DoubleContourIntegral~∯~DoubleDot~¨~DoubleDownArrow~⇓~DoubleLeftArrow~⇐~DoubleLeftRightArrow~⇔~DoubleLeftTee~⫤~DoubleLongLeftArrow~⟸~DoubleLongLeftRightArrow~⟺~DoubleLongRightArrow~⟹~DoubleRightArrow~⇒~DoubleRightTee~⊨~DoubleUpArrow~⇑~DoubleUpDownArrow~⇕~DoubleVerticalBar~∥~DownArrow~↓~DownArrowBar~⤓~DownArrowUpArrow~⇵~DownBreve~̑~DownLeftRightVector~⥐~DownLeftTeeVector~⥞~DownLeftVector~↽~DownLeftVectorBar~⥖~DownRightTeeVector~⥟~DownRightVector~⇁~DownRightVectorBar~⥗~DownTee~⊤~DownTeeArrow~↧~Downarrow~⇓~Dscr~𝒟~Dstrok~Đ~ENG~Ŋ~Ecaron~Ě~Ecy~Э~Edot~Ė~Efr~𝔈~Element~∈~Emacr~Ē~EmptySmallSquare~◻~EmptyVerySmallSquare~▫~Eogon~Ę~Eopf~𝔼~Equal~⩵~EqualTilde~≂~Equilibrium~⇌~Escr~ℰ~Esim~⩳~Exists~∃~ExponentialE~ⅇ~Fcy~Ф~Ffr~𝔉~FilledSmallSquare~◼~FilledVerySmallSquare~▪~Fopf~𝔽~ForAll~∀~Fouriertrf~ℱ~Fscr~ℱ~GJcy~Ѓ~Gammad~Ϝ~Gbreve~Ğ~Gcedil~Ģ~Gcirc~Ĝ~Gcy~Г~Gdot~Ġ~Gfr~𝔊~Gg~⋙~Gopf~𝔾~GreaterEqual~≥~GreaterEqualLess~⋛~GreaterFullEqual~≧~GreaterGreater~⪢~GreaterLess~≷~GreaterSlantEqual~⩾~GreaterTilde~≳~Gscr~𝒢~Gt~≫~HARDcy~Ъ~Hacek~ˇ~Hat~^~Hcirc~Ĥ~Hfr~ℌ~HilbertSpace~ℋ~Hopf~ℍ~HorizontalLine~─~Hscr~ℋ~Hstrok~Ħ~HumpDownHump~≎~HumpEqual~≏~IEcy~Е~IJlig~Ĳ~IOcy~Ё~Icy~И~Idot~İ~Ifr~ℑ~Im~ℑ~Imacr~Ī~ImaginaryI~ⅈ~Implies~⇒~Int~∬~Integral~∫~Intersection~⋂~InvisibleComma~⁣~InvisibleTimes~⁢~Iogon~Į~Iopf~𝕀~Iscr~ℐ~Itilde~Ĩ~Iukcy~І~Jcirc~Ĵ~Jcy~Й~Jfr~𝔍~Jopf~𝕁~Jscr~𝒥~Jsercy~Ј~Jukcy~Є~KHcy~Х~KJcy~Ќ~Kcedil~Ķ~Kcy~К~Kfr~𝔎~Kopf~𝕂~Kscr~𝒦~LJcy~Љ~Lacute~Ĺ~Lang~⟪~Laplacetrf~ℒ~Larr~↞~Lcaron~Ľ~Lcedil~Ļ~Lcy~Л~LeftAngleBracket~⟨~LeftArrow~←~LeftArrowBar~⇤~LeftArrowRightArrow~⇆~LeftCeiling~⌈~LeftDoubleBracket~⟦~LeftDownTeeVector~⥡~LeftDownVector~⇃~LeftDownVectorBar~⥙~LeftFloor~⌊~LeftRightArrow~↔~LeftRightVector~⥎~LeftTee~⊣~LeftTeeArrow~↤~LeftTeeVector~⥚~LeftTriangle~⊲~LeftTriangleBar~⧏~LeftTriangleEqual~⊴~LeftUpDownVector~⥑~LeftUpTeeVector~⥠~LeftUpVector~↿~LeftUpVectorBar~⥘~LeftVector~↼~LeftVectorBar~⥒~Leftarrow~⇐~Leftrightarrow~⇔~LessEqualGreater~⋚~LessFullEqual~≦~LessGreater~≶~LessLess~⪡~LessSlantEqual~⩽~LessTilde~≲~Lfr~𝔏~Ll~⋘~Lleftarrow~⇚~Lmidot~Ŀ~LongLeftArrow~⟵~LongLeftRightArrow~⟷~LongRightArrow~⟶~Longleftarrow~⟸~Longleftrightarrow~⟺~Longrightarrow~⟹~Lopf~𝕃~LowerLeftArrow~↙~LowerRightArrow~↘~Lscr~ℒ~Lsh~↰~Lstrok~Ł~Lt~≪~Map~⤅~Mcy~М~MediumSpace~ ~Mellintrf~ℳ~Mfr~𝔐~MinusPlus~∓~Mopf~𝕄~Mscr~ℳ~NJcy~Њ~Nacute~Ń~Ncaron~Ň~Ncedil~Ņ~Ncy~Н~NegativeMediumSpace~​~NegativeThickSpace~​~NegativeThinSpace~​~NegativeVeryThinSpace~​~NestedGreaterGreater~≫~NestedLessLess~≪~NewLine~\n~Nfr~𝔑~NoBreak~⁠~NonBreakingSpace~ ~Nopf~ℕ~Not~⫬~NotCongruent~≢~NotCupCap~≭~NotDoubleVerticalBar~∦~NotElement~∉~NotEqual~≠~NotEqualTilde~≂̸~NotExists~∄~NotGreater~≯~NotGreaterEqual~≱~NotGreaterFullEqual~≧̸~NotGreaterGreater~≫̸~NotGreaterLess~≹~NotGreaterSlantEqual~⩾̸~NotGreaterTilde~≵~NotHumpDownHump~≎̸~NotHumpEqual~≏̸~NotLeftTriangle~⋪~NotLeftTriangleBar~⧏̸~NotLeftTriangleEqual~⋬~NotLess~≮~NotLessEqual~≰~NotLessGreater~≸~NotLessLess~≪̸~NotLessSlantEqual~⩽̸~NotLessTilde~≴~NotNestedGreaterGreater~⪢̸~NotNestedLessLess~⪡̸~NotPrecedes~⊀~NotPrecedesEqual~⪯̸~NotPrecedesSlantEqual~⋠~NotReverseElement~∌~NotRightTriangle~⋫~NotRightTriangleBar~⧐̸~NotRightTriangleEqual~⋭~NotSquareSubset~⊏̸~NotSquareSubsetEqual~⋢~NotSquareSuperset~⊐̸~NotSquareSupersetEqual~⋣~NotSubset~⊂⃒~NotSubsetEqual~⊈~NotSucceeds~⊁~NotSucceedsEqual~⪰̸~NotSucceedsSlantEqual~⋡~NotSucceedsTilde~≿̸~NotSuperset~⊃⃒~NotSupersetEqual~⊉~NotTilde~≁~NotTildeEqual~≄~NotTildeFullEqual~≇~NotTildeTilde~≉~NotVerticalBar~∤~Nscr~𝒩~Ocy~О~Odblac~Ő~Ofr~𝔒~Omacr~Ō~Oopf~𝕆~OpenCurlyDoubleQuote~“~OpenCurlyQuote~‘~Or~⩔~Oscr~𝒪~Otimes~⨷~OverBar~‾~OverBrace~⏞~OverBracket~⎴~OverParenthesis~⏜~PartialD~∂~Pcy~П~Pfr~𝔓~PlusMinus~±~Poincareplane~ℌ~Popf~ℙ~Pr~⪻~Precedes~≺~PrecedesEqual~⪯~PrecedesSlantEqual~≼~PrecedesTilde~≾~Product~∏~Proportion~∷~Proportional~∝~Pscr~𝒫~Qfr~𝔔~Qopf~ℚ~Qscr~𝒬~RBarr~⤐~Racute~Ŕ~Rang~⟫~Rarr~↠~Rarrtl~⤖~Rcaron~Ř~Rcedil~Ŗ~Rcy~Р~Re~ℜ~ReverseElement~∋~ReverseEquilibrium~⇋~ReverseUpEquilibrium~⥯~Rfr~ℜ~RightAngleBracket~⟩~RightArrow~→~RightArrowBar~⇥~RightArrowLeftArrow~⇄~RightCeiling~⌉~RightDoubleBracket~⟧~RightDownTeeVector~⥝~RightDownVector~⇂~RightDownVectorBar~⥕~RightFloor~⌋~RightTee~⊢~RightTeeArrow~↦~RightTeeVector~⥛~RightTriangle~⊳~RightTriangleBar~⧐~RightTriangleEqual~⊵~RightUpDownVector~⥏~RightUpTeeVector~⥜~RightUpVector~↾~RightUpVectorBar~⥔~RightVector~⇀~RightVectorBar~⥓~Rightarrow~⇒~Ropf~ℝ~RoundImplies~⥰~Rrightarrow~⇛~Rscr~ℛ~Rsh~↱~RuleDelayed~⧴~SHCHcy~Щ~SHcy~Ш~SOFTcy~Ь~Sacute~Ś~Sc~⪼~Scedil~Ş~Scirc~Ŝ~Scy~С~Sfr~𝔖~ShortDownArrow~↓~ShortLeftArrow~←~ShortRightArrow~→~ShortUpArrow~↑~SmallCircle~∘~Sopf~𝕊~Sqrt~√~Square~□~SquareIntersection~⊓~SquareSubset~⊏~SquareSubsetEqual~⊑~SquareSuperset~⊐~SquareSupersetEqual~⊒~SquareUnion~⊔~Sscr~𝒮~Star~⋆~Sub~⋐~Subset~⋐~SubsetEqual~⊆~Succeeds~≻~SucceedsEqual~⪰~SucceedsSlantEqual~≽~SucceedsTilde~≿~SuchThat~∋~Sum~∑~Sup~⋑~Superset~⊃~SupersetEqual~⊇~Supset~⋑~TRADE~™~TSHcy~Ћ~TScy~Ц~Tab~	~Tcaron~Ť~Tcedil~Ţ~Tcy~Т~Tfr~𝔗~Therefore~∴~ThickSpace~  ~ThinSpace~ ~Tilde~∼~TildeEqual~≃~TildeFullEqual~≅~TildeTilde~≈~Topf~𝕋~TripleDot~⃛~Tscr~𝒯~Tstrok~Ŧ~Uarr~↟~Uarrocir~⥉~Ubrcy~Ў~Ubreve~Ŭ~Ucy~У~Udblac~Ű~Ufr~𝔘~Umacr~Ū~UnderBar~_~UnderBrace~⏟~UnderBracket~⎵~UnderParenthesis~⏝~Union~⋃~UnionPlus~⊎~Uogon~Ų~Uopf~𝕌~UpArrow~↑~UpArrowBar~⤒~UpArrowDownArrow~⇅~UpDownArrow~↕~UpEquilibrium~⥮~UpTee~⊥~UpTeeArrow~↥~Uparrow~⇑~Updownarrow~⇕~UpperLeftArrow~↖~UpperRightArrow~↗~Upsi~ϒ~Uring~Ů~Uscr~𝒰~Utilde~Ũ~VDash~⊫~Vbar~⫫~Vcy~В~Vdash~⊩~Vdashl~⫦~Vee~⋁~Verbar~‖~Vert~‖~VerticalBar~∣~VerticalLine~|~VerticalSeparator~❘~VerticalTilde~≀~VeryThinSpace~ ~Vfr~𝔙~Vopf~𝕍~Vscr~𝒱~Vvdash~⊪~Wcirc~Ŵ~Wedge~⋀~Wfr~𝔚~Wopf~𝕎~Wscr~𝒲~Xfr~𝔛~Xopf~𝕏~Xscr~𝒳~YAcy~Я~YIcy~Ї~YUcy~Ю~Ycirc~Ŷ~Ycy~Ы~Yfr~𝔜~Yopf~𝕐~Yscr~𝒴~ZHcy~Ж~Zacute~Ź~Zcaron~Ž~Zcy~З~Zdot~Ż~ZeroWidthSpace~​~Zfr~ℨ~Zopf~ℤ~Zscr~𝒵~abreve~ă~ac~∾~acE~∾̳~acd~∿~acy~а~af~⁡~afr~𝔞~aleph~ℵ~amacr~ā~amalg~⨿~andand~⩕~andd~⩜~andslope~⩘~andv~⩚~ange~⦤~angle~∠~angmsd~∡~angmsdaa~⦨~angmsdab~⦩~angmsdac~⦪~angmsdad~⦫~angmsdae~⦬~angmsdaf~⦭~angmsdag~⦮~angmsdah~⦯~angrt~∟~angrtvb~⊾~angrtvbd~⦝~angsph~∢~angst~Å~angzarr~⍼~aogon~ą~aopf~𝕒~ap~≈~apE~⩰~apacir~⩯~ape~≊~apid~≋~approx~≈~approxeq~≊~ascr~𝒶~ast~*~asympeq~≍~awconint~∳~awint~⨑~bNot~⫭~backcong~≌~backepsilon~϶~backprime~‵~backsim~∽~backsimeq~⋍~barvee~⊽~barwed~⌅~barwedge~⌅~bbrk~⎵~bbrktbrk~⎶~bcong~≌~bcy~б~becaus~∵~because~∵~bemptyv~⦰~bepsi~϶~bernou~ℬ~beth~ℶ~between~≬~bfr~𝔟~bigcap~⋂~bigcirc~◯~bigcup~⋃~bigodot~⨀~bigoplus~⨁~bigotimes~⨂~bigsqcup~⨆~bigstar~★~bigtriangledown~▽~bigtriangleup~△~biguplus~⨄~bigvee~⋁~bigwedge~⋀~bkarow~⤍~blacklozenge~⧫~blacksquare~▪~blacktriangle~▴~blacktriangledown~▾~blacktriangleleft~◂~blacktriangleright~▸~blank~␣~blk12~▒~blk14~░~blk34~▓~block~█~bne~=⃥~bnequiv~≡⃥~bnot~⌐~bopf~𝕓~bot~⊥~bottom~⊥~bowtie~⋈~boxDL~╗~boxDR~╔~boxDl~╖~boxDr~╓~boxH~═~boxHD~╦~boxHU~╩~boxHd~╤~boxHu~╧~boxUL~╝~boxUR~╚~boxUl~╜~boxUr~╙~boxV~║~boxVH~╬~boxVL~╣~boxVR~╠~boxVh~╫~boxVl~╢~boxVr~╟~boxbox~⧉~boxdL~╕~boxdR~╒~boxdl~┐~boxdr~┌~boxh~─~boxhD~╥~boxhU~╨~boxhd~┬~boxhu~┴~boxminus~⊟~boxplus~⊞~boxtimes~⊠~boxuL~╛~boxuR~╘~boxul~┘~boxur~└~boxv~│~boxvH~╪~boxvL~╡~boxvR~╞~boxvh~┼~boxvl~┤~boxvr~├~bprime~‵~breve~˘~bscr~𝒷~bsemi~⁏~bsim~∽~bsime~⋍~bsol~\\~bsolb~⧅~bsolhsub~⟈~bullet~•~bump~≎~bumpE~⪮~bumpe~≏~bumpeq~≏~cacute~ć~capand~⩄~capbrcup~⩉~capcap~⩋~capcup~⩇~capdot~⩀~caps~∩︀~caret~⁁~caron~ˇ~ccaps~⩍~ccaron~č~ccirc~ĉ~ccups~⩌~ccupssm~⩐~cdot~ċ~cemptyv~⦲~centerdot~·~cfr~𝔠~chcy~ч~check~✓~checkmark~✓~cir~○~cirE~⧃~circeq~≗~circlearrowleft~↺~circlearrowright~↻~circledR~®~circledS~Ⓢ~circledast~⊛~circledcirc~⊚~circleddash~⊝~cire~≗~cirfnint~⨐~cirmid~⫯~cirscir~⧂~clubsuit~♣~colon~:~colone~≔~coloneq~≔~comma~,~commat~@~comp~∁~compfn~∘~complement~∁~complexes~ℂ~congdot~⩭~conint~∮~copf~𝕔~coprod~∐~copysr~℗~cross~✗~cscr~𝒸~csub~⫏~csube~⫑~csup~⫐~csupe~⫒~ctdot~⋯~cudarrl~⤸~cudarrr~⤵~cuepr~⋞~cuesc~⋟~cularr~↶~cularrp~⤽~cupbrcap~⩈~cupcap~⩆~cupcup~⩊~cupdot~⊍~cupor~⩅~cups~∪︀~curarr~↷~curarrm~⤼~curlyeqprec~⋞~curlyeqsucc~⋟~curlyvee~⋎~curlywedge~⋏~curvearrowleft~↶~curvearrowright~↷~cuvee~⋎~cuwed~⋏~cwconint~∲~cwint~∱~cylcty~⌭~dHar~⥥~daleth~ℸ~dash~‐~dashv~⊣~dbkarow~⤏~dblac~˝~dcaron~ď~dcy~д~dd~ⅆ~ddagger~‡~ddarr~⇊~ddotseq~⩷~demptyv~⦱~dfisht~⥿~dfr~𝔡~dharl~⇃~dharr~⇂~diam~⋄~diamond~⋄~diamondsuit~♦~die~¨~digamma~ϝ~disin~⋲~div~÷~divideontimes~⋇~divonx~⋇~djcy~ђ~dlcorn~⌞~dlcrop~⌍~dollar~$~dopf~𝕕~dot~˙~doteq~≐~doteqdot~≑~dotminus~∸~dotplus~∔~dotsquare~⊡~doublebarwedge~⌆~downarrow~↓~downdownarrows~⇊~downharpoonleft~⇃~downharpoonright~⇂~drbkarow~⤐~drcorn~⌟~drcrop~⌌~dscr~𝒹~dscy~ѕ~dsol~⧶~dstrok~đ~dtdot~⋱~dtri~▿~dtrif~▾~duarr~⇵~duhar~⥯~dwangle~⦦~dzcy~џ~dzigrarr~⟿~eDDot~⩷~eDot~≑~easter~⩮~ecaron~ě~ecir~≖~ecolon~≕~ecy~э~edot~ė~ee~ⅇ~efDot~≒~efr~𝔢~eg~⪚~egs~⪖~egsdot~⪘~el~⪙~elinters~⏧~ell~ℓ~els~⪕~elsdot~⪗~emacr~ē~emptyset~∅~emptyv~∅~emsp13~ ~emsp14~ ~eng~ŋ~eogon~ę~eopf~𝕖~epar~⋕~eparsl~⧣~eplus~⩱~epsi~ε~epsiv~ϵ~eqcirc~≖~eqcolon~≕~eqsim~≂~eqslantgtr~⪖~eqslantless~⪕~equals~=~equest~≟~equivDD~⩸~eqvparsl~⧥~erDot~≓~erarr~⥱~escr~ℯ~esdot~≐~esim~≂~excl~!~expectation~ℰ~exponentiale~ⅇ~fallingdotseq~≒~fcy~ф~female~♀~ffilig~ﬃ~fflig~ﬀ~ffllig~ﬄ~ffr~𝔣~filig~ﬁ~fjlig~fj~flat~♭~fllig~ﬂ~fltns~▱~fopf~𝕗~fork~⋔~forkv~⫙~fpartint~⨍~frac13~⅓~frac15~⅕~frac16~⅙~frac18~⅛~frac23~⅔~frac25~⅖~frac35~⅗~frac38~⅜~frac45~⅘~frac56~⅚~frac58~⅝~frac78~⅞~frown~⌢~fscr~𝒻~gE~≧~gEl~⪌~gacute~ǵ~gammad~ϝ~gap~⪆~gbreve~ğ~gcirc~ĝ~gcy~г~gdot~ġ~gel~⋛~geq~≥~geqq~≧~geqslant~⩾~ges~⩾~gescc~⪩~gesdot~⪀~gesdoto~⪂~gesdotol~⪄~gesl~⋛︀~gesles~⪔~gfr~𝔤~gg~≫~ggg~⋙~gimel~ℷ~gjcy~ѓ~gl~≷~glE~⪒~gla~⪥~glj~⪤~gnE~≩~gnap~⪊~gnapprox~⪊~gne~⪈~gneq~⪈~gneqq~≩~gnsim~⋧~gopf~𝕘~grave~`~gscr~ℊ~gsim~≳~gsime~⪎~gsiml~⪐~gtcc~⪧~gtcir~⩺~gtdot~⋗~gtlPar~⦕~gtquest~⩼~gtrapprox~⪆~gtrarr~⥸~gtrdot~⋗~gtreqless~⋛~gtreqqless~⪌~gtrless~≷~gtrsim~≳~gvertneqq~≩︀~gvnE~≩︀~hairsp~ ~half~½~hamilt~ℋ~hardcy~ъ~harrcir~⥈~harrw~↭~hbar~ℏ~hcirc~ĥ~heartsuit~♥~hercon~⊹~hfr~𝔥~hksearow~⤥~hkswarow~⤦~hoarr~⇿~homtht~∻~hookleftarrow~↩~hookrightarrow~↪~hopf~𝕙~horbar~―~hscr~𝒽~hslash~ℏ~hstrok~ħ~hybull~⁃~hyphen~‐~ic~⁣~icy~и~iecy~е~iff~⇔~ifr~𝔦~ii~ⅈ~iiiint~⨌~iiint~∭~iinfin~⧜~iiota~℩~ijlig~ĳ~imacr~ī~imagline~ℐ~imagpart~ℑ~imath~ı~imof~⊷~imped~Ƶ~in~∈~incare~℅~infintie~⧝~inodot~ı~intcal~⊺~integers~ℤ~intercal~⊺~intlarhk~⨗~intprod~⨼~iocy~ё~iogon~į~iopf~𝕚~iprod~⨼~iscr~𝒾~isinE~⋹~isindot~⋵~isins~⋴~isinsv~⋳~isinv~∈~it~⁢~itilde~ĩ~iukcy~і~jcirc~ĵ~jcy~й~jfr~𝔧~jmath~ȷ~jopf~𝕛~jscr~𝒿~jsercy~ј~jukcy~є~kappav~ϰ~kcedil~ķ~kcy~к~kfr~𝔨~kgreen~ĸ~khcy~х~kjcy~ќ~kopf~𝕜~kscr~𝓀~lAarr~⇚~lAtail~⤛~lBarr~⤎~lE~≦~lEg~⪋~lHar~⥢~lacute~ĺ~laemptyv~⦴~lagran~ℒ~langd~⦑~langle~⟨~lap~⪅~larrb~⇤~larrbfs~⤟~larrfs~⤝~larrhk~↩~larrlp~↫~larrpl~⤹~larrsim~⥳~larrtl~↢~lat~⪫~latail~⤙~late~⪭~lates~⪭︀~lbarr~⤌~lbbrk~❲~lbrace~{~lbrack~[~lbrke~⦋~lbrksld~⦏~lbrkslu~⦍~lcaron~ľ~lcedil~ļ~lcub~{~lcy~л~ldca~⤶~ldquor~„~ldrdhar~⥧~ldrushar~⥋~ldsh~↲~leftarrow~←~leftarrowtail~↢~leftharpoondown~↽~leftharpoonup~↼~leftleftarrows~⇇~leftrightarrow~↔~leftrightarrows~⇆~leftrightharpoons~⇋~leftrightsquigarrow~↭~leftthreetimes~⋋~leg~⋚~leq~≤~leqq~≦~leqslant~⩽~les~⩽~lescc~⪨~lesdot~⩿~lesdoto~⪁~lesdotor~⪃~lesg~⋚︀~lesges~⪓~lessapprox~⪅~lessdot~⋖~lesseqgtr~⋚~lesseqqgtr~⪋~lessgtr~≶~lesssim~≲~lfisht~⥼~lfr~𝔩~lg~≶~lgE~⪑~lhard~↽~lharu~↼~lharul~⥪~lhblk~▄~ljcy~љ~ll~≪~llarr~⇇~llcorner~⌞~llhard~⥫~lltri~◺~lmidot~ŀ~lmoust~⎰~lmoustache~⎰~lnE~≨~lnap~⪉~lnapprox~⪉~lne~⪇~lneq~⪇~lneqq~≨~lnsim~⋦~loang~⟬~loarr~⇽~lobrk~⟦~longleftarrow~⟵~longleftrightarrow~⟷~longmapsto~⟼~longrightarrow~⟶~looparrowleft~↫~looparrowright~↬~lopar~⦅~lopf~𝕝~loplus~⨭~lotimes~⨴~lowbar~_~lozenge~◊~lozf~⧫~lpar~(~lparlt~⦓~lrarr~⇆~lrcorner~⌟~lrhar~⇋~lrhard~⥭~lrtri~⊿~lscr~𝓁~lsh~↰~lsim~≲~lsime~⪍~lsimg~⪏~lsqb~[~lsquor~‚~lstrok~ł~ltcc~⪦~ltcir~⩹~ltdot~⋖~lthree~⋋~ltimes~⋉~ltlarr~⥶~ltquest~⩻~ltrPar~⦖~ltri~◃~ltrie~⊴~ltrif~◂~lurdshar~⥊~luruhar~⥦~lvertneqq~≨︀~lvnE~≨︀~mDDot~∺~male~♂~malt~✠~maltese~✠~map~↦~mapsto~↦~mapstodown~↧~mapstoleft~↤~mapstoup~↥~marker~▮~mcomma~⨩~mcy~м~measuredangle~∡~mfr~𝔪~mho~℧~mid~∣~midast~*~midcir~⫰~minusb~⊟~minusd~∸~minusdu~⨪~mlcp~⫛~mldr~…~mnplus~∓~models~⊧~mopf~𝕞~mp~∓~mscr~𝓂~mstpos~∾~multimap~⊸~mumap~⊸~nGg~⋙̸~nGt~≫⃒~nGtv~≫̸~nLeftarrow~⇍~nLeftrightarrow~⇎~nLl~⋘̸~nLt~≪⃒~nLtv~≪̸~nRightarrow~⇏~nVDash~⊯~nVdash~⊮~nacute~ń~nang~∠⃒~nap~≉~napE~⩰̸~napid~≋̸~napos~ŉ~napprox~≉~natur~♮~natural~♮~naturals~ℕ~nbump~≎̸~nbumpe~≏̸~ncap~⩃~ncaron~ň~ncedil~ņ~ncong~≇~ncongdot~⩭̸~ncup~⩂~ncy~н~neArr~⇗~nearhk~⤤~nearr~↗~nearrow~↗~nedot~≐̸~nequiv~≢~nesear~⤨~nesim~≂̸~nexist~∄~nexists~∄~nfr~𝔫~ngE~≧̸~nge~≱~ngeq~≱~ngeqq~≧̸~ngeqslant~⩾̸~nges~⩾̸~ngsim~≵~ngt~≯~ngtr~≯~nhArr~⇎~nharr~↮~nhpar~⫲~nis~⋼~nisd~⋺~niv~∋~njcy~њ~nlArr~⇍~nlE~≦̸~nlarr~↚~nldr~‥~nle~≰~nleftarrow~↚~nleftrightarrow~↮~nleq~≰~nleqq~≦̸~nleqslant~⩽̸~nles~⩽̸~nless~≮~nlsim~≴~nlt~≮~nltri~⋪~nltrie~⋬~nmid~∤~nopf~𝕟~notinE~⋹̸~notindot~⋵̸~notinva~∉~notinvb~⋷~notinvc~⋶~notni~∌~notniva~∌~notnivb~⋾~notnivc~⋽~npar~∦~nparallel~∦~nparsl~⫽⃥~npart~∂̸~npolint~⨔~npr~⊀~nprcue~⋠~npre~⪯̸~nprec~⊀~npreceq~⪯̸~nrArr~⇏~nrarr~↛~nrarrc~⤳̸~nrarrw~↝̸~nrightarrow~↛~nrtri~⋫~nrtrie~⋭~nsc~⊁~nsccue~⋡~nsce~⪰̸~nscr~𝓃~nshortmid~∤~nshortparallel~∦~nsim~≁~nsime~≄~nsimeq~≄~nsmid~∤~nspar~∦~nsqsube~⋢~nsqsupe~⋣~nsubE~⫅̸~nsube~⊈~nsubset~⊂⃒~nsubseteq~⊈~nsubseteqq~⫅̸~nsucc~⊁~nsucceq~⪰̸~nsup~⊅~nsupE~⫆̸~nsupe~⊉~nsupset~⊃⃒~nsupseteq~⊉~nsupseteqq~⫆̸~ntgl~≹~ntlg~≸~ntriangleleft~⋪~ntrianglelefteq~⋬~ntriangleright~⋫~ntrianglerighteq~⋭~num~#~numero~№~numsp~ ~nvDash~⊭~nvHarr~⤄~nvap~≍⃒~nvdash~⊬~nvge~≥⃒~nvgt~>⃒~nvinfin~⧞~nvlArr~⤂~nvle~≤⃒~nvlt~<⃒~nvltrie~⊴⃒~nvrArr~⤃~nvrtrie~⊵⃒~nvsim~∼⃒~nwArr~⇖~nwarhk~⤣~nwarr~↖~nwarrow~↖~nwnear~⤧~oS~Ⓢ~oast~⊛~ocir~⊚~ocy~о~odash~⊝~odblac~ő~odiv~⨸~odot~⊙~odsold~⦼~ofcir~⦿~ofr~𝔬~ogon~˛~ogt~⧁~ohbar~⦵~ohm~Ω~oint~∮~olarr~↺~olcir~⦾~olcross~⦻~olt~⧀~omacr~ō~omid~⦶~ominus~⊖~oopf~𝕠~opar~⦷~operp~⦹~orarr~↻~ord~⩝~order~ℴ~orderof~ℴ~origof~⊶~oror~⩖~orslope~⩗~orv~⩛~oscr~ℴ~osol~⊘~otimesas~⨶~ovbar~⌽~par~∥~parallel~∥~parsim~⫳~parsl~⫽~pcy~п~percnt~%~period~.~pertenk~‱~pfr~𝔭~phiv~ϕ~phmmat~ℳ~phone~☎~pitchfork~⋔~planck~ℏ~planckh~ℎ~plankv~ℏ~plus~+~plusacir~⨣~plusb~⊞~pluscir~⨢~plusdo~∔~plusdu~⨥~pluse~⩲~plussim~⨦~plustwo~⨧~pm~±~pointint~⨕~popf~𝕡~pr~≺~prE~⪳~prap~⪷~prcue~≼~pre~⪯~prec~≺~precapprox~⪷~preccurlyeq~≼~preceq~⪯~precnapprox~⪹~precneqq~⪵~precnsim~⋨~precsim~≾~primes~ℙ~prnE~⪵~prnap~⪹~prnsim~⋨~profalar~⌮~profline~⌒~profsurf~⌓~propto~∝~prsim~≾~prurel~⊰~pscr~𝓅~puncsp~ ~qfr~𝔮~qint~⨌~qopf~𝕢~qprime~⁗~qscr~𝓆~quaternions~ℍ~quatint~⨖~quest~?~questeq~≟~rAarr~⇛~rAtail~⤜~rBarr~⤏~rHar~⥤~race~∽̱~racute~ŕ~raemptyv~⦳~rangd~⦒~range~⦥~rangle~⟩~rarrap~⥵~rarrb~⇥~rarrbfs~⤠~rarrc~⤳~rarrfs~⤞~rarrhk~↪~rarrlp~↬~rarrpl~⥅~rarrsim~⥴~rarrtl~↣~rarrw~↝~ratail~⤚~ratio~∶~rationals~ℚ~rbarr~⤍~rbbrk~❳~rbrace~}~rbrack~]~rbrke~⦌~rbrksld~⦎~rbrkslu~⦐~rcaron~ř~rcedil~ŗ~rcub~}~rcy~р~rdca~⤷~rdldhar~⥩~rdquor~”~rdsh~↳~realine~ℛ~realpart~ℜ~reals~ℝ~rect~▭~rfisht~⥽~rfr~𝔯~rhard~⇁~rharu~⇀~rharul~⥬~rhov~ϱ~rightarrow~→~rightarrowtail~↣~rightharpoondown~⇁~rightharpoonup~⇀~rightleftarrows~⇄~rightleftharpoons~⇌~rightrightarrows~⇉~rightsquigarrow~↝~rightthreetimes~⋌~ring~˚~risingdotseq~≓~rlarr~⇄~rlhar~⇌~rmoust~⎱~rmoustache~⎱~rnmid~⫮~roang~⟭~roarr~⇾~robrk~⟧~ropar~⦆~ropf~𝕣~roplus~⨮~rotimes~⨵~rpar~)~rpargt~⦔~rppolint~⨒~rrarr~⇉~rscr~𝓇~rsh~↱~rsqb~]~rsquor~’~rthree~⋌~rtimes~⋊~rtri~▹~rtrie~⊵~rtrif~▸~rtriltri~⧎~ruluhar~⥨~rx~℞~sacute~ś~sc~≻~scE~⪴~scap~⪸~sccue~≽~sce~⪰~scedil~ş~scirc~ŝ~scnE~⪶~scnap~⪺~scnsim~⋩~scpolint~⨓~scsim~≿~scy~с~sdotb~⊡~sdote~⩦~seArr~⇘~searhk~⤥~searr~↘~searrow~↘~semi~;~seswar~⤩~setminus~∖~setmn~∖~sext~✶~sfr~𝔰~sfrown~⌢~sharp~♯~shchcy~щ~shcy~ш~shortmid~∣~shortparallel~∥~sigmav~ς~simdot~⩪~sime~≃~simeq~≃~simg~⪞~simgE~⪠~siml~⪝~simlE~⪟~simne~≆~simplus~⨤~simrarr~⥲~slarr~←~smallsetminus~∖~smashp~⨳~smeparsl~⧤~smid~∣~smile~⌣~smt~⪪~smte~⪬~smtes~⪬︀~softcy~ь~sol~/~solb~⧄~solbar~⌿~sopf~𝕤~spadesuit~♠~spar~∥~sqcap~⊓~sqcaps~⊓︀~sqcup~⊔~sqcups~⊔︀~sqsub~⊏~sqsube~⊑~sqsubset~⊏~sqsubseteq~⊑~sqsup~⊐~sqsupe~⊒~sqsupset~⊐~sqsupseteq~⊒~squ~□~square~□~squarf~▪~squf~▪~srarr~→~sscr~𝓈~ssetmn~∖~ssmile~⌣~sstarf~⋆~star~☆~starf~★~straightepsilon~ϵ~straightphi~ϕ~strns~¯~subE~⫅~subdot~⪽~subedot~⫃~submult~⫁~subnE~⫋~subne~⊊~subplus~⪿~subrarr~⥹~subset~⊂~subseteq~⊆~subseteqq~⫅~subsetneq~⊊~subsetneqq~⫋~subsim~⫇~subsub~⫕~subsup~⫓~succ~≻~succapprox~⪸~succcurlyeq~≽~succeq~⪰~succnapprox~⪺~succneqq~⪶~succnsim~⋩~succsim~≿~sung~♪~supE~⫆~supdot~⪾~supdsub~⫘~supedot~⫄~suphsol~⟉~suphsub~⫗~suplarr~⥻~supmult~⫂~supnE~⫌~supne~⊋~supplus~⫀~supset~⊃~supseteq~⊇~supseteqq~⫆~supsetneq~⊋~supsetneqq~⫌~supsim~⫈~supsub~⫔~supsup~⫖~swArr~⇙~swarhk~⤦~swarr~↙~swarrow~↙~swnwar~⤪~target~⌖~tbrk~⎴~tcaron~ť~tcedil~ţ~tcy~т~tdot~⃛~telrec~⌕~tfr~𝔱~therefore~∴~thetav~ϑ~thickapprox~≈~thicksim~∼~thkap~≈~thksim~∼~timesb~⊠~timesbar~⨱~timesd~⨰~tint~∭~toea~⤨~top~⊤~topbot~⌶~topcir~⫱~topf~𝕥~topfork~⫚~tosa~⤩~tprime~‴~triangle~▵~triangledown~▿~triangleleft~◃~trianglelefteq~⊴~triangleq~≜~triangleright~▹~trianglerighteq~⊵~tridot~◬~trie~≜~triminus~⨺~triplus~⨹~trisb~⧍~tritime~⨻~trpezium~⏢~tscr~𝓉~tscy~ц~tshcy~ћ~tstrok~ŧ~twixt~≬~twoheadleftarrow~↞~twoheadrightarrow~↠~uHar~⥣~ubrcy~ў~ubreve~ŭ~ucy~у~udarr~⇅~udblac~ű~udhar~⥮~ufisht~⥾~ufr~𝔲~uharl~↿~uharr~↾~uhblk~▀~ulcorn~⌜~ulcorner~⌜~ulcrop~⌏~ultri~◸~umacr~ū~uogon~ų~uopf~𝕦~uparrow~↑~updownarrow~↕~upharpoonleft~↿~upharpoonright~↾~uplus~⊎~upsi~υ~upuparrows~⇈~urcorn~⌝~urcorner~⌝~urcrop~⌎~uring~ů~urtri~◹~uscr~𝓊~utdot~⋰~utilde~ũ~utri~▵~utrif~▴~uuarr~⇈~uwangle~⦧~vArr~⇕~vBar~⫨~vBarv~⫩~vDash~⊨~vangrt~⦜~varepsilon~ϵ~varkappa~ϰ~varnothing~∅~varphi~ϕ~varpi~ϖ~varpropto~∝~varr~↕~varrho~ϱ~varsigma~ς~varsubsetneq~⊊︀~varsubsetneqq~⫋︀~varsupsetneq~⊋︀~varsupsetneqq~⫌︀~vartheta~ϑ~vartriangleleft~⊲~vartriangleright~⊳~vcy~в~vdash~⊢~vee~∨~veebar~⊻~veeeq~≚~vellip~⋮~verbar~|~vert~|~vfr~𝔳~vltri~⊲~vnsub~⊂⃒~vnsup~⊃⃒~vopf~𝕧~vprop~∝~vrtri~⊳~vscr~𝓋~vsubnE~⫋︀~vsubne~⊊︀~vsupnE~⫌︀~vsupne~⊋︀~vzigzag~⦚~wcirc~ŵ~wedbar~⩟~wedge~∧~wedgeq~≙~wfr~𝔴~wopf~𝕨~wp~℘~wr~≀~wreath~≀~wscr~𝓌~xcap~⋂~xcirc~◯~xcup~⋃~xdtri~▽~xfr~𝔵~xhArr~⟺~xharr~⟷~xlArr~⟸~xlarr~⟵~xmap~⟼~xnis~⋻~xodot~⨀~xopf~𝕩~xoplus~⨁~xotime~⨂~xrArr~⟹~xrarr~⟶~xscr~𝓍~xsqcup~⨆~xuplus~⨄~xutri~△~xvee~⋁~xwedge~⋀~yacy~я~ycirc~ŷ~ycy~ы~yfr~𝔶~yicy~ї~yopf~𝕪~yscr~𝓎~yucy~ю~zacute~ź~zcaron~ž~zcy~з~zdot~ż~zeetrf~ℨ~zfr~𝔷~zhcy~ж~zigrarr~⇝~zopf~𝕫~zscr~𝓏~~AMP~&~COPY~©~GT~>~LT~<~QUOT~"~REG~®',eo.html4);var ZO={0:65533,128:8364,130:8218,131:402,132:8222,133:8230,134:8224,135:8225,136:710,137:8240,138:352,139:8249,140:338,142:381,145:8216,146:8217,147:8220,148:8221,149:8226,150:8211,151:8212,152:732,153:8482,154:353,155:8250,156:339,158:382,159:376},eF=String.fromCodePoint||function(i){return String.fromCharCode(Math.floor((i-65536)/1024)+55296,(i-65536)%1024+56320)},to=function(){return to=Object.assign||function(i){for(var e,t=1,r=arguments.length;t<r;t++){e=arguments[t];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(i[n]=e[n])}return i},to.apply(this,arguments)},tF=to(to({},eo),{all:eo.html5}),rF={scope:"body",level:"all"},hp=/&(?:#\d+|#[xX][\da-fA-F]+|[0-9a-zA-Z]+);/g,dp=/&(?:#\d+|#[xX][\da-fA-F]+|[0-9a-zA-Z]+)[;=]?/g,_2={xml:{strict:hp,attribute:dp,body:cp.xml},html4:{strict:hp,attribute:dp,body:cp.html4},html5:{strict:hp,attribute:dp,body:cp.html5}},iF=to(to({},_2),{all:_2.html5}),M2=String.fromCharCode,nF=M2(65533);function sF(i,e,t,r){var n=i,s=i[i.length-1];if(t&&s==="=")n=i;else if(r&&s!==";")n=i;else{var a=e[i];if(a)n=a;else if(i[0]==="&"&&i[1]==="#"){var o=i[2],l=o=="x"||o=="X"?parseInt(i.substr(3),16):parseInt(i.substr(2));n=l>=1114111?nF:l>65535?eF(l):M2(ZO[l]||l)}}return n}function P2(i,e){var t=e===void 0?rF:e,r=t.level,n=r===void 0?"all":r,s=t.scope,a=s===void 0?n==="xml"?"strict":"body":s;if(!i)return"";var o=iF[n][a],l=tF[n].entities,u=a==="attribute",h=a==="strict";return i.replace(o,function(d){return sF(d,l,u,h)})}/**
 * @name ranges-sort
 * @fileoverview Sort string index ranges
 * @version 6.0.13
 * @author Roy Revelt, Codsen Ltd
 * @license MIT
 * {@link https://codsen.com/os/ranges-sort/}
 */var aF={strictlyTwoElementsInRangeArrays:!1,progressFn:null};function mc(i,e){if(!Array.isArray(i)||!i.length)return i;let t={...aF,...e},r,n;if(t.strictlyTwoElementsInRangeArrays&&!i.every((o,l)=>!Array.isArray(o)||o.length!==2?(r=l,n=o.length,!1):!0))throw new TypeError(`ranges-sort: [THROW_ID_03] The first argument should be an array and must consist of arrays which are natural number indexes representing TWO string index ranges. However, ${r}th range (${JSON.stringify(i[r],null,4)}) has not two but ${n} elements!`);if(!i.every((o,l)=>!Array.isArray(o)||!Number.isInteger(o[0])||o[0]<0||!Number.isInteger(o[1])||o[1]<0?(r=l,!1):!0))throw new TypeError(`ranges-sort: [THROW_ID_04] The first argument should be an array and must consist of arrays which are natural number indexes representing string index ranges. However, ${r}th range (${JSON.stringify(i[r],null,4)}) does not consist of only natural numbers!`);let s=i.length**2,a=0;return Array.from(i).sort((o,l)=>(t.progressFn&&(a+=1,t.progressFn(Math.floor(a*100/s))),o[0]===l[0]?o[1]<l[1]?-1:o[1]>l[1]?1:0:o[0]<l[0]?-1:1))}/**
 * @name ranges-merge
 * @fileoverview Merge and sort string index ranges
 * @version 9.0.18
 * @author Roy Revelt, Codsen Ltd
 * @license MIT
 * {@link https://codsen.com/os/ranges-merge/}
 */var k2={mergeType:1,progressFn:null,joinRangesThatTouchEdges:!0};function oF(i,e){function t(u){return!!u&&typeof u=="object"&&!Array.isArray(u)}if(!Array.isArray(i)||!i.length)return null;let r;if(e)if(t(e)){if(r={...k2,...e},r.progressFn&&t(r.progressFn)&&!Object.keys(r.progressFn).length)r.progressFn=null;else if(r.progressFn&&typeof r.progressFn!="function")throw new Error(`ranges-merge: [THROW_ID_01] opts.progressFn must be a function! It was given of a type: "${typeof r.progressFn}", equal to ${JSON.stringify(r.progressFn,null,4)}`);if(![1,2,"1","2"].includes(r.mergeType))throw new Error(`ranges-merge: [THROW_ID_02] opts.mergeType was customised to a wrong thing! It was given of a type: "${typeof r.mergeType}", equal to ${JSON.stringify(r.mergeType,null,4)}`);if(typeof r.joinRangesThatTouchEdges!="boolean")throw new Error(`ranges-merge: [THROW_ID_04] opts.joinRangesThatTouchEdges was customised to a wrong thing! It was given of a type: "${typeof r.joinRangesThatTouchEdges}", equal to ${JSON.stringify(r.joinRangesThatTouchEdges,null,4)}`)}else throw new Error(`emlint: [THROW_ID_03] the second input argument must be a plain object. It was given as:
${JSON.stringify(e,null,4)} (type ${typeof e})`);else r={...k2};let n=i.filter(u=>Array.isArray(u)).map(u=>[...u]).filter(u=>u[2]!==void 0||u[0]!==u[1]),s,a,o;r.progressFn?s=mc(n,{progressFn:u=>{o=Math.floor(u/5),o!==a&&(a=o,r.progressFn(o))}}):s=mc(n);let l=s.length-1;for(let u=l;u>0;u--)r.progressFn&&(o=Math.floor((1-u/l)*78)+21,o!==a&&o>a&&(a=o,r.progressFn(o))),(s[u][0]<=s[u-1][0]||!r.joinRangesThatTouchEdges&&s[u][0]<s[u-1][1]||r.joinRangesThatTouchEdges&&s[u][0]<=s[u-1][1])&&(s[u-1][0]=Math.min(s[u][0],s[u-1][0]),s[u-1][1]=Math.max(s[u][1],s[u-1][1]),s[u][2]!==void 0&&(s[u-1][0]>=s[u][0]||s[u-1][1]<=s[u][1])&&s[u-1][2]!==null&&(s[u][2]===null&&s[u-1][2]!==null?s[u-1][2]=null:s[u-1][2]!=null?+r.mergeType==2&&s[u-1][0]===s[u][0]?s[u-1][2]=s[u][2]:s[u-1][2]+=s[u][2]:s[u-1][2]=s[u][2]),s.splice(u,1),u=s.length);return s.length?s:null}var lF="Invariant failed";function uF(i,e){if(!i)throw new Error(lF)}/**
 * @name ranges-apply
 * @fileoverview Take an array of string index ranges, delete/replace the string according to them
 * @version 7.0.19
 * @author Roy Revelt, Codsen Ltd
 * @license MIT
 * {@link https://codsen.com/os/ranges-apply/}
 */function cF(i,e,t){if(arguments.length===0)throw new Error("ranges-apply: [THROW_ID_01] inputs missing!");if(typeof i!="string")throw new TypeError(`ranges-apply: [THROW_ID_02] first input argument must be a string! Currently it's: ${typeof i}, equal to: ${JSON.stringify(i,null,4)}`);if(e&&!Array.isArray(e))throw new TypeError(`ranges-apply: [THROW_ID_03] second input argument must be an array (or null)! Currently it's: ${typeof e}, equal to: ${JSON.stringify(e,null,4)}`);if(!(e!=null&&e.filter(a=>a).length))return i;let r;Array.isArray(e)&&Number.isInteger(e[0])&&Number.isInteger(e[1])?r=[Array.from(e)]:r=Array.from(e),r.length,r.filter(a=>a).forEach((a,o)=>{if(!Array.isArray(a))throw new TypeError(`ranges-apply: [THROW_ID_05] ranges array, second input arg., has ${o}th element not an array: ${JSON.stringify(a,null,4)}, which is ${typeof a}`);if(!Number.isInteger(a[0])){if(!Number.isInteger(+a[0])||+a[0]<0)throw new TypeError(`ranges-apply: [THROW_ID_06] ranges array, second input arg. has ${o}th element, array ${JSON.stringify(a,null,0)}. Its first element is not an integer, string index, but ${typeof a[0]}, equal to: ${JSON.stringify(a[0],null,4)}.`);r[o][0]=+r[o][0]}if(!Number.isInteger(a[1])){if(!Number.isInteger(+a[1])||+a[1]<0)throw new TypeError(`ranges-apply: [THROW_ID_07] ranges array, second input arg. has ${o}th element, array ${JSON.stringify(a,null,0)}. Its second element is not an integer, string index, but ${typeof a[1]}, equal to: ${JSON.stringify(a[1],null,4)}.`);r[o][1]=+r[o][1]}});let n=oF(r,{progressFn:a=>{}});uF(n);let s=n.length;if(s>0){let a=i.slice(n[s-1][1]);i=n.reduce((o,l,u,h)=>{let d=u===0?0:h[u-1][1],p=h[u][0];return`${o}${i.slice(d,p)}${h[u][2]||""}`},""),i+=a}return i}/**
 * @name string-collapse-leading-whitespace
 * @fileoverview Collapse the leading and trailing whitespace of a string
 * @version 7.0.9
 * @author Roy Revelt, Codsen Ltd
 * @license MIT
 * {@link https://codsen.com/os/string-collapse-leading-whitespace/}
 */function fp(i,e=1){let t=" ";function r(s){return Array.from(s).reverse().join("")}function n(s,a,o){let l=o?`
`:"\r",u=o?"\r":`
`;if(!s)return s;let h=0,d="";for(let p=0,g=s.length;p<g;p++)(s[p]===l||s[p]===u&&s[p-1]!==l)&&h++,`\r
`.includes(s[p])||s[p]===t?s[p]===t?d+=s[p]:s[p]===l?h<=a&&(d+=s[p],s[p+1]===u&&(d+=s[p+1],p++)):s[p]===u&&(s==null?void 0:s[p-1])!==l&&h<=a&&(d+=s[p]):!s[p+1]&&!h&&(d+=" ");return d}if(typeof i=="string"&&i.length){let s=1;typeof+e=="number"&&Number.isInteger(+e)&&+e>=0&&(s=+e);let a="",o="";if(!i.trim())a=i;else if(!i[0].trim()){for(let l=0,u=i.length;l<u;l++)if(i[l].trim()){a=i.slice(0,l);break}}if(i.trim()&&(i.slice(-1).trim()===""||i.slice(-1)===t)){for(let l=i.length;l--;)if(i[l].trim()){o=i.slice(l+1);break}}return`${n(a,s,!1)}${i.trim()}${r(n(r(o),s,!0))}`}return i}/**
 * @name ranges-push
 * @fileoverview Gather string index ranges
 * @version 7.0.18
 * @author Roy Revelt, Codsen Ltd
 * @license MIT
 * {@link https://codsen.com/os/ranges-push/}
 */var O2={mergeType:1,progressFn:null,joinRangesThatTouchEdges:!0};function hF(i,e){var u;function t(h){return!!h&&typeof h=="object"&&!Array.isArray(h)}if(!Array.isArray(i)||!i.length)return null;let r;if(e)if(t(e)){if(r={...O2,...e},r.progressFn&&t(r.progressFn)&&!Object.keys(r.progressFn).length)r.progressFn=null;else if(r.progressFn&&typeof r.progressFn!="function")throw new Error(`ranges-merge: [THROW_ID_01] resolvedOpts.progressFn must be a function! It was given of a type: "${typeof r.progressFn}", equal to ${JSON.stringify(r.progressFn,null,4)}`);if(![1,2,"1","2"].includes(r.mergeType))throw new Error(`ranges-merge: [THROW_ID_02] resolvedOpts.mergeType was customised to a wrong thing! It was given of a type: "${typeof r.mergeType}", equal to ${JSON.stringify(r.mergeType,null,4)}`);if(typeof r.joinRangesThatTouchEdges!="boolean")throw new Error(`ranges-merge: [THROW_ID_04] resolvedOpts.joinRangesThatTouchEdges was customised to a wrong thing! It was given of a type: "${typeof r.joinRangesThatTouchEdges}", equal to ${JSON.stringify(r.joinRangesThatTouchEdges,null,4)}`)}else throw new Error(`ranges-merge: [THROW_ID_03] the second input argument must be a plain object. It was given as:
${JSON.stringify(e,null,4)} (type ${typeof e})`);else r={...O2};let n=i.filter(h=>Array.isArray(h)).map(h=>[...h]).filter(h=>h[2]!==void 0||h[0]!==h[1]),s,a,o;r.progressFn?s=mc(n,{progressFn:h=>{o=Math.floor(h/5),o!==a&&(a=o,r.progressFn!=null&&r.progressFn(o))}}):s=mc(n);let l=s.length-1;for(let h=l;h>0;h--)r.progressFn&&(o=Math.floor((1-h/l)*78)+21,o!==a&&o>a&&(a=o,r.progressFn(o))),(s[h][0]<=s[h-1][0]||!r.joinRangesThatTouchEdges&&s[h][0]<s[h-1][1]||r.joinRangesThatTouchEdges&&s[h][0]<=s[h-1][1])&&(s[h-1][0]=Math.min(s[h][0],s[h-1][0]),s[h-1][1]=Math.max(s[h][1],s[h-1][1]),s[h][2]!==void 0&&(s[h-1][0]>=s[h][0]||s[h-1][1]<=s[h][1])&&s[h-1][2]!==null&&(s[h][2]===null&&s[h-1][2]!==null?s[h-1][2]=null:s[h-1][2]!=null?+((u=r||{})==null?void 0:u.mergeType)==2&&s[h-1][0]===s[h][0]?s[h-1][2]=s[h][2]:s[h-1][2]+=s[h][2]:s[h-1][2]=s[h][2]),s.splice(h,1),h=s.length);return s.length?s:null}var dF={limitToBeAddedWhitespace:!1,limitLinebreaksCount:1,mergeType:1},fF=class{constructor(i){re(this,"ranges");re(this,"opts");let e={...dF,...i};if(e.mergeType&&e.mergeType!==1&&e.mergeType!==2)if(ja(e.mergeType)&&e.mergeType.trim()==="1")e.mergeType=1;else if(ja(e.mergeType)&&e.mergeType.trim()==="2")e.mergeType=2;else throw new Error(`ranges-push: [THROW_ID_02] opts.mergeType was customised to a wrong thing! It was given of a type: "${typeof e.mergeType}", equal to ${JSON.stringify(e.mergeType,null,4)}`);this.opts=e,this.ranges=[]}add(i,e,t){var s;if(i==null&&e==null)return;if(ys(i)&&!ys(e)){if(Array.isArray(i)){if(i.length){if(i.some(a=>Array.isArray(a))){i.forEach(a=>{Array.isArray(a)&&this.add(...a)});return}i.length&&ms(+i[0])&&ms(+i[1])&&this.add(...i)}return}throw new TypeError(`ranges-push/Ranges/add(): [THROW_ID_12] the first input argument, "from" is set (${JSON.stringify(i,null,0)}) but second-one, "to" is not (${JSON.stringify(e,null,0)})`)}else if(!ys(i)&&ys(e))throw new TypeError(`ranges-push/Ranges/add(): [THROW_ID_13] the second input argument, "to" is set (${JSON.stringify(e,null,0)}) but first-one, "from" is not (${JSON.stringify(i,null,0)})`);let r=+i,n=+e;if(ms(t)&&(t=String(t)),ms(r)&&ms(n)){if(ys(t)&&!ja(t)&&!ms(t))throw new TypeError(`ranges-push/Ranges/add(): [THROW_ID_08] The third argument, the value to add, was given not as string but ${typeof t}, equal to:
${JSON.stringify(t,null,4)}`);if(ys(this.ranges)&&Array.isArray(this.last())&&r===this.last()[1]){if(this.last()[1]=n,this.last()[2],this.last()[2]!==null&&ys(t)){let a=this.last()[2]&&this.last()[2].length&&(!((s=this.opts)!=null&&s.mergeType)||this.opts.mergeType===1)?`${this.last()[2]}${t}`:t;this.opts.limitToBeAddedWhitespace&&(a=fp(a,this.opts.limitLinebreaksCount)),ja(a)&&!a.length||(this.last()[2]=a)}}else{this.ranges||(this.ranges=[]);let a=t!==void 0&&!(ja(t)&&!t.length)?[r,n,t&&this.opts.limitToBeAddedWhitespace?fp(t,this.opts.limitLinebreaksCount):t]:[r,n];this.ranges.push(a)}}else throw ms(r)&&r>=0?new TypeError(`ranges-push/Ranges/add(): [THROW_ID_10] "to" value, the second input argument, must be a natural number or zero! Currently it's of a type "${typeof n}" equal to: ${JSON.stringify(n,null,4)}`):new TypeError(`ranges-push/Ranges/add(): [THROW_ID_09] "from" value, the first input argument, must be a natural number or zero! Currently it's of a type "${typeof r}" equal to: ${JSON.stringify(r,null,4)}`)}push(i,e,t){this.add(i,e,t)}current(){return Array.isArray(this.ranges)&&this.ranges.length?(this.ranges=hF(this.ranges,{mergeType:this.opts.mergeType}),this.ranges&&this.opts.limitToBeAddedWhitespace?this.ranges.map(i=>ys(i[2])?[i[0],i[1],fp(i[2],this.opts.limitLinebreaksCount)]:i):this.ranges):null}wipe(){this.ranges=[]}replace(i){if(Array.isArray(i)&&i.length)if(Array.isArray(i[0])&&ms(i[0][0]))this.ranges=Array.from(i);else throw new Error(`ranges-push/Ranges/replace(): [THROW_ID_11] Single range was given but we expected array of arrays! The first element, ${JSON.stringify(i[0],null,4)} should be an array and its first element should be an integer, a string index.`);else this.ranges=[]}last(){return Array.isArray(this.ranges)&&this.ranges.length?this.ranges[this.ranges.length-1]:null}};/**
 * @name string-left-right
 * @fileoverview Looks up the first non-whitespace character to the left/right of a given index
 * @version 6.0.20
 * @author Roy Revelt, Codsen Ltd
 * @license MIT
 * {@link https://codsen.com/os/string-left-right/}
 */h2();var gp=" ";function gF({str:i,idx:e=0,stopAtNewlines:t=!1,stopAtRawNbsp:r=!1}){if(typeof i!="string"||!i.length||((!e||typeof e!="number")&&(e=0),!i[e+1]))return null;if(i[e+1]&&(i[e+1].trim()||t&&`
\r`.includes(i[e+1])||r&&i[e+1]===gp))return e+1;if(i[e+2]&&(i[e+2].trim()||t&&`
\r`.includes(i[e+2])||r&&i[e+2]===gp))return e+2;for(let n=e+1,s=i.length;n<s;n++)if(i[n].trim()||t&&`
\r`.includes(i[n])||r&&i[n]===gp)return n;return null}function cn(i,e=0){return gF({str:i,idx:e,stopAtNewlines:!1,stopAtRawNbsp:!1})}/**
 * @name string-strip-html
 * @fileoverview Strip HTML tags from strings. No parser, accepts mixed sources.
 * @version 13.4.12
 * @author Roy Revelt, Codsen Ltd
 * @license MIT
 * {@link https://codsen.com/os/string-strip-html/}
 */function pF(i){return/[-_A-Za-z0-9]/.test(i)}function F2(i,e){if(!i)return[];if(Array.isArray(i))return i.filter(t=>typeof t=="string"&&t.trim());if(typeof i=="string")return i.trim()?[i]:[];throw new TypeError(`string-strip-html/stripHtml(): [THROW_ID_05] ${e} must be array containing zero or more strings or something falsey. Currently it's equal to: ${i}, that a type of ${typeof i}.`)}function yc(i,e,t,r){for(let n=e,s=i.length;n<s;n++){if(i.startsWith(t,n))return!0;if(i.startsWith(r,n))return!1}return!1}function B2(i,e,t){var r,n,s,a,o,l,u;return i!=null&&i.quotes,(r=i==null?void 0:i.quotes)!=null&&r.value&&yc(e,t+1,i.quotes.value,">"),(n=i==null?void 0:i.quotes)==null||n.next,yc(e,((s=i==null?void 0:i.quotes)==null?void 0:s.next)-1,(a=i==null?void 0:i.quotes)==null?void 0:a.value,">"),!(i!=null&&i.quotes)||!yc(e,t+1,i.quotes.value,">")&&((o=i==null?void 0:i.quotes)==null?void 0:o.next)!==-1&&yc(e,((l=i==null?void 0:i.quotes)==null?void 0:l.next)-1,(u=i==null?void 0:i.quotes)==null?void 0:u.value,">")}function mF(i,e){return(e.match(new RegExp(i,"g"))||[]).length}var fl=new Set(["!doctype","abbr","address","area","article","aside","audio","base","bdi","bdo","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","doctype","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","math","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","param","picture","pre","progress","rb","rp","rt","rtc","ruby","samp","script","section","select","slot","small","source","span","strong","style","sub","summary","sup","svg","table","tbody","td","template","textarea","tfoot","th","thead","time","title","tr","track","ul","var","video","wbr","xml"]),pp=new Set(["a","b","i","p","q","s","u"]),mp=new Set([".",",",";","!","?"]),U2=new Set([".",",","?",";",")","…",'"',"»"]),yF=new Set(["a","abbr","acronym","audio","b","bdi","bdo","big","button","canvas","cite","code","data","datalist","del","dfn","em","embed","i","iframe","input","ins","kbd","label","map","mark","meter","noscript","object","output","picture","progress","q","ruby","s","samp","select","slot","small","span","strong","sub","sup","svg","template","textarea","time","u","tt","var","video","wbr"]),$2={ignoreTags:[],ignoreTagsWithTheirContents:[],onlyStripTags:[],stripTogetherWithTheirContents:["script","style","xml"],skipHtmlDecoding:!1,trimOnlySpaces:!1,stripRecognisedHTMLOnly:!1,dumpLinkHrefsNearby:{enabled:!1,putOnNewLine:!1,wrapHeads:"",wrapTails:""},ignoreIndentations:!1,cb:null,reportProgressFunc:null,reportProgressFuncFrom:0,reportProgressFuncTo:100};function G2(i,e){var ve,fe,De,Ie,we,Ue,$e,et,it,Ge,st;let t=Date.now(),r=[],n=[],s=[],a=[],o={};function l(){o={attributes:[]}}l();let u=null,h=null,d=null,p=!1,g={},m={tagName:"",hrefValue:"",openingTagEnds:void 0},v="",E=!1,A=null,D=!0;function R(B,ae,Ae){if(Array.isArray(ae.stripTogetherWithTheirContents)&&(ae.stripTogetherWithTheirContents.includes(o.name)||ae.stripTogetherWithTheirContents.includes("*")))if(o.slashPresent&&Array.isArray(r)&&r.some(be=>be.name===o.name)){for(let be=r.length;be--;)if(r[be].name===o.name){a=a.filter(([Ne,Pe])=>(Ne<r[be].lastOpeningBracketAt||Ne>=B+1)&&(Pe<=r[be].lastOpeningBracketAt||Pe>B+1));let ge=B+1;o.lastClosingBracketAt&&(ge=o.lastClosingBracketAt+1),a.push([r[be].lastOpeningBracketAt,ge]),U2.has(i[B])&&ae.cb?ae.cb({tag:o,deleteFrom:r[be].lastOpeningBracketAt,deleteTo:B+1,insert:null,rangesArr:Ae,proposedReturn:[r[be].lastOpeningBracketAt,B,null]}):ae.cb&&ae.cb({tag:o,deleteFrom:r[be].lastOpeningBracketAt,deleteTo:B,insert:"",rangesArr:Ae,proposedReturn:[r[be].lastOpeningBracketAt,B,""]}),r.splice(be,1);break}}else o.slashPresent||r.push(o);else Array.isArray(ae.ignoreTagsWithTheirContents)&&M(B,ae,o)&&(D=!1)}function _(B,ae,Ae,be,ge,Ne){var k;if(Array.isArray($.current())&&typeof Ae=="number"&&$.current()[0][0]===0&&$.current()[0][1]>=Ae)return"";if(i.length===be&&Ne&&!((k=I==null?void 0:I.dumpLinkHrefsNearby)!=null&&k.enabled))return null;let Pe="";if(Number.isInteger(Ae)&&Ae<ge&&(Pe+=B.slice(Ae,ge)),Number.isInteger(be)&&be>Ne+1){let j=B.slice(Ne+1,be);be&&!cn(i,be-1)&&(j=j.trimEnd()),j.includes(`
`)&&w(be,B)?Pe+=" ":Pe+=j}let ue=!U2.has(B[ae]),K=B[be-1]!==">"||!B[Ae].trim(),T=!['"',"("].includes(B[ge-1]),S=![";",".",":","!"].includes(B[ae]);if((ue||K&&T&&S)&&(K||T)&&B[ae]!=="!"&&(!yF.has(o.name)||typeof Ae=="number"&&Ae<ge||typeof be=="number"&&be>Ne+1)){let j=Pe.match(/\n/g);return Array.isArray(j)&&j.length?j.length===1?`
`:j.length===2?`

`:`


`:" "}return""}function F(B,ae){var Ae,be;if((Ae=B.dumpLinkHrefsNearby)!=null&&Ae.enabled&&m.tagName&&m.tagName===o.name&&o.lastOpeningBracketAt&&(m.openingTagEnds&&o.lastOpeningBracketAt>m.openingTagEnds||!m.openingTagEnds)&&(E=!0),E){let ge=(be=B.dumpLinkHrefsNearby)!=null&&be.putOnNewLine?`

`:"";v=`${ge}${m.hrefValue}`,(typeof ae!="number"||cn(i,ae-1))&&(v+=ge)}}function w(B,ae){return ae?ae[B]==="<"&&ae[B+1]!=="%":i[B]==="<"&&i[B+1]!=="%"}function C(B){return i[B]===">"&&i[B-1]!=="%"}function M(B,ae,Ae){if(ae.ignoreTagsWithTheirContents.includes("*"))return!0;let be=i.indexOf(`<${Ae.name}`,B),ge=i.indexOf(`</${Ae.name}`,B);return!Ae.slashPresent&&ge===-1||Ae.slashPresent&&!n.some(Ne=>Ne.name===Ae.name)||ge>-1&&be>-1&&be<ge?!1:ae.ignoreTagsWithTheirContents.includes(Ae.name)}if(typeof i!="string")throw new TypeError(`string-strip-html/stripHtml(): [THROW_ID_01] Input must be string! Currently it's: ${(typeof i).toLowerCase()}, equal to:
${JSON.stringify(i,null,4)}`);if(e)if(tp(e)){if(e.reportProgressFunc&&typeof e.reportProgressFunc!="function")throw new Error(`string-strip-html/stripHtml(): [THROW_ID_03] The Optional Options Object's key reportProgressFunc, callback function, should be a function but it was given as type ${typeof e.reportProgressFunc}, equal to ${JSON.stringify(e.reportProgressFunc,null,4)}`);if(typeof e.dumpLinkHrefsNearby=="boolean"&&e.dumpLinkHrefsNearby!=null)throw new Error(`string-strip-html/stripHtml(): [THROW_ID_04] The Optional Options Object's key should be a plain object but it was given as type ${typeof e.dumpLinkHrefsNearby}, equal to ${JSON.stringify(e.dumpLinkHrefsNearby,null,4)}`)}else throw new TypeError(`string-strip-html/stripHtml(): [THROW_ID_02] Optional Options Object must be a plain object! Currently it's: ${(typeof e).toLowerCase()}, equal to:
${JSON.stringify(e,null,4)}`);function L(){E&&(m={tagName:"",hrefValue:"",openingTagEnds:void 0},E=!1)}let I={...$2,...e,dumpLinkHrefsNearby:Object.assign({},$2.dumpLinkHrefsNearby,e==null?void 0:e.dumpLinkHrefsNearby)};if(HP(I,"returnRangesOnly"))throw new TypeError("string-strip-html/stripHtml(): [THROW_ID_05] The Optional Options Object's key returnRangesOnly has been removed from the API since v.5 release.");if(I.reportProgressFunc){if(typeof I.reportProgressFuncFrom!="number")throw new Error(`string-strip-html/stripHtml(): [THROW_ID_06] The Optional Options Object's key reportProgressFuncFrom, callback function's "from" range, should be a number but it was given as type ${typeof I.reportProgressFuncFrom}, equal to ${JSON.stringify(I.reportProgressFuncFrom,null,4)}`);if(typeof I.reportProgressFuncTo!="number")throw new Error(`string-strip-html/stripHtml(): [THROW_ID_07] The Optional Options Object's key reportProgressFuncTo, callback function's "to" range, should be a number but it was given as type ${typeof I.reportProgressFuncTo}, equal to ${JSON.stringify(I.reportProgressFuncTo,null,4)}`)}I.ignoreTags=F2(I.ignoreTags,"resolvedOpts.ignoreTags"),I.onlyStripTags=F2(I.onlyStripTags,"resolvedOpts.onlyStripTags");let U=!!I.onlyStripTags.length;I.onlyStripTags.length&&I.ignoreTags.length&&(I.onlyStripTags=zO(I.onlyStripTags,...I.ignoreTags)),I.stripTogetherWithTheirContents?typeof I.stripTogetherWithTheirContents=="string"&&I.stripTogetherWithTheirContents.length&&(I.stripTogetherWithTheirContents=[I.stripTogetherWithTheirContents]):I.stripTogetherWithTheirContents=[];let q={};if(I.stripTogetherWithTheirContents&&Array.isArray(I.stripTogetherWithTheirContents)&&I.stripTogetherWithTheirContents.length&&!I.stripTogetherWithTheirContents.every((B,ae)=>typeof B!="string"?(q.el=B,q.i=ae,!1):!0))throw new TypeError(`string-strip-html/stripHtml(): [THROW_ID_08] Optional Options Object's key stripTogetherWithTheirContents was set to contain not just string elements! For example, element at index ${q.i} has a value ${q.el} which is not string but ${(typeof q.el).toLowerCase()}.`);I.cb||(I.cb=({rangesArr:B,proposedReturn:ae})=>{ae&&B.push(...ae)});let $=new fF({limitToBeAddedWhitespace:!0,limitLinebreaksCount:2});if(!I.skipHtmlDecoding)for(;i!==P2(i,{scope:"strict"});)i=P2(i,{scope:"strict"});let X=!1,ne=!1,se=0,ce=0,ie=i.length,H=Math.floor(ie/2);for(let B=0;B<ie;B++){if(I.reportProgressFunc&&(ie>1e3&&ie<2e3?B===H&&I.reportProgressFunc(Math.floor((I.reportProgressFuncTo-I.reportProgressFuncFrom)/2)):ie>=2e3&&(se=I.reportProgressFuncFrom+Math.floor(B/ie*(I.reportProgressFuncTo-I.reportProgressFuncFrom)),se!==ce&&(ce=se,I.reportProgressFunc(se)))),Object.keys(o).length>1&&o.lastClosingBracketAt&&o.lastClosingBracketAt<B&&i[B]!==" "&&A===null&&(A=B),!X&&i[B]==="%"&&i[B-1]==="{"&&i.includes("%}",B+1)){d=null;let ae=i.indexOf("%}",B)-1;if(ae>B){B=ae;continue}}if(!X&&C(B)&&(!o||Object.keys(o).length<2)&&B>1){for(let ae=B;ae--;)if(i[ae-1]===void 0||C(ae)){let Ae=i[ae-1]===void 0?ae:ae+1,be=i.slice(Ae,B+1)||"";if((be.includes("/>")||be.includes("/ >")||be.includes('="')||be.includes("='"))&&i!==`<${L2(be.trim(),"/>")}>`&&[...fl].some(ge=>L2(be.trim().split(/\s+/).filter(Ne=>Ne.trim()).filter((Ne,Pe)=>Pe===0),"/>").toLowerCase()===ge)&&G2(`<${be.trim()}>`,I).result===""){(!s.length||s[s.length-1][0]!==o.lastOpeningBracketAt)&&s.push([Ae,B+1]),(!a.length||a[a.length-1][0]!==o.lastOpeningBracketAt)&&a.push([Ae,B+1]);let ge=_(i,B,Ae,B+1,Ae,B+1),Ne=B+1;if(i[Ne]&&!i[Ne].trim()){for(let Pe=Ne;Pe<ie;Pe++)if(i[Pe].trim()){Ne=Pe;break}}I.cb({tag:o,deleteFrom:Ae,deleteTo:Ne,insert:ge,rangesArr:$,proposedReturn:[Ae,Ne,ge]})}break}}if(!ne&&i[B]==="/"&&!((ve=o.quotes)!=null&&ve.value)&&Number.isInteger(o.lastOpeningBracketAt)&&!Number.isInteger(o.lastClosingBracketAt)&&(o.slashPresent=B),i[B]==='"'||i[B]==="'")if(!ne&&o.nameStarts&&((fe=o==null?void 0:o.quotes)==null?void 0:fe.value)===i[B])if(g.valueStarts===void 0)g={},delete o.quotes;else{g.valueEnds=B,g.value=i.slice(g.valueStarts,B),o.attributes.push(g),g={},delete o.quotes;let ae;(De=I.dumpLinkHrefsNearby)!=null&&De.enabled&&!r.length&&o.attributes.some(Ae=>{var be,ge;if(typeof Ae.name=="string"&&Ae.name.toLowerCase()==="href")return ae=`${((be=I.dumpLinkHrefsNearby)==null?void 0:be.wrapHeads)||""}${Ae.value}${((ge=I.dumpLinkHrefsNearby)==null?void 0:ge.wrapTails)||""}`,!0})&&(m={tagName:o.name,hrefValue:ae,openingTagEnds:void 0})}else!ne&&!o.quotes&&o.nameStarts&&(o.quotes={},o.quotes.value=i[B],o.quotes.start=B,o.quotes.next=i.indexOf(i[B],B+1),g.nameStarts&&g.nameEnds&&g.nameEnds<B&&g.nameStarts<B&&!g.valueStarts&&(g.name=i.slice(g.nameStarts,g.nameEnds)));if(o.nameStarts!==void 0&&o.nameEnds===void 0&&(!i[B].trim()||!pF(i[B]))){if(o.nameEnds=B,o.name=i.slice(o.nameStarts,o.nameEnds+(!C(B)&&i[B]!=="/"&&i[B+1]===void 0?1:0)),i[o.nameStarts-1]!=="!"&&!o.name.replace(/-/g,"").length||/^\d+$/.test(o.name[0])){o={};continue}if(typeof o.name=="string"&&o.name.toLowerCase()==="doctype"&&(ne=!0),w(B)){F(I);let ae=_(i,B,o.leftOuterWhitespace,B,o.lastOpeningBracketAt,B);(I.stripTogetherWithTheirContents.includes(o.name)||I.stripTogetherWithTheirContents.includes("*"))&&(a=a.filter(([Ae,be])=>!(Ae===o.leftOuterWhitespace&&be===B))),I.cb({tag:o,deleteFrom:o.leftOuterWhitespace,deleteTo:B,insert:`${ae}${v}${ae}`,rangesArr:$,proposedReturn:[o.leftOuterWhitespace,B,`${ae}${v}${ae}`]}),L(),R(B,I,$)}}if((Ie=o.quotes)!=null&&Ie.start&&o.quotes.start<B&&!o.quotes.end&&g.nameEnds&&g.equalsAt&&!g.valueStarts&&(g.valueStarts=B),!o.quotes&&g.nameEnds&&i[B]==="="&&!g.valueStarts&&!g.equalsAt&&(g.equalsAt=B),!o.quotes&&g.nameStarts&&g.nameEnds&&!g.valueStarts&&i[B].trim()&&i[B]!=="="&&(o.attributes.push(g),g={}),!o.quotes&&g.nameStarts&&!g.nameEnds&&(ne&&`'"`.includes(i[g.nameStarts])?g.nameStarts<B&&i[B]===i[g.nameStarts]&&(g.nameEnds=B+1,g.name=i.slice(g.nameStarts,g.nameEnds)):i[B].trim()?i[B]==="="?g.equalsAt||(g.nameEnds=B,g.equalsAt=B,g.name=i.slice(g.nameStarts,g.nameEnds)):i[B]==="/"||C(B)?(g.nameEnds=B,g.name=i.slice(g.nameStarts,g.nameEnds),o.attributes.push(g),g={}):w(B)&&(g.nameEnds=B,g.name=i.slice(g.nameStarts,g.nameEnds),o.attributes.push(g),g={}):(g.nameEnds=B,g.name=i.slice(g.nameStarts,g.nameEnds))),!o.quotes&&o.nameEnds<B&&!i[B-1].trim()&&i[B].trim()&&!"<>/!".includes(i[B])&&!g.nameStarts&&!o.lastClosingBracketAt&&(g.nameStarts=B),o.lastOpeningBracketAt!==null&&o.lastOpeningBracketAt<B&&i[B]==="/"&&o.onlyPlausible&&(o.onlyPlausible=!1),o.lastOpeningBracketAt!==null&&o.lastOpeningBracketAt<B&&i[B]!=="/"&&(o.onlyPlausible===void 0&&((!i[B].trim()||w(B))&&!o.slashPresent?o.onlyPlausible=!0:o.onlyPlausible=!1),i[B].trim()&&o.nameStarts===void 0&&!w(B)&&i[B]!=="/"&&!C(B)&&i[B]!=="!"&&(o.nameStarts=B,o.nameContainsLetters=!1)),o.nameStarts&&!o.quotes&&typeof i[B]=="string"&&i[B].toLowerCase()!==i[B].toUpperCase()&&(o.nameContainsLetters=!0),C(B)&&(B2(o,i,B)||o.quotes.value&&typeof o.lastOpeningBracketAt=="number"&&mF(o.quotes.value,i.slice(o.lastOpeningBracketAt,B))%2===1&&!i.slice(o.lastOpeningBracketAt+1,B).includes("<")&&!i.slice(o.lastOpeningBracketAt+1,B).includes(">"))&&o.lastOpeningBracketAt!==void 0&&(o.lastClosingBracketAt=B,A=null,Object.keys(g).length&&(o.attributes.push(g),g={}),(we=I.dumpLinkHrefsNearby)!=null&&we.enabled&&m.tagName&&!m.openingTagEnds&&(m.openingTagEnds=B)),(!ne||i[B]===">")&&o.lastOpeningBracketAt!==void 0){if(o.lastClosingBracketAt===void 0){if(o.lastOpeningBracketAt<B&&!w(B)&&(i[B+1]===void 0||w(B+1)&&!((Ue=o==null?void 0:o.quotes)!=null&&Ue.value))&&o.nameContainsLetters&&typeof o.nameStarts=="number"){if(o.name=i.slice(o.nameStarts,o.nameEnds||B+1).toLowerCase(),(!s.length||s[s.length-1][0]!==o.lastOpeningBracketAt)&&s.push([o.lastOpeningBracketAt,B+1]),I.ignoreTags.includes(o.name)||M(B,I,o)||!fl.has(o.name)&&(o.onlyPlausible||I.stripRecognisedHTMLOnly)){o={},g={};continue}if((fl.has(o.name)||pp.has(o.name))&&(o.onlyPlausible===!1||o.onlyPlausible===!0&&o.attributes.length)||i[B+1]===void 0){F(I);let ae=_(i,B,o.leftOuterWhitespace,B+1,o.lastOpeningBracketAt,o.lastClosingBracketAt);X&&o.name==="script"&&o.slashPresent&&(X=!1);let Ae;ae===null||v===null?Ae=null:Ae=`${ae}${v}${ae}`,I.cb({tag:o,deleteFrom:o.leftOuterWhitespace,deleteTo:B+1,insert:Ae,rangesArr:$,proposedReturn:[o.leftOuterWhitespace,B+1,Ae]}),L(),R(B,I,$)}if(!a.length||a[a.length-1][0]!==o.lastOpeningBracketAt&&a[a.length-1][1]!==B+1)if(I.stripTogetherWithTheirContents.includes(o.name)||I.stripTogetherWithTheirContents.includes("*")){let ae;for(let Ae=r.length;Ae--;)r[Ae].name===o.name&&(ae=r[Ae]);ae?(a=a.filter(([Ae])=>Ae!==ae.lastOpeningBracketAt),a.push([ae.lastOpeningBracketAt,B+1])):a.push([o.lastOpeningBracketAt,B+1])}else a.push([o.lastOpeningBracketAt,B+1])}}else if(B>o.lastClosingBracketAt&&i[B].trim()||i[B+1]===void 0||I.ignoreIndentations&&`\r
`.includes(i[B])){let ae=o.lastClosingBracketAt===B?B+1:B;I.trimOnlySpaces&&ae===ie-1&&A!==null&&A<B&&(ae=A),(!s.length||s[s.length-1][0]!==o.lastOpeningBracketAt)&&s.push([o.lastOpeningBracketAt,o.lastClosingBracketAt+1]);let Ae=I.ignoreTags.includes(o.name),be=M(B,I,o);if(!D||I.stripRecognisedHTMLOnly&&typeof o.name=="string"&&!fl.has(o.name.toLowerCase())&&!pp.has(o.name.toLowerCase())||!U&&(Ae||be)||U&&!I.onlyStripTags.includes(o.name)||I.ignoreTagsWithTheirContents.includes(o.name)){if(be)if(o.slashPresent){for(let ge=n.length;ge--;)if(n[ge].name===o.name){n.splice(ge,1);break}n.length||(D=!0)}else D&&(D=!1),n.push(o);I.cb({tag:o,deleteFrom:null,deleteTo:null,insert:null,rangesArr:$,proposedReturn:null}),o={},g={}}else if(!o.onlyPlausible||o.attributes.length===0&&o.name&&(fl.has(o.name.toLowerCase())||pp.has(o.name.toLowerCase()))||($e=o.attributes)!=null&&$e.some(ge=>ge.equalsAt)){(!a.length||a[a.length-1][0]!==o.lastOpeningBracketAt)&&a.push([o.lastOpeningBracketAt,o.lastClosingBracketAt+1]);let ge=_(i,B,o.leftOuterWhitespace,ae,o.lastOpeningBracketAt,o.lastClosingBracketAt);v="",E=!1,F(I,ae);let Ne;typeof v=="string"&&v.length?(Ne=`${ge}${v}${ge===`

`?`
`:ge}`,ae===o.lastClosingBracketAt+1&&(!i[ae]||!mp.has(i[ae]))&&(Ne+=" "),o.leftOuterWhitespace===o.lastOpeningBracketAt&&$.last()&&$.last()[1]<o.lastOpeningBracketAt&&(!((et=I==null?void 0:I.dumpLinkHrefsNearby)!=null&&et.putOnNewLine)||!mp.has(i[ae]))&&(Ne=" "+Ne)):Ne=ge,Ne!==null&&(o.leftOuterWhitespace===0||!cn(i,ae-1))&&(!((it=I.dumpLinkHrefsNearby)!=null&&it.enabled)||o.name!=="a")&&(Ne=void 0);let Pe=0;if(E&&mp.has(i[ae])){(Ge=I.dumpLinkHrefsNearby)!=null&&Ge.putOnNewLine&&(Ne=`${i[ae]}${Ne||""}`);let ue=cn(i,ae);ue&&(Ne!=null&&Ne.endsWith(`
`))?Pe+=ue-B:(!ue||ue>B)&&Pe++}I.cb({tag:o,deleteFrom:o.leftOuterWhitespace,deleteTo:ae+Pe,insert:Ne,rangesArr:$,proposedReturn:[o.leftOuterWhitespace,ae+Pe,Ne]}),L(),R(B,I,$)}else o={};C(B)||(o={})}ne&&(ne=!1)}if((!X||i[B]==="<"&&cn(i,cn(i,B))&&i[cn(i,B)]==="/"&&i.startsWith("script",cn(i,cn(i,B))))&&w(B)&&!w(B-1)&&!`'"`.includes(i[B+1])&&(!`'"`.includes(i[B+2])||/\w/.test(i[B+1]))&&!(i[B+1]==="c"&&i[B+2]===":")&&!(i[B+1]==="f"&&i[B+2]==="m"&&i[B+3]==="t"&&i[B+4]===":")&&!(i[B+1]==="s"&&i[B+2]==="q"&&i[B+3]==="l"&&i[B+4]===":")&&!(i[B+1]==="x"&&i[B+2]===":")&&!(i[B+1]==="f"&&i[B+2]==="n"&&i[B+3]===":")&&B2(o,i,B)){if(C(cn(i,B)))continue;if(o.nameEnds&&o.nameEnds<B&&!o.lastClosingBracketAt&&(o.onlyPlausible===!0&&((st=o.attributes)!=null&&st.length)||o.onlyPlausible===!1)){let ae=_(i,B,o.leftOuterWhitespace,B,o.lastOpeningBracketAt,B);I.cb({tag:o,deleteFrom:o.leftOuterWhitespace,deleteTo:B,insert:ae,rangesArr:$,proposedReturn:[o.leftOuterWhitespace,B,ae]}),R(B,I,$),o={},g={}}if(o.lastOpeningBracketAt!==void 0&&o.onlyPlausible&&o.name&&!o.quotes&&(o.lastOpeningBracketAt=void 0,o.name=void 0,o.onlyPlausible=!1),(o.lastOpeningBracketAt===void 0||!o.onlyPlausible)&&!o.quotes&&(o.lastOpeningBracketAt=B,o.slashPresent=!1,o.attributes=[],u===null?o.leftOuterWhitespace=B:I.trimOnlySpaces&&u===0?o.leftOuterWhitespace=h||B:o.leftOuterWhitespace=u,`${i[B+1]}${i[B+2]}${i[B+3]}`=="!--"||`${i[B+1]}${i[B+2]}${i[B+3]}${i[B+4]}${i[B+5]}${i[B+6]}${i[B+7]}${i[B+8]}`=="![CDATA[")){let ae=!0;i[B+2]==="-"&&(ae=!1);let Ae;for(let be=B;be<ie;be++)if((!Ae&&ae&&`${i[be-2]}${i[be-1]}${i[be]}`=="]]>"||!ae&&`${i[be-2]}${i[be-1]}${i[be]}`=="-->")&&(Ae=be),Ae&&(Ae<be&&i[be].trim()||i[be+1]===void 0)){let ge=be;(i[be+1]===void 0&&!i[be].trim()||i[be]===">")&&(ge+=1),(!s.length||s[s.length-1][0]!==o.lastOpeningBracketAt)&&s.push([o.lastOpeningBracketAt,Ae+1]),(!a.length||a[a.length-1][0]!==o.lastOpeningBracketAt)&&a.push([o.lastOpeningBracketAt,Ae+1]);let Ne=_(i,be,o.leftOuterWhitespace,ge,o.lastOpeningBracketAt,Ae);I.cb({tag:o,deleteFrom:o.leftOuterWhitespace,deleteTo:ge,insert:Ne,rangesArr:$,proposedReturn:[o.leftOuterWhitespace,ge,Ne]}),B=be-1,i[be]===">"&&(B=be),o={},g={};break}}}!i[B].trim()||i[B].charCodeAt(0)===847?(u===null&&(u=B,o.lastOpeningBracketAt!==void 0&&o.lastOpeningBracketAt<B&&o.nameStarts&&o.nameStarts<o.lastOpeningBracketAt&&B===o.lastOpeningBracketAt+1&&!r.some(ae=>ae.name===o.name)&&(o.onlyPlausible=!0,o.name=void 0,o.nameStarts=void 0)),(i[B]===`
`||i[B]==="\r")&&(d=B,p&&(p=!1))):(u!==null&&(!o.quotes&&g.equalsAt>u-1&&g.nameEnds&&g.equalsAt>g.nameEnds&&i[B]!=='"'&&i[B]!=="'"&&(tp(g)&&o.attributes.push(g),g={},o.equalsSpottedAt=void 0),u=null),p||(p=!0,D&&!X&&typeof d=="number"&&B&&d<B-1&&(i.slice(d+1,B).trim()?d=null:I.ignoreIndentations||$.push([d+1,B])))),i[B]===" "?h===null&&(h=B):h!==null&&(h=null),o.name==="script"&&(X=!o.slashPresent)}if(i&&!I.ignoreIndentations&&(I.trimOnlySpaces&&i[0]===" "||!I.trimOnlySpaces&&!i[0].trim()))for(let B=0;B<ie;B++)if(I.trimOnlySpaces&&i[B]!==" "||!I.trimOnlySpaces&&i[B].trim()){$.push([0,B]);break}else i[B+1]||$.push([0,B+1]);if(i&&(I.trimOnlySpaces&&i[~-i.length]===" "||!I.trimOnlySpaces&&!i[~-i.length].trim())){for(let B=i.length;B--;)if(I.trimOnlySpaces&&i[B]!==" "||!I.trimOnlySpaces&&i[B].trim()){$.push([B+1,ie]);break}}let J=$.current();if(!(e!=null&&e.cb)&&J&&(J[0]&&!J[0][0]&&(J[0][1],$.ranges[0]=[$.ranges[0][0],$.ranges[0][1]]),J[J.length-1]&&J[J.length-1][1]===i.length&&(J[J.length-1][0],$.ranges))){let B=$.ranges[$.ranges.length-1][0];i[B-1]&&(I.trimOnlySpaces&&i[B-1]===" "||!I.trimOnlySpaces&&!i[B-1].trim())&&(B-=1);let ae=$.ranges[$.ranges.length-1][2];$.ranges[$.ranges.length-1]=[B,$.ranges[$.ranges.length-1][1]],ae!=null&&ae.trim()&&$.ranges[$.ranges.length-1].push(ae.trimEnd())}return{log:{timeTakenInMilliseconds:Date.now()-t},result:cF(i,$.current()),ranges:$.current(),allTagLocations:s,filteredTagLocations:a}}var gl={exports:{}};/*! https://mths.be/he v1.2.0 by @mathias | MIT license */var vF=gl.exports,q2;function EF(){return q2||(q2=1,function(i,e){(function(t){var r=e,n=i&&i.exports==r&&i,s=typeof wi=="object"&&wi;(s.global===s||s.window===s)&&(t=s);var a=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,o=/[\x01-\x7F]/g,l=/[\x01-\t\x0B\f\x0E-\x1F\x7F\x81\x8D\x8F\x90\x9D\xA0-\uFFFF]/g,u=/<\u20D2|=\u20E5|>\u20D2|\u205F\u200A|\u219D\u0338|\u2202\u0338|\u2220\u20D2|\u2229\uFE00|\u222A\uFE00|\u223C\u20D2|\u223D\u0331|\u223E\u0333|\u2242\u0338|\u224B\u0338|\u224D\u20D2|\u224E\u0338|\u224F\u0338|\u2250\u0338|\u2261\u20E5|\u2264\u20D2|\u2265\u20D2|\u2266\u0338|\u2267\u0338|\u2268\uFE00|\u2269\uFE00|\u226A\u0338|\u226A\u20D2|\u226B\u0338|\u226B\u20D2|\u227F\u0338|\u2282\u20D2|\u2283\u20D2|\u228A\uFE00|\u228B\uFE00|\u228F\u0338|\u2290\u0338|\u2293\uFE00|\u2294\uFE00|\u22B4\u20D2|\u22B5\u20D2|\u22D8\u0338|\u22D9\u0338|\u22DA\uFE00|\u22DB\uFE00|\u22F5\u0338|\u22F9\u0338|\u2933\u0338|\u29CF\u0338|\u29D0\u0338|\u2A6D\u0338|\u2A70\u0338|\u2A7D\u0338|\u2A7E\u0338|\u2AA1\u0338|\u2AA2\u0338|\u2AAC\uFE00|\u2AAD\uFE00|\u2AAF\u0338|\u2AB0\u0338|\u2AC5\u0338|\u2AC6\u0338|\u2ACB\uFE00|\u2ACC\uFE00|\u2AFD\u20E5|[\xA0-\u0113\u0116-\u0122\u0124-\u012B\u012E-\u014D\u0150-\u017E\u0192\u01B5\u01F5\u0237\u02C6\u02C7\u02D8-\u02DD\u0311\u0391-\u03A1\u03A3-\u03A9\u03B1-\u03C9\u03D1\u03D2\u03D5\u03D6\u03DC\u03DD\u03F0\u03F1\u03F5\u03F6\u0401-\u040C\u040E-\u044F\u0451-\u045C\u045E\u045F\u2002-\u2005\u2007-\u2010\u2013-\u2016\u2018-\u201A\u201C-\u201E\u2020-\u2022\u2025\u2026\u2030-\u2035\u2039\u203A\u203E\u2041\u2043\u2044\u204F\u2057\u205F-\u2063\u20AC\u20DB\u20DC\u2102\u2105\u210A-\u2113\u2115-\u211E\u2122\u2124\u2127-\u2129\u212C\u212D\u212F-\u2131\u2133-\u2138\u2145-\u2148\u2153-\u215E\u2190-\u219B\u219D-\u21A7\u21A9-\u21AE\u21B0-\u21B3\u21B5-\u21B7\u21BA-\u21DB\u21DD\u21E4\u21E5\u21F5\u21FD-\u2205\u2207-\u2209\u220B\u220C\u220F-\u2214\u2216-\u2218\u221A\u221D-\u2238\u223A-\u2257\u2259\u225A\u225C\u225F-\u2262\u2264-\u228B\u228D-\u229B\u229D-\u22A5\u22A7-\u22B0\u22B2-\u22BB\u22BD-\u22DB\u22DE-\u22E3\u22E6-\u22F7\u22F9-\u22FE\u2305\u2306\u2308-\u2310\u2312\u2313\u2315\u2316\u231C-\u231F\u2322\u2323\u232D\u232E\u2336\u233D\u233F\u237C\u23B0\u23B1\u23B4-\u23B6\u23DC-\u23DF\u23E2\u23E7\u2423\u24C8\u2500\u2502\u250C\u2510\u2514\u2518\u251C\u2524\u252C\u2534\u253C\u2550-\u256C\u2580\u2584\u2588\u2591-\u2593\u25A1\u25AA\u25AB\u25AD\u25AE\u25B1\u25B3-\u25B5\u25B8\u25B9\u25BD-\u25BF\u25C2\u25C3\u25CA\u25CB\u25EC\u25EF\u25F8-\u25FC\u2605\u2606\u260E\u2640\u2642\u2660\u2663\u2665\u2666\u266A\u266D-\u266F\u2713\u2717\u2720\u2736\u2758\u2772\u2773\u27C8\u27C9\u27E6-\u27ED\u27F5-\u27FA\u27FC\u27FF\u2902-\u2905\u290C-\u2913\u2916\u2919-\u2920\u2923-\u292A\u2933\u2935-\u2939\u293C\u293D\u2945\u2948-\u294B\u294E-\u2976\u2978\u2979\u297B-\u297F\u2985\u2986\u298B-\u2996\u299A\u299C\u299D\u29A4-\u29B7\u29B9\u29BB\u29BC\u29BE-\u29C5\u29C9\u29CD-\u29D0\u29DC-\u29DE\u29E3-\u29E5\u29EB\u29F4\u29F6\u2A00-\u2A02\u2A04\u2A06\u2A0C\u2A0D\u2A10-\u2A17\u2A22-\u2A27\u2A29\u2A2A\u2A2D-\u2A31\u2A33-\u2A3C\u2A3F\u2A40\u2A42-\u2A4D\u2A50\u2A53-\u2A58\u2A5A-\u2A5D\u2A5F\u2A66\u2A6A\u2A6D-\u2A75\u2A77-\u2A9A\u2A9D-\u2AA2\u2AA4-\u2AB0\u2AB3-\u2AC8\u2ACB\u2ACC\u2ACF-\u2ADB\u2AE4\u2AE6-\u2AE9\u2AEB-\u2AF3\u2AFD\uFB00-\uFB04]|\uD835[\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDCCF\uDD04\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDD6B]/g,h={"­":"shy","‌":"zwnj","‍":"zwj","‎":"lrm","⁣":"ic","⁢":"it","⁡":"af","‏":"rlm","​":"ZeroWidthSpace","⁠":"NoBreak","̑":"DownBreve","⃛":"tdot","⃜":"DotDot","	":"Tab","\n":"NewLine"," ":"puncsp"," ":"MediumSpace"," ":"thinsp"," ":"hairsp"," ":"emsp13"," ":"ensp"," ":"emsp14"," ":"emsp"," ":"numsp"," ":"nbsp","  ":"ThickSpace","‾":"oline",_:"lowbar","‐":"dash","–":"ndash","—":"mdash","―":"horbar",",":"comma",";":"semi","⁏":"bsemi",":":"colon","⩴":"Colone","!":"excl","¡":"iexcl","?":"quest","¿":"iquest",".":"period","‥":"nldr","…":"mldr","·":"middot","'":"apos","‘":"lsquo","’":"rsquo","‚":"sbquo","‹":"lsaquo","›":"rsaquo",'"':"quot","“":"ldquo","”":"rdquo","„":"bdquo","«":"laquo","»":"raquo","(":"lpar",")":"rpar","[":"lsqb","]":"rsqb","{":"lcub","}":"rcub","⌈":"lceil","⌉":"rceil","⌊":"lfloor","⌋":"rfloor","⦅":"lopar","⦆":"ropar","⦋":"lbrke","⦌":"rbrke","⦍":"lbrkslu","⦎":"rbrksld","⦏":"lbrksld","⦐":"rbrkslu","⦑":"langd","⦒":"rangd","⦓":"lparlt","⦔":"rpargt","⦕":"gtlPar","⦖":"ltrPar","⟦":"lobrk","⟧":"robrk","⟨":"lang","⟩":"rang","⟪":"Lang","⟫":"Rang","⟬":"loang","⟭":"roang","❲":"lbbrk","❳":"rbbrk","‖":"Vert","§":"sect","¶":"para","@":"commat","*":"ast","/":"sol",undefined:null,"&":"amp","#":"num","%":"percnt","‰":"permil","‱":"pertenk","†":"dagger","‡":"Dagger","•":"bull","⁃":"hybull","′":"prime","″":"Prime","‴":"tprime","⁗":"qprime","‵":"bprime","⁁":"caret","`":"grave","´":"acute","˜":"tilde","^":"Hat","¯":"macr","˘":"breve","˙":"dot","¨":"die","˚":"ring","˝":"dblac","¸":"cedil","˛":"ogon","ˆ":"circ","ˇ":"caron","°":"deg","©":"copy","®":"reg","℗":"copysr","℘":"wp","℞":"rx","℧":"mho","℩":"iiota","←":"larr","↚":"nlarr","→":"rarr","↛":"nrarr","↑":"uarr","↓":"darr","↔":"harr","↮":"nharr","↕":"varr","↖":"nwarr","↗":"nearr","↘":"searr","↙":"swarr","↝":"rarrw","↝̸":"nrarrw","↞":"Larr","↟":"Uarr","↠":"Rarr","↡":"Darr","↢":"larrtl","↣":"rarrtl","↤":"mapstoleft","↥":"mapstoup","↦":"map","↧":"mapstodown","↩":"larrhk","↪":"rarrhk","↫":"larrlp","↬":"rarrlp","↭":"harrw","↰":"lsh","↱":"rsh","↲":"ldsh","↳":"rdsh","↵":"crarr","↶":"cularr","↷":"curarr","↺":"olarr","↻":"orarr","↼":"lharu","↽":"lhard","↾":"uharr","↿":"uharl","⇀":"rharu","⇁":"rhard","⇂":"dharr","⇃":"dharl","⇄":"rlarr","⇅":"udarr","⇆":"lrarr","⇇":"llarr","⇈":"uuarr","⇉":"rrarr","⇊":"ddarr","⇋":"lrhar","⇌":"rlhar","⇐":"lArr","⇍":"nlArr","⇑":"uArr","⇒":"rArr","⇏":"nrArr","⇓":"dArr","⇔":"iff","⇎":"nhArr","⇕":"vArr","⇖":"nwArr","⇗":"neArr","⇘":"seArr","⇙":"swArr","⇚":"lAarr","⇛":"rAarr","⇝":"zigrarr","⇤":"larrb","⇥":"rarrb","⇵":"duarr","⇽":"loarr","⇾":"roarr","⇿":"hoarr","∀":"forall","∁":"comp","∂":"part","∂̸":"npart","∃":"exist","∄":"nexist","∅":"empty","∇":"Del","∈":"in","∉":"notin","∋":"ni","∌":"notni","϶":"bepsi","∏":"prod","∐":"coprod","∑":"sum","+":"plus","±":"pm","÷":"div","×":"times","<":"lt","≮":"nlt","<⃒":"nvlt","=":"equals","≠":"ne","=⃥":"bne","⩵":"Equal",">":"gt","≯":"ngt",">⃒":"nvgt","¬":"not","|":"vert","¦":"brvbar","−":"minus","∓":"mp","∔":"plusdo","⁄":"frasl","∖":"setmn","∗":"lowast","∘":"compfn","√":"Sqrt","∝":"prop","∞":"infin","∟":"angrt","∠":"ang","∠⃒":"nang","∡":"angmsd","∢":"angsph","∣":"mid","∤":"nmid","∥":"par","∦":"npar","∧":"and","∨":"or","∩":"cap","∩︀":"caps","∪":"cup","∪︀":"cups","∫":"int","∬":"Int","∭":"tint","⨌":"qint","∮":"oint","∯":"Conint","∰":"Cconint","∱":"cwint","∲":"cwconint","∳":"awconint","∴":"there4","∵":"becaus","∶":"ratio","∷":"Colon","∸":"minusd","∺":"mDDot","∻":"homtht","∼":"sim","≁":"nsim","∼⃒":"nvsim","∽":"bsim","∽̱":"race","∾":"ac","∾̳":"acE","∿":"acd","≀":"wr","≂":"esim","≂̸":"nesim","≃":"sime","≄":"nsime","≅":"cong","≇":"ncong","≆":"simne","≈":"ap","≉":"nap","≊":"ape","≋":"apid","≋̸":"napid","≌":"bcong","≍":"CupCap","≭":"NotCupCap","≍⃒":"nvap","≎":"bump","≎̸":"nbump","≏":"bumpe","≏̸":"nbumpe","≐":"doteq","≐̸":"nedot","≑":"eDot","≒":"efDot","≓":"erDot","≔":"colone","≕":"ecolon","≖":"ecir","≗":"cire","≙":"wedgeq","≚":"veeeq","≜":"trie","≟":"equest","≡":"equiv","≢":"nequiv","≡⃥":"bnequiv","≤":"le","≰":"nle","≤⃒":"nvle","≥":"ge","≱":"nge","≥⃒":"nvge","≦":"lE","≦̸":"nlE","≧":"gE","≧̸":"ngE","≨︀":"lvnE","≨":"lnE","≩":"gnE","≩︀":"gvnE","≪":"ll","≪̸":"nLtv","≪⃒":"nLt","≫":"gg","≫̸":"nGtv","≫⃒":"nGt","≬":"twixt","≲":"lsim","≴":"nlsim","≳":"gsim","≵":"ngsim","≶":"lg","≸":"ntlg","≷":"gl","≹":"ntgl","≺":"pr","⊀":"npr","≻":"sc","⊁":"nsc","≼":"prcue","⋠":"nprcue","≽":"sccue","⋡":"nsccue","≾":"prsim","≿":"scsim","≿̸":"NotSucceedsTilde","⊂":"sub","⊄":"nsub","⊂⃒":"vnsub","⊃":"sup","⊅":"nsup","⊃⃒":"vnsup","⊆":"sube","⊈":"nsube","⊇":"supe","⊉":"nsupe","⊊︀":"vsubne","⊊":"subne","⊋︀":"vsupne","⊋":"supne","⊍":"cupdot","⊎":"uplus","⊏":"sqsub","⊏̸":"NotSquareSubset","⊐":"sqsup","⊐̸":"NotSquareSuperset","⊑":"sqsube","⋢":"nsqsube","⊒":"sqsupe","⋣":"nsqsupe","⊓":"sqcap","⊓︀":"sqcaps","⊔":"sqcup","⊔︀":"sqcups","⊕":"oplus","⊖":"ominus","⊗":"otimes","⊘":"osol","⊙":"odot","⊚":"ocir","⊛":"oast","⊝":"odash","⊞":"plusb","⊟":"minusb","⊠":"timesb","⊡":"sdotb","⊢":"vdash","⊬":"nvdash","⊣":"dashv","⊤":"top","⊥":"bot","⊧":"models","⊨":"vDash","⊭":"nvDash","⊩":"Vdash","⊮":"nVdash","⊪":"Vvdash","⊫":"VDash","⊯":"nVDash","⊰":"prurel","⊲":"vltri","⋪":"nltri","⊳":"vrtri","⋫":"nrtri","⊴":"ltrie","⋬":"nltrie","⊴⃒":"nvltrie","⊵":"rtrie","⋭":"nrtrie","⊵⃒":"nvrtrie","⊶":"origof","⊷":"imof","⊸":"mumap","⊹":"hercon","⊺":"intcal","⊻":"veebar","⊽":"barvee","⊾":"angrtvb","⊿":"lrtri","⋀":"Wedge","⋁":"Vee","⋂":"xcap","⋃":"xcup","⋄":"diam","⋅":"sdot","⋆":"Star","⋇":"divonx","⋈":"bowtie","⋉":"ltimes","⋊":"rtimes","⋋":"lthree","⋌":"rthree","⋍":"bsime","⋎":"cuvee","⋏":"cuwed","⋐":"Sub","⋑":"Sup","⋒":"Cap","⋓":"Cup","⋔":"fork","⋕":"epar","⋖":"ltdot","⋗":"gtdot","⋘":"Ll","⋘̸":"nLl","⋙":"Gg","⋙̸":"nGg","⋚︀":"lesg","⋚":"leg","⋛":"gel","⋛︀":"gesl","⋞":"cuepr","⋟":"cuesc","⋦":"lnsim","⋧":"gnsim","⋨":"prnsim","⋩":"scnsim","⋮":"vellip","⋯":"ctdot","⋰":"utdot","⋱":"dtdot","⋲":"disin","⋳":"isinsv","⋴":"isins","⋵":"isindot","⋵̸":"notindot","⋶":"notinvc","⋷":"notinvb","⋹":"isinE","⋹̸":"notinE","⋺":"nisd","⋻":"xnis","⋼":"nis","⋽":"notnivc","⋾":"notnivb","⌅":"barwed","⌆":"Barwed","⌌":"drcrop","⌍":"dlcrop","⌎":"urcrop","⌏":"ulcrop","⌐":"bnot","⌒":"profline","⌓":"profsurf","⌕":"telrec","⌖":"target","⌜":"ulcorn","⌝":"urcorn","⌞":"dlcorn","⌟":"drcorn","⌢":"frown","⌣":"smile","⌭":"cylcty","⌮":"profalar","⌶":"topbot","⌽":"ovbar","⌿":"solbar","⍼":"angzarr","⎰":"lmoust","⎱":"rmoust","⎴":"tbrk","⎵":"bbrk","⎶":"bbrktbrk","⏜":"OverParenthesis","⏝":"UnderParenthesis","⏞":"OverBrace","⏟":"UnderBrace","⏢":"trpezium","⏧":"elinters","␣":"blank","─":"boxh","│":"boxv","┌":"boxdr","┐":"boxdl","└":"boxur","┘":"boxul","├":"boxvr","┤":"boxvl","┬":"boxhd","┴":"boxhu","┼":"boxvh","═":"boxH","║":"boxV","╒":"boxdR","╓":"boxDr","╔":"boxDR","╕":"boxdL","╖":"boxDl","╗":"boxDL","╘":"boxuR","╙":"boxUr","╚":"boxUR","╛":"boxuL","╜":"boxUl","╝":"boxUL","╞":"boxvR","╟":"boxVr","╠":"boxVR","╡":"boxvL","╢":"boxVl","╣":"boxVL","╤":"boxHd","╥":"boxhD","╦":"boxHD","╧":"boxHu","╨":"boxhU","╩":"boxHU","╪":"boxvH","╫":"boxVh","╬":"boxVH","▀":"uhblk","▄":"lhblk","█":"block","░":"blk14","▒":"blk12","▓":"blk34","□":"squ","▪":"squf","▫":"EmptyVerySmallSquare","▭":"rect","▮":"marker","▱":"fltns","△":"xutri","▴":"utrif","▵":"utri","▸":"rtrif","▹":"rtri","▽":"xdtri","▾":"dtrif","▿":"dtri","◂":"ltrif","◃":"ltri","◊":"loz","○":"cir","◬":"tridot","◯":"xcirc","◸":"ultri","◹":"urtri","◺":"lltri","◻":"EmptySmallSquare","◼":"FilledSmallSquare","★":"starf","☆":"star","☎":"phone","♀":"female","♂":"male","♠":"spades","♣":"clubs","♥":"hearts","♦":"diams","♪":"sung","✓":"check","✗":"cross","✠":"malt","✶":"sext","❘":"VerticalSeparator","⟈":"bsolhsub","⟉":"suphsol","⟵":"xlarr","⟶":"xrarr","⟷":"xharr","⟸":"xlArr","⟹":"xrArr","⟺":"xhArr","⟼":"xmap","⟿":"dzigrarr","⤂":"nvlArr","⤃":"nvrArr","⤄":"nvHarr","⤅":"Map","⤌":"lbarr","⤍":"rbarr","⤎":"lBarr","⤏":"rBarr","⤐":"RBarr","⤑":"DDotrahd","⤒":"UpArrowBar","⤓":"DownArrowBar","⤖":"Rarrtl","⤙":"latail","⤚":"ratail","⤛":"lAtail","⤜":"rAtail","⤝":"larrfs","⤞":"rarrfs","⤟":"larrbfs","⤠":"rarrbfs","⤣":"nwarhk","⤤":"nearhk","⤥":"searhk","⤦":"swarhk","⤧":"nwnear","⤨":"toea","⤩":"tosa","⤪":"swnwar","⤳":"rarrc","⤳̸":"nrarrc","⤵":"cudarrr","⤶":"ldca","⤷":"rdca","⤸":"cudarrl","⤹":"larrpl","⤼":"curarrm","⤽":"cularrp","⥅":"rarrpl","⥈":"harrcir","⥉":"Uarrocir","⥊":"lurdshar","⥋":"ldrushar","⥎":"LeftRightVector","⥏":"RightUpDownVector","⥐":"DownLeftRightVector","⥑":"LeftUpDownVector","⥒":"LeftVectorBar","⥓":"RightVectorBar","⥔":"RightUpVectorBar","⥕":"RightDownVectorBar","⥖":"DownLeftVectorBar","⥗":"DownRightVectorBar","⥘":"LeftUpVectorBar","⥙":"LeftDownVectorBar","⥚":"LeftTeeVector","⥛":"RightTeeVector","⥜":"RightUpTeeVector","⥝":"RightDownTeeVector","⥞":"DownLeftTeeVector","⥟":"DownRightTeeVector","⥠":"LeftUpTeeVector","⥡":"LeftDownTeeVector","⥢":"lHar","⥣":"uHar","⥤":"rHar","⥥":"dHar","⥦":"luruhar","⥧":"ldrdhar","⥨":"ruluhar","⥩":"rdldhar","⥪":"lharul","⥫":"llhard","⥬":"rharul","⥭":"lrhard","⥮":"udhar","⥯":"duhar","⥰":"RoundImplies","⥱":"erarr","⥲":"simrarr","⥳":"larrsim","⥴":"rarrsim","⥵":"rarrap","⥶":"ltlarr","⥸":"gtrarr","⥹":"subrarr","⥻":"suplarr","⥼":"lfisht","⥽":"rfisht","⥾":"ufisht","⥿":"dfisht","⦚":"vzigzag","⦜":"vangrt","⦝":"angrtvbd","⦤":"ange","⦥":"range","⦦":"dwangle","⦧":"uwangle","⦨":"angmsdaa","⦩":"angmsdab","⦪":"angmsdac","⦫":"angmsdad","⦬":"angmsdae","⦭":"angmsdaf","⦮":"angmsdag","⦯":"angmsdah","⦰":"bemptyv","⦱":"demptyv","⦲":"cemptyv","⦳":"raemptyv","⦴":"laemptyv","⦵":"ohbar","⦶":"omid","⦷":"opar","⦹":"operp","⦻":"olcross","⦼":"odsold","⦾":"olcir","⦿":"ofcir","⧀":"olt","⧁":"ogt","⧂":"cirscir","⧃":"cirE","⧄":"solb","⧅":"bsolb","⧉":"boxbox","⧍":"trisb","⧎":"rtriltri","⧏":"LeftTriangleBar","⧏̸":"NotLeftTriangleBar","⧐":"RightTriangleBar","⧐̸":"NotRightTriangleBar","⧜":"iinfin","⧝":"infintie","⧞":"nvinfin","⧣":"eparsl","⧤":"smeparsl","⧥":"eqvparsl","⧫":"lozf","⧴":"RuleDelayed","⧶":"dsol","⨀":"xodot","⨁":"xoplus","⨂":"xotime","⨄":"xuplus","⨆":"xsqcup","⨍":"fpartint","⨐":"cirfnint","⨑":"awint","⨒":"rppolint","⨓":"scpolint","⨔":"npolint","⨕":"pointint","⨖":"quatint","⨗":"intlarhk","⨢":"pluscir","⨣":"plusacir","⨤":"simplus","⨥":"plusdu","⨦":"plussim","⨧":"plustwo","⨩":"mcomma","⨪":"minusdu","⨭":"loplus","⨮":"roplus","⨯":"Cross","⨰":"timesd","⨱":"timesbar","⨳":"smashp","⨴":"lotimes","⨵":"rotimes","⨶":"otimesas","⨷":"Otimes","⨸":"odiv","⨹":"triplus","⨺":"triminus","⨻":"tritime","⨼":"iprod","⨿":"amalg","⩀":"capdot","⩂":"ncup","⩃":"ncap","⩄":"capand","⩅":"cupor","⩆":"cupcap","⩇":"capcup","⩈":"cupbrcap","⩉":"capbrcup","⩊":"cupcup","⩋":"capcap","⩌":"ccups","⩍":"ccaps","⩐":"ccupssm","⩓":"And","⩔":"Or","⩕":"andand","⩖":"oror","⩗":"orslope","⩘":"andslope","⩚":"andv","⩛":"orv","⩜":"andd","⩝":"ord","⩟":"wedbar","⩦":"sdote","⩪":"simdot","⩭":"congdot","⩭̸":"ncongdot","⩮":"easter","⩯":"apacir","⩰":"apE","⩰̸":"napE","⩱":"eplus","⩲":"pluse","⩳":"Esim","⩷":"eDDot","⩸":"equivDD","⩹":"ltcir","⩺":"gtcir","⩻":"ltquest","⩼":"gtquest","⩽":"les","⩽̸":"nles","⩾":"ges","⩾̸":"nges","⩿":"lesdot","⪀":"gesdot","⪁":"lesdoto","⪂":"gesdoto","⪃":"lesdotor","⪄":"gesdotol","⪅":"lap","⪆":"gap","⪇":"lne","⪈":"gne","⪉":"lnap","⪊":"gnap","⪋":"lEg","⪌":"gEl","⪍":"lsime","⪎":"gsime","⪏":"lsimg","⪐":"gsiml","⪑":"lgE","⪒":"glE","⪓":"lesges","⪔":"gesles","⪕":"els","⪖":"egs","⪗":"elsdot","⪘":"egsdot","⪙":"el","⪚":"eg","⪝":"siml","⪞":"simg","⪟":"simlE","⪠":"simgE","⪡":"LessLess","⪡̸":"NotNestedLessLess","⪢":"GreaterGreater","⪢̸":"NotNestedGreaterGreater","⪤":"glj","⪥":"gla","⪦":"ltcc","⪧":"gtcc","⪨":"lescc","⪩":"gescc","⪪":"smt","⪫":"lat","⪬":"smte","⪬︀":"smtes","⪭":"late","⪭︀":"lates","⪮":"bumpE","⪯":"pre","⪯̸":"npre","⪰":"sce","⪰̸":"nsce","⪳":"prE","⪴":"scE","⪵":"prnE","⪶":"scnE","⪷":"prap","⪸":"scap","⪹":"prnap","⪺":"scnap","⪻":"Pr","⪼":"Sc","⪽":"subdot","⪾":"supdot","⪿":"subplus","⫀":"supplus","⫁":"submult","⫂":"supmult","⫃":"subedot","⫄":"supedot","⫅":"subE","⫅̸":"nsubE","⫆":"supE","⫆̸":"nsupE","⫇":"subsim","⫈":"supsim","⫋︀":"vsubnE","⫋":"subnE","⫌︀":"vsupnE","⫌":"supnE","⫏":"csub","⫐":"csup","⫑":"csube","⫒":"csupe","⫓":"subsup","⫔":"supsub","⫕":"subsub","⫖":"supsup","⫗":"suphsub","⫘":"supdsub","⫙":"forkv","⫚":"topfork","⫛":"mlcp","⫤":"Dashv","⫦":"Vdashl","⫧":"Barv","⫨":"vBar","⫩":"vBarv","⫫":"Vbar","⫬":"Not","⫭":"bNot","⫮":"rnmid","⫯":"cirmid","⫰":"midcir","⫱":"topcir","⫲":"nhpar","⫳":"parsim","⫽":"parsl","⫽⃥":"nparsl","♭":"flat","♮":"natur","♯":"sharp","¤":"curren","¢":"cent",$:"dollar","£":"pound","¥":"yen","€":"euro","¹":"sup1","½":"half","⅓":"frac13","¼":"frac14","⅕":"frac15","⅙":"frac16","⅛":"frac18","²":"sup2","⅔":"frac23","⅖":"frac25","³":"sup3","¾":"frac34","⅗":"frac35","⅜":"frac38","⅘":"frac45","⅚":"frac56","⅝":"frac58","⅞":"frac78","𝒶":"ascr","𝕒":"aopf","𝔞":"afr","𝔸":"Aopf","𝔄":"Afr","𝒜":"Ascr",ª:"ordf",á:"aacute",Á:"Aacute",à:"agrave",À:"Agrave",ă:"abreve",Ă:"Abreve",â:"acirc",Â:"Acirc",å:"aring",Å:"angst",ä:"auml",Ä:"Auml",ã:"atilde",Ã:"Atilde",ą:"aogon",Ą:"Aogon",ā:"amacr",Ā:"Amacr",æ:"aelig",Æ:"AElig","𝒷":"bscr","𝕓":"bopf","𝔟":"bfr","𝔹":"Bopf",ℬ:"Bscr","𝔅":"Bfr","𝔠":"cfr","𝒸":"cscr","𝕔":"copf",ℭ:"Cfr","𝒞":"Cscr",ℂ:"Copf",ć:"cacute",Ć:"Cacute",ĉ:"ccirc",Ĉ:"Ccirc",č:"ccaron",Č:"Ccaron",ċ:"cdot",Ċ:"Cdot",ç:"ccedil",Ç:"Ccedil","℅":"incare","𝔡":"dfr","ⅆ":"dd","𝕕":"dopf","𝒹":"dscr","𝒟":"Dscr","𝔇":"Dfr","ⅅ":"DD","𝔻":"Dopf",ď:"dcaron",Ď:"Dcaron",đ:"dstrok",Đ:"Dstrok",ð:"eth",Ð:"ETH","ⅇ":"ee",ℯ:"escr","𝔢":"efr","𝕖":"eopf",ℰ:"Escr","𝔈":"Efr","𝔼":"Eopf",é:"eacute",É:"Eacute",è:"egrave",È:"Egrave",ê:"ecirc",Ê:"Ecirc",ě:"ecaron",Ě:"Ecaron",ë:"euml",Ë:"Euml",ė:"edot",Ė:"Edot",ę:"eogon",Ę:"Eogon",ē:"emacr",Ē:"Emacr","𝔣":"ffr","𝕗":"fopf","𝒻":"fscr","𝔉":"Ffr","𝔽":"Fopf",ℱ:"Fscr",ﬀ:"fflig",ﬃ:"ffilig",ﬄ:"ffllig",ﬁ:"filig",fj:"fjlig",ﬂ:"fllig",ƒ:"fnof",ℊ:"gscr","𝕘":"gopf","𝔤":"gfr","𝒢":"Gscr","𝔾":"Gopf","𝔊":"Gfr",ǵ:"gacute",ğ:"gbreve",Ğ:"Gbreve",ĝ:"gcirc",Ĝ:"Gcirc",ġ:"gdot",Ġ:"Gdot",Ģ:"Gcedil","𝔥":"hfr",ℎ:"planckh","𝒽":"hscr","𝕙":"hopf",ℋ:"Hscr",ℌ:"Hfr",ℍ:"Hopf",ĥ:"hcirc",Ĥ:"Hcirc",ℏ:"hbar",ħ:"hstrok",Ħ:"Hstrok","𝕚":"iopf","𝔦":"ifr","𝒾":"iscr","ⅈ":"ii","𝕀":"Iopf",ℐ:"Iscr",ℑ:"Im",í:"iacute",Í:"Iacute",ì:"igrave",Ì:"Igrave",î:"icirc",Î:"Icirc",ï:"iuml",Ï:"Iuml",ĩ:"itilde",Ĩ:"Itilde",İ:"Idot",į:"iogon",Į:"Iogon",ī:"imacr",Ī:"Imacr",ĳ:"ijlig",Ĳ:"IJlig",ı:"imath","𝒿":"jscr","𝕛":"jopf","𝔧":"jfr","𝒥":"Jscr","𝔍":"Jfr","𝕁":"Jopf",ĵ:"jcirc",Ĵ:"Jcirc","ȷ":"jmath","𝕜":"kopf","𝓀":"kscr","𝔨":"kfr","𝒦":"Kscr","𝕂":"Kopf","𝔎":"Kfr",ķ:"kcedil",Ķ:"Kcedil","𝔩":"lfr","𝓁":"lscr",ℓ:"ell","𝕝":"lopf",ℒ:"Lscr","𝔏":"Lfr","𝕃":"Lopf",ĺ:"lacute",Ĺ:"Lacute",ľ:"lcaron",Ľ:"Lcaron",ļ:"lcedil",Ļ:"Lcedil",ł:"lstrok",Ł:"Lstrok",ŀ:"lmidot",Ŀ:"Lmidot","𝔪":"mfr","𝕞":"mopf","𝓂":"mscr","𝔐":"Mfr","𝕄":"Mopf",ℳ:"Mscr","𝔫":"nfr","𝕟":"nopf","𝓃":"nscr",ℕ:"Nopf","𝒩":"Nscr","𝔑":"Nfr",ń:"nacute",Ń:"Nacute",ň:"ncaron",Ň:"Ncaron",ñ:"ntilde",Ñ:"Ntilde",ņ:"ncedil",Ņ:"Ncedil","№":"numero",ŋ:"eng",Ŋ:"ENG","𝕠":"oopf","𝔬":"ofr",ℴ:"oscr","𝒪":"Oscr","𝔒":"Ofr","𝕆":"Oopf",º:"ordm",ó:"oacute",Ó:"Oacute",ò:"ograve",Ò:"Ograve",ô:"ocirc",Ô:"Ocirc",ö:"ouml",Ö:"Ouml",ő:"odblac",Ő:"Odblac",õ:"otilde",Õ:"Otilde",ø:"oslash",Ø:"Oslash",ō:"omacr",Ō:"Omacr",œ:"oelig",Œ:"OElig","𝔭":"pfr","𝓅":"pscr","𝕡":"popf",ℙ:"Popf","𝔓":"Pfr","𝒫":"Pscr","𝕢":"qopf","𝔮":"qfr","𝓆":"qscr","𝒬":"Qscr","𝔔":"Qfr",ℚ:"Qopf",ĸ:"kgreen","𝔯":"rfr","𝕣":"ropf","𝓇":"rscr",ℛ:"Rscr",ℜ:"Re",ℝ:"Ropf",ŕ:"racute",Ŕ:"Racute",ř:"rcaron",Ř:"Rcaron",ŗ:"rcedil",Ŗ:"Rcedil","𝕤":"sopf","𝓈":"sscr","𝔰":"sfr","𝕊":"Sopf","𝔖":"Sfr","𝒮":"Sscr","Ⓢ":"oS",ś:"sacute",Ś:"Sacute",ŝ:"scirc",Ŝ:"Scirc",š:"scaron",Š:"Scaron",ş:"scedil",Ş:"Scedil",ß:"szlig","𝔱":"tfr","𝓉":"tscr","𝕥":"topf","𝒯":"Tscr","𝔗":"Tfr","𝕋":"Topf",ť:"tcaron",Ť:"Tcaron",ţ:"tcedil",Ţ:"Tcedil","™":"trade",ŧ:"tstrok",Ŧ:"Tstrok","𝓊":"uscr","𝕦":"uopf","𝔲":"ufr","𝕌":"Uopf","𝔘":"Ufr","𝒰":"Uscr",ú:"uacute",Ú:"Uacute",ù:"ugrave",Ù:"Ugrave",ŭ:"ubreve",Ŭ:"Ubreve",û:"ucirc",Û:"Ucirc",ů:"uring",Ů:"Uring",ü:"uuml",Ü:"Uuml",ű:"udblac",Ű:"Udblac",ũ:"utilde",Ũ:"Utilde",ų:"uogon",Ų:"Uogon",ū:"umacr",Ū:"Umacr","𝔳":"vfr","𝕧":"vopf","𝓋":"vscr","𝔙":"Vfr","𝕍":"Vopf","𝒱":"Vscr","𝕨":"wopf","𝓌":"wscr","𝔴":"wfr","𝒲":"Wscr","𝕎":"Wopf","𝔚":"Wfr",ŵ:"wcirc",Ŵ:"Wcirc","𝔵":"xfr","𝓍":"xscr","𝕩":"xopf","𝕏":"Xopf","𝔛":"Xfr","𝒳":"Xscr","𝔶":"yfr","𝓎":"yscr","𝕪":"yopf","𝒴":"Yscr","𝔜":"Yfr","𝕐":"Yopf",ý:"yacute",Ý:"Yacute",ŷ:"ycirc",Ŷ:"Ycirc",ÿ:"yuml",Ÿ:"Yuml","𝓏":"zscr","𝔷":"zfr","𝕫":"zopf",ℨ:"Zfr",ℤ:"Zopf","𝒵":"Zscr",ź:"zacute",Ź:"Zacute",ž:"zcaron",Ž:"Zcaron",ż:"zdot",Ż:"Zdot",Ƶ:"imped",þ:"thorn",Þ:"THORN",ŉ:"napos",α:"alpha",Α:"Alpha",β:"beta",Β:"Beta",γ:"gamma",Γ:"Gamma",δ:"delta",Δ:"Delta",ε:"epsi","ϵ":"epsiv",Ε:"Epsilon",ϝ:"gammad",Ϝ:"Gammad",ζ:"zeta",Ζ:"Zeta",η:"eta",Η:"Eta",θ:"theta",ϑ:"thetav",Θ:"Theta",ι:"iota",Ι:"Iota",κ:"kappa",ϰ:"kappav",Κ:"Kappa",λ:"lambda",Λ:"Lambda",μ:"mu",µ:"micro",Μ:"Mu",ν:"nu",Ν:"Nu",ξ:"xi",Ξ:"Xi",ο:"omicron",Ο:"Omicron",π:"pi",ϖ:"piv",Π:"Pi",ρ:"rho",ϱ:"rhov",Ρ:"Rho",σ:"sigma",Σ:"Sigma",ς:"sigmaf",τ:"tau",Τ:"Tau",υ:"upsi",Υ:"Upsilon",ϒ:"Upsi",φ:"phi",ϕ:"phiv",Φ:"Phi",χ:"chi",Χ:"Chi",ψ:"psi",Ψ:"Psi",ω:"omega",Ω:"ohm",а:"acy",А:"Acy",б:"bcy",Б:"Bcy",в:"vcy",В:"Vcy",г:"gcy",Г:"Gcy",ѓ:"gjcy",Ѓ:"GJcy",д:"dcy",Д:"Dcy",ђ:"djcy",Ђ:"DJcy",е:"iecy",Е:"IEcy",ё:"iocy",Ё:"IOcy",є:"jukcy",Є:"Jukcy",ж:"zhcy",Ж:"ZHcy",з:"zcy",З:"Zcy",ѕ:"dscy",Ѕ:"DScy",и:"icy",И:"Icy",і:"iukcy",І:"Iukcy",ї:"yicy",Ї:"YIcy",й:"jcy",Й:"Jcy",ј:"jsercy",Ј:"Jsercy",к:"kcy",К:"Kcy",ќ:"kjcy",Ќ:"KJcy",л:"lcy",Л:"Lcy",љ:"ljcy",Љ:"LJcy",м:"mcy",М:"Mcy",н:"ncy",Н:"Ncy",њ:"njcy",Њ:"NJcy",о:"ocy",О:"Ocy",п:"pcy",П:"Pcy",р:"rcy",Р:"Rcy",с:"scy",С:"Scy",т:"tcy",Т:"Tcy",ћ:"tshcy",Ћ:"TSHcy",у:"ucy",У:"Ucy",ў:"ubrcy",Ў:"Ubrcy",ф:"fcy",Ф:"Fcy",х:"khcy",Х:"KHcy",ц:"tscy",Ц:"TScy",ч:"chcy",Ч:"CHcy",џ:"dzcy",Џ:"DZcy",ш:"shcy",Ш:"SHcy",щ:"shchcy",Щ:"SHCHcy",ъ:"hardcy",Ъ:"HARDcy",ы:"ycy",Ы:"Ycy",ь:"softcy",Ь:"SOFTcy",э:"ecy",Э:"Ecy",ю:"yucy",Ю:"YUcy",я:"yacy",Я:"YAcy",ℵ:"aleph",ℶ:"beth",ℷ:"gimel",ℸ:"daleth"},d=/["&'<>`]/g,p={'"':"&quot;","&":"&amp;","'":"&#x27;","<":"&lt;",">":"&gt;","`":"&#x60;"},g=/&#(?:[xX][^a-fA-F0-9]|[^0-9xX])/,m=/[\0-\x08\x0B\x0E-\x1F\x7F-\x9F\uFDD0-\uFDEF\uFFFE\uFFFF]|[\uD83F\uD87F\uD8BF\uD8FF\uD93F\uD97F\uD9BF\uD9FF\uDA3F\uDA7F\uDABF\uDAFF\uDB3F\uDB7F\uDBBF\uDBFF][\uDFFE\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,v=/&(CounterClockwiseContourIntegral|DoubleLongLeftRightArrow|ClockwiseContourIntegral|NotNestedGreaterGreater|NotSquareSupersetEqual|DiacriticalDoubleAcute|NotRightTriangleEqual|NotSucceedsSlantEqual|NotPrecedesSlantEqual|CloseCurlyDoubleQuote|NegativeVeryThinSpace|DoubleContourIntegral|FilledVerySmallSquare|CapitalDifferentialD|OpenCurlyDoubleQuote|EmptyVerySmallSquare|NestedGreaterGreater|DoubleLongRightArrow|NotLeftTriangleEqual|NotGreaterSlantEqual|ReverseUpEquilibrium|DoubleLeftRightArrow|NotSquareSubsetEqual|NotDoubleVerticalBar|RightArrowLeftArrow|NotGreaterFullEqual|NotRightTriangleBar|SquareSupersetEqual|DownLeftRightVector|DoubleLongLeftArrow|leftrightsquigarrow|LeftArrowRightArrow|NegativeMediumSpace|blacktriangleright|RightDownVectorBar|PrecedesSlantEqual|RightDoubleBracket|SucceedsSlantEqual|NotLeftTriangleBar|RightTriangleEqual|SquareIntersection|RightDownTeeVector|ReverseEquilibrium|NegativeThickSpace|longleftrightarrow|Longleftrightarrow|LongLeftRightArrow|DownRightTeeVector|DownRightVectorBar|GreaterSlantEqual|SquareSubsetEqual|LeftDownVectorBar|LeftDoubleBracket|VerticalSeparator|rightleftharpoons|NotGreaterGreater|NotSquareSuperset|blacktriangleleft|blacktriangledown|NegativeThinSpace|LeftDownTeeVector|NotLessSlantEqual|leftrightharpoons|DoubleUpDownArrow|DoubleVerticalBar|LeftTriangleEqual|FilledSmallSquare|twoheadrightarrow|NotNestedLessLess|DownLeftTeeVector|DownLeftVectorBar|RightAngleBracket|NotTildeFullEqual|NotReverseElement|RightUpDownVector|DiacriticalTilde|NotSucceedsTilde|circlearrowright|NotPrecedesEqual|rightharpoondown|DoubleRightArrow|NotSucceedsEqual|NonBreakingSpace|NotRightTriangle|LessEqualGreater|RightUpTeeVector|LeftAngleBracket|GreaterFullEqual|DownArrowUpArrow|RightUpVectorBar|twoheadleftarrow|GreaterEqualLess|downharpoonright|RightTriangleBar|ntrianglerighteq|NotSupersetEqual|LeftUpDownVector|DiacriticalAcute|rightrightarrows|vartriangleright|UpArrowDownArrow|DiacriticalGrave|UnderParenthesis|EmptySmallSquare|LeftUpVectorBar|leftrightarrows|DownRightVector|downharpoonleft|trianglerighteq|ShortRightArrow|OverParenthesis|DoubleLeftArrow|DoubleDownArrow|NotSquareSubset|bigtriangledown|ntrianglelefteq|UpperRightArrow|curvearrowright|vartriangleleft|NotLeftTriangle|nleftrightarrow|LowerRightArrow|NotHumpDownHump|NotGreaterTilde|rightthreetimes|LeftUpTeeVector|NotGreaterEqual|straightepsilon|LeftTriangleBar|rightsquigarrow|ContourIntegral|rightleftarrows|CloseCurlyQuote|RightDownVector|LeftRightVector|nLeftrightarrow|leftharpoondown|circlearrowleft|SquareSuperset|OpenCurlyQuote|hookrightarrow|HorizontalLine|DiacriticalDot|NotLessGreater|ntriangleright|DoubleRightTee|InvisibleComma|InvisibleTimes|LowerLeftArrow|DownLeftVector|NotSubsetEqual|curvearrowleft|trianglelefteq|NotVerticalBar|TildeFullEqual|downdownarrows|NotGreaterLess|RightTeeVector|ZeroWidthSpace|looparrowright|LongRightArrow|doublebarwedge|ShortLeftArrow|ShortDownArrow|RightVectorBar|GreaterGreater|ReverseElement|rightharpoonup|LessSlantEqual|leftthreetimes|upharpoonright|rightarrowtail|LeftDownVector|Longrightarrow|NestedLessLess|UpperLeftArrow|nshortparallel|leftleftarrows|leftrightarrow|Leftrightarrow|LeftRightArrow|longrightarrow|upharpoonleft|RightArrowBar|ApplyFunction|LeftTeeVector|leftarrowtail|NotEqualTilde|varsubsetneqq|varsupsetneqq|RightTeeArrow|SucceedsEqual|SucceedsTilde|LeftVectorBar|SupersetEqual|hookleftarrow|DifferentialD|VerticalTilde|VeryThinSpace|blacktriangle|bigtriangleup|LessFullEqual|divideontimes|leftharpoonup|UpEquilibrium|ntriangleleft|RightTriangle|measuredangle|shortparallel|longleftarrow|Longleftarrow|LongLeftArrow|DoubleLeftTee|Poincareplane|PrecedesEqual|triangleright|DoubleUpArrow|RightUpVector|fallingdotseq|looparrowleft|PrecedesTilde|NotTildeEqual|NotTildeTilde|smallsetminus|Proportional|triangleleft|triangledown|UnderBracket|NotHumpEqual|exponentiale|ExponentialE|NotLessTilde|HilbertSpace|RightCeiling|blacklozenge|varsupsetneq|HumpDownHump|GreaterEqual|VerticalLine|LeftTeeArrow|NotLessEqual|DownTeeArrow|LeftTriangle|varsubsetneq|Intersection|NotCongruent|DownArrowBar|LeftUpVector|LeftArrowBar|risingdotseq|GreaterTilde|RoundImplies|SquareSubset|ShortUpArrow|NotSuperset|quaternions|precnapprox|backepsilon|preccurlyeq|OverBracket|blacksquare|MediumSpace|VerticalBar|circledcirc|circleddash|CircleMinus|CircleTimes|LessGreater|curlyeqprec|curlyeqsucc|diamondsuit|UpDownArrow|Updownarrow|RuleDelayed|Rrightarrow|updownarrow|RightVector|nRightarrow|nrightarrow|eqslantless|LeftCeiling|Equilibrium|SmallCircle|expectation|NotSucceeds|thickapprox|GreaterLess|SquareUnion|NotPrecedes|NotLessLess|straightphi|succnapprox|succcurlyeq|SubsetEqual|sqsupseteq|Proportion|Laplacetrf|ImaginaryI|supsetneqq|NotGreater|gtreqqless|NotElement|ThickSpace|TildeEqual|TildeTilde|Fouriertrf|rmoustache|EqualTilde|eqslantgtr|UnderBrace|LeftVector|UpArrowBar|nLeftarrow|nsubseteqq|subsetneqq|nsupseteqq|nleftarrow|succapprox|lessapprox|UpTeeArrow|upuparrows|curlywedge|lesseqqgtr|varepsilon|varnothing|RightFloor|complement|CirclePlus|sqsubseteq|Lleftarrow|circledast|RightArrow|Rightarrow|rightarrow|lmoustache|Bernoullis|precapprox|mapstoleft|mapstodown|longmapsto|dotsquare|downarrow|DoubleDot|nsubseteq|supsetneq|leftarrow|nsupseteq|subsetneq|ThinSpace|ngeqslant|subseteqq|HumpEqual|NotSubset|triangleq|NotCupCap|lesseqgtr|heartsuit|TripleDot|Leftarrow|Coproduct|Congruent|varpropto|complexes|gvertneqq|LeftArrow|LessTilde|supseteqq|MinusPlus|CircleDot|nleqslant|NotExists|gtreqless|nparallel|UnionPlus|LeftFloor|checkmark|CenterDot|centerdot|Mellintrf|gtrapprox|bigotimes|OverBrace|spadesuit|therefore|pitchfork|rationals|PlusMinus|Backslash|Therefore|DownBreve|backsimeq|backprime|DownArrow|nshortmid|Downarrow|lvertneqq|eqvparsl|imagline|imagpart|infintie|integers|Integral|intercal|LessLess|Uarrocir|intlarhk|sqsupset|angmsdaf|sqsubset|llcorner|vartheta|cupbrcap|lnapprox|Superset|SuchThat|succnsim|succneqq|angmsdag|biguplus|curlyvee|trpezium|Succeeds|NotTilde|bigwedge|angmsdah|angrtvbd|triminus|cwconint|fpartint|lrcorner|smeparsl|subseteq|urcorner|lurdshar|laemptyv|DDotrahd|approxeq|ldrushar|awconint|mapstoup|backcong|shortmid|triangle|geqslant|gesdotol|timesbar|circledR|circledS|setminus|multimap|naturals|scpolint|ncongdot|RightTee|boxminus|gnapprox|boxtimes|andslope|thicksim|angmsdaa|varsigma|cirfnint|rtriltri|angmsdab|rppolint|angmsdac|barwedge|drbkarow|clubsuit|thetasym|bsolhsub|capbrcup|dzigrarr|doteqdot|DotEqual|dotminus|UnderBar|NotEqual|realpart|otimesas|ulcorner|hksearow|hkswarow|parallel|PartialD|elinters|emptyset|plusacir|bbrktbrk|angmsdad|pointint|bigoplus|angmsdae|Precedes|bigsqcup|varkappa|notindot|supseteq|precneqq|precnsim|profalar|profline|profsurf|leqslant|lesdotor|raemptyv|subplus|notnivb|notnivc|subrarr|zigrarr|vzigzag|submult|subedot|Element|between|cirscir|larrbfs|larrsim|lotimes|lbrksld|lbrkslu|lozenge|ldrdhar|dbkarow|bigcirc|epsilon|simrarr|simplus|ltquest|Epsilon|luruhar|gtquest|maltese|npolint|eqcolon|npreceq|bigodot|ddagger|gtrless|bnequiv|harrcir|ddotseq|equivDD|backsim|demptyv|nsqsube|nsqsupe|Upsilon|nsubset|upsilon|minusdu|nsucceq|swarrow|nsupset|coloneq|searrow|boxplus|napprox|natural|asympeq|alefsym|congdot|nearrow|bigstar|diamond|supplus|tritime|LeftTee|nvinfin|triplus|NewLine|nvltrie|nvrtrie|nwarrow|nexists|Diamond|ruluhar|Implies|supmult|angzarr|suplarr|suphsub|questeq|because|digamma|Because|olcross|bemptyv|omicron|Omicron|rotimes|NoBreak|intprod|angrtvb|orderof|uwangle|suphsol|lesdoto|orslope|DownTee|realine|cudarrl|rdldhar|OverBar|supedot|lessdot|supdsub|topfork|succsim|rbrkslu|rbrksld|pertenk|cudarrr|isindot|planckh|lessgtr|pluscir|gesdoto|plussim|plustwo|lesssim|cularrp|rarrsim|Cayleys|notinva|notinvb|notinvc|UpArrow|Uparrow|uparrow|NotLess|dwangle|precsim|Product|curarrm|Cconint|dotplus|rarrbfs|ccupssm|Cedilla|cemptyv|notniva|quatint|frac35|frac38|frac45|frac56|frac58|frac78|tridot|xoplus|gacute|gammad|Gammad|lfisht|lfloor|bigcup|sqsupe|gbreve|Gbreve|lharul|sqsube|sqcups|Gcedil|apacir|llhard|lmidot|Lmidot|lmoust|andand|sqcaps|approx|Abreve|spades|circeq|tprime|divide|topcir|Assign|topbot|gesdot|divonx|xuplus|timesd|gesles|atilde|solbar|SOFTcy|loplus|timesb|lowast|lowbar|dlcorn|dlcrop|softcy|dollar|lparlt|thksim|lrhard|Atilde|lsaquo|smashp|bigvee|thinsp|wreath|bkarow|lsquor|lstrok|Lstrok|lthree|ltimes|ltlarr|DotDot|simdot|ltrPar|weierp|xsqcup|angmsd|sigmav|sigmaf|zeetrf|Zcaron|zcaron|mapsto|vsupne|thetav|cirmid|marker|mcomma|Zacute|vsubnE|there4|gtlPar|vsubne|bottom|gtrarr|SHCHcy|shchcy|midast|midcir|middot|minusb|minusd|gtrdot|bowtie|sfrown|mnplus|models|colone|seswar|Colone|mstpos|searhk|gtrsim|nacute|Nacute|boxbox|telrec|hairsp|Tcedil|nbumpe|scnsim|ncaron|Ncaron|ncedil|Ncedil|hamilt|Scedil|nearhk|hardcy|HARDcy|tcedil|Tcaron|commat|nequiv|nesear|tcaron|target|hearts|nexist|varrho|scedil|Scaron|scaron|hellip|Sacute|sacute|hercon|swnwar|compfn|rtimes|rthree|rsquor|rsaquo|zacute|wedgeq|homtht|barvee|barwed|Barwed|rpargt|horbar|conint|swarhk|roplus|nltrie|hslash|hstrok|Hstrok|rmoust|Conint|bprime|hybull|hyphen|iacute|Iacute|supsup|supsub|supsim|varphi|coprod|brvbar|agrave|Supset|supset|igrave|Igrave|notinE|Agrave|iiiint|iinfin|copysr|wedbar|Verbar|vangrt|becaus|incare|verbar|inodot|bullet|drcorn|intcal|drcrop|cularr|vellip|Utilde|bumpeq|cupcap|dstrok|Dstrok|CupCap|cupcup|cupdot|eacute|Eacute|supdot|iquest|easter|ecaron|Ecaron|ecolon|isinsv|utilde|itilde|Itilde|curarr|succeq|Bumpeq|cacute|ulcrop|nparsl|Cacute|nprcue|egrave|Egrave|nrarrc|nrarrw|subsup|subsub|nrtrie|jsercy|nsccue|Jsercy|kappav|kcedil|Kcedil|subsim|ulcorn|nsimeq|egsdot|veebar|kgreen|capand|elsdot|Subset|subset|curren|aacute|lacute|Lacute|emptyv|ntilde|Ntilde|lagran|lambda|Lambda|capcap|Ugrave|langle|subdot|emsp13|numero|emsp14|nvdash|nvDash|nVdash|nVDash|ugrave|ufisht|nvHarr|larrfs|nvlArr|larrhk|larrlp|larrpl|nvrArr|Udblac|nwarhk|larrtl|nwnear|oacute|Oacute|latail|lAtail|sstarf|lbrace|odblac|Odblac|lbrack|udblac|odsold|eparsl|lcaron|Lcaron|ograve|Ograve|lcedil|Lcedil|Aacute|ssmile|ssetmn|squarf|ldquor|capcup|ominus|cylcty|rharul|eqcirc|dagger|rfloor|rfisht|Dagger|daleth|equals|origof|capdot|equest|dcaron|Dcaron|rdquor|oslash|Oslash|otilde|Otilde|otimes|Otimes|urcrop|Ubreve|ubreve|Yacute|Uacute|uacute|Rcedil|rcedil|urcorn|parsim|Rcaron|Vdashl|rcaron|Tstrok|percnt|period|permil|Exists|yacute|rbrack|rbrace|phmmat|ccaron|Ccaron|planck|ccedil|plankv|tstrok|female|plusdo|plusdu|ffilig|plusmn|ffllig|Ccedil|rAtail|dfisht|bernou|ratail|Rarrtl|rarrtl|angsph|rarrpl|rarrlp|rarrhk|xwedge|xotime|forall|ForAll|Vvdash|vsupnE|preceq|bigcap|frac12|frac13|frac14|primes|rarrfs|prnsim|frac15|Square|frac16|square|lesdot|frac18|frac23|propto|prurel|rarrap|rangle|puncsp|frac25|Racute|qprime|racute|lesges|frac34|abreve|AElig|eqsim|utdot|setmn|urtri|Equal|Uring|seArr|uring|searr|dashv|Dashv|mumap|nabla|iogon|Iogon|sdote|sdotb|scsim|napid|napos|equiv|natur|Acirc|dblac|erarr|nbump|iprod|erDot|ucirc|awint|esdot|angrt|ncong|isinE|scnap|Scirc|scirc|ndash|isins|Ubrcy|nearr|neArr|isinv|nedot|ubrcy|acute|Ycirc|iukcy|Iukcy|xutri|nesim|caret|jcirc|Jcirc|caron|twixt|ddarr|sccue|exist|jmath|sbquo|ngeqq|angst|ccaps|lceil|ngsim|UpTee|delta|Delta|rtrif|nharr|nhArr|nhpar|rtrie|jukcy|Jukcy|kappa|rsquo|Kappa|nlarr|nlArr|TSHcy|rrarr|aogon|Aogon|fflig|xrarr|tshcy|ccirc|nleqq|filig|upsih|nless|dharl|nlsim|fjlig|ropar|nltri|dharr|robrk|roarr|fllig|fltns|roang|rnmid|subnE|subne|lAarr|trisb|Ccirc|acirc|ccups|blank|VDash|forkv|Vdash|langd|cedil|blk12|blk14|laquo|strns|diams|notin|vDash|larrb|blk34|block|disin|uplus|vdash|vBarv|aelig|starf|Wedge|check|xrArr|lates|lbarr|lBarr|notni|lbbrk|bcong|frasl|lbrke|frown|vrtri|vprop|vnsup|gamma|Gamma|wedge|xodot|bdquo|srarr|doteq|ldquo|boxdl|boxdL|gcirc|Gcirc|boxDl|boxDL|boxdr|boxdR|boxDr|TRADE|trade|rlhar|boxDR|vnsub|npart|vltri|rlarr|boxhd|boxhD|nprec|gescc|nrarr|nrArr|boxHd|boxHD|boxhu|boxhU|nrtri|boxHu|clubs|boxHU|times|colon|Colon|gimel|xlArr|Tilde|nsime|tilde|nsmid|nspar|THORN|thorn|xlarr|nsube|nsubE|thkap|xhArr|comma|nsucc|boxul|boxuL|nsupe|nsupE|gneqq|gnsim|boxUl|boxUL|grave|boxur|boxuR|boxUr|boxUR|lescc|angle|bepsi|boxvh|varpi|boxvH|numsp|Theta|gsime|gsiml|theta|boxVh|boxVH|boxvl|gtcir|gtdot|boxvL|boxVl|boxVL|crarr|cross|Cross|nvsim|boxvr|nwarr|nwArr|sqsup|dtdot|Uogon|lhard|lharu|dtrif|ocirc|Ocirc|lhblk|duarr|odash|sqsub|Hacek|sqcup|llarr|duhar|oelig|OElig|ofcir|boxvR|uogon|lltri|boxVr|csube|uuarr|ohbar|csupe|ctdot|olarr|olcir|harrw|oline|sqcap|omacr|Omacr|omega|Omega|boxVR|aleph|lneqq|lnsim|loang|loarr|rharu|lobrk|hcirc|operp|oplus|rhard|Hcirc|orarr|Union|order|ecirc|Ecirc|cuepr|szlig|cuesc|breve|reals|eDDot|Breve|hoarr|lopar|utrif|rdquo|Umacr|umacr|efDot|swArr|ultri|alpha|rceil|ovbar|swarr|Wcirc|wcirc|smtes|smile|bsemi|lrarr|aring|parsl|lrhar|bsime|uhblk|lrtri|cupor|Aring|uharr|uharl|slarr|rbrke|bsolb|lsime|rbbrk|RBarr|lsimg|phone|rBarr|rbarr|icirc|lsquo|Icirc|emacr|Emacr|ratio|simne|plusb|simlE|simgE|simeq|pluse|ltcir|ltdot|empty|xharr|xdtri|iexcl|Alpha|ltrie|rarrw|pound|ltrif|xcirc|bumpe|prcue|bumpE|asymp|amacr|cuvee|Sigma|sigma|iiint|udhar|iiota|ijlig|IJlig|supnE|imacr|Imacr|prime|Prime|image|prnap|eogon|Eogon|rarrc|mdash|mDDot|cuwed|imath|supne|imped|Amacr|udarr|prsim|micro|rarrb|cwint|raquo|infin|eplus|range|rangd|Ucirc|radic|minus|amalg|veeeq|rAarr|epsiv|ycirc|quest|sharp|quot|zwnj|Qscr|race|qscr|Qopf|qopf|qint|rang|Rang|Zscr|zscr|Zopf|zopf|rarr|rArr|Rarr|Pscr|pscr|prop|prod|prnE|prec|ZHcy|zhcy|prap|Zeta|zeta|Popf|popf|Zdot|plus|zdot|Yuml|yuml|phiv|YUcy|yucy|Yscr|yscr|perp|Yopf|yopf|part|para|YIcy|Ouml|rcub|yicy|YAcy|rdca|ouml|osol|Oscr|rdsh|yacy|real|oscr|xvee|andd|rect|andv|Xscr|oror|ordm|ordf|xscr|ange|aopf|Aopf|rHar|Xopf|opar|Oopf|xopf|xnis|rhov|oopf|omid|xmap|oint|apid|apos|ogon|ascr|Ascr|odot|odiv|xcup|xcap|ocir|oast|nvlt|nvle|nvgt|nvge|nvap|Wscr|wscr|auml|ntlg|ntgl|nsup|nsub|nsim|Nscr|nscr|nsce|Wopf|ring|npre|wopf|npar|Auml|Barv|bbrk|Nopf|nopf|nmid|nLtv|beta|ropf|Ropf|Beta|beth|nles|rpar|nleq|bnot|bNot|nldr|NJcy|rscr|Rscr|Vscr|vscr|rsqb|njcy|bopf|nisd|Bopf|rtri|Vopf|nGtv|ngtr|vopf|boxh|boxH|boxv|nges|ngeq|boxV|bscr|scap|Bscr|bsim|Vert|vert|bsol|bull|bump|caps|cdot|ncup|scnE|ncap|nbsp|napE|Cdot|cent|sdot|Vbar|nang|vBar|chcy|Mscr|mscr|sect|semi|CHcy|Mopf|mopf|sext|circ|cire|mldr|mlcp|cirE|comp|shcy|SHcy|vArr|varr|cong|copf|Copf|copy|COPY|malt|male|macr|lvnE|cscr|ltri|sime|ltcc|simg|Cscr|siml|csub|Uuml|lsqb|lsim|uuml|csup|Lscr|lscr|utri|smid|lpar|cups|smte|lozf|darr|Lopf|Uscr|solb|lopf|sopf|Sopf|lneq|uscr|spar|dArr|lnap|Darr|dash|Sqrt|LJcy|ljcy|lHar|dHar|Upsi|upsi|diam|lesg|djcy|DJcy|leqq|dopf|Dopf|dscr|Dscr|dscy|ldsh|ldca|squf|DScy|sscr|Sscr|dsol|lcub|late|star|Star|Uopf|Larr|lArr|larr|uopf|dtri|dzcy|sube|subE|Lang|lang|Kscr|kscr|Kopf|kopf|KJcy|kjcy|KHcy|khcy|DZcy|ecir|edot|eDot|Jscr|jscr|succ|Jopf|jopf|Edot|uHar|emsp|ensp|Iuml|iuml|eopf|isin|Iscr|iscr|Eopf|epar|sung|epsi|escr|sup1|sup2|sup3|Iota|iota|supe|supE|Iopf|iopf|IOcy|iocy|Escr|esim|Esim|imof|Uarr|QUOT|uArr|uarr|euml|IEcy|iecy|Idot|Euml|euro|excl|Hscr|hscr|Hopf|hopf|TScy|tscy|Tscr|hbar|tscr|flat|tbrk|fnof|hArr|harr|half|fopf|Fopf|tdot|gvnE|fork|trie|gtcc|fscr|Fscr|gdot|gsim|Gscr|gscr|Gopf|gopf|gneq|Gdot|tosa|gnap|Topf|topf|geqq|toea|GJcy|gjcy|tint|gesl|mid|Sfr|ggg|top|ges|gla|glE|glj|geq|gne|gEl|gel|gnE|Gcy|gcy|gap|Tfr|tfr|Tcy|tcy|Hat|Tau|Ffr|tau|Tab|hfr|Hfr|ffr|Fcy|fcy|icy|Icy|iff|ETH|eth|ifr|Ifr|Eta|eta|int|Int|Sup|sup|ucy|Ucy|Sum|sum|jcy|ENG|ufr|Ufr|eng|Jcy|jfr|els|ell|egs|Efr|efr|Jfr|uml|kcy|Kcy|Ecy|ecy|kfr|Kfr|lap|Sub|sub|lat|lcy|Lcy|leg|Dot|dot|lEg|leq|les|squ|div|die|lfr|Lfr|lgE|Dfr|dfr|Del|deg|Dcy|dcy|lne|lnE|sol|loz|smt|Cup|lrm|cup|lsh|Lsh|sim|shy|map|Map|mcy|Mcy|mfr|Mfr|mho|gfr|Gfr|sfr|cir|Chi|chi|nap|Cfr|vcy|Vcy|cfr|Scy|scy|ncy|Ncy|vee|Vee|Cap|cap|nfr|scE|sce|Nfr|nge|ngE|nGg|vfr|Vfr|ngt|bot|nGt|nis|niv|Rsh|rsh|nle|nlE|bne|Bfr|bfr|nLl|nlt|nLt|Bcy|bcy|not|Not|rlm|wfr|Wfr|npr|nsc|num|ocy|ast|Ocy|ofr|xfr|Xfr|Ofr|ogt|ohm|apE|olt|Rho|ape|rho|Rfr|rfr|ord|REG|ang|reg|orv|And|and|AMP|Rcy|amp|Afr|ycy|Ycy|yen|yfr|Yfr|rcy|par|pcy|Pcy|pfr|Pfr|phi|Phi|afr|Acy|acy|zcy|Zcy|piv|acE|acd|zfr|Zfr|pre|prE|psi|Psi|qfr|Qfr|zwj|Or|ge|Gg|gt|gg|el|oS|lt|Lt|LT|Re|lg|gl|eg|ne|Im|it|le|DD|wp|wr|nu|Nu|dd|lE|Sc|sc|pi|Pi|ee|af|ll|Ll|rx|gE|xi|pm|Xi|ic|pr|Pr|in|ni|mp|mu|ac|Mu|or|ap|Gt|GT|ii);|&(Aacute|Agrave|Atilde|Ccedil|Eacute|Egrave|Iacute|Igrave|Ntilde|Oacute|Ograve|Oslash|Otilde|Uacute|Ugrave|Yacute|aacute|agrave|atilde|brvbar|ccedil|curren|divide|eacute|egrave|frac12|frac14|frac34|iacute|igrave|iquest|middot|ntilde|oacute|ograve|oslash|otilde|plusmn|uacute|ugrave|yacute|AElig|Acirc|Aring|Ecirc|Icirc|Ocirc|THORN|Ucirc|acirc|acute|aelig|aring|cedil|ecirc|icirc|iexcl|laquo|micro|ocirc|pound|raquo|szlig|thorn|times|ucirc|Auml|COPY|Euml|Iuml|Ouml|QUOT|Uuml|auml|cent|copy|euml|iuml|macr|nbsp|ordf|ordm|ouml|para|quot|sect|sup1|sup2|sup3|uuml|yuml|AMP|ETH|REG|amp|deg|eth|not|reg|shy|uml|yen|GT|LT|gt|lt)(?!;)([=a-zA-Z0-9]?)|&#([0-9]+)(;?)|&#[xX]([a-fA-F0-9]+)(;?)|&([0-9a-zA-Z]+)/g,E={aacute:"á",Aacute:"Á",abreve:"ă",Abreve:"Ă",ac:"∾",acd:"∿",acE:"∾̳",acirc:"â",Acirc:"Â",acute:"´",acy:"а",Acy:"А",aelig:"æ",AElig:"Æ",af:"⁡",afr:"𝔞",Afr:"𝔄",agrave:"à",Agrave:"À",alefsym:"ℵ",aleph:"ℵ",alpha:"α",Alpha:"Α",amacr:"ā",Amacr:"Ā",amalg:"⨿",amp:"&",AMP:"&",and:"∧",And:"⩓",andand:"⩕",andd:"⩜",andslope:"⩘",andv:"⩚",ang:"∠",ange:"⦤",angle:"∠",angmsd:"∡",angmsdaa:"⦨",angmsdab:"⦩",angmsdac:"⦪",angmsdad:"⦫",angmsdae:"⦬",angmsdaf:"⦭",angmsdag:"⦮",angmsdah:"⦯",angrt:"∟",angrtvb:"⊾",angrtvbd:"⦝",angsph:"∢",angst:"Å",angzarr:"⍼",aogon:"ą",Aogon:"Ą",aopf:"𝕒",Aopf:"𝔸",ap:"≈",apacir:"⩯",ape:"≊",apE:"⩰",apid:"≋",apos:"'",ApplyFunction:"⁡",approx:"≈",approxeq:"≊",aring:"å",Aring:"Å",ascr:"𝒶",Ascr:"𝒜",Assign:"≔",ast:"*",asymp:"≈",asympeq:"≍",atilde:"ã",Atilde:"Ã",auml:"ä",Auml:"Ä",awconint:"∳",awint:"⨑",backcong:"≌",backepsilon:"϶",backprime:"‵",backsim:"∽",backsimeq:"⋍",Backslash:"∖",Barv:"⫧",barvee:"⊽",barwed:"⌅",Barwed:"⌆",barwedge:"⌅",bbrk:"⎵",bbrktbrk:"⎶",bcong:"≌",bcy:"б",Bcy:"Б",bdquo:"„",becaus:"∵",because:"∵",Because:"∵",bemptyv:"⦰",bepsi:"϶",bernou:"ℬ",Bernoullis:"ℬ",beta:"β",Beta:"Β",beth:"ℶ",between:"≬",bfr:"𝔟",Bfr:"𝔅",bigcap:"⋂",bigcirc:"◯",bigcup:"⋃",bigodot:"⨀",bigoplus:"⨁",bigotimes:"⨂",bigsqcup:"⨆",bigstar:"★",bigtriangledown:"▽",bigtriangleup:"△",biguplus:"⨄",bigvee:"⋁",bigwedge:"⋀",bkarow:"⤍",blacklozenge:"⧫",blacksquare:"▪",blacktriangle:"▴",blacktriangledown:"▾",blacktriangleleft:"◂",blacktriangleright:"▸",blank:"␣",blk12:"▒",blk14:"░",blk34:"▓",block:"█",bne:"=⃥",bnequiv:"≡⃥",bnot:"⌐",bNot:"⫭",bopf:"𝕓",Bopf:"𝔹",bot:"⊥",bottom:"⊥",bowtie:"⋈",boxbox:"⧉",boxdl:"┐",boxdL:"╕",boxDl:"╖",boxDL:"╗",boxdr:"┌",boxdR:"╒",boxDr:"╓",boxDR:"╔",boxh:"─",boxH:"═",boxhd:"┬",boxhD:"╥",boxHd:"╤",boxHD:"╦",boxhu:"┴",boxhU:"╨",boxHu:"╧",boxHU:"╩",boxminus:"⊟",boxplus:"⊞",boxtimes:"⊠",boxul:"┘",boxuL:"╛",boxUl:"╜",boxUL:"╝",boxur:"└",boxuR:"╘",boxUr:"╙",boxUR:"╚",boxv:"│",boxV:"║",boxvh:"┼",boxvH:"╪",boxVh:"╫",boxVH:"╬",boxvl:"┤",boxvL:"╡",boxVl:"╢",boxVL:"╣",boxvr:"├",boxvR:"╞",boxVr:"╟",boxVR:"╠",bprime:"‵",breve:"˘",Breve:"˘",brvbar:"¦",bscr:"𝒷",Bscr:"ℬ",bsemi:"⁏",bsim:"∽",bsime:"⋍",bsol:"\\",bsolb:"⧅",bsolhsub:"⟈",bull:"•",bullet:"•",bump:"≎",bumpe:"≏",bumpE:"⪮",bumpeq:"≏",Bumpeq:"≎",cacute:"ć",Cacute:"Ć",cap:"∩",Cap:"⋒",capand:"⩄",capbrcup:"⩉",capcap:"⩋",capcup:"⩇",capdot:"⩀",CapitalDifferentialD:"ⅅ",caps:"∩︀",caret:"⁁",caron:"ˇ",Cayleys:"ℭ",ccaps:"⩍",ccaron:"č",Ccaron:"Č",ccedil:"ç",Ccedil:"Ç",ccirc:"ĉ",Ccirc:"Ĉ",Cconint:"∰",ccups:"⩌",ccupssm:"⩐",cdot:"ċ",Cdot:"Ċ",cedil:"¸",Cedilla:"¸",cemptyv:"⦲",cent:"¢",centerdot:"·",CenterDot:"·",cfr:"𝔠",Cfr:"ℭ",chcy:"ч",CHcy:"Ч",check:"✓",checkmark:"✓",chi:"χ",Chi:"Χ",cir:"○",circ:"ˆ",circeq:"≗",circlearrowleft:"↺",circlearrowright:"↻",circledast:"⊛",circledcirc:"⊚",circleddash:"⊝",CircleDot:"⊙",circledR:"®",circledS:"Ⓢ",CircleMinus:"⊖",CirclePlus:"⊕",CircleTimes:"⊗",cire:"≗",cirE:"⧃",cirfnint:"⨐",cirmid:"⫯",cirscir:"⧂",ClockwiseContourIntegral:"∲",CloseCurlyDoubleQuote:"”",CloseCurlyQuote:"’",clubs:"♣",clubsuit:"♣",colon:":",Colon:"∷",colone:"≔",Colone:"⩴",coloneq:"≔",comma:",",commat:"@",comp:"∁",compfn:"∘",complement:"∁",complexes:"ℂ",cong:"≅",congdot:"⩭",Congruent:"≡",conint:"∮",Conint:"∯",ContourIntegral:"∮",copf:"𝕔",Copf:"ℂ",coprod:"∐",Coproduct:"∐",copy:"©",COPY:"©",copysr:"℗",CounterClockwiseContourIntegral:"∳",crarr:"↵",cross:"✗",Cross:"⨯",cscr:"𝒸",Cscr:"𝒞",csub:"⫏",csube:"⫑",csup:"⫐",csupe:"⫒",ctdot:"⋯",cudarrl:"⤸",cudarrr:"⤵",cuepr:"⋞",cuesc:"⋟",cularr:"↶",cularrp:"⤽",cup:"∪",Cup:"⋓",cupbrcap:"⩈",cupcap:"⩆",CupCap:"≍",cupcup:"⩊",cupdot:"⊍",cupor:"⩅",cups:"∪︀",curarr:"↷",curarrm:"⤼",curlyeqprec:"⋞",curlyeqsucc:"⋟",curlyvee:"⋎",curlywedge:"⋏",curren:"¤",curvearrowleft:"↶",curvearrowright:"↷",cuvee:"⋎",cuwed:"⋏",cwconint:"∲",cwint:"∱",cylcty:"⌭",dagger:"†",Dagger:"‡",daleth:"ℸ",darr:"↓",dArr:"⇓",Darr:"↡",dash:"‐",dashv:"⊣",Dashv:"⫤",dbkarow:"⤏",dblac:"˝",dcaron:"ď",Dcaron:"Ď",dcy:"д",Dcy:"Д",dd:"ⅆ",DD:"ⅅ",ddagger:"‡",ddarr:"⇊",DDotrahd:"⤑",ddotseq:"⩷",deg:"°",Del:"∇",delta:"δ",Delta:"Δ",demptyv:"⦱",dfisht:"⥿",dfr:"𝔡",Dfr:"𝔇",dHar:"⥥",dharl:"⇃",dharr:"⇂",DiacriticalAcute:"´",DiacriticalDot:"˙",DiacriticalDoubleAcute:"˝",DiacriticalGrave:"`",DiacriticalTilde:"˜",diam:"⋄",diamond:"⋄",Diamond:"⋄",diamondsuit:"♦",diams:"♦",die:"¨",DifferentialD:"ⅆ",digamma:"ϝ",disin:"⋲",div:"÷",divide:"÷",divideontimes:"⋇",divonx:"⋇",djcy:"ђ",DJcy:"Ђ",dlcorn:"⌞",dlcrop:"⌍",dollar:"$",dopf:"𝕕",Dopf:"𝔻",dot:"˙",Dot:"¨",DotDot:"⃜",doteq:"≐",doteqdot:"≑",DotEqual:"≐",dotminus:"∸",dotplus:"∔",dotsquare:"⊡",doublebarwedge:"⌆",DoubleContourIntegral:"∯",DoubleDot:"¨",DoubleDownArrow:"⇓",DoubleLeftArrow:"⇐",DoubleLeftRightArrow:"⇔",DoubleLeftTee:"⫤",DoubleLongLeftArrow:"⟸",DoubleLongLeftRightArrow:"⟺",DoubleLongRightArrow:"⟹",DoubleRightArrow:"⇒",DoubleRightTee:"⊨",DoubleUpArrow:"⇑",DoubleUpDownArrow:"⇕",DoubleVerticalBar:"∥",downarrow:"↓",Downarrow:"⇓",DownArrow:"↓",DownArrowBar:"⤓",DownArrowUpArrow:"⇵",DownBreve:"̑",downdownarrows:"⇊",downharpoonleft:"⇃",downharpoonright:"⇂",DownLeftRightVector:"⥐",DownLeftTeeVector:"⥞",DownLeftVector:"↽",DownLeftVectorBar:"⥖",DownRightTeeVector:"⥟",DownRightVector:"⇁",DownRightVectorBar:"⥗",DownTee:"⊤",DownTeeArrow:"↧",drbkarow:"⤐",drcorn:"⌟",drcrop:"⌌",dscr:"𝒹",Dscr:"𝒟",dscy:"ѕ",DScy:"Ѕ",dsol:"⧶",dstrok:"đ",Dstrok:"Đ",dtdot:"⋱",dtri:"▿",dtrif:"▾",duarr:"⇵",duhar:"⥯",dwangle:"⦦",dzcy:"џ",DZcy:"Џ",dzigrarr:"⟿",eacute:"é",Eacute:"É",easter:"⩮",ecaron:"ě",Ecaron:"Ě",ecir:"≖",ecirc:"ê",Ecirc:"Ê",ecolon:"≕",ecy:"э",Ecy:"Э",eDDot:"⩷",edot:"ė",eDot:"≑",Edot:"Ė",ee:"ⅇ",efDot:"≒",efr:"𝔢",Efr:"𝔈",eg:"⪚",egrave:"è",Egrave:"È",egs:"⪖",egsdot:"⪘",el:"⪙",Element:"∈",elinters:"⏧",ell:"ℓ",els:"⪕",elsdot:"⪗",emacr:"ē",Emacr:"Ē",empty:"∅",emptyset:"∅",EmptySmallSquare:"◻",emptyv:"∅",EmptyVerySmallSquare:"▫",emsp:" ",emsp13:" ",emsp14:" ",eng:"ŋ",ENG:"Ŋ",ensp:" ",eogon:"ę",Eogon:"Ę",eopf:"𝕖",Eopf:"𝔼",epar:"⋕",eparsl:"⧣",eplus:"⩱",epsi:"ε",epsilon:"ε",Epsilon:"Ε",epsiv:"ϵ",eqcirc:"≖",eqcolon:"≕",eqsim:"≂",eqslantgtr:"⪖",eqslantless:"⪕",Equal:"⩵",equals:"=",EqualTilde:"≂",equest:"≟",Equilibrium:"⇌",equiv:"≡",equivDD:"⩸",eqvparsl:"⧥",erarr:"⥱",erDot:"≓",escr:"ℯ",Escr:"ℰ",esdot:"≐",esim:"≂",Esim:"⩳",eta:"η",Eta:"Η",eth:"ð",ETH:"Ð",euml:"ë",Euml:"Ë",euro:"€",excl:"!",exist:"∃",Exists:"∃",expectation:"ℰ",exponentiale:"ⅇ",ExponentialE:"ⅇ",fallingdotseq:"≒",fcy:"ф",Fcy:"Ф",female:"♀",ffilig:"ﬃ",fflig:"ﬀ",ffllig:"ﬄ",ffr:"𝔣",Ffr:"𝔉",filig:"ﬁ",FilledSmallSquare:"◼",FilledVerySmallSquare:"▪",fjlig:"fj",flat:"♭",fllig:"ﬂ",fltns:"▱",fnof:"ƒ",fopf:"𝕗",Fopf:"𝔽",forall:"∀",ForAll:"∀",fork:"⋔",forkv:"⫙",Fouriertrf:"ℱ",fpartint:"⨍",frac12:"½",frac13:"⅓",frac14:"¼",frac15:"⅕",frac16:"⅙",frac18:"⅛",frac23:"⅔",frac25:"⅖",frac34:"¾",frac35:"⅗",frac38:"⅜",frac45:"⅘",frac56:"⅚",frac58:"⅝",frac78:"⅞",frasl:"⁄",frown:"⌢",fscr:"𝒻",Fscr:"ℱ",gacute:"ǵ",gamma:"γ",Gamma:"Γ",gammad:"ϝ",Gammad:"Ϝ",gap:"⪆",gbreve:"ğ",Gbreve:"Ğ",Gcedil:"Ģ",gcirc:"ĝ",Gcirc:"Ĝ",gcy:"г",Gcy:"Г",gdot:"ġ",Gdot:"Ġ",ge:"≥",gE:"≧",gel:"⋛",gEl:"⪌",geq:"≥",geqq:"≧",geqslant:"⩾",ges:"⩾",gescc:"⪩",gesdot:"⪀",gesdoto:"⪂",gesdotol:"⪄",gesl:"⋛︀",gesles:"⪔",gfr:"𝔤",Gfr:"𝔊",gg:"≫",Gg:"⋙",ggg:"⋙",gimel:"ℷ",gjcy:"ѓ",GJcy:"Ѓ",gl:"≷",gla:"⪥",glE:"⪒",glj:"⪤",gnap:"⪊",gnapprox:"⪊",gne:"⪈",gnE:"≩",gneq:"⪈",gneqq:"≩",gnsim:"⋧",gopf:"𝕘",Gopf:"𝔾",grave:"`",GreaterEqual:"≥",GreaterEqualLess:"⋛",GreaterFullEqual:"≧",GreaterGreater:"⪢",GreaterLess:"≷",GreaterSlantEqual:"⩾",GreaterTilde:"≳",gscr:"ℊ",Gscr:"𝒢",gsim:"≳",gsime:"⪎",gsiml:"⪐",gt:">",Gt:"≫",GT:">",gtcc:"⪧",gtcir:"⩺",gtdot:"⋗",gtlPar:"⦕",gtquest:"⩼",gtrapprox:"⪆",gtrarr:"⥸",gtrdot:"⋗",gtreqless:"⋛",gtreqqless:"⪌",gtrless:"≷",gtrsim:"≳",gvertneqq:"≩︀",gvnE:"≩︀",Hacek:"ˇ",hairsp:" ",half:"½",hamilt:"ℋ",hardcy:"ъ",HARDcy:"Ъ",harr:"↔",hArr:"⇔",harrcir:"⥈",harrw:"↭",Hat:"^",hbar:"ℏ",hcirc:"ĥ",Hcirc:"Ĥ",hearts:"♥",heartsuit:"♥",hellip:"…",hercon:"⊹",hfr:"𝔥",Hfr:"ℌ",HilbertSpace:"ℋ",hksearow:"⤥",hkswarow:"⤦",hoarr:"⇿",homtht:"∻",hookleftarrow:"↩",hookrightarrow:"↪",hopf:"𝕙",Hopf:"ℍ",horbar:"―",HorizontalLine:"─",hscr:"𝒽",Hscr:"ℋ",hslash:"ℏ",hstrok:"ħ",Hstrok:"Ħ",HumpDownHump:"≎",HumpEqual:"≏",hybull:"⁃",hyphen:"‐",iacute:"í",Iacute:"Í",ic:"⁣",icirc:"î",Icirc:"Î",icy:"и",Icy:"И",Idot:"İ",iecy:"е",IEcy:"Е",iexcl:"¡",iff:"⇔",ifr:"𝔦",Ifr:"ℑ",igrave:"ì",Igrave:"Ì",ii:"ⅈ",iiiint:"⨌",iiint:"∭",iinfin:"⧜",iiota:"℩",ijlig:"ĳ",IJlig:"Ĳ",Im:"ℑ",imacr:"ī",Imacr:"Ī",image:"ℑ",ImaginaryI:"ⅈ",imagline:"ℐ",imagpart:"ℑ",imath:"ı",imof:"⊷",imped:"Ƶ",Implies:"⇒",in:"∈",incare:"℅",infin:"∞",infintie:"⧝",inodot:"ı",int:"∫",Int:"∬",intcal:"⊺",integers:"ℤ",Integral:"∫",intercal:"⊺",Intersection:"⋂",intlarhk:"⨗",intprod:"⨼",InvisibleComma:"⁣",InvisibleTimes:"⁢",iocy:"ё",IOcy:"Ё",iogon:"į",Iogon:"Į",iopf:"𝕚",Iopf:"𝕀",iota:"ι",Iota:"Ι",iprod:"⨼",iquest:"¿",iscr:"𝒾",Iscr:"ℐ",isin:"∈",isindot:"⋵",isinE:"⋹",isins:"⋴",isinsv:"⋳",isinv:"∈",it:"⁢",itilde:"ĩ",Itilde:"Ĩ",iukcy:"і",Iukcy:"І",iuml:"ï",Iuml:"Ï",jcirc:"ĵ",Jcirc:"Ĵ",jcy:"й",Jcy:"Й",jfr:"𝔧",Jfr:"𝔍",jmath:"ȷ",jopf:"𝕛",Jopf:"𝕁",jscr:"𝒿",Jscr:"𝒥",jsercy:"ј",Jsercy:"Ј",jukcy:"є",Jukcy:"Є",kappa:"κ",Kappa:"Κ",kappav:"ϰ",kcedil:"ķ",Kcedil:"Ķ",kcy:"к",Kcy:"К",kfr:"𝔨",Kfr:"𝔎",kgreen:"ĸ",khcy:"х",KHcy:"Х",kjcy:"ќ",KJcy:"Ќ",kopf:"𝕜",Kopf:"𝕂",kscr:"𝓀",Kscr:"𝒦",lAarr:"⇚",lacute:"ĺ",Lacute:"Ĺ",laemptyv:"⦴",lagran:"ℒ",lambda:"λ",Lambda:"Λ",lang:"⟨",Lang:"⟪",langd:"⦑",langle:"⟨",lap:"⪅",Laplacetrf:"ℒ",laquo:"«",larr:"←",lArr:"⇐",Larr:"↞",larrb:"⇤",larrbfs:"⤟",larrfs:"⤝",larrhk:"↩",larrlp:"↫",larrpl:"⤹",larrsim:"⥳",larrtl:"↢",lat:"⪫",latail:"⤙",lAtail:"⤛",late:"⪭",lates:"⪭︀",lbarr:"⤌",lBarr:"⤎",lbbrk:"❲",lbrace:"{",lbrack:"[",lbrke:"⦋",lbrksld:"⦏",lbrkslu:"⦍",lcaron:"ľ",Lcaron:"Ľ",lcedil:"ļ",Lcedil:"Ļ",lceil:"⌈",lcub:"{",lcy:"л",Lcy:"Л",ldca:"⤶",ldquo:"“",ldquor:"„",ldrdhar:"⥧",ldrushar:"⥋",ldsh:"↲",le:"≤",lE:"≦",LeftAngleBracket:"⟨",leftarrow:"←",Leftarrow:"⇐",LeftArrow:"←",LeftArrowBar:"⇤",LeftArrowRightArrow:"⇆",leftarrowtail:"↢",LeftCeiling:"⌈",LeftDoubleBracket:"⟦",LeftDownTeeVector:"⥡",LeftDownVector:"⇃",LeftDownVectorBar:"⥙",LeftFloor:"⌊",leftharpoondown:"↽",leftharpoonup:"↼",leftleftarrows:"⇇",leftrightarrow:"↔",Leftrightarrow:"⇔",LeftRightArrow:"↔",leftrightarrows:"⇆",leftrightharpoons:"⇋",leftrightsquigarrow:"↭",LeftRightVector:"⥎",LeftTee:"⊣",LeftTeeArrow:"↤",LeftTeeVector:"⥚",leftthreetimes:"⋋",LeftTriangle:"⊲",LeftTriangleBar:"⧏",LeftTriangleEqual:"⊴",LeftUpDownVector:"⥑",LeftUpTeeVector:"⥠",LeftUpVector:"↿",LeftUpVectorBar:"⥘",LeftVector:"↼",LeftVectorBar:"⥒",leg:"⋚",lEg:"⪋",leq:"≤",leqq:"≦",leqslant:"⩽",les:"⩽",lescc:"⪨",lesdot:"⩿",lesdoto:"⪁",lesdotor:"⪃",lesg:"⋚︀",lesges:"⪓",lessapprox:"⪅",lessdot:"⋖",lesseqgtr:"⋚",lesseqqgtr:"⪋",LessEqualGreater:"⋚",LessFullEqual:"≦",LessGreater:"≶",lessgtr:"≶",LessLess:"⪡",lesssim:"≲",LessSlantEqual:"⩽",LessTilde:"≲",lfisht:"⥼",lfloor:"⌊",lfr:"𝔩",Lfr:"𝔏",lg:"≶",lgE:"⪑",lHar:"⥢",lhard:"↽",lharu:"↼",lharul:"⥪",lhblk:"▄",ljcy:"љ",LJcy:"Љ",ll:"≪",Ll:"⋘",llarr:"⇇",llcorner:"⌞",Lleftarrow:"⇚",llhard:"⥫",lltri:"◺",lmidot:"ŀ",Lmidot:"Ŀ",lmoust:"⎰",lmoustache:"⎰",lnap:"⪉",lnapprox:"⪉",lne:"⪇",lnE:"≨",lneq:"⪇",lneqq:"≨",lnsim:"⋦",loang:"⟬",loarr:"⇽",lobrk:"⟦",longleftarrow:"⟵",Longleftarrow:"⟸",LongLeftArrow:"⟵",longleftrightarrow:"⟷",Longleftrightarrow:"⟺",LongLeftRightArrow:"⟷",longmapsto:"⟼",longrightarrow:"⟶",Longrightarrow:"⟹",LongRightArrow:"⟶",looparrowleft:"↫",looparrowright:"↬",lopar:"⦅",lopf:"𝕝",Lopf:"𝕃",loplus:"⨭",lotimes:"⨴",lowast:"∗",lowbar:"_",LowerLeftArrow:"↙",LowerRightArrow:"↘",loz:"◊",lozenge:"◊",lozf:"⧫",lpar:"(",lparlt:"⦓",lrarr:"⇆",lrcorner:"⌟",lrhar:"⇋",lrhard:"⥭",lrm:"‎",lrtri:"⊿",lsaquo:"‹",lscr:"𝓁",Lscr:"ℒ",lsh:"↰",Lsh:"↰",lsim:"≲",lsime:"⪍",lsimg:"⪏",lsqb:"[",lsquo:"‘",lsquor:"‚",lstrok:"ł",Lstrok:"Ł",lt:"<",Lt:"≪",LT:"<",ltcc:"⪦",ltcir:"⩹",ltdot:"⋖",lthree:"⋋",ltimes:"⋉",ltlarr:"⥶",ltquest:"⩻",ltri:"◃",ltrie:"⊴",ltrif:"◂",ltrPar:"⦖",lurdshar:"⥊",luruhar:"⥦",lvertneqq:"≨︀",lvnE:"≨︀",macr:"¯",male:"♂",malt:"✠",maltese:"✠",map:"↦",Map:"⤅",mapsto:"↦",mapstodown:"↧",mapstoleft:"↤",mapstoup:"↥",marker:"▮",mcomma:"⨩",mcy:"м",Mcy:"М",mdash:"—",mDDot:"∺",measuredangle:"∡",MediumSpace:" ",Mellintrf:"ℳ",mfr:"𝔪",Mfr:"𝔐",mho:"℧",micro:"µ",mid:"∣",midast:"*",midcir:"⫰",middot:"·",minus:"−",minusb:"⊟",minusd:"∸",minusdu:"⨪",MinusPlus:"∓",mlcp:"⫛",mldr:"…",mnplus:"∓",models:"⊧",mopf:"𝕞",Mopf:"𝕄",mp:"∓",mscr:"𝓂",Mscr:"ℳ",mstpos:"∾",mu:"μ",Mu:"Μ",multimap:"⊸",mumap:"⊸",nabla:"∇",nacute:"ń",Nacute:"Ń",nang:"∠⃒",nap:"≉",napE:"⩰̸",napid:"≋̸",napos:"ŉ",napprox:"≉",natur:"♮",natural:"♮",naturals:"ℕ",nbsp:" ",nbump:"≎̸",nbumpe:"≏̸",ncap:"⩃",ncaron:"ň",Ncaron:"Ň",ncedil:"ņ",Ncedil:"Ņ",ncong:"≇",ncongdot:"⩭̸",ncup:"⩂",ncy:"н",Ncy:"Н",ndash:"–",ne:"≠",nearhk:"⤤",nearr:"↗",neArr:"⇗",nearrow:"↗",nedot:"≐̸",NegativeMediumSpace:"​",NegativeThickSpace:"​",NegativeThinSpace:"​",NegativeVeryThinSpace:"​",nequiv:"≢",nesear:"⤨",nesim:"≂̸",NestedGreaterGreater:"≫",NestedLessLess:"≪",NewLine:`
`,nexist:"∄",nexists:"∄",nfr:"𝔫",Nfr:"𝔑",nge:"≱",ngE:"≧̸",ngeq:"≱",ngeqq:"≧̸",ngeqslant:"⩾̸",nges:"⩾̸",nGg:"⋙̸",ngsim:"≵",ngt:"≯",nGt:"≫⃒",ngtr:"≯",nGtv:"≫̸",nharr:"↮",nhArr:"⇎",nhpar:"⫲",ni:"∋",nis:"⋼",nisd:"⋺",niv:"∋",njcy:"њ",NJcy:"Њ",nlarr:"↚",nlArr:"⇍",nldr:"‥",nle:"≰",nlE:"≦̸",nleftarrow:"↚",nLeftarrow:"⇍",nleftrightarrow:"↮",nLeftrightarrow:"⇎",nleq:"≰",nleqq:"≦̸",nleqslant:"⩽̸",nles:"⩽̸",nless:"≮",nLl:"⋘̸",nlsim:"≴",nlt:"≮",nLt:"≪⃒",nltri:"⋪",nltrie:"⋬",nLtv:"≪̸",nmid:"∤",NoBreak:"⁠",NonBreakingSpace:" ",nopf:"𝕟",Nopf:"ℕ",not:"¬",Not:"⫬",NotCongruent:"≢",NotCupCap:"≭",NotDoubleVerticalBar:"∦",NotElement:"∉",NotEqual:"≠",NotEqualTilde:"≂̸",NotExists:"∄",NotGreater:"≯",NotGreaterEqual:"≱",NotGreaterFullEqual:"≧̸",NotGreaterGreater:"≫̸",NotGreaterLess:"≹",NotGreaterSlantEqual:"⩾̸",NotGreaterTilde:"≵",NotHumpDownHump:"≎̸",NotHumpEqual:"≏̸",notin:"∉",notindot:"⋵̸",notinE:"⋹̸",notinva:"∉",notinvb:"⋷",notinvc:"⋶",NotLeftTriangle:"⋪",NotLeftTriangleBar:"⧏̸",NotLeftTriangleEqual:"⋬",NotLess:"≮",NotLessEqual:"≰",NotLessGreater:"≸",NotLessLess:"≪̸",NotLessSlantEqual:"⩽̸",NotLessTilde:"≴",NotNestedGreaterGreater:"⪢̸",NotNestedLessLess:"⪡̸",notni:"∌",notniva:"∌",notnivb:"⋾",notnivc:"⋽",NotPrecedes:"⊀",NotPrecedesEqual:"⪯̸",NotPrecedesSlantEqual:"⋠",NotReverseElement:"∌",NotRightTriangle:"⋫",NotRightTriangleBar:"⧐̸",NotRightTriangleEqual:"⋭",NotSquareSubset:"⊏̸",NotSquareSubsetEqual:"⋢",NotSquareSuperset:"⊐̸",NotSquareSupersetEqual:"⋣",NotSubset:"⊂⃒",NotSubsetEqual:"⊈",NotSucceeds:"⊁",NotSucceedsEqual:"⪰̸",NotSucceedsSlantEqual:"⋡",NotSucceedsTilde:"≿̸",NotSuperset:"⊃⃒",NotSupersetEqual:"⊉",NotTilde:"≁",NotTildeEqual:"≄",NotTildeFullEqual:"≇",NotTildeTilde:"≉",NotVerticalBar:"∤",npar:"∦",nparallel:"∦",nparsl:"⫽⃥",npart:"∂̸",npolint:"⨔",npr:"⊀",nprcue:"⋠",npre:"⪯̸",nprec:"⊀",npreceq:"⪯̸",nrarr:"↛",nrArr:"⇏",nrarrc:"⤳̸",nrarrw:"↝̸",nrightarrow:"↛",nRightarrow:"⇏",nrtri:"⋫",nrtrie:"⋭",nsc:"⊁",nsccue:"⋡",nsce:"⪰̸",nscr:"𝓃",Nscr:"𝒩",nshortmid:"∤",nshortparallel:"∦",nsim:"≁",nsime:"≄",nsimeq:"≄",nsmid:"∤",nspar:"∦",nsqsube:"⋢",nsqsupe:"⋣",nsub:"⊄",nsube:"⊈",nsubE:"⫅̸",nsubset:"⊂⃒",nsubseteq:"⊈",nsubseteqq:"⫅̸",nsucc:"⊁",nsucceq:"⪰̸",nsup:"⊅",nsupe:"⊉",nsupE:"⫆̸",nsupset:"⊃⃒",nsupseteq:"⊉",nsupseteqq:"⫆̸",ntgl:"≹",ntilde:"ñ",Ntilde:"Ñ",ntlg:"≸",ntriangleleft:"⋪",ntrianglelefteq:"⋬",ntriangleright:"⋫",ntrianglerighteq:"⋭",nu:"ν",Nu:"Ν",num:"#",numero:"№",numsp:" ",nvap:"≍⃒",nvdash:"⊬",nvDash:"⊭",nVdash:"⊮",nVDash:"⊯",nvge:"≥⃒",nvgt:">⃒",nvHarr:"⤄",nvinfin:"⧞",nvlArr:"⤂",nvle:"≤⃒",nvlt:"<⃒",nvltrie:"⊴⃒",nvrArr:"⤃",nvrtrie:"⊵⃒",nvsim:"∼⃒",nwarhk:"⤣",nwarr:"↖",nwArr:"⇖",nwarrow:"↖",nwnear:"⤧",oacute:"ó",Oacute:"Ó",oast:"⊛",ocir:"⊚",ocirc:"ô",Ocirc:"Ô",ocy:"о",Ocy:"О",odash:"⊝",odblac:"ő",Odblac:"Ő",odiv:"⨸",odot:"⊙",odsold:"⦼",oelig:"œ",OElig:"Œ",ofcir:"⦿",ofr:"𝔬",Ofr:"𝔒",ogon:"˛",ograve:"ò",Ograve:"Ò",ogt:"⧁",ohbar:"⦵",ohm:"Ω",oint:"∮",olarr:"↺",olcir:"⦾",olcross:"⦻",oline:"‾",olt:"⧀",omacr:"ō",Omacr:"Ō",omega:"ω",Omega:"Ω",omicron:"ο",Omicron:"Ο",omid:"⦶",ominus:"⊖",oopf:"𝕠",Oopf:"𝕆",opar:"⦷",OpenCurlyDoubleQuote:"“",OpenCurlyQuote:"‘",operp:"⦹",oplus:"⊕",or:"∨",Or:"⩔",orarr:"↻",ord:"⩝",order:"ℴ",orderof:"ℴ",ordf:"ª",ordm:"º",origof:"⊶",oror:"⩖",orslope:"⩗",orv:"⩛",oS:"Ⓢ",oscr:"ℴ",Oscr:"𝒪",oslash:"ø",Oslash:"Ø",osol:"⊘",otilde:"õ",Otilde:"Õ",otimes:"⊗",Otimes:"⨷",otimesas:"⨶",ouml:"ö",Ouml:"Ö",ovbar:"⌽",OverBar:"‾",OverBrace:"⏞",OverBracket:"⎴",OverParenthesis:"⏜",par:"∥",para:"¶",parallel:"∥",parsim:"⫳",parsl:"⫽",part:"∂",PartialD:"∂",pcy:"п",Pcy:"П",percnt:"%",period:".",permil:"‰",perp:"⊥",pertenk:"‱",pfr:"𝔭",Pfr:"𝔓",phi:"φ",Phi:"Φ",phiv:"ϕ",phmmat:"ℳ",phone:"☎",pi:"π",Pi:"Π",pitchfork:"⋔",piv:"ϖ",planck:"ℏ",planckh:"ℎ",plankv:"ℏ",plus:"+",plusacir:"⨣",plusb:"⊞",pluscir:"⨢",plusdo:"∔",plusdu:"⨥",pluse:"⩲",PlusMinus:"±",plusmn:"±",plussim:"⨦",plustwo:"⨧",pm:"±",Poincareplane:"ℌ",pointint:"⨕",popf:"𝕡",Popf:"ℙ",pound:"£",pr:"≺",Pr:"⪻",prap:"⪷",prcue:"≼",pre:"⪯",prE:"⪳",prec:"≺",precapprox:"⪷",preccurlyeq:"≼",Precedes:"≺",PrecedesEqual:"⪯",PrecedesSlantEqual:"≼",PrecedesTilde:"≾",preceq:"⪯",precnapprox:"⪹",precneqq:"⪵",precnsim:"⋨",precsim:"≾",prime:"′",Prime:"″",primes:"ℙ",prnap:"⪹",prnE:"⪵",prnsim:"⋨",prod:"∏",Product:"∏",profalar:"⌮",profline:"⌒",profsurf:"⌓",prop:"∝",Proportion:"∷",Proportional:"∝",propto:"∝",prsim:"≾",prurel:"⊰",pscr:"𝓅",Pscr:"𝒫",psi:"ψ",Psi:"Ψ",puncsp:" ",qfr:"𝔮",Qfr:"𝔔",qint:"⨌",qopf:"𝕢",Qopf:"ℚ",qprime:"⁗",qscr:"𝓆",Qscr:"𝒬",quaternions:"ℍ",quatint:"⨖",quest:"?",questeq:"≟",quot:'"',QUOT:'"',rAarr:"⇛",race:"∽̱",racute:"ŕ",Racute:"Ŕ",radic:"√",raemptyv:"⦳",rang:"⟩",Rang:"⟫",rangd:"⦒",range:"⦥",rangle:"⟩",raquo:"»",rarr:"→",rArr:"⇒",Rarr:"↠",rarrap:"⥵",rarrb:"⇥",rarrbfs:"⤠",rarrc:"⤳",rarrfs:"⤞",rarrhk:"↪",rarrlp:"↬",rarrpl:"⥅",rarrsim:"⥴",rarrtl:"↣",Rarrtl:"⤖",rarrw:"↝",ratail:"⤚",rAtail:"⤜",ratio:"∶",rationals:"ℚ",rbarr:"⤍",rBarr:"⤏",RBarr:"⤐",rbbrk:"❳",rbrace:"}",rbrack:"]",rbrke:"⦌",rbrksld:"⦎",rbrkslu:"⦐",rcaron:"ř",Rcaron:"Ř",rcedil:"ŗ",Rcedil:"Ŗ",rceil:"⌉",rcub:"}",rcy:"р",Rcy:"Р",rdca:"⤷",rdldhar:"⥩",rdquo:"”",rdquor:"”",rdsh:"↳",Re:"ℜ",real:"ℜ",realine:"ℛ",realpart:"ℜ",reals:"ℝ",rect:"▭",reg:"®",REG:"®",ReverseElement:"∋",ReverseEquilibrium:"⇋",ReverseUpEquilibrium:"⥯",rfisht:"⥽",rfloor:"⌋",rfr:"𝔯",Rfr:"ℜ",rHar:"⥤",rhard:"⇁",rharu:"⇀",rharul:"⥬",rho:"ρ",Rho:"Ρ",rhov:"ϱ",RightAngleBracket:"⟩",rightarrow:"→",Rightarrow:"⇒",RightArrow:"→",RightArrowBar:"⇥",RightArrowLeftArrow:"⇄",rightarrowtail:"↣",RightCeiling:"⌉",RightDoubleBracket:"⟧",RightDownTeeVector:"⥝",RightDownVector:"⇂",RightDownVectorBar:"⥕",RightFloor:"⌋",rightharpoondown:"⇁",rightharpoonup:"⇀",rightleftarrows:"⇄",rightleftharpoons:"⇌",rightrightarrows:"⇉",rightsquigarrow:"↝",RightTee:"⊢",RightTeeArrow:"↦",RightTeeVector:"⥛",rightthreetimes:"⋌",RightTriangle:"⊳",RightTriangleBar:"⧐",RightTriangleEqual:"⊵",RightUpDownVector:"⥏",RightUpTeeVector:"⥜",RightUpVector:"↾",RightUpVectorBar:"⥔",RightVector:"⇀",RightVectorBar:"⥓",ring:"˚",risingdotseq:"≓",rlarr:"⇄",rlhar:"⇌",rlm:"‏",rmoust:"⎱",rmoustache:"⎱",rnmid:"⫮",roang:"⟭",roarr:"⇾",robrk:"⟧",ropar:"⦆",ropf:"𝕣",Ropf:"ℝ",roplus:"⨮",rotimes:"⨵",RoundImplies:"⥰",rpar:")",rpargt:"⦔",rppolint:"⨒",rrarr:"⇉",Rrightarrow:"⇛",rsaquo:"›",rscr:"𝓇",Rscr:"ℛ",rsh:"↱",Rsh:"↱",rsqb:"]",rsquo:"’",rsquor:"’",rthree:"⋌",rtimes:"⋊",rtri:"▹",rtrie:"⊵",rtrif:"▸",rtriltri:"⧎",RuleDelayed:"⧴",ruluhar:"⥨",rx:"℞",sacute:"ś",Sacute:"Ś",sbquo:"‚",sc:"≻",Sc:"⪼",scap:"⪸",scaron:"š",Scaron:"Š",sccue:"≽",sce:"⪰",scE:"⪴",scedil:"ş",Scedil:"Ş",scirc:"ŝ",Scirc:"Ŝ",scnap:"⪺",scnE:"⪶",scnsim:"⋩",scpolint:"⨓",scsim:"≿",scy:"с",Scy:"С",sdot:"⋅",sdotb:"⊡",sdote:"⩦",searhk:"⤥",searr:"↘",seArr:"⇘",searrow:"↘",sect:"§",semi:";",seswar:"⤩",setminus:"∖",setmn:"∖",sext:"✶",sfr:"𝔰",Sfr:"𝔖",sfrown:"⌢",sharp:"♯",shchcy:"щ",SHCHcy:"Щ",shcy:"ш",SHcy:"Ш",ShortDownArrow:"↓",ShortLeftArrow:"←",shortmid:"∣",shortparallel:"∥",ShortRightArrow:"→",ShortUpArrow:"↑",shy:"­",sigma:"σ",Sigma:"Σ",sigmaf:"ς",sigmav:"ς",sim:"∼",simdot:"⩪",sime:"≃",simeq:"≃",simg:"⪞",simgE:"⪠",siml:"⪝",simlE:"⪟",simne:"≆",simplus:"⨤",simrarr:"⥲",slarr:"←",SmallCircle:"∘",smallsetminus:"∖",smashp:"⨳",smeparsl:"⧤",smid:"∣",smile:"⌣",smt:"⪪",smte:"⪬",smtes:"⪬︀",softcy:"ь",SOFTcy:"Ь",sol:"/",solb:"⧄",solbar:"⌿",sopf:"𝕤",Sopf:"𝕊",spades:"♠",spadesuit:"♠",spar:"∥",sqcap:"⊓",sqcaps:"⊓︀",sqcup:"⊔",sqcups:"⊔︀",Sqrt:"√",sqsub:"⊏",sqsube:"⊑",sqsubset:"⊏",sqsubseteq:"⊑",sqsup:"⊐",sqsupe:"⊒",sqsupset:"⊐",sqsupseteq:"⊒",squ:"□",square:"□",Square:"□",SquareIntersection:"⊓",SquareSubset:"⊏",SquareSubsetEqual:"⊑",SquareSuperset:"⊐",SquareSupersetEqual:"⊒",SquareUnion:"⊔",squarf:"▪",squf:"▪",srarr:"→",sscr:"𝓈",Sscr:"𝒮",ssetmn:"∖",ssmile:"⌣",sstarf:"⋆",star:"☆",Star:"⋆",starf:"★",straightepsilon:"ϵ",straightphi:"ϕ",strns:"¯",sub:"⊂",Sub:"⋐",subdot:"⪽",sube:"⊆",subE:"⫅",subedot:"⫃",submult:"⫁",subne:"⊊",subnE:"⫋",subplus:"⪿",subrarr:"⥹",subset:"⊂",Subset:"⋐",subseteq:"⊆",subseteqq:"⫅",SubsetEqual:"⊆",subsetneq:"⊊",subsetneqq:"⫋",subsim:"⫇",subsub:"⫕",subsup:"⫓",succ:"≻",succapprox:"⪸",succcurlyeq:"≽",Succeeds:"≻",SucceedsEqual:"⪰",SucceedsSlantEqual:"≽",SucceedsTilde:"≿",succeq:"⪰",succnapprox:"⪺",succneqq:"⪶",succnsim:"⋩",succsim:"≿",SuchThat:"∋",sum:"∑",Sum:"∑",sung:"♪",sup:"⊃",Sup:"⋑",sup1:"¹",sup2:"²",sup3:"³",supdot:"⪾",supdsub:"⫘",supe:"⊇",supE:"⫆",supedot:"⫄",Superset:"⊃",SupersetEqual:"⊇",suphsol:"⟉",suphsub:"⫗",suplarr:"⥻",supmult:"⫂",supne:"⊋",supnE:"⫌",supplus:"⫀",supset:"⊃",Supset:"⋑",supseteq:"⊇",supseteqq:"⫆",supsetneq:"⊋",supsetneqq:"⫌",supsim:"⫈",supsub:"⫔",supsup:"⫖",swarhk:"⤦",swarr:"↙",swArr:"⇙",swarrow:"↙",swnwar:"⤪",szlig:"ß",Tab:"	",target:"⌖",tau:"τ",Tau:"Τ",tbrk:"⎴",tcaron:"ť",Tcaron:"Ť",tcedil:"ţ",Tcedil:"Ţ",tcy:"т",Tcy:"Т",tdot:"⃛",telrec:"⌕",tfr:"𝔱",Tfr:"𝔗",there4:"∴",therefore:"∴",Therefore:"∴",theta:"θ",Theta:"Θ",thetasym:"ϑ",thetav:"ϑ",thickapprox:"≈",thicksim:"∼",ThickSpace:"  ",thinsp:" ",ThinSpace:" ",thkap:"≈",thksim:"∼",thorn:"þ",THORN:"Þ",tilde:"˜",Tilde:"∼",TildeEqual:"≃",TildeFullEqual:"≅",TildeTilde:"≈",times:"×",timesb:"⊠",timesbar:"⨱",timesd:"⨰",tint:"∭",toea:"⤨",top:"⊤",topbot:"⌶",topcir:"⫱",topf:"𝕥",Topf:"𝕋",topfork:"⫚",tosa:"⤩",tprime:"‴",trade:"™",TRADE:"™",triangle:"▵",triangledown:"▿",triangleleft:"◃",trianglelefteq:"⊴",triangleq:"≜",triangleright:"▹",trianglerighteq:"⊵",tridot:"◬",trie:"≜",triminus:"⨺",TripleDot:"⃛",triplus:"⨹",trisb:"⧍",tritime:"⨻",trpezium:"⏢",tscr:"𝓉",Tscr:"𝒯",tscy:"ц",TScy:"Ц",tshcy:"ћ",TSHcy:"Ћ",tstrok:"ŧ",Tstrok:"Ŧ",twixt:"≬",twoheadleftarrow:"↞",twoheadrightarrow:"↠",uacute:"ú",Uacute:"Ú",uarr:"↑",uArr:"⇑",Uarr:"↟",Uarrocir:"⥉",ubrcy:"ў",Ubrcy:"Ў",ubreve:"ŭ",Ubreve:"Ŭ",ucirc:"û",Ucirc:"Û",ucy:"у",Ucy:"У",udarr:"⇅",udblac:"ű",Udblac:"Ű",udhar:"⥮",ufisht:"⥾",ufr:"𝔲",Ufr:"𝔘",ugrave:"ù",Ugrave:"Ù",uHar:"⥣",uharl:"↿",uharr:"↾",uhblk:"▀",ulcorn:"⌜",ulcorner:"⌜",ulcrop:"⌏",ultri:"◸",umacr:"ū",Umacr:"Ū",uml:"¨",UnderBar:"_",UnderBrace:"⏟",UnderBracket:"⎵",UnderParenthesis:"⏝",Union:"⋃",UnionPlus:"⊎",uogon:"ų",Uogon:"Ų",uopf:"𝕦",Uopf:"𝕌",uparrow:"↑",Uparrow:"⇑",UpArrow:"↑",UpArrowBar:"⤒",UpArrowDownArrow:"⇅",updownarrow:"↕",Updownarrow:"⇕",UpDownArrow:"↕",UpEquilibrium:"⥮",upharpoonleft:"↿",upharpoonright:"↾",uplus:"⊎",UpperLeftArrow:"↖",UpperRightArrow:"↗",upsi:"υ",Upsi:"ϒ",upsih:"ϒ",upsilon:"υ",Upsilon:"Υ",UpTee:"⊥",UpTeeArrow:"↥",upuparrows:"⇈",urcorn:"⌝",urcorner:"⌝",urcrop:"⌎",uring:"ů",Uring:"Ů",urtri:"◹",uscr:"𝓊",Uscr:"𝒰",utdot:"⋰",utilde:"ũ",Utilde:"Ũ",utri:"▵",utrif:"▴",uuarr:"⇈",uuml:"ü",Uuml:"Ü",uwangle:"⦧",vangrt:"⦜",varepsilon:"ϵ",varkappa:"ϰ",varnothing:"∅",varphi:"ϕ",varpi:"ϖ",varpropto:"∝",varr:"↕",vArr:"⇕",varrho:"ϱ",varsigma:"ς",varsubsetneq:"⊊︀",varsubsetneqq:"⫋︀",varsupsetneq:"⊋︀",varsupsetneqq:"⫌︀",vartheta:"ϑ",vartriangleleft:"⊲",vartriangleright:"⊳",vBar:"⫨",Vbar:"⫫",vBarv:"⫩",vcy:"в",Vcy:"В",vdash:"⊢",vDash:"⊨",Vdash:"⊩",VDash:"⊫",Vdashl:"⫦",vee:"∨",Vee:"⋁",veebar:"⊻",veeeq:"≚",vellip:"⋮",verbar:"|",Verbar:"‖",vert:"|",Vert:"‖",VerticalBar:"∣",VerticalLine:"|",VerticalSeparator:"❘",VerticalTilde:"≀",VeryThinSpace:" ",vfr:"𝔳",Vfr:"𝔙",vltri:"⊲",vnsub:"⊂⃒",vnsup:"⊃⃒",vopf:"𝕧",Vopf:"𝕍",vprop:"∝",vrtri:"⊳",vscr:"𝓋",Vscr:"𝒱",vsubne:"⊊︀",vsubnE:"⫋︀",vsupne:"⊋︀",vsupnE:"⫌︀",Vvdash:"⊪",vzigzag:"⦚",wcirc:"ŵ",Wcirc:"Ŵ",wedbar:"⩟",wedge:"∧",Wedge:"⋀",wedgeq:"≙",weierp:"℘",wfr:"𝔴",Wfr:"𝔚",wopf:"𝕨",Wopf:"𝕎",wp:"℘",wr:"≀",wreath:"≀",wscr:"𝓌",Wscr:"𝒲",xcap:"⋂",xcirc:"◯",xcup:"⋃",xdtri:"▽",xfr:"𝔵",Xfr:"𝔛",xharr:"⟷",xhArr:"⟺",xi:"ξ",Xi:"Ξ",xlarr:"⟵",xlArr:"⟸",xmap:"⟼",xnis:"⋻",xodot:"⨀",xopf:"𝕩",Xopf:"𝕏",xoplus:"⨁",xotime:"⨂",xrarr:"⟶",xrArr:"⟹",xscr:"𝓍",Xscr:"𝒳",xsqcup:"⨆",xuplus:"⨄",xutri:"△",xvee:"⋁",xwedge:"⋀",yacute:"ý",Yacute:"Ý",yacy:"я",YAcy:"Я",ycirc:"ŷ",Ycirc:"Ŷ",ycy:"ы",Ycy:"Ы",yen:"¥",yfr:"𝔶",Yfr:"𝔜",yicy:"ї",YIcy:"Ї",yopf:"𝕪",Yopf:"𝕐",yscr:"𝓎",Yscr:"𝒴",yucy:"ю",YUcy:"Ю",yuml:"ÿ",Yuml:"Ÿ",zacute:"ź",Zacute:"Ź",zcaron:"ž",Zcaron:"Ž",zcy:"з",Zcy:"З",zdot:"ż",Zdot:"Ż",zeetrf:"ℨ",ZeroWidthSpace:"​",zeta:"ζ",Zeta:"Ζ",zfr:"𝔷",Zfr:"ℨ",zhcy:"ж",ZHcy:"Ж",zigrarr:"⇝",zopf:"𝕫",Zopf:"ℤ",zscr:"𝓏",Zscr:"𝒵",zwj:"‍",zwnj:"‌"},A={aacute:"á",Aacute:"Á",acirc:"â",Acirc:"Â",acute:"´",aelig:"æ",AElig:"Æ",agrave:"à",Agrave:"À",amp:"&",AMP:"&",aring:"å",Aring:"Å",atilde:"ã",Atilde:"Ã",auml:"ä",Auml:"Ä",brvbar:"¦",ccedil:"ç",Ccedil:"Ç",cedil:"¸",cent:"¢",copy:"©",COPY:"©",curren:"¤",deg:"°",divide:"÷",eacute:"é",Eacute:"É",ecirc:"ê",Ecirc:"Ê",egrave:"è",Egrave:"È",eth:"ð",ETH:"Ð",euml:"ë",Euml:"Ë",frac12:"½",frac14:"¼",frac34:"¾",gt:">",GT:">",iacute:"í",Iacute:"Í",icirc:"î",Icirc:"Î",iexcl:"¡",igrave:"ì",Igrave:"Ì",iquest:"¿",iuml:"ï",Iuml:"Ï",laquo:"«",lt:"<",LT:"<",macr:"¯",micro:"µ",middot:"·",nbsp:" ",not:"¬",ntilde:"ñ",Ntilde:"Ñ",oacute:"ó",Oacute:"Ó",ocirc:"ô",Ocirc:"Ô",ograve:"ò",Ograve:"Ò",ordf:"ª",ordm:"º",oslash:"ø",Oslash:"Ø",otilde:"õ",Otilde:"Õ",ouml:"ö",Ouml:"Ö",para:"¶",plusmn:"±",pound:"£",quot:'"',QUOT:'"',raquo:"»",reg:"®",REG:"®",sect:"§",shy:"­",sup1:"¹",sup2:"²",sup3:"³",szlig:"ß",thorn:"þ",THORN:"Þ",times:"×",uacute:"ú",Uacute:"Ú",ucirc:"û",Ucirc:"Û",ugrave:"ù",Ugrave:"Ù",uml:"¨",uuml:"ü",Uuml:"Ü",yacute:"ý",Yacute:"Ý",yen:"¥",yuml:"ÿ"},D={0:"�",128:"€",130:"‚",131:"ƒ",132:"„",133:"…",134:"†",135:"‡",136:"ˆ",137:"‰",138:"Š",139:"‹",140:"Œ",142:"Ž",145:"‘",146:"’",147:"“",148:"”",149:"•",150:"–",151:"—",152:"˜",153:"™",154:"š",155:"›",156:"œ",158:"ž",159:"Ÿ"},R=[1,2,3,4,5,6,7,8,11,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,64976,64977,64978,64979,64980,64981,64982,64983,64984,64985,64986,64987,64988,64989,64990,64991,64992,64993,64994,64995,64996,64997,64998,64999,65e3,65001,65002,65003,65004,65005,65006,65007,65534,65535,131070,131071,196606,196607,262142,262143,327678,327679,393214,393215,458750,458751,524286,524287,589822,589823,655358,655359,720894,720895,786430,786431,851966,851967,917502,917503,983038,983039,1048574,1048575,1114110,1114111],_=String.fromCharCode,F={},w=F.hasOwnProperty,C=function(H,J){return w.call(H,J)},M=function(H,J){for(var ve=-1,fe=H.length;++ve<fe;)if(H[ve]==J)return!0;return!1},L=function(H,J){if(!H)return J;var ve={},fe;for(fe in J)ve[fe]=C(H,fe)?H[fe]:J[fe];return ve},I=function(H,J){var ve="";return H>=55296&&H<=57343||H>1114111?(J&&$("character reference outside the permissible Unicode range"),"�"):C(D,H)?(J&&$("disallowed character reference"),D[H]):(J&&M(R,H)&&$("disallowed character reference"),H>65535&&(H-=65536,ve+=_(H>>>10&1023|55296),H=56320|H&1023),ve+=_(H),ve)},U=function(H){return"&#x"+H.toString(16).toUpperCase()+";"},q=function(H){return"&#"+H+";"},$=function(H){throw Error("Parse error: "+H)},X=function(H,J){J=L(J,X.options);var ve=J.strict;ve&&m.test(H)&&$("forbidden code point");var fe=J.encodeEverything,De=J.useNamedReferences,Ie=J.allowUnsafeSymbols,we=J.decimal?q:U,Ue=function($e){return we($e.charCodeAt(0))};return fe?(H=H.replace(o,function($e){return De&&C(h,$e)?"&"+h[$e]+";":Ue($e)}),De&&(H=H.replace(/&gt;\u20D2/g,"&nvgt;").replace(/&lt;\u20D2/g,"&nvlt;").replace(/&#x66;&#x6A;/g,"&fjlig;")),De&&(H=H.replace(u,function($e){return"&"+h[$e]+";"}))):De?(Ie||(H=H.replace(d,function($e){return"&"+h[$e]+";"})),H=H.replace(/&gt;\u20D2/g,"&nvgt;").replace(/&lt;\u20D2/g,"&nvlt;"),H=H.replace(u,function($e){return"&"+h[$e]+";"})):Ie||(H=H.replace(d,Ue)),H.replace(a,function($e){var et=$e.charCodeAt(0),it=$e.charCodeAt(1),Ge=(et-55296)*1024+it-56320+65536;return we(Ge)}).replace(l,Ue)};X.options={allowUnsafeSymbols:!1,encodeEverything:!1,strict:!1,useNamedReferences:!1,decimal:!1};var ne=function(H,J){J=L(J,ne.options);var ve=J.strict;return ve&&g.test(H)&&$("malformed character reference"),H.replace(v,function(fe,De,Ie,we,Ue,$e,et,it,Ge){var st,B,ae,Ae,be,ge;return De?(be=De,E[be]):Ie?(be=Ie,ge=we,ge&&J.isAttributeValue?(ve&&ge=="="&&$("`&` did not start a character reference"),fe):(ve&&$("named character reference was not terminated by a semicolon"),A[be]+(ge||""))):Ue?(ae=Ue,B=$e,ve&&!B&&$("character reference was not terminated by a semicolon"),st=parseInt(ae,10),I(st,ve)):et?(Ae=et,B=it,ve&&!B&&$("character reference was not terminated by a semicolon"),st=parseInt(Ae,16),I(st,ve)):(ve&&$("named character reference was not terminated by a semicolon"),fe)})};ne.options={isAttributeValue:!1,strict:!1};var se=function(H){return H.replace(d,function(J){return p[J]})},ce={version:"1.2.0",encode:X,decode:ne,escape:se,unescape:ne};if(r&&!r.nodeType)if(n)n.exports=ce;else for(var ie in ce)C(ce,ie)&&(r[ie]=ce[ie]);else t.he=ce})(vF)}(gl,gl.exports)),gl.exports}var bF=EF();const AF=Vs(bF);var vc={exports:{}},V2={};/*! http://mths.be/fromcodepoint v0.2.1 by @mathias */var H2;function SF(){return H2||(H2=1,String.fromCodePoint||function(){var i=function(){try{var n={},s=Object.defineProperty,a=s(n,n,n)&&s}catch{}return a}(),e=String.fromCharCode,t=Math.floor,r=function(n){var s=16384,a=[],o,l,u=-1,h=arguments.length;if(!h)return"";for(var d="";++u<h;){var p=Number(arguments[u]);if(!isFinite(p)||p<0||p>1114111||t(p)!=p)throw RangeError("Invalid code point: "+p);p<=65535?a.push(p):(p-=65536,o=(p>>10)+55296,l=p%1024+56320,a.push(o,l)),(u+1==h||a.length>s)&&(d+=e.apply(null,a),a.length=0)}return d};i?i(String,"fromCodePoint",{value:r,configurable:!0,writable:!0}):String.fromCodePoint=r}()),V2}var K2;function xF(){return K2||(K2=1,function(i,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,SF();var t=/\\(u\{([0-9A-Fa-f]+)\}|u([0-9A-Fa-f]{4})|x([0-9A-Fa-f]{2})|([1-7][0-7]{0,2}|[0-7]{2,3})|(['"tbrnfv0\\]))|\\U([0-9A-Fa-f]{8})/g,r={0:"\0",b:"\b",f:"\f",n:`
`,r:"\r",t:"	",v:"\v","'":"'",'"':'"',"\\":"\\"},n=function(l){return String.fromCodePoint(parseInt(l,16))},s=function(l){return String.fromCodePoint(parseInt(l,8))},a=function(l){return l.replace(t,function(u,h,d,p,g,m,v,E){return d!==void 0?n(d):p!==void 0?n(p):g!==void 0?n(g):m!==void 0?s(m):E!==void 0?n(E):r[v]})};e.default=a,i.exports=e.default}(vc,vc.exports)),vc.exports}var TF=xF();const DF=Vs(TF);class Ct{static appendSubtitle(e,t,r){return e.end=t.end,e.dur=e.end-e.start,r?e.text+=" "+t.text:e.text+=t.text,e}static convertVttEntriesToSubtitles(e){const t=[],r=[];let n=!1;for(let s=0;s<e.length;s++){const a=e[s],o=this.createSubtitle(a),l=this.createSubtitle(a);!n&&this.hasPunctuation(o.text)&&(n=!0),t.push(o),r.push(l)}return{hasPunctuation:n,subtitles:t,originSubtitles:r}}static convertDropboxSegmentsToSubtitles(e){const t=[],r=[];let n=!1;for(let s=0;s<e.length;s++){const a=e[s],o=this.createSubtitleBySegment(a),l=this.createSubtitleBySegment(a);!n&&this.hasPunctuation(o.text)&&(n=!0),t.push(o),r.push(l)}return{hasPunctuation:n,subtitles:t,originSubtitles:r}}static createSubtitleBySegment(e){return{start:e.startTime,end:e.endTime,dur:e.endTime-e.startTime,text:this.normalizeSubtitleText(e.text),processPunctuation:!0}}static createSubtitle(e){return{start:e.startTime,end:e.endTime,dur:e.endTime-e.startTime,text:this.normalizeSubtitleText(e.text),processPunctuation:!0}}static normalizeSubtitleText(e){let t=e.replaceAll(`
`," ");return t=DF(t),t=AF.decode(t),t=G2(t).result,t=t.replace(/[^\p{L}\p{N}\p{P}\p{Zs}]/gu,""),t=t.replace(/(\s+|^)uh,?/gi,"$1"),t.startsWith("- [Instructor]")&&(t=t.replace("- [Instructor]","")),t}static hasPunctuation(e){for(let t=0;t<e.length;t++){const r=e.charAt(t);if(jt.isPunctuation(r))return!0}return!1}static hasAnyPunctuation(e){for(let t of e)if(Ct.hasPunctuation(t.text))return!0;return!1}static copyToSubtitleRequests(e){return e.map(t=>({text:t.text,start:t.start,end:t.end,dur:t.dur}))}static copyToSubtitles(e){return e.map(t=>({text:t.text,start:t.start,end:t.end,dur:t.dur,processPunctuation:!0}))}static findFirstWord(e){let t="";const r=e.text.trim();for(let n=0;n<r.length;n++){const s=r.charAt(n);if(t+=s,jt.isPunctuation(s)||jt.isWeakPunctuation(s)||s.trim().length===0)return t}return t}static findLastWord(e){let t=[];for(let r=e.text.length-1;r>=0;r--){const n=e.text.charAt(r);if(!(t.length===0&&(jt.isPunctuation(n)||jt.isWeakPunctuation(n)||n.trim().length===0))&&(t.push(n),t.length!==0&&(jt.isPunctuation(n)||jt.isWeakPunctuation(n)||n.trim().length===0)))break}return t.reverse().join("")}static isSoundEffectMarker(e){return e.startsWith("[")&&e.endsWith("]")}}class RF{constructor(e="en"){re(this,"segmenter");re(this,"locale");re(this,"MIN_SENTENCE_LENGTH",10);re(this,"MAX_SENTENCE_LENGTH",300);re(this,"MAX_SUBTITLE_DURATION",30);re(this,"MIN_WORD_COUNT",5);this.locale=e,typeof Intl<"u"&&"Segmenter"in Intl&&(this.segmenter=new Intl.Segmenter(e,{granularity:"sentence"}))}segment(e){if(!this.segmenter)return this.fallbackSegment(e);const t=[],r=this.segmenter.segment(e);for(const{segment:n}of r){const s=n.trim();s.length>0&&t.push(s)}return this.postProcessSegments(t)}segmentSubtitle(e,t,r=!0){const n=this.segment(t);let s;if(r){const o=e.text||t;s=this.segment(o)}const a=this.distributeTimeToSegments(e,n,s);return this.secondarySplitByDuration(a,r)}distributeTimeToSegments(e,t,r){if(t.length===0)return[];const n=e.dur,s=e.start,a=t.map(d=>this.countCharacters(d)),o=a.reduce((d,p)=>d+p,0);if(o===0)return[];const l=[];let u=s;const h=r&&r.length===t.length;for(let d=0;d<t.length;d++){const p=t[d],g=h?r[d]:p,v=a[d]/o*n,E=Math.min(u+v,e.end);l.push({text:g,start:u,end:E,dur:E-u,googleTranslation:p,processPunctuation:!0}),u=E}return l}secondarySplitByDuration(e,t=!0){var n;const r=[];for(const s of e){if(s.dur<=this.MAX_SUBTITLE_DURATION){r.push(s);continue}console.log(`[SmartSegmenter] Secondary splitting: dur=${s.dur.toFixed(1)}s > ${this.MAX_SUBTITLE_DURATION}s, length=${((n=s.googleTranslation)==null?void 0:n.length)||s.text.length} chars`);const a=s.googleTranslation||s.text,o=this.splitByWeakPunctuation(a);let l;if(t){const h=s.text;l=this.splitByWeakPunctuation(h)}if(console.log(`[SmartSegmenter] Split into ${o.length} segments by weak punctuation`),o.length<=1){console.log("[SmartSegmenter] Warning: Could not split subtitle further, keeping original"),r.push(s);continue}const u=this.distributeTimeToSegments(s,o,l);r.push(...u),console.log(`[SmartSegmenter] Result: ${u.length} subtitles, max duration: ${Math.max(...u.map(h=>h.dur)).toFixed(1)}s`)}return r}splitByWeakPunctuation(e){const t=e.split(/([，,？?！!]+)/),r=[];let n="";for(let a=0;a<t.length;a++)if(a%2===0)n=t[a];else{n+=t[a];const o=n.trim();o&&r.push(o),n=""}n.trim()&&r.push(n.trim());const s=this.mergeShortSegments(r);return s.length>0?s:[e]}isSegmentTooShort(e){if(!e||!e.trim())return!0;const t=new Intl.Segmenter(this.locale,{granularity:"word"}),n=Array.from(t.segment(e)).filter(a=>a.isWordLike).length,s=n<this.MIN_WORD_COUNT;return console.log(`[SmartSegmenter] Segment "${e.substring(0,30)}${e.length>30?"...":""}", word count: ${n}, min required: ${this.MIN_WORD_COUNT}, too short: ${s}`),s}mergeShortSegments(e){if(e.length===0)return e;const t=[];let r="";for(let n=0;n<e.length;n++){const s=e[n];console.log(`[SmartSegmenter.mergeShortSegments] Processing segment ${n}: "${s.substring(0,30)}${s.length>30?"...":""}"`),this.isSegmentTooShort(s)?(console.log(`[SmartSegmenter.mergeShortSegments] Segment ${n} is too short, needs merging`),r?(r+=" "+s,console.log(`[SmartSegmenter.mergeShortSegments] Appending to buffer: "${r.substring(0,50)}${r.length>50?"...":""}"`)):t.length>0?(t[t.length-1]+=" "+s,console.log("[SmartSegmenter.mergeShortSegments] Merging with previous segment")):(r=s,console.log(`[SmartSegmenter.mergeShortSegments] Starting new buffer: "${r.substring(0,50)}${r.length>50?"...":""}"`))):r?(t.push(r+" "+s),r="",console.log("[SmartSegmenter.mergeShortSegments] Outputting buffer + current segment")):t.push(s)}return r&&(t.length>0?(t[t.length-1]+=" "+r,console.log("[SmartSegmenter.mergeShortSegments] Merging remaining buffer with last result")):(t.push(r),console.log("[SmartSegmenter.mergeShortSegments] Outputting remaining buffer as sole result"))),t}countCharacters(e){let t=0;for(let r=0;r<e.length;r++){const n=e.charAt(r);!jt.isPunctuation(n)&&!jt.isWeakPunctuation(n)&&n.trim().length>0&&t++}return t}postProcessSegments(e){const t=[];let r="";for(let n=0;n<e.length;n++){const s=e[n];if(r&&this.shouldMergeWithPrevious(r,s)){r+=" "+s;continue}if(r&&s.length>=this.MIN_SENTENCE_LENGTH?(t.push(r),r=s):r?r+=" "+s:r=s,r.length>this.MAX_SENTENCE_LENGTH){const a=this.findBestSplitPoint(r);if(a>0&&a<r.length-1)t.push(r.substring(0,a+1).trim()),r=r.substring(a+1).trim();else{const o=this.findSpaceSplitPoint(r,this.MAX_SENTENCE_LENGTH);o>this.MIN_SENTENCE_LENGTH?(t.push(r.substring(0,o).trim()),r=r.substring(o).trim()):(t.push(r.substring(0,this.MAX_SENTENCE_LENGTH).trim()),r=r.substring(this.MAX_SENTENCE_LENGTH).trim())}}}for(;r;)if(r.length<this.MIN_SENTENCE_LENGTH&&t.length>0){const n=t[t.length-1];n.length+r.length<this.MAX_SENTENCE_LENGTH?(t[t.length-1]=n+" "+r,r=""):(t.push(r),r="")}else if(r.length<=this.MAX_SENTENCE_LENGTH)t.push(r),r="";else{const n=this.findBestSplitPoint(r);if(n>0)t.push(r.substring(0,n+1).trim()),r=r.substring(n+1).trim();else{const s=this.findSpaceSplitPoint(r,this.MAX_SENTENCE_LENGTH);s>this.MIN_SENTENCE_LENGTH?(t.push(r.substring(0,s).trim()),r=r.substring(s).trim()):(t.push(r.substring(0,this.MAX_SENTENCE_LENGTH).trim()),r=r.substring(this.MAX_SENTENCE_LENGTH).trim())}}return t.filter(n=>this.isValidSegment(n))}shouldMergeWithPrevious(e,t){var u;const r=e.trim(),n=t.trim();if(/\d\.$/.test(r)&&/^\d/.test(n)||/\w+\.\w+\.$/.test(r)&&/^(com|org|net|io|edu|gov|mil|int|co|uk|cn|jp|de|fr|au|ca|br|in|ru|kr|it|es|nl|se|no|dk|fi|ch|at|be|nz|sg|hk|tw|my|th|vn|id|ph|pk|bd|ng|za|eg|ke|gh|tz|ug|zm|zw|bw|mw|rw|et|sd|so|dj|er|ss|ao|mz|mg|mu|sc|re|yt|km|bi|sn|gm|gn|sl|lr|ci|bf|ml|ne|td|mr|gw|cf|cg|ga|gq|st|cm|tg|bj|cv)\b/i.test(n))return!0;const s=r.split(/\s+/).slice(-2),a=s[s.length-1];if(/^\w+\.\w{1,2}$/.test(a)&&/^[a-zA-Z]{1,3}(\s|$)/.test(n)){const h=a.split(".").pop()+n.split(/\s/)[0];if(["md","mdx","cpp","hpp","jsx","tsx","scss","yaml","yml","json","html","xml","svg","vue","php","sql","java","py","rb","go","rs","swift","kt","scala","clj","elm","lua","r","sh","bash","zsh","fish","ps1","bat","cmd"].includes(h.toLowerCase()))return!0}const o=["Dr","Mr","Mrs","Ms","Prof","Sr","Jr","Ph","M","B","D"],l=((u=r.split(" ").pop())==null?void 0:u.replace(".",""))||"";return!!(o.includes(l)||n.length<3&&!/[.!?]/.test(n))}findBestSplitPoint(e){const t=[".","!","?","。","！","？"];for(const n of t){const s=e.lastIndexOf(n,this.MAX_SENTENCE_LENGTH);if(s>this.MIN_SENTENCE_LENGTH){if(n==="."){const a=e.substring(Math.max(0,s-20),s),o=e.substring(s+1,Math.min(e.length,s+10));if(o.length>0&&/^[a-zA-Z]/.test(o)||/\w+\.\w+$/.test(a+".")||/\d$/.test(a)&&/^\d/.test(o))continue}return s}}const r=[",",";","，","；"];for(const n of r){const s=e.lastIndexOf(n,this.MAX_SENTENCE_LENGTH);if(s>this.MIN_SENTENCE_LENGTH)return s}return-1}findSpaceSplitPoint(e,t){for(let r=Math.min(t,e.length-1);r>this.MIN_SENTENCE_LENGTH;r--)if(e.charAt(r)===" "||e.charAt(r)==="　")return r;return-1}isValidSegment(e){const t=e.trim();if(!t||jt.containsOnlyPunctuationAndSpaces(t)||Ct.isSoundEffectMarker(t))return!1;const r=t.replace(/^-?\s*\[Instructor\]\s*/i,"");return!(!r||jt.containsOnlyPunctuationAndSpaces(r))}fallbackSegment(e){const t=e.split(/([.!?。！？]+)/),r=[];let n="";for(let s=0;s<t.length;s++)if(s%2===0)n=t[s];else{n+=t[s];const a=n.trim();a&&r.push(a),n=""}return n.trim()&&r.push(n.trim()),this.postProcessSegments(r)}}class vs{constructor(){re(this,"smartSegmenter");re(this,"GAP_THRESHOLD",.15)}segmentSubtitlesBySentence(e,t){if(typeof Intl>"u"||!("Segmenter"in Intl))return console.warn("[PunctuationSubtitleService] Intl.Segmenter not supported, skipping segmentation"),e;(!this.smartSegmenter||this.smartSegmenter.locale!==(t||"en-US"))&&(this.smartSegmenter=new RF(t||"en-US"));const r=e.filter(o=>o.text&&!jt.containsOnlyPunctuationAndSpaces(o.text));if(r.length===0)return[];const n=r.reduce((o,l,u)=>this.processSubtitleItem(o,l,u,r,t||"en-US"),new IF);console.log("[PunctuationSubtitleService] Processed",r.length,"subtitles into",n.subtitles.length,"segments");const s=this.mergeSubtitlesByWordBoundary(n.subtitles),a=this.cleanupPunctuationOnlySubtitles(s);return this.resolveTimeOverlaps(a)}resolveTimeOverlaps(e){if(e.length<=1)return e;const t=[];for(let r=0;r<e.length;r++){const n={...e[r]};if(r<e.length-1){const s=e[r+1];n.end>s.start&&(n.end=s.start,n.dur=n.end-n.start)}t.push(n)}return t}processSubtitleItem(e,t,r,n,s){if(e.shouldSkip(r))return e;let a=t;if(e.hasPending()){const o=e.popPending();a=this.mergePendingToSubtitle(t,o,e.lastSubtitleEnd)}return this.processCurrentSubtitle(a,e,n,r,s),e}processCurrentSubtitle(e,t,r,n,s){if(this.hasSignificantGap(e,r,n+1)){t.pushSubtitle(e);return}const a=this.smartSegmenter.segment(e.text);a.length!==0&&(a.length===1?this.tryMergeForward(e,t,r,n+1,s):this.splitAtFirstSentence(e,t,a))}hasSignificantGap(e,t,r){return r>=t.length?!0:t[r].start-e.end>=this.GAP_THRESHOLD}splitAtFirstSentence(e,t,r){const n=r[0],s=e.text.substring(n.length).trim();if(!s){t.pushSubtitle(e);return}const a=this.calculateTextProportionalTime(e.text,s,e.dur),o=e.dur-a,l={...e,text:n,dur:o,end:e.start+o};t.pushSubtitle(l),t.pushPending(new yp(s,a))}tryMergeForward(e,t,r,n,s){let a=e.text,o=e.dur,l=e.end;const u=[];let h=!1;for(let d=n;d<r.length&&!(d>n&&this.hasSignificantGap(r[d-1],r,d));d++){const p=r[d],g=a+" "+p.text,m=this.smartSegmenter.segment(g);if(m.length>1){const v=m[0].trim(),E=a.trim();if(g.startsWith(v+" ")&&v.length<E.length){const A=a.substring(v.length).trim(),D=this.calculateTextProportionalTime(a,A,o),R=o-D,_=e.start;t.pushSubtitle({...e,text:v,start:_,dur:R,end:_+R}),A&&t.pushPending(new yp(A,D)),h=!0;break}v.length>E.length+1?(this.mergePartialNext(e,a,o,l,p,v,t),u.push(d)):t.pushSubtitle({...e,text:a,dur:o,end:l}),h=!0;break}else a=g,o+=p.dur,l=p.end,u.push(d)}h||t.pushSubtitle({...e,text:a,dur:o,end:l}),u.forEach(d=>t.markSkip(d))}mergePartialNext(e,t,r,n,s,a,o){const l=a.substring(t.length).trim(),u=this.calculateTextProportionalTime(s.text,l,s.dur),h=r+u,d=e.start,p={...e,text:a,start:d,dur:h,end:d+h};o.pushSubtitle(p);const g=s.text.substring(l.length).trim();if(g){const m=s.dur-u;o.pushPending(new yp(g,m))}}mergePendingToSubtitle(e,t,r){let n=e.start-t.time;r>0&&n<r&&(n=r);const s=e.end-n;return{...e,text:t.text+" "+e.text,start:n,dur:s,end:e.end}}calculateTextProportionalTime(e,t,r){const n=this.calculateTextWeight(e),s=this.calculateTextWeight(t);return n===0?0:s/n*r}calculateTextWeight(e){let t=0;for(let r=0;r<e.length;r++){const n=e.charAt(r);!jt.isPunctuation(n)&&!jt.isWeakPunctuation(n)&&n.trim().length>0&&t++}return t}cleanupPunctuationOnlySubtitles(e){if(e.length===0)return e;if(e.length===1)return jt.containsOnlyPunctuationAndSpaces(e[0].text)?[]:e;const t=[];for(let r=0;r<e.length;r++){const n=e[r];jt.containsOnlyPunctuationAndSpaces(n.text)?r===0&&r+1<e.length?(Ct.appendSubtitle(n,e[r+1],!1),t.push(n),r++):t.length>0&&Ct.appendSubtitle(t[t.length-1],n,!1):t.push(n)}return t}mergeSubtitlesByWordBoundary(e){if(e.length<=1)return e;const t=[];let r=e[0];for(let n=0;n<e.length-1;n++){const s=e[n+1],a=Ct.findLastWord(r).trim(),o=Ct.findFirstWord(s).trim();a&&o&&a===o?Ct.appendSubtitle(r,s,!0):this.isDecimalNumberSplit(r,s)||jt.containsOnlyPunctuationAndSpaces(s.text)?Ct.appendSubtitle(r,s,!1):(t.push(r),r=s)}return t.push(r),t}isDecimalNumberSplit(e,t){const r=e.text.trim(),n=r.substring(r.length-2)+t.text.trim().charAt(0),s=Number(n);return!isNaN(s)&&isFinite(s)}postProcessParsedResult(e,t,r){return e.hasPunctuation&&(e.subtitles=this.segmentSubtitlesBySentence(e.subtitles,r)),t.subtitleTimeUnit==="millisecond"&&(e.subtitles=this.convertSubtitlesToSeconds(e.subtitles),e.originSubtitles=this.convertSubtitlesToSeconds(e.originSubtitles)),e}convertSubtitlesToSeconds(e){return e.forEach(t=>{t.start=t.start/1e3,t.end=t.end/1e3,t.dur=t.dur/1e3}),e}}class IF{constructor(){re(this,"_subtitles",[]);re(this,"_pendingText");re(this,"_skipIndices",new Set);re(this,"_lastSubtitleEnd",0)}get subtitles(){return this._subtitles}get lastSubtitleEnd(){return this._lastSubtitleEnd}pushSubtitle(e){this._subtitles.push(e),this._lastSubtitleEnd=e.end}pushPending(e){this._pendingText=e}hasPending(){return this._pendingText!==void 0}popPending(){const e=this._pendingText;return this._pendingText=void 0,e}markSkip(e){this._skipIndices.add(e)}shouldSkip(e){return this._skipIndices.has(e)}}class yp{constructor(e,t){this.text=e,this.time=t}}class vp{constructor(){re(this,"punctuationSubtitleService",new vs)}async parse(e,t){const r=await this.parseSubtitle(e,t);return this.punctuationSubtitleService.postProcessParsedResult(r,t)}}const Pn={BadSignature:1,BadTimestamp:2,BadSettingValue:3,BadFormat:4,UnknownSetting:5};class kn extends Error{constructor(t){super(t.reason);re(this,"code");re(this,"line");this.code=t.code,this.line=t.line}}const NF=/\r?\n|\r/gm;async function pl(i,e){const t=new ReadableStream({start(r){const n=i.split(NF);for(const s of n)r.enqueue(s);r.close()}});return CF(t,e)}async function CF(i,e){const t=(e==null?void 0:e.type)??"vtt";let r;if(typeof t=="string")switch(t){case"srt":r=(await Promise.resolve().then(()=>G3)).default;break;case"ssa":case"ass":r=(await Promise.resolve().then(()=>V3)).default;break;default:r=(await Promise.resolve().then(function(){return XF})).default}else r=t;let n;const s=i.getReader(),a=r(),o=!!(e!=null&&e.strict)||!!(e!=null&&e.errors);await a.init({strict:!1,...e,errors:o,type:t,cancel(){s.cancel(),n=a.done(!0)}});let l=1;for(;;){const{value:u,done:h}=await s.read();if(h){a.parse("",l),n=a.done(!1);break}a.parse(u,l),l++}return n}const wF=window.VTTCue;class Ep extends wF{constructor(){super(...arguments);re(this,"region",null);re(this,"vertical","");re(this,"snapToLines",!0);re(this,"line","auto");re(this,"lineAlign","start");re(this,"position","auto");re(this,"positionAlign","auto");re(this,"size",100);re(this,"align","center");re(this,"style")}}class LF{constructor(){re(this,"id","");re(this,"width",100);re(this,"lines",3);re(this,"regionAnchorX",0);re(this,"regionAnchorY",100);re(this,"viewportAnchorX",0);re(this,"viewportAnchorY",100);re(this,"scroll","")}}const W2=",",_F="%";function MF(i){const e=parseInt(i,10);return Number.isNaN(e)?null:e}function ml(i){const e=parseInt(i.replace(_F,""),10);return!Number.isNaN(e)&&e>=0&&e<=100?e:null}function Y2(i){if(!i.includes(W2))return null;const[e,t]=i.split(W2).map(ml);return e!==null&&t!==null?[e,t]:null}function PF(i){const e=parseFloat(i);return Number.isNaN(e)?null:e}const kF="WEBVTT",X2=",",OF="%",ro=/[:=]/,FF=/^[\s\t]*(region|vertical|line|position|size|align)[:=]/,BF="NOTE",UF="REGION",$F=/^REGION:?[\s\t]+/,yl=/[\s\t]+/,GF="-->",qF=/[\s\t]*-->[\s\t]+/,VF=/start|center|end|left|right/,HF=/start|center|end/,KF=/line-(?:left|right)|center|auto/,WF=/^(?:(\d{1,2}):)?(\d{2}):(\d{2})(?:\.(\d{1,3}))?$/;var vl=(i=>(i[i.None=0]="None",i[i.Header=1]="Header",i[i.Cue=2]="Cue",i[i.Region=3]="Region",i[i.Note=4]="Note",i))(vl||{});class bp{constructor(){re(this,"f");re(this,"c",0);re(this,"g",{});re(this,"h",{});re(this,"j",[]);re(this,"a",null);re(this,"b",null);re(this,"k",[]);re(this,"d");re(this,"l","")}async init(e){this.f=e,e.strict&&(this.c=1),e.errors&&(this.d=(await Promise.resolve().then(()=>gS)).ParseErrorBuilder)}parse(e,t){var r,n,s,a,o,l;if(e==="")this.a?(this.j.push(this.a),(n=(r=this.f).onCue)==null||n.call(r,this.a),this.a=null):this.b?(this.h[this.b.id]=this.b,(a=(s=this.f).onRegion)==null||a.call(s,this.b),this.b=null):this.c===1&&(this.i(e,t),(l=(o=this.f).onHeaderMetadata)==null||l.call(o,this.g)),this.c=0;else if(this.c)switch(this.c){case 1:this.i(e,t);break;case 2:if(this.a){const u=this.a.text.length>0;!u&&FF.test(e)?this.m(e.split(yl),t):this.a.text+=(u?`
`:"")+e}break;case 3:this.n(e.split(yl),t);break}else if(e.startsWith(BF))this.c=4;else if(e.startsWith(UF))this.c=3,this.b=new LF,this.n(e.replace($F,"").split(yl),t);else if(e.includes(GF)){const u=this.o(e,t);u&&(this.a=new Ep(u[0],u[1],""),this.a.id=this.l,this.m(u[2],t)),this.c=2}else t===1&&this.i(e,t);this.l=e}done(){return{metadata:this.g,cues:this.j,regions:Object.values(this.h),errors:this.k}}i(e,t){var r;if(t>1){if(ro.test(e)){const[n,s]=e.split(ro);n&&(this.g[n]=(s||"").replace(yl,""))}}else e.startsWith(kF)?this.c=1:this.e((r=this.d)==null?void 0:r.p())}o(e,t){var u,h,d;const[r,n=""]=e.split(qF),[s,...a]=n.split(yl),o=El(r),l=El(s);if(o!==null&&l!==null&&l>o)return[o,l,a];o===null&&this.e((u=this.d)==null?void 0:u.q(r,t)),l===null&&this.e((h=this.d)==null?void 0:h.r(s,t)),o!=null&&l!==null&&l>o&&this.e((d=this.d)==null?void 0:d.s(o,l,t))}n(e,t){var n,s;let r;for(let a=0;a<e.length;a++)if(ro.test(e[a])){r=!1;const[o,l]=e[a].split(ro);switch(o){case"id":this.b.id=l;break;case"width":const u=ml(l);u!==null?this.b.width=u:r=!0;break;case"lines":const h=MF(l);h!==null?this.b.lines=h:r=!0;break;case"regionanchor":const d=Y2(l);d!==null?(this.b.regionAnchorX=d[0],this.b.regionAnchorY=d[1]):r=!0;break;case"viewportanchor":const p=Y2(l);p!==null?(this.b.viewportAnchorX=p[0],this.b.viewportAnchorY=p[1]):r=!0;break;case"scroll":l==="up"?this.b.scroll="up":r=!0;break;default:this.e((n=this.d)==null?void 0:n.t(o,l,t))}r&&this.e((s=this.d)==null?void 0:s.u(o,l,t))}}m(e,t){var n,s;let r;for(let a=0;a<e.length;a++)if(r=!1,ro.test(e[a])){const[o,l]=e[a].split(ro);switch(o){case"region":const u=this.h[l];u&&(this.a.region=u);break;case"vertical":l==="lr"||l==="rl"?(this.a.vertical=l,this.a.region=null):r=!0;break;case"line":const[h,d]=l.split(X2);if(h.includes(OF)){const E=ml(h);E!==null?(this.a.line=E,this.a.snapToLines=!1):r=!0}else{const E=PF(h);E!==null?this.a.line=E:r=!0}HF.test(d)?this.a.lineAlign=d:d&&(r=!0),this.a.line!=="auto"&&(this.a.region=null);break;case"position":const[p,g]=l.split(X2),m=ml(p);m!==null?this.a.position=m:r=!0,g&&KF.test(g)?this.a.positionAlign=g:g&&(r=!0);break;case"size":const v=ml(l);v!==null?(this.a.size=v,v<100&&(this.a.region=null)):r=!0;break;case"align":VF.test(l)?this.a.align=l:r=!0;break;default:this.e((n=this.d)==null?void 0:n.v(o,l,t))}r&&this.e((s=this.d)==null?void 0:s.w(o,l,t))}}e(e){var t,r;if(e){if(this.k.push(e),this.f.strict)throw this.f.cancel(),e;(r=(t=this.f).onError)==null||r.call(t,e)}}}function El(i){const e=i.match(WF);if(!e)return null;const t=e[1]?parseInt(e[1],10):0,r=parseInt(e[2],10),n=parseInt(e[3],10),s=e[4]?parseInt(e[4].padEnd(3,"0"),10):0,a=t*3600+r*60+n+s/1e3;return t<0||r<0||n<0||s<0||r>59||n>59?null:a}function YF(){return new bp}var XF=Object.freeze({__proto__:null,VTTBlock:vl,VTTParser:bp,default:YF,parseVTTTimestamp:El});class j2 extends vp{async parseSubtitle(e,t){const r=this.removeVttHeader(e);let n;return t.subtitleFormat==="vtt"?n=await pl(r):n=await pl(r,{type:"srt"}),Ct.convertVttEntriesToSubtitles(n.cues)}removeVttHeader(e){let t=e.trimStart();return t.startsWith(`WEBVTT
`)&&(t=t.replace(`WEBVTT
`,"")),t}}class jF extends vp{async parseSubtitle(e,t){if(t.subtitleFormat==="vtt"||t.subtitleFormat==="srt")throw console.error("CustomFormatSubtitleParser does not support standard subtitle formats, please use SrtVttSubtitleParser for vtt/srt formats",{subtitleFormat:t.subtitleFormat,domain:t.domain}),new Error(`CustomFormatSubtitleParser does not support ${t.subtitleFormat} format, standard subtitle formats should be handled by SrtVttSubtitleParser`);const r=t.subtitleFormat,n=JSON.parse(e),s=Ji(n,r.subtitleListJsonPath),a=[],o=[];let l=!1;for(let u=0;u<s.length;u++){const h=s[u],d=this.createSubtitle(h,r),p=this.createSubtitle(h,r);!l&&Ct.hasPunctuation(d.text)&&(l=!0);const g=h;g[r.subtitleTextName].startsWith("♪")&&g[r.subtitleTextName].endsWith("♪")||g[r.subtitleTextName].trim()==="音乐"||a.push(d),o.push(p)}if(!l)for(let u of a)u.processPunctuation=!1;return{hasPunctuation:l,subtitles:a,originSubtitles:o}}createSubtitle(e,t){const r=e[t.subtitleStartTimeName],n=t.timeType==="end"?e[t.subtitleEndTimeName]:r+e[t.subtitleEndTimeName];return{start:r,end:n,dur:n-r,text:Ct.normalizeSubtitleText(e[t.subtitleTextName]),processPunctuation:!0}}}var hn=(i=>(i[i.GREEN=0]="GREEN",i[i.YELLOW=1]="YELLOW",i[i.RED=2]="RED",i))(hn||{});class Ap{static async fetchText(e){const t=ti.addParam(e,"youtubedubbing","true"),r=await fetch(t,{headers:{Referer:window.location.href}});if(!r.ok)throw new Error(`主 M3U8 fetch 失败: ${r.status}`);return r.text()}}var Sp=function(){function i(){this.listeners={}}var e=i.prototype;return e.on=function(r,n){this.listeners[r]||(this.listeners[r]=[]),this.listeners[r].push(n)},e.off=function(r,n){if(!this.listeners[r])return!1;var s=this.listeners[r].indexOf(n);return this.listeners[r]=this.listeners[r].slice(0),this.listeners[r].splice(s,1),s>-1},e.trigger=function(r){var n=this.listeners[r];if(n)if(arguments.length===2)for(var s=n.length,a=0;a<s;++a)n[a].call(this,arguments[1]);else for(var o=Array.prototype.slice.call(arguments,1),l=n.length,u=0;u<l;++u)n[u].apply(this,o)},e.dispose=function(){this.listeners={}},e.pipe=function(r){this.on("data",function(n){r.push(n)})},i}();function io(){return io=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(i[r]=t[r])}return i},io.apply(null,arguments)}var xp,z2;function zF(){if(z2)return xp;z2=1;var i;return typeof window<"u"?i=window:typeof wi<"u"?i=wi:typeof self<"u"?i=self:i={},xp=i,xp}var JF=zF();const J2=Vs(JF);var QF=function(e){return J2.atob?J2.atob(e):Buffer.from(e,"base64").toString("binary")};function ZF(i){for(var e=QF(i),t=new Uint8Array(e.length),r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}/*! @name m3u8-parser @version 7.2.0 @license Apache-2.0 */class e3 extends Sp{constructor(){super(),this.buffer=""}push(e){let t;for(this.buffer+=e,t=this.buffer.indexOf(`
`);t>-1;t=this.buffer.indexOf(`
`))this.trigger("data",this.buffer.substring(0,t)),this.buffer=this.buffer.substring(t+1)}}const t3="	",Tp=function(i){const e=/([0-9.]*)?@?([0-9.]*)?/.exec(i||""),t={};return e[1]&&(t.length=parseInt(e[1],10)),e[2]&&(t.offset=parseInt(e[2],10)),t},r3=function(){const t="(?:"+"[^=]*"+")=(?:"+'"[^"]*"|[^,]*'+")";return new RegExp("(?:^|,)("+t+")")},Br=function(i){const e={};if(!i)return e;const t=i.split(r3());let r=t.length,n;for(;r--;)t[r]!==""&&(n=/([^=]*)=(.*)/.exec(t[r]).slice(1),n[0]=n[0].replace(/^\s+|\s+$/g,""),n[1]=n[1].replace(/^\s+|\s+$/g,""),n[1]=n[1].replace(/^['"](.*)['"]$/g,"$1"),e[n[0]]=n[1]);return e},Q2=i=>{const e=i.split("x"),t={};return e[0]&&(t.width=parseInt(e[0],10)),e[1]&&(t.height=parseInt(e[1],10)),t};class i3 extends Sp{constructor(){super(),this.customParsers=[],this.tagMappers=[]}push(e){let t,r;if(e=e.trim(),e.length===0)return;if(e[0]!=="#"){this.trigger("data",{type:"uri",uri:e});return}this.tagMappers.reduce((s,a)=>{const o=a(e);return o===e?s:s.concat([o])},[e]).forEach(s=>{for(let a=0;a<this.customParsers.length;a++)if(this.customParsers[a].call(this,s))return;if(s.indexOf("#EXT")!==0){this.trigger("data",{type:"comment",text:s.slice(1)});return}if(s=s.replace("\r",""),t=/^#EXTM3U/.exec(s),t){this.trigger("data",{type:"tag",tagType:"m3u"});return}if(t=/^#EXTINF:([0-9\.]*)?,?(.*)?$/.exec(s),t){r={type:"tag",tagType:"inf"},t[1]&&(r.duration=parseFloat(t[1])),t[2]&&(r.title=t[2]),this.trigger("data",r);return}if(t=/^#EXT-X-TARGETDURATION:([0-9.]*)?/.exec(s),t){r={type:"tag",tagType:"targetduration"},t[1]&&(r.duration=parseInt(t[1],10)),this.trigger("data",r);return}if(t=/^#EXT-X-VERSION:([0-9.]*)?/.exec(s),t){r={type:"tag",tagType:"version"},t[1]&&(r.version=parseInt(t[1],10)),this.trigger("data",r);return}if(t=/^#EXT-X-MEDIA-SEQUENCE:(\-?[0-9.]*)?/.exec(s),t){r={type:"tag",tagType:"media-sequence"},t[1]&&(r.number=parseInt(t[1],10)),this.trigger("data",r);return}if(t=/^#EXT-X-DISCONTINUITY-SEQUENCE:(\-?[0-9.]*)?/.exec(s),t){r={type:"tag",tagType:"discontinuity-sequence"},t[1]&&(r.number=parseInt(t[1],10)),this.trigger("data",r);return}if(t=/^#EXT-X-PLAYLIST-TYPE:(.*)?$/.exec(s),t){r={type:"tag",tagType:"playlist-type"},t[1]&&(r.playlistType=t[1]),this.trigger("data",r);return}if(t=/^#EXT-X-BYTERANGE:(.*)?$/.exec(s),t){r=io(Tp(t[1]),{type:"tag",tagType:"byterange"}),this.trigger("data",r);return}if(t=/^#EXT-X-ALLOW-CACHE:(YES|NO)?/.exec(s),t){r={type:"tag",tagType:"allow-cache"},t[1]&&(r.allowed=!/NO/.test(t[1])),this.trigger("data",r);return}if(t=/^#EXT-X-MAP:(.*)$/.exec(s),t){if(r={type:"tag",tagType:"map"},t[1]){const a=Br(t[1]);a.URI&&(r.uri=a.URI),a.BYTERANGE&&(r.byterange=Tp(a.BYTERANGE))}this.trigger("data",r);return}if(t=/^#EXT-X-STREAM-INF:(.*)$/.exec(s),t){r={type:"tag",tagType:"stream-inf"},t[1]&&(r.attributes=Br(t[1]),r.attributes.RESOLUTION&&(r.attributes.RESOLUTION=Q2(r.attributes.RESOLUTION)),r.attributes.BANDWIDTH&&(r.attributes.BANDWIDTH=parseInt(r.attributes.BANDWIDTH,10)),r.attributes["FRAME-RATE"]&&(r.attributes["FRAME-RATE"]=parseFloat(r.attributes["FRAME-RATE"])),r.attributes["PROGRAM-ID"]&&(r.attributes["PROGRAM-ID"]=parseInt(r.attributes["PROGRAM-ID"],10))),this.trigger("data",r);return}if(t=/^#EXT-X-MEDIA:(.*)$/.exec(s),t){r={type:"tag",tagType:"media"},t[1]&&(r.attributes=Br(t[1])),this.trigger("data",r);return}if(t=/^#EXT-X-ENDLIST/.exec(s),t){this.trigger("data",{type:"tag",tagType:"endlist"});return}if(t=/^#EXT-X-DISCONTINUITY/.exec(s),t){this.trigger("data",{type:"tag",tagType:"discontinuity"});return}if(t=/^#EXT-X-PROGRAM-DATE-TIME:(.*)$/.exec(s),t){r={type:"tag",tagType:"program-date-time"},t[1]&&(r.dateTimeString=t[1],r.dateTimeObject=new Date(t[1])),this.trigger("data",r);return}if(t=/^#EXT-X-KEY:(.*)$/.exec(s),t){r={type:"tag",tagType:"key"},t[1]&&(r.attributes=Br(t[1]),r.attributes.IV&&(r.attributes.IV.substring(0,2).toLowerCase()==="0x"&&(r.attributes.IV=r.attributes.IV.substring(2)),r.attributes.IV=r.attributes.IV.match(/.{8}/g),r.attributes.IV[0]=parseInt(r.attributes.IV[0],16),r.attributes.IV[1]=parseInt(r.attributes.IV[1],16),r.attributes.IV[2]=parseInt(r.attributes.IV[2],16),r.attributes.IV[3]=parseInt(r.attributes.IV[3],16),r.attributes.IV=new Uint32Array(r.attributes.IV))),this.trigger("data",r);return}if(t=/^#EXT-X-START:(.*)$/.exec(s),t){r={type:"tag",tagType:"start"},t[1]&&(r.attributes=Br(t[1]),r.attributes["TIME-OFFSET"]=parseFloat(r.attributes["TIME-OFFSET"]),r.attributes.PRECISE=/YES/.test(r.attributes.PRECISE)),this.trigger("data",r);return}if(t=/^#EXT-X-CUE-OUT-CONT:(.*)?$/.exec(s),t){r={type:"tag",tagType:"cue-out-cont"},t[1]?r.data=t[1]:r.data="",this.trigger("data",r);return}if(t=/^#EXT-X-CUE-OUT:(.*)?$/.exec(s),t){r={type:"tag",tagType:"cue-out"},t[1]?r.data=t[1]:r.data="",this.trigger("data",r);return}if(t=/^#EXT-X-CUE-IN:?(.*)?$/.exec(s),t){r={type:"tag",tagType:"cue-in"},t[1]?r.data=t[1]:r.data="",this.trigger("data",r);return}if(t=/^#EXT-X-SKIP:(.*)$/.exec(s),t&&t[1]){r={type:"tag",tagType:"skip"},r.attributes=Br(t[1]),r.attributes.hasOwnProperty("SKIPPED-SEGMENTS")&&(r.attributes["SKIPPED-SEGMENTS"]=parseInt(r.attributes["SKIPPED-SEGMENTS"],10)),r.attributes.hasOwnProperty("RECENTLY-REMOVED-DATERANGES")&&(r.attributes["RECENTLY-REMOVED-DATERANGES"]=r.attributes["RECENTLY-REMOVED-DATERANGES"].split(t3)),this.trigger("data",r);return}if(t=/^#EXT-X-PART:(.*)$/.exec(s),t&&t[1]){r={type:"tag",tagType:"part"},r.attributes=Br(t[1]),["DURATION"].forEach(function(a){r.attributes.hasOwnProperty(a)&&(r.attributes[a]=parseFloat(r.attributes[a]))}),["INDEPENDENT","GAP"].forEach(function(a){r.attributes.hasOwnProperty(a)&&(r.attributes[a]=/YES/.test(r.attributes[a]))}),r.attributes.hasOwnProperty("BYTERANGE")&&(r.attributes.byterange=Tp(r.attributes.BYTERANGE)),this.trigger("data",r);return}if(t=/^#EXT-X-SERVER-CONTROL:(.*)$/.exec(s),t&&t[1]){r={type:"tag",tagType:"server-control"},r.attributes=Br(t[1]),["CAN-SKIP-UNTIL","PART-HOLD-BACK","HOLD-BACK"].forEach(function(a){r.attributes.hasOwnProperty(a)&&(r.attributes[a]=parseFloat(r.attributes[a]))}),["CAN-SKIP-DATERANGES","CAN-BLOCK-RELOAD"].forEach(function(a){r.attributes.hasOwnProperty(a)&&(r.attributes[a]=/YES/.test(r.attributes[a]))}),this.trigger("data",r);return}if(t=/^#EXT-X-PART-INF:(.*)$/.exec(s),t&&t[1]){r={type:"tag",tagType:"part-inf"},r.attributes=Br(t[1]),["PART-TARGET"].forEach(function(a){r.attributes.hasOwnProperty(a)&&(r.attributes[a]=parseFloat(r.attributes[a]))}),this.trigger("data",r);return}if(t=/^#EXT-X-PRELOAD-HINT:(.*)$/.exec(s),t&&t[1]){r={type:"tag",tagType:"preload-hint"},r.attributes=Br(t[1]),["BYTERANGE-START","BYTERANGE-LENGTH"].forEach(function(a){if(r.attributes.hasOwnProperty(a)){r.attributes[a]=parseInt(r.attributes[a],10);const o=a==="BYTERANGE-LENGTH"?"length":"offset";r.attributes.byterange=r.attributes.byterange||{},r.attributes.byterange[o]=r.attributes[a],delete r.attributes[a]}}),this.trigger("data",r);return}if(t=/^#EXT-X-RENDITION-REPORT:(.*)$/.exec(s),t&&t[1]){r={type:"tag",tagType:"rendition-report"},r.attributes=Br(t[1]),["LAST-MSN","LAST-PART"].forEach(function(a){r.attributes.hasOwnProperty(a)&&(r.attributes[a]=parseInt(r.attributes[a],10))}),this.trigger("data",r);return}if(t=/^#EXT-X-DATERANGE:(.*)$/.exec(s),t&&t[1]){r={type:"tag",tagType:"daterange"},r.attributes=Br(t[1]),["ID","CLASS"].forEach(function(o){r.attributes.hasOwnProperty(o)&&(r.attributes[o]=String(r.attributes[o]))}),["START-DATE","END-DATE"].forEach(function(o){r.attributes.hasOwnProperty(o)&&(r.attributes[o]=new Date(r.attributes[o]))}),["DURATION","PLANNED-DURATION"].forEach(function(o){r.attributes.hasOwnProperty(o)&&(r.attributes[o]=parseFloat(r.attributes[o]))}),["END-ON-NEXT"].forEach(function(o){r.attributes.hasOwnProperty(o)&&(r.attributes[o]=/YES/i.test(r.attributes[o]))}),["SCTE35-CMD"," SCTE35-OUT","SCTE35-IN"].forEach(function(o){r.attributes.hasOwnProperty(o)&&(r.attributes[o]=r.attributes[o].toString(16))});const a=/^X-([A-Z]+-)+[A-Z]+$/;for(const o in r.attributes){if(!a.test(o))continue;const l=/[0-9A-Fa-f]{6}/g.test(r.attributes[o]),u=/^\d+(\.\d+)?$/.test(r.attributes[o]);r.attributes[o]=l?r.attributes[o].toString(16):u?parseFloat(r.attributes[o]):String(r.attributes[o])}this.trigger("data",r);return}if(t=/^#EXT-X-INDEPENDENT-SEGMENTS/.exec(s),t){this.trigger("data",{type:"tag",tagType:"independent-segments"});return}if(t=/^#EXT-X-I-FRAMES-ONLY/.exec(s),t){this.trigger("data",{type:"tag",tagType:"i-frames-only"});return}if(t=/^#EXT-X-CONTENT-STEERING:(.*)$/.exec(s),t){r={type:"tag",tagType:"content-steering"},r.attributes=Br(t[1]),this.trigger("data",r);return}if(t=/^#EXT-X-I-FRAME-STREAM-INF:(.*)$/.exec(s),t){r={type:"tag",tagType:"i-frame-playlist"},r.attributes=Br(t[1]),r.attributes.URI&&(r.uri=r.attributes.URI),r.attributes.BANDWIDTH&&(r.attributes.BANDWIDTH=parseInt(r.attributes.BANDWIDTH,10)),r.attributes.RESOLUTION&&(r.attributes.RESOLUTION=Q2(r.attributes.RESOLUTION)),r.attributes["AVERAGE-BANDWIDTH"]&&(r.attributes["AVERAGE-BANDWIDTH"]=parseInt(r.attributes["AVERAGE-BANDWIDTH"],10)),r.attributes["FRAME-RATE"]&&(r.attributes["FRAME-RATE"]=parseFloat(r.attributes["FRAME-RATE"])),this.trigger("data",r);return}if(t=/^#EXT-X-DEFINE:(.*)$/.exec(s),t){r={type:"tag",tagType:"define"},r.attributes=Br(t[1]),this.trigger("data",r);return}this.trigger("data",{type:"tag",data:s.slice(4)})})}addParser({expression:e,customType:t,dataParser:r,segment:n}){typeof r!="function"&&(r=s=>s),this.customParsers.push(s=>{if(e.exec(s))return this.trigger("data",{type:"custom",data:r(s),customType:t,segment:n}),!0})}addTagMapper({expression:e,map:t}){const r=n=>e.test(n)?t(n):n;this.tagMappers.push(r)}}const n3=i=>i.toLowerCase().replace(/-(\w)/g,e=>e[1].toUpperCase()),Es=function(i){const e={};return Object.keys(i).forEach(function(t){e[n3(t)]=i[t]}),e},Dp=function(i){const{serverControl:e,targetDuration:t,partTargetDuration:r}=i;if(!e)return;const n="#EXT-X-SERVER-CONTROL",s="holdBack",a="partHoldBack",o=t&&t*3,l=r&&r*2;t&&!e.hasOwnProperty(s)&&(e[s]=o,this.trigger("info",{message:`${n} defaulting HOLD-BACK to targetDuration * 3 (${o}).`})),o&&e[s]<o&&(this.trigger("warn",{message:`${n} clamping HOLD-BACK (${e[s]}) to targetDuration * 3 (${o})`}),e[s]=o),r&&!e.hasOwnProperty(a)&&(e[a]=r*3,this.trigger("info",{message:`${n} defaulting PART-HOLD-BACK to partTargetDuration * 3 (${e[a]}).`})),r&&e[a]<l&&(this.trigger("warn",{message:`${n} clamping PART-HOLD-BACK (${e[a]}) to partTargetDuration * 2 (${l}).`}),e[a]=l)};class s3 extends Sp{constructor(e={}){super(),this.lineStream=new e3,this.parseStream=new i3,this.lineStream.pipe(this.parseStream),this.mainDefinitions=e.mainDefinitions||{},this.params=new URL(e.uri,"https://a.com").searchParams,this.lastProgramDateTime=null;const t=this,r=[];let n={},s,a,o=!1;const l=function(){},u={AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},h="urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed";let d=0;this.manifest={allowCache:!0,discontinuityStarts:[],dateRanges:[],iFramePlaylists:[],segments:[]};let p=0,g=0;const m={};this.on("end",()=>{n.uri||!n.parts&&!n.preloadHints||(!n.map&&s&&(n.map=s),!n.key&&a&&(n.key=a),!n.timeline&&typeof d=="number"&&(n.timeline=d),this.manifest.preloadSegment=n)}),this.parseStream.on("data",function(v){let E,A;if(t.manifest.definitions){for(const D in t.manifest.definitions)if(v.uri&&(v.uri=v.uri.replace(`{$${D}}`,t.manifest.definitions[D])),v.attributes)for(const R in v.attributes)typeof v.attributes[R]=="string"&&(v.attributes[R]=v.attributes[R].replace(`{$${D}}`,t.manifest.definitions[D]))}({tag(){({version(){v.version&&(this.manifest.version=v.version)},"allow-cache"(){this.manifest.allowCache=v.allowed,"allowed"in v||(this.trigger("info",{message:"defaulting allowCache to YES"}),this.manifest.allowCache=!0)},byterange(){const D={};"length"in v&&(n.byterange=D,D.length=v.length,"offset"in v||(v.offset=p)),"offset"in v&&(n.byterange=D,D.offset=v.offset),p=D.offset+D.length},endlist(){this.manifest.endList=!0},inf(){"mediaSequence"in this.manifest||(this.manifest.mediaSequence=0,this.trigger("info",{message:"defaulting media sequence to zero"})),"discontinuitySequence"in this.manifest||(this.manifest.discontinuitySequence=0,this.trigger("info",{message:"defaulting discontinuity sequence to zero"})),v.title&&(n.title=v.title),v.duration>0&&(n.duration=v.duration),v.duration===0&&(n.duration=.01,this.trigger("info",{message:"updating zero segment duration to a small value"})),this.manifest.segments=r},key(){if(!v.attributes){this.trigger("warn",{message:"ignoring key declaration without attribute list"});return}if(v.attributes.METHOD==="NONE"){a=null;return}if(!v.attributes.URI){this.trigger("warn",{message:"ignoring key declaration without URI"});return}if(v.attributes.KEYFORMAT==="com.apple.streamingkeydelivery"){this.manifest.contentProtection=this.manifest.contentProtection||{},this.manifest.contentProtection["com.apple.fps.1_0"]={attributes:v.attributes};return}if(v.attributes.KEYFORMAT==="com.microsoft.playready"){this.manifest.contentProtection=this.manifest.contentProtection||{},this.manifest.contentProtection["com.microsoft.playready"]={uri:v.attributes.URI};return}if(v.attributes.KEYFORMAT===h){if(["SAMPLE-AES","SAMPLE-AES-CTR","SAMPLE-AES-CENC"].indexOf(v.attributes.METHOD)===-1){this.trigger("warn",{message:"invalid key method provided for Widevine"});return}if(v.attributes.METHOD==="SAMPLE-AES-CENC"&&this.trigger("warn",{message:"SAMPLE-AES-CENC is deprecated, please use SAMPLE-AES-CTR instead"}),v.attributes.URI.substring(0,23)!=="data:text/plain;base64,"){this.trigger("warn",{message:"invalid key URI provided for Widevine"});return}if(!(v.attributes.KEYID&&v.attributes.KEYID.substring(0,2)==="0x")){this.trigger("warn",{message:"invalid key ID provided for Widevine"});return}this.manifest.contentProtection=this.manifest.contentProtection||{},this.manifest.contentProtection["com.widevine.alpha"]={attributes:{schemeIdUri:v.attributes.KEYFORMAT,keyId:v.attributes.KEYID.substring(2)},pssh:ZF(v.attributes.URI.split(",")[1])};return}v.attributes.METHOD||this.trigger("warn",{message:"defaulting key method to AES-128"}),a={method:v.attributes.METHOD||"AES-128",uri:v.attributes.URI},typeof v.attributes.IV<"u"&&(a.iv=v.attributes.IV)},"media-sequence"(){if(!isFinite(v.number)){this.trigger("warn",{message:"ignoring invalid media sequence: "+v.number});return}this.manifest.mediaSequence=v.number},"discontinuity-sequence"(){if(!isFinite(v.number)){this.trigger("warn",{message:"ignoring invalid discontinuity sequence: "+v.number});return}this.manifest.discontinuitySequence=v.number,d=v.number},"playlist-type"(){if(!/VOD|EVENT/.test(v.playlistType)){this.trigger("warn",{message:"ignoring unknown playlist type: "+v.playlist});return}this.manifest.playlistType=v.playlistType},map(){s={},v.uri&&(s.uri=v.uri),v.byterange&&(s.byterange=v.byterange),a&&(s.key=a)},"stream-inf"(){if(this.manifest.playlists=r,this.manifest.mediaGroups=this.manifest.mediaGroups||u,!v.attributes){this.trigger("warn",{message:"ignoring empty stream-inf attributes"});return}n.attributes||(n.attributes={}),io(n.attributes,v.attributes)},media(){if(this.manifest.mediaGroups=this.manifest.mediaGroups||u,!(v.attributes&&v.attributes.TYPE&&v.attributes["GROUP-ID"]&&v.attributes.NAME)){this.trigger("warn",{message:"ignoring incomplete or missing media group"});return}const D=this.manifest.mediaGroups[v.attributes.TYPE];D[v.attributes["GROUP-ID"]]=D[v.attributes["GROUP-ID"]]||{},E=D[v.attributes["GROUP-ID"]],A={default:/yes/i.test(v.attributes.DEFAULT)},A.default?A.autoselect=!0:A.autoselect=/yes/i.test(v.attributes.AUTOSELECT),v.attributes.LANGUAGE&&(A.language=v.attributes.LANGUAGE),v.attributes.URI&&(A.uri=v.attributes.URI),v.attributes["INSTREAM-ID"]&&(A.instreamId=v.attributes["INSTREAM-ID"]),v.attributes.CHARACTERISTICS&&(A.characteristics=v.attributes.CHARACTERISTICS),v.attributes.FORCED&&(A.forced=/yes/i.test(v.attributes.FORCED)),E[v.attributes.NAME]=A},discontinuity(){d+=1,n.discontinuity=!0,this.manifest.discontinuityStarts.push(r.length)},"program-date-time"(){typeof this.manifest.dateTimeString>"u"&&(this.manifest.dateTimeString=v.dateTimeString,this.manifest.dateTimeObject=v.dateTimeObject),n.dateTimeString=v.dateTimeString,n.dateTimeObject=v.dateTimeObject;const{lastProgramDateTime:D}=this;this.lastProgramDateTime=new Date(v.dateTimeString).getTime(),D===null&&this.manifest.segments.reduceRight((R,_)=>(_.programDateTime=R-_.duration*1e3,_.programDateTime),this.lastProgramDateTime)},targetduration(){if(!isFinite(v.duration)||v.duration<0){this.trigger("warn",{message:"ignoring invalid target duration: "+v.duration});return}this.manifest.targetDuration=v.duration,Dp.call(this,this.manifest)},start(){if(!v.attributes||isNaN(v.attributes["TIME-OFFSET"])){this.trigger("warn",{message:"ignoring start declaration without appropriate attribute list"});return}this.manifest.start={timeOffset:v.attributes["TIME-OFFSET"],precise:v.attributes.PRECISE}},"cue-out"(){n.cueOut=v.data},"cue-out-cont"(){n.cueOutCont=v.data},"cue-in"(){n.cueIn=v.data},skip(){this.manifest.skip=Es(v.attributes),this.warnOnMissingAttributes_("#EXT-X-SKIP",v.attributes,["SKIPPED-SEGMENTS"])},part(){o=!0;const D=this.manifest.segments.length,R=Es(v.attributes);n.parts=n.parts||[],n.parts.push(R),R.byterange&&(R.byterange.hasOwnProperty("offset")||(R.byterange.offset=g),g=R.byterange.offset+R.byterange.length);const _=n.parts.length-1;this.warnOnMissingAttributes_(`#EXT-X-PART #${_} for segment #${D}`,v.attributes,["URI","DURATION"]),this.manifest.renditionReports&&this.manifest.renditionReports.forEach((F,w)=>{F.hasOwnProperty("lastPart")||this.trigger("warn",{message:`#EXT-X-RENDITION-REPORT #${w} lacks required attribute(s): LAST-PART`})})},"server-control"(){const D=this.manifest.serverControl=Es(v.attributes);D.hasOwnProperty("canBlockReload")||(D.canBlockReload=!1,this.trigger("info",{message:"#EXT-X-SERVER-CONTROL defaulting CAN-BLOCK-RELOAD to false"})),Dp.call(this,this.manifest),D.canSkipDateranges&&!D.hasOwnProperty("canSkipUntil")&&this.trigger("warn",{message:"#EXT-X-SERVER-CONTROL lacks required attribute CAN-SKIP-UNTIL which is required when CAN-SKIP-DATERANGES is set"})},"preload-hint"(){const D=this.manifest.segments.length,R=Es(v.attributes),_=R.type&&R.type==="PART";n.preloadHints=n.preloadHints||[],n.preloadHints.push(R),R.byterange&&(R.byterange.hasOwnProperty("offset")||(R.byterange.offset=_?g:0,_&&(g=R.byterange.offset+R.byterange.length)));const F=n.preloadHints.length-1;if(this.warnOnMissingAttributes_(`#EXT-X-PRELOAD-HINT #${F} for segment #${D}`,v.attributes,["TYPE","URI"]),!!R.type)for(let w=0;w<n.preloadHints.length-1;w++){const C=n.preloadHints[w];C.type&&C.type===R.type&&this.trigger("warn",{message:`#EXT-X-PRELOAD-HINT #${F} for segment #${D} has the same TYPE ${R.type} as preload hint #${w}`})}},"rendition-report"(){const D=Es(v.attributes);this.manifest.renditionReports=this.manifest.renditionReports||[],this.manifest.renditionReports.push(D);const R=this.manifest.renditionReports.length-1,_=["LAST-MSN","URI"];o&&_.push("LAST-PART"),this.warnOnMissingAttributes_(`#EXT-X-RENDITION-REPORT #${R}`,v.attributes,_)},"part-inf"(){this.manifest.partInf=Es(v.attributes),this.warnOnMissingAttributes_("#EXT-X-PART-INF",v.attributes,["PART-TARGET"]),this.manifest.partInf.partTarget&&(this.manifest.partTargetDuration=this.manifest.partInf.partTarget),Dp.call(this,this.manifest)},daterange(){this.manifest.dateRanges.push(Es(v.attributes));const D=this.manifest.dateRanges.length-1;this.warnOnMissingAttributes_(`#EXT-X-DATERANGE #${D}`,v.attributes,["ID","START-DATE"]);const R=this.manifest.dateRanges[D];R.endDate&&R.startDate&&new Date(R.endDate)<new Date(R.startDate)&&this.trigger("warn",{message:"EXT-X-DATERANGE END-DATE must be equal to or later than the value of the START-DATE"}),R.duration&&R.duration<0&&this.trigger("warn",{message:"EXT-X-DATERANGE DURATION must not be negative"}),R.plannedDuration&&R.plannedDuration<0&&this.trigger("warn",{message:"EXT-X-DATERANGE PLANNED-DURATION must not be negative"});const _=!!R.endOnNext;if(_&&!R.class&&this.trigger("warn",{message:"EXT-X-DATERANGE with an END-ON-NEXT=YES attribute must have a CLASS attribute"}),_&&(R.duration||R.endDate)&&this.trigger("warn",{message:"EXT-X-DATERANGE with an END-ON-NEXT=YES attribute must not contain DURATION or END-DATE attributes"}),R.duration&&R.endDate){const w=R.startDate.getTime()+R.duration*1e3;this.manifest.dateRanges[D].endDate=new Date(w)}if(!m[R.id])m[R.id]=R;else{for(const w in m[R.id])if(R[w]&&JSON.stringify(m[R.id][w])!==JSON.stringify(R[w])){this.trigger("warn",{message:"EXT-X-DATERANGE tags with the same ID in a playlist must have the same attributes values"});break}const F=this.manifest.dateRanges.findIndex(w=>w.id===R.id);this.manifest.dateRanges[F]=io(this.manifest.dateRanges[F],R),m[R.id]=io(m[R.id],R),this.manifest.dateRanges.pop()}},"independent-segments"(){this.manifest.independentSegments=!0},"i-frames-only"(){this.manifest.iFramesOnly=!0,this.requiredCompatibilityversion(this.manifest.version,4)},"content-steering"(){this.manifest.contentSteering=Es(v.attributes),this.warnOnMissingAttributes_("#EXT-X-CONTENT-STEERING",v.attributes,["SERVER-URI"])},define(){this.manifest.definitions=this.manifest.definitions||{};const D=(R,_)=>{if(R in this.manifest.definitions){this.trigger("error",{message:`EXT-X-DEFINE: Duplicate name ${R}`});return}this.manifest.definitions[R]=_};if("QUERYPARAM"in v.attributes){if("NAME"in v.attributes||"IMPORT"in v.attributes){this.trigger("error",{message:"EXT-X-DEFINE: Invalid attributes"});return}const R=this.params.get(v.attributes.QUERYPARAM);if(!R){this.trigger("error",{message:`EXT-X-DEFINE: No query param ${v.attributes.QUERYPARAM}`});return}D(v.attributes.QUERYPARAM,decodeURIComponent(R));return}if("NAME"in v.attributes){if("IMPORT"in v.attributes){this.trigger("error",{message:"EXT-X-DEFINE: Invalid attributes"});return}if(!("VALUE"in v.attributes)||typeof v.attributes.VALUE!="string"){this.trigger("error",{message:`EXT-X-DEFINE: No value for ${v.attributes.NAME}`});return}D(v.attributes.NAME,v.attributes.VALUE);return}if("IMPORT"in v.attributes){if(!this.mainDefinitions[v.attributes.IMPORT]){this.trigger("error",{message:`EXT-X-DEFINE: No value ${v.attributes.IMPORT} to import, or IMPORT used on main playlist`});return}D(v.attributes.IMPORT,this.mainDefinitions[v.attributes.IMPORT]);return}this.trigger("error",{message:"EXT-X-DEFINE: No attribute"})},"i-frame-playlist"(){this.manifest.iFramePlaylists.push({attributes:v.attributes,uri:v.uri,timeline:d}),this.warnOnMissingAttributes_("#EXT-X-I-FRAME-STREAM-INF",v.attributes,["BANDWIDTH","URI"])}}[v.tagType]||l).call(t)},uri(){n.uri=v.uri,r.push(n),this.manifest.targetDuration&&!("duration"in n)&&(this.trigger("warn",{message:"defaulting segment duration to the target duration"}),n.duration=this.manifest.targetDuration),a&&(n.key=a),n.timeline=d,s&&(n.map=s),g=0,this.lastProgramDateTime!==null&&(n.programDateTime=this.lastProgramDateTime,this.lastProgramDateTime+=n.duration*1e3),n={}},comment(){},custom(){v.segment?(n.custom=n.custom||{},n.custom[v.customType]=v.data):(this.manifest.custom=this.manifest.custom||{},this.manifest.custom[v.customType]=v.data)}})[v.type].call(t)})}requiredCompatibilityversion(e,t){(e<t||!e)&&this.trigger("warn",{message:`manifest must be at least version ${t}`})}warnOnMissingAttributes_(e,t,r){const n=[];r.forEach(function(s){t.hasOwnProperty(s)||n.push(s)}),n.length&&this.trigger("warn",{message:`${e} lacks required attribute(s): ${n.join(", ")}`})}push(e){this.lineStream.push(e)}end(){this.lineStream.push(`
`),this.manifest.dateRanges.length&&this.lastProgramDateTime===null&&this.trigger("warn",{message:"A playlist with EXT-X-DATERANGE tag must contain atleast one EXT-X-PROGRAM-DATE-TIME tag"}),this.lastProgramDateTime=null,this.trigger("end")}addParser(e){this.parseStream.addParser(e)}addTagMapper(e){this.parseStream.addTagMapper(e)}}const br=[];for(let i=0;i<256;++i)br.push((i+256).toString(16).slice(1));function a3(i,e=0){return(br[i[e+0]]+br[i[e+1]]+br[i[e+2]]+br[i[e+3]]+"-"+br[i[e+4]]+br[i[e+5]]+"-"+br[i[e+6]]+br[i[e+7]]+"-"+br[i[e+8]]+br[i[e+9]]+"-"+br[i[e+10]]+br[i[e+11]]+br[i[e+12]]+br[i[e+13]]+br[i[e+14]]+br[i[e+15]]).toLowerCase()}let Rp;const o3=new Uint8Array(16);function l3(){if(!Rp){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");Rp=crypto.getRandomValues.bind(crypto)}return Rp(o3)}const Z2={randomUUID:typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function u3(i,e,t){var n;if(Z2.randomUUID&&!i)return Z2.randomUUID();i=i||{};const r=i.random??((n=i.rng)==null?void 0:n.call(i))??l3();if(r.length<16)throw new Error("Random bytes length must be >= 16");return r[6]=r[6]&15|64,r[8]=r[8]&63|128,a3(r)}class eS{constructor(){re(this,"punctuationSubtitleService",new vs)}async parserSubtitle(e,t,r){const n=await this.parseMasterManifest(e);return this.parserSubtitleByManifest(n,t,e,r)}async parserSubtitleByManifest(e,t,r,n){var s;if(e.segments.length===1&&e.segments[0].uri.endsWith(".vtt")){const a=this.resolveSegmentUrl(e.segments[0],r),o=await Ap.fetchText(a);return await new j2().parse(o,n)}else{const a=(s=e.mediaGroups)==null?void 0:s.SUBTITLES;if(!a||Object.keys(a).length===0){console.log("No subtitle tracks found");return}const o=this.getSubtitleUrl(a,t);if(!o){console.error(`Subtitle track not found for language: ${t}`);return}return await this.parserSubtitlesBySubtitleUrl(o)}}async parserSubtitlesBySubtitleUrl(e){const t=await this.parseMasterManifest(e),r=await this.extractSegmentUrls(t,e);let n=Ct.convertVttEntriesToSubtitles(r);return n.hasPunctuation?{hasPunctuation:!0,subtitles:this.punctuationSubtitleService.segmentSubtitlesBySentence(n.subtitles),originSubtitles:n.originSubtitles}:n}extractSegmentUrls(e,t){return En.of(e.segments).map(r=>this.resolveSegmentUrl(r,t)).map(r=>Ap.fetchText(r).then(n=>pl(n)).then(n=>n.cues)).flatten().map(r=>r).distinct(r=>r.id&&r.id.length>0?r.id:u3()).toArray()}resolveSegmentUrl(e,t){let r=e.uri;return r.startsWith("https://")||(r=new URL(r,t).href),r}async parseMasterManifest(e){const t=await Ap.fetchText(e);return this.parseManifest(t)}parseManifest(e){const t=new s3;return t.push(e),t.end(),t.manifest}getSubtitleUrl(e,t){for(const[r,n]of Object.entries(e))for(const[s,a]of Object.entries(n))if(a.language===t)return a.uri}parserSubtitleMetadataArray(e){var a;const t=e.getParam("m3u8Manifest"),r=e.getParam("mediaUrl"),n=[],s=(a=t.mediaGroups)==null?void 0:a.SUBTITLES;if(s&&Object.keys(s).length>0){for(const[o,l]of Object.entries(s))for(const[u,h]of Object.entries(l))n.push({url:ti.resolveUrl(h.uri,r),language:h.language||"unknown",isAsr:!1,hasPunctuation:!0});return n}if(t.segments&&t.segments.length>0){const o=t.segments[0].uri;if(o&&o.endsWith(".vtt"))return n.push({url:r,language:"unknown",isAsr:!1,hasPunctuation:!0}),n}return[]}}class Yr{constructor(){re(this,"m3u8ParserService",new eS)}observeMediaMetadata(e){return this.createMetadataObservable(e).pipe(Mt(r=>this.transformMetadata(r,e.siteDubbingRules)))}extractMediaMetadata(e,t,r){var o;const n=Vt.extractVideoId(e.videoIdExtract,t),s=Vt.extractTitle(e.titleExtract,t),a=this.getBestSubtitle(e,t);return{videoId:n,title:s,subtitleMetadata:a,subtitleLevel:a!=null&&a.isAsr?hn.RED:hn.YELLOW,videoLanguage:Vt.extractVideoLanguage(e,t),isPrivate:e.isPrivateExtract?new BP().getIsPrivate(e.isPrivateExtract,t):!1,channelId:e.channelIdExtract?new UP().getChannelId(e.channelIdExtract,t):"",duration:e.durationExtract?new $P().extractDuration(e.durationExtract,t):((o=t.media)==null?void 0:o.duration)??0,isLiveVideo:r,supportLanguageCode:e.supportedLanguageExtract?new GP().extractSupportLanguage(e.supportedLanguageExtract,t):["SG"],subtitles:[],originSubtitles:[]}}getBestSubtitle(e,t){return new P1().getBestSubtitle(e.subtitleExtract,t)}async transformMetadata(e,t){if(e.subtitleMetadata===void 0)return e;if(t.subtitleFormat==="m3u8"){const r=await this.m3u8ParserService.parserSubtitle(e.subtitleMetadata.url,e.subtitleMetadata.language,t);r&&(e.originSubtitles=r.originSubtitles,e.subtitles=r.subtitles,e.subtitleMetadata.hasPunctuation=r.hasPunctuation)}else{const r=await fetch(e.subtitleMetadata.url);if(r.ok){const n=await r.text(),s=await this.parseSubtitle(n,t);e.originSubtitles=s.originSubtitles,e.subtitles=s.subtitles,e.subtitleMetadata.hasPunctuation=s.hasPunctuation}}return e}async parseSubtitle(e,t){return t.subtitleFormat==="vtt"||t.subtitleFormat==="srt"?new j2().parse(e,t):new jF().parse(e,t)}matchUrl(e,t){return t.urlMatchType==="includes"?e.includes(t.url):!e.startsWith("https")||t.urlExclude&&new gr(t.urlExclude).includes(e)?!1:new gr(t.url).includes(e)}filterRequest(e,t,r,n){return r.urlRequestMethod.toLowerCase()===e.toLowerCase()&&this.matchUrl(t,r)&&n.dubbingPages.some(s=>new gr(s).includes(window.location.href))}}class tS extends Yr{createMetadataObservable(e){if(e.siteDubbingRules.domTrackConfig===void 0)throw console.error("DomBasedMediaMetadataService: domTrackConfig is undefined for site",e.siteDubbingRules),new Error("the website is missing the domTrackConfig configuration.");const t=e.siteDubbingRules.mediaSelector;return es(200).pipe(lr(()=>{const n=this.findMedia(t);if(!n)return null;if((e.siteDubbingRules.subtitleFormat==="m3u8"||e.siteDubbingRules.site==="khanacademy"||e.siteDubbingRules.site==="kaltura")&&this.findTracks(n).length===0){if(e.siteDubbingRules.site==="khanacademy"||e.siteDubbingRules.site==="kaltura")return null;if(Le(n).find("source").length>0)return null}return n.src}),Tr(n=>n!=null&&n!==""),rR()).pipe(Mt(n=>{console.log("enter dom switchMap, src changed to:",n);const s=this.findMedia(t),a=new ur(s,e.tabTitle);return e.siteDubbingRules.domTrackConfig.parseConfig.isLiveVideoExtract?er(new u2().getIsLive(e.siteDubbingRules.domTrackConfig.parseConfig.isLiveVideoExtract,a)).pipe(lr(o=>this.extractMediaMetadata(e.siteDubbingRules.domTrackConfig.parseConfig,a,o))):or(this.extractMediaMetadata(e.siteDubbingRules.domTrackConfig.parseConfig,a,!1))}))}findTracks(e){return Le(e).find('track[kind="captions"], track[kind="subtitles"]')}findMedia(e){return document.querySelector(e)}extractMediaMetadata(e,t,r){var n,s;return{videoId:Vt.extractVideoId(e.videoIdExtract,t),title:Vt.extractTitle(e.titleExtract,t),subtitleMetadata:this.getBestSubtitle(e,t),subtitleLevel:hn.YELLOW,videoLanguage:Vt.extractVideoLanguage(e,t),isPrivate:!1,channelId:"",duration:Number.isFinite((n=t.media)==null?void 0:n.duration)?(s=t.media)==null?void 0:s.duration:0,isLiveVideo:r,supportLanguageCode:["SG"],subtitles:[],originSubtitles:[]}}getBestSubtitle(e,t){return new DE().getBestSubtitle(e.subtitleExtract,t)}}class Ec{async getIsLive(e,t){if(!t.data)throw console.error("Context vo object is missing, unable to extract live video status using JSONPath",t),Error("Context vo object is missing, unable to extract live video status using JSONPath");if(It.isEmpty(e.values))throw console.error("Live video extraction configuration is missing JSONPath values property",e),new Error("Live video extraction configuration is missing JSONPath values property");return Vt.extractBooleanByJsonPath(e.values,e.computeType,t.data)}}class rS extends Yr{createMetadataObservable(e){var a;if(e.siteDubbingRules.windowVariableConfig===void 0)throw console.error("WindowBasedMediaMetadataService: windowVariableConfig is undefined for site",e.siteDubbingRules),new Error("The website is missing the windowVariableConfig configuration.");const t=document.querySelector(e.siteDubbingRules.mediaSelector),r=e.siteDubbingRules.windowVariableConfig,n=Ji(window,r.variableJsonPath);if(!n)return Lo;const s=new ur(t,e.tabTitle,n);return(a=r.parseConfig)!=null&&a.isLiveVideoExtract?er(new Ec().getIsLive(r.parseConfig.isLiveVideoExtract,s)).pipe(lr(o=>this.extractMediaMetadata(r.parseConfig,s,o))):or(this.extractMediaMetadata(r.parseConfig,s,!1))}}class Ip{constructor(){re(this,"rules",[{className:"SiteDubbingRules",domain:"*://*.youtube.com/*",excludeKeywords:["youtube.com/embed/?"],dubbingPages:["*://*.youtube.com/embed/*"],injectPages:["*://*.youtube.com/embed/*"],playBtnContainerSelector:".ytp-right-controls",playBtnCss:{btnCss:"youtube-dubbing-embed-button",logoCss:"youtube-dubbing-embed-logo",containerCss:"youtube-dubbing-embed-container"},mediaSelector:"video",enabled:!0,videoIdExtract:{type:"urlPath",buildType:"raw",values:["/embed/:videoId","videoId"]},subtitleFetchMethod:"youtube",apiInterceptConfig:{url:"/youtubei/v1/player?",urlMatchType:"includes",urlRequestType:"ajax",urlRequestMethod:"POST",parseConfig:{subtitleExtract:{subtitleListJsonPath:"$.captions.playerCaptionsTracklistRenderer.captionTracks",subtitleUrlName:"baseUrl",subtitleLanguageName:"languageCode",subtitleAsrName:"kind",subtitleAsrValue:"asr"},titleExtract:{type:"jsonPath",values:["$.videoDetails.title"]},videoIdExtract:{type:"jsonPath",buildType:"raw",values:["$.videoDetails.videoId"]},isPrivateExtract:{type:"jsonpath",values:["$.videoDetails.isPrivate"],computeType:"all"},isLiveVideoExtract:{type:"jsonpath",computeType:"any",values:["$.videoDetails.isLive"]},channelIdExtract:{type:"jsonpath",value:"$.videoDetails.channelId"},durationExtract:{type:"jsonpath",value:"$.videoDetails.lengthSeconds"},supportedLanguageExtract:{type:"jsonpath",value:"$.microformat.playerMicroformatRenderer.availableCountries"},videoLanguageExtract:{type:"asr"}}},windowVariableConfig:{variableJsonPath:"$.ytInitialPlayerResponse",parseConfig:{subtitleExtract:{subtitleListJsonPath:"$.captions.playerCaptionsTracklistRenderer.captionTracks",subtitleUrlName:"baseUrl",subtitleLanguageName:"languageCode",subtitleAsrName:"kind",subtitleAsrValue:"asr"},titleExtract:{type:"jsonPath",values:["$.videoDetails.title"]},videoIdExtract:{type:"jsonPath",buildType:"raw",values:["$.videoDetails.videoId"]},isPrivateExtract:{type:"jsonpath",values:["$.videoDetails.isPrivate"],computeType:"all"},isLiveVideoExtract:{type:"jsonpath",computeType:"any",values:["$.videoDetails.isLive"]},channelIdExtract:{type:"jsonpath",value:"$.videoDetails.channelId"},durationExtract:{type:"jsonpath",value:"$.microformat.playerMicroformatRenderer.availableCountries"},supportedLanguageExtract:{type:"jsonpath",value:"$.videoDetails.supportedLanguage"},videoLanguageExtract:{type:"asr"}}},playerConfig:{playerClass:"YouTubePlayer"},subtitleFormat:{subtitleListJsonPath:"$.transcript.text",subtitleStartTimeName:"offsetTimeMs",timeType:"duration",subtitleEndTimeName:"dur",subtitleTextName:"utf8"},subtitleTimeUnit:"millisecond",site:"youtube",needWebRequest:!0},{className:"SiteDubbingRules",domain:"*://*.youtube-nocookie.com/*",dubbingPages:["*://*.youtube-nocookie.com/embed/*"],injectPages:["*://*.youtube-nocookie.com/embed/*"],playBtnContainerSelector:".ytp-right-controls",playBtnCss:{btnCss:"youtube-dubbing-embed-button",logoCss:"youtube-dubbing-embed-logo",containerCss:"youtube-dubbing-embed-container"},mediaSelector:"video",enabled:!0,videoIdExtract:{type:"urlPath",buildType:"raw",values:["/embed/:videoId","videoId"]},subtitleFetchMethod:"youtube",apiInterceptConfig:{url:"/youtubei/v1/player?",urlMatchType:"includes",urlRequestType:"ajax",urlRequestMethod:"POST",parseConfig:{subtitleExtract:{subtitleListJsonPath:"$.captions.playerCaptionsTracklistRenderer.captionTracks",subtitleUrlName:"baseUrl",subtitleLanguageName:"languageCode",subtitleAsrName:"kind",subtitleAsrValue:"asr"},titleExtract:{type:"jsonPath",values:["$.videoDetails.title"]},videoIdExtract:{type:"jsonPath",buildType:"raw",values:["$.videoDetails.videoId"]},isPrivateExtract:{type:"jsonpath",values:["$.videoDetails.isPrivate"],computeType:"all"},isLiveVideoExtract:{type:"jsonpath",computeType:"any",values:["$.videoDetails.isLive"]},channelIdExtract:{type:"jsonpath",value:"$.videoDetails.channelId"},durationExtract:{type:"jsonpath",value:"$.videoDetails.lengthSeconds"},supportedLanguageExtract:{type:"jsonpath",value:"$.microformat.playerMicroformatRenderer.availableCountries"},videoLanguageExtract:{type:"asr"}}},windowVariableConfig:{variableJsonPath:"$.ytInitialPlayerResponse",parseConfig:{subtitleExtract:{subtitleListJsonPath:"$.captions.playerCaptionsTracklistRenderer.captionTracks",subtitleUrlName:"baseUrl",subtitleLanguageName:"languageCode",subtitleAsrName:"kind",subtitleAsrValue:"asr"},titleExtract:{type:"jsonPath",values:["$.videoDetails.title"]},videoIdExtract:{type:"jsonPath",buildType:"raw",values:["$.videoDetails.videoId"]},isPrivateExtract:{type:"jsonpath",values:["$.videoDetails.isPrivate"],computeType:"all"},isLiveVideoExtract:{type:"jsonpath",computeType:"any",values:["$.videoDetails.isLive"]},channelIdExtract:{type:"jsonpath",value:"$.videoDetails.channelId"},durationExtract:{type:"jsonpath",value:"$.microformat.playerMicroformatRenderer.availableCountries"},supportedLanguageExtract:{type:"jsonpath",value:"$.videoDetails.supportedLanguage"},videoLanguageExtract:{type:"asr"}}},playerConfig:{playerClass:"YouTubePlayer"},subtitleFormat:{subtitleListJsonPath:"$.transcript.text",subtitleStartTimeName:"offsetTimeMs",timeType:"duration",subtitleEndTimeName:"dur",subtitleTextName:"utf8"},subtitleTimeUnit:"millisecond",site:"youtube",needWebRequest:!0},{className:"SiteDubbingRules",domain:"*://*.youtube.com/*",dubbingPages:["*://*.youtube.com/watch*","*://*.youtube.com/shorts/*","*://*.youtube.com/live/*"],injectPages:["*://*.youtube.com/*"],playBtnContainerSelector:".ytp-right-controls",playBtnCss:{btnCss:"youtube-dubbing-button",logoCss:"youtube-dubbing-logo",containerCss:"youtube-dubbing-container"},mediaSelector:"video.video-stream.html5-main-video",enabled:!0,videoIdExtract:{type:"multi-pattern",buildType:"raw",values:[this.getYoutubeMultiPatternExtractVideoIdConfig()]},subtitleFetchMethod:"youtube",apiInterceptConfig:{url:"/youtubei/v1/player?",urlMatchType:"includes",urlRequestType:"ajax",urlRequestMethod:"POST",parseConfig:{subtitleExtract:{subtitleListJsonPath:"$.captions.playerCaptionsTracklistRenderer.captionTracks",subtitleUrlName:"baseUrl",subtitleLanguageName:"languageCode",subtitleAsrName:"kind",subtitleAsrValue:"asr"},titleExtract:{type:"jsonPath",values:["$.videoDetails.title"]},videoIdExtract:{type:"jsonPath",buildType:"raw",values:["$.videoDetails.videoId"]},isPrivateExtract:{type:"jsonpath",values:["$.videoDetails.isPrivate"],computeType:"all"},isLiveVideoExtract:{type:"jsonpath",computeType:"any",values:["$.videoDetails.isLive"]},channelIdExtract:{type:"jsonpath",value:"$.videoDetails.channelId"},durationExtract:{type:"jsonpath",value:"$.videoDetails.lengthSeconds"},supportedLanguageExtract:{type:"jsonpath",value:"$.microformat.playerMicroformatRenderer.availableCountries"},videoLanguageExtract:{type:"asr"}}},windowVariableConfig:{variableJsonPath:"$.ytInitialPlayerResponse",parseConfig:{subtitleExtract:{subtitleListJsonPath:"$.captions.playerCaptionsTracklistRenderer.captionTracks",subtitleUrlName:"baseUrl",subtitleLanguageName:"languageCode",subtitleAsrName:"kind",subtitleAsrValue:"asr"},titleExtract:{type:"jsonPath",values:["$.videoDetails.title"]},videoIdExtract:{type:"jsonPath",buildType:"raw",values:["$.videoDetails.videoId"]},isPrivateExtract:{type:"jsonpath",values:["$.videoDetails.isPrivate"],computeType:"all"},isLiveVideoExtract:{type:"jsonpath",computeType:"any",values:["$.videoDetails.isLive"]},channelIdExtract:{type:"jsonpath",value:"$.videoDetails.channelId"},durationExtract:{type:"jsonpath",value:"$.videoDetails.lengthSeconds"},supportedLanguageExtract:{type:"jsonpath",value:"$.microformat.playerMicroformatRenderer.availableCountries"},videoLanguageExtract:{type:"asr"}}},playerConfig:{playerClass:"YouTubePlayer"},subtitleFormat:{subtitleListJsonPath:"$.transcript.text",subtitleStartTimeName:"offsetTimeMs",timeType:"duration",subtitleEndTimeName:"dur",subtitleTextName:"utf8"},subtitleTimeUnit:"millisecond",site:"youtube",needWebRequest:!0},{className:"SiteDubbingRules",domain:"*://courses.apps.whop.com/*",dubbingPages:["*://courses.apps.whop.com/*"],injectPages:["*://courses.apps.whop.com/*"],playBtnContainerSelector:"mux-player",playBtnCss:{btnCss:"youtube-dubbing-button",logoCss:"youtube-dubbing-logo",containerCss:"youtube-dubbing-container"},mediaSelector:"mux-player",enabled:!0,videoIdExtract:{type:"attr",buildType:"raw",values:["mux-player","playback-id"],prefix:"mux_"},subtitleFetchMethod:"mux",muxConfig:{parseConfig:{subtitleExtract:{subtitleLanguageName:"language"},titleExtract:{type:"attr",values:["mux-player","title"]},videoIdExtract:{type:"attr",buildType:"raw",values:["mux-player","playback-id"],prefix:"mux_"}}},playerConfig:{playerClass:"MuxPlayer"},subtitleFormat:{subtitleListJsonPath:"$.transcript.text",subtitleStartTimeName:"offsetTimeMs",timeType:"duration",subtitleEndTimeName:"dur",subtitleTextName:"utf8"},subtitleTimeUnit:"second",site:"mux"},{className:"SiteDubbingRules",domain:"*://*.bilibili.com/*",dubbingPages:["*://*.bilibili.com/video*"],injectPages:["*://*.bilibili.com/*"],playBtnContainerSelector:".bpx-player-control-bottom-right",playBtnCss:{btnCss:"bili-dubbing-button",logoCss:"youtube-dubbing-logo",containerCss:"youtube-dubbing-container"},mediaSelector:"video",enabled:!0,videoIdExtract:{type:"multi-type",buildType:"join",buildParams:["_"],prefix:"bili_",values:[this.getBiliMultiTypeExtractVideoIdConfig()]},subtitleFetchMethod:"bili",apiInterceptConfig:{url:"/x/player/wbi/v2?",urlMatchType:"includes",urlRequestType:"ajax",urlRequestMethod:"GET",parseConfig:{subtitleExtract:{subtitleListJsonPath:"$.data.subtitle.subtitles",subtitleUrlName:"subtitle_url",subtitleLanguageName:"lan",subtitleAsrName:"type",subtitleAsrValue:"1"},titleExtract:{type:"selector",values:[".video-title"]},videoIdExtract:{type:"multi-type",buildType:"join",buildParams:["_"],prefix:"bili_",values:[this.getJSONBiliMultiTypeExtractVideoIdConfig()]},isPrivateExtract:{type:"jsonpath",values:["$.data.is_ugc_pay_preview","$.data.is_upower_exclusive","$.data.is_upower_play"],computeType:"any"}}},windowVariableConfig:{variableJsonPath:"$['__INITIAL_STATE__']",parseConfig:{subtitleExtract:{subtitleListJsonPath:"$.data.subtitle.subtitles",subtitleUrlName:"subtitle_url",subtitleLanguageName:"lan",subtitleAsrName:"type",subtitleAsrValue:"1"},titleExtract:{type:"selector",values:[".video-title"]},videoIdExtract:{type:"multi-type",buildType:"join",buildParams:["_"],prefix:"bili_",values:[this.getJSONBiliMultiTypeExtractVideoIdConfig()]}}},playerConfig:{playerClass:"BiliPlayer"},subtitleFormat:{subtitleListJsonPath:"$.body",subtitleStartTimeName:"from",timeType:"end",subtitleEndTimeName:"to",subtitleTextName:"content"},subtitleTimeUnit:"second",site:"bili",needWebRequest:!0},{className:"SiteDubbingRules",domain:"*://*.udemy.*/*",dubbingPages:["*://*.udemy.*/course/*/learn/lecture/*"],injectPages:["*://*.udemy.*/course/*/learn/*"],playBtnContainerSelector:'div[data-purpose="video-controls"]',playBtnCss:{btnCss:"udemy-dubbing-button",logoCss:"youtube-dubbing-logo",containerCss:"youtube-dubbing-container"},mediaSelector:"video",enabled:!0,videoIdExtract:{type:"urlPath",buildType:"raw",prefix:"udemy_",values:["/course/:course/learn/lecture/:id","id"]},subtitleFetchMethod:"udemy",apiInterceptConfig:{url:"*://*.udemy.*/api-2.0/users/me/subscribed-courses/*/lectures/*",urlMatchType:"pattern",urlExclude:"*://*.udemy.*/api-2.0/users/me/subscribed-courses/*/lectures/*/social-bookmarks/*",urlRequestType:"ajax",urlRequestMethod:"GET",parseConfig:{subtitleExtract:{subtitleListJsonPath:"$.asset.captions",subtitleUrlName:"url",subtitleLanguageName:"locale_id"},titleExtract:{type:"tab"},videoIdExtract:{type:"jsonPath",buildType:"raw",prefix:"udemy_",values:["$.id"]},durationExtract:{type:"jsonpath",value:"$.asset.length"}}},playerConfig:{playerClass:"NoOfflineVideoPlayer"},subtitleFormat:"vtt",subtitleTimeUnit:"second",site:"udemy",needWebRequest:!0},{className:"SiteDubbingRules",domain:"*://iframe.mediadelivery.net/*",dubbingPages:["*://iframe.mediadelivery.net/embed/*"],injectPages:["*://iframe.mediadelivery.net/embed/*"],playBtnContainerSelector:".plyr__controls",playBtnCss:{btnCss:"gamedev-dubbing-button",logoCss:"youtube-dubbing-logo",containerCss:"youtube-dubbing-container"},mediaSelector:"#main-video",enabled:!0,videoIdExtract:{type:"urlPath",buildType:"raw",prefix:"gamedev_",values:["/embed/:videoLibId/:videoId","videoId"]},subtitleFetchMethod:"domTrack",domTrackConfig:{parseConfig:{subtitleExtract:{subtitleLanguageName:"srclang"},titleExtract:{type:"tab"},videoIdExtract:{type:"urlPath",buildType:"raw",prefix:"gamedev_",values:["/embed/:videoLibId/:videoId","videoId"]}}},playerConfig:{playerClass:"NoOfflineVideoPlayer"},subtitleFormat:"vtt",subtitleTimeUnit:"second",site:"gamedev",startResetPlaybackRate:!0},{className:"SiteDubbingRules",domain:"*://dev.epicgames.com/*",dubbingPages:["*://dev.epicgames.com/*/embed.html"],injectPages:["*://dev.epicgames.com/*/embed.html"],playBtnContainerSelector:".vjs-control-bar",playBtnCss:{btnCss:"epicgames-dubbing-button",logoCss:"youtube-dubbing-logo",containerCss:"youtube-dubbing-container"},mediaSelector:"video",enabled:!0,videoIdExtract:{type:"urlPath",buildType:"raw",prefix:"epicgames_",values:["/community/api/:category/videos/:videoId/embed.html","videoId"]},subtitleFetchMethod:"videojs",videoJsConfig:{parseConfig:{subtitleExtract:{subtitleLanguageName:"auto"},titleExtract:{type:"tab"},videoIdExtract:{type:"urlPath",buildType:"raw",prefix:"epicgames_",values:["/community/api/:category/videos/:videoId/embed.html","videoId"]}}},playerConfig:{playerClass:"NoOfflineVideoPlayer"},subtitleFormat:"vtt",subtitleTimeUnit:"second",site:"epicgames",startResetPlaybackRate:!0},{className:"SiteDubbingRules",domain:"*://*.coursera.org/*",dubbingPages:["*://*.coursera.org/learn/*/lecture/*"],injectPages:["*://*.coursera.org/learn/*"],playBtnContainerSelector:".icon-container > div:last-child",playBtnCss:{btnCss:"epicgames-dubbing-button",logoCss:"youtube-dubbing-logo",containerCss:"youtube-dubbing-container"},mediaSelector:"video",enabled:!0,videoIdExtract:{type:"urlPath",buildType:"raw",prefix:"coursera_",values:["/learn/:a/lecture/:videoId/:b","videoId"]},subtitleFetchMethod:"domTrack",domTrackConfig:{parseConfig:{subtitleExtract:{subtitleLanguageName:"srclang"},titleExtract:{type:"tab"},videoIdExtract:{type:"urlPath",buildType:"raw",prefix:"coursera_",values:["/learn/:a/lecture/:videoId/:b","videoId"]}}},playerConfig:{playerClass:"NoOfflineVideoPlayer"},subtitleFormat:"vtt",subtitleTimeUnit:"second",site:"coursera",startResetPlaybackRate:!0},{className:"SiteDubbingRules",domain:"*://player.vimeo.com/*",dubbingPages:["*://player.vimeo.com/video/*"],injectPages:["*://player.vimeo.com/video/*"],playBtnContainerSelector:"div:has(> #fullscreen-control-bar-button)",playBtnCss:{btnCss:"epicgames-dubbing-button",logoCss:"youtube-dubbing-logo",containerCss:"youtube-dubbing-container"},mediaSelector:"video",enabled:!0,videoIdExtract:{type:"urlPath",buildType:"raw",prefix:"vimeo_",values:["/video/:videoId","videoId"]},subtitleFetchMethod:"domTrack",domTrackConfig:{parseConfig:{subtitleExtract:{subtitleLanguageName:"srclang"},titleExtract:{type:"tab"},videoIdExtract:{type:"urlPath",buildType:"raw",prefix:"vimeo_",values:["/video/:videoId","videoId"]}}},playerConfig:{playerClass:"VimeoPlayer"},subtitleFormat:"vtt",subtitleTimeUnit:"second",site:"vimeo",startResetPlaybackRate:!0},{className:"SiteDubbingRules",domain:"*://vimeo.com/*",dubbingPages:["*://vimeo.com/*"],injectPages:["*://vimeo.com/*"],playBtnContainerSelector:"div:has(> #fullscreen-control-bar-button)",playBtnCss:{btnCss:"epicgames-dubbing-button",logoCss:"youtube-dubbing-logo",containerCss:"youtube-dubbing-container"},mediaSelector:"video",enabled:!0,videoIdExtract:{type:"urlPath",buildType:"raw",prefix:"vimeo_",values:["/:videoId","videoId"]},subtitleFetchMethod:"domTrack",domTrackConfig:{parseConfig:{subtitleExtract:{subtitleLanguageName:"srclang"},titleExtract:{type:"tab"},videoIdExtract:{type:"urlPath",buildType:"raw",prefix:"vimeo_",values:["/:videoId","videoId"]}}},playerConfig:{playerClass:"VimeoPlayer"},subtitleFormat:"vtt",subtitleTimeUnit:"second",site:"vimeo",startResetPlaybackRate:!0},{className:"SiteDubbingRules",domain:"*://threejs-journey.com/lessons/*",dubbingPages:["*://threejs-journey.com/lessons/*"],injectPages:["*://threejs-journey.com/lessons/*"],playBtnContainerSelector:"div.undefined",playBtnCss:{btnCss:"epicgames-dubbing-button",logoCss:"youtube-dubbing-logo",containerCss:"youtube-dubbing-container"},mediaSelector:"video",enabled:!0,videoIdExtract:{type:"urlPath",buildType:"raw",prefix:"threejs_journey_",values:["/lessons/:videoId","videoId"]},subtitleFetchMethod:"domTrack",domTrackConfig:{parseConfig:{subtitleExtract:{subtitleLanguageName:"srclang",domKind:"metadata"},titleExtract:{type:"tab"},videoIdExtract:{type:"urlPath",buildType:"raw",prefix:"threejs_journey_",values:["/lessons/:videoId","videoId"]}}},playerConfig:{playerClass:"NoOfflineVideoPlayer"},subtitleFormat:"vtt",subtitleTimeUnit:"second",site:"threejs_journey",startResetPlaybackRate:!0},{className:"SiteDubbingRules",domain:"*://*.dropbox.com/*",dubbingPages:["*://*.dropbox.com/preview/*","*://*.dropbox.com/scl/fi/*"],injectPages:["*://*.dropbox.com/*"],playBtnContainerSelector:"div.undefined",playBtnCss:{btnCss:"epicgames-dubbing-button",logoCss:"youtube-dubbing-logo",containerCss:"youtube-dubbing-container"},mediaSelector:"video",enabled:!0,videoIdExtract:{type:"multi-pattern",buildType:"raw",values:[this.getDropboxMultiPatternExtractVideoIdConfig()]},subtitleFetchMethod:"dropbox",dropboxConfig:{parseConfig:{subtitleExtract:{subtitleLanguageName:"srclang"},titleExtract:{type:"tab"},videoIdExtract:{type:"multi-pattern",buildType:"raw",values:[this.getDropboxMultiPatternExtractVideoIdConfig()]}}},playerConfig:{playerClass:"DropboxPlayer"},subtitleFormat:"vtt",subtitleTimeUnit:"second",site:"dropbox",startResetPlaybackRate:!0,needWebRequest:!0},{className:"SiteDubbingRules",domain:"*://mediaspace.illinois.edu/*",dubbingPages:["*://mediaspace.illinois.edu/media/*"],injectPages:["*://mediaspace.illinois.edu/*"],playBtnContainerSelector:".playkit-controls-container .playkit-right-controls",playBtnCss:{btnCss:"youtube-dubbing-button",logoCss:"youtube-dubbing-logo",containerCss:"custom-play-btn-container"},mediaSelector:"video, audio",enabled:!0,videoIdExtract:{type:"undefined",buildType:"raw",values:[]},subtitleFetchMethod:"commonM3u8",mediaParseConfig:{parseConfig:{subtitleExtract:{subtitleLanguageName:"auto"},titleExtract:{type:"tab"},videoIdExtract:{type:"undefined",buildType:"raw",values:[]}}},playerConfig:{playerClass:"IllinoisPlayer"},subtitleFormat:"vtt",subtitleTimeUnit:"second",site:"illinois",startResetPlaybackRate:!0,needWebRequest:!0},{className:"SiteDubbingRules",domain:"*://players.brightcove.net/*",dubbingPages:["*://players.brightcove.net/*"],injectPages:["*://players.brightcove.net/*"],playBtnContainerSelector:".vjs-control-bar",playBtnCss:{btnCss:"youtube-dubbing-button",logoCss:"youtube-dubbing-logo",containerCss:"custom-play-btn-container"},mediaSelector:"video",enabled:!0,videoIdExtract:{type:"urlQueryParam",buildType:"raw",values:["videoId"],prefix:"brightcove_"},subtitleFetchMethod:"commonM3u8",mediaParseConfig:{parseConfig:{subtitleExtract:{subtitleLanguageName:"auto"},titleExtract:{type:"tab"},videoIdExtract:{type:"urlQueryParam",buildType:"raw",values:["videoId"],prefix:"brightcove_"}}},playerConfig:{playerClass:"BrightcovePlayer"},subtitleFormat:"vtt",subtitleTimeUnit:"second",site:"brightcove_",startResetPlaybackRate:!0,needWebRequest:!0},{className:"SiteDubbingRules",domain:"*://learn.deeplearning.ai/*",dubbingPages:["*://learn.deeplearning.ai/courses/*"],injectPages:["*://learn.deeplearning.ai/*"],playBtnContainerSelector:"div:has(> .vds-fullscreen-button)",playBtnCss:{btnCss:"epicgames-dubbing-button",logoCss:"youtube-dubbing-logo",containerCss:"youtube-dubbing-container"},mediaSelector:"video",enabled:!0,videoIdExtract:{type:"urlPath",buildType:"raw",prefix:"deeplearningai_",values:["/courses/:a/lesson/:videoId/:b","videoId"]},subtitleFetchMethod:"domTrack",domTrackConfig:{parseConfig:{subtitleExtract:{subtitleLanguageName:"srclang"},titleExtract:{type:"tab"},videoIdExtract:{type:"urlPath",buildType:"raw",prefix:"deeplearningai_",values:["/courses/:a/lesson/:videoId/:b","videoId"]}}},playerConfig:{playerClass:"NoOfflineVideoPlayer"},subtitleFormat:"m3u8",subtitleTimeUnit:"second",site:"deeplearning.ai",startResetPlaybackRate:!0},{className:"SiteDubbingRules",domain:"*://opencast.dcex.harvard.edu/*",dubbingPages:["*://opencast.dcex.harvard.edu/engage/player/watch.html*"],injectPages:["*://opencast.dcex.harvard.edu/engage/player/watch.html*"],playBtnContainerSelector:"#player-container > div.playback-bar.top-mode > div.button-plugins.right-side",playBtnCss:{btnCss:"youtube-dubbing-button",logoCss:"youtube-dubbing-logo",containerCss:"custom-play-btn-container"},mediaSelector:"video, audio",enabled:!0,videoIdExtract:{type:"urlQueryParam",buildType:"raw",values:["id"],prefix:"harvard_"},subtitleFetchMethod:"commonVtt",commonVttConfig:{parseConfig:{subtitleExtract:{subtitleLanguageName:"auto"},titleExtract:{type:"tab"},videoIdExtract:{type:"urlQueryParam",buildType:"raw",values:["id"],prefix:"harvard_"}}},playerConfig:{playerClass:"HarvardPlayer"},subtitleFormat:"vtt",subtitleTimeUnit:"second",site:"harvard",startResetPlaybackRate:!0,needWebRequest:!0},{className:"SiteDubbingRules",domain:"*://*.khanacademy.org/*",dubbingPages:["*://*.khanacademy.org/*/*/*/*/v/*"],injectPages:["*://*.khanacademy.org/*"],playBtnContainerSelector:".undefined",playBtnCss:{btnCss:"epicgames-dubbing-button",logoCss:"youtube-dubbing-logo",containerCss:"youtube-dubbing-container"},mediaSelector:"video",enabled:!0,videoIdExtract:{type:"urlPath",buildType:"raw",prefix:"khanac_",values:["/:category1/:category2/:slug1/:slug2/v/:title","title"]},subtitleFetchMethod:"domTrack",domTrackConfig:{parseConfig:{subtitleExtract:{subtitleLanguageName:"srclang"},titleExtract:{type:"tab"},videoIdExtract:{type:"urlPath",buildType:"raw",prefix:"khanac_",values:["/:category1/:category2/:slug1/:slug2/v/:title","title"]}}},playerConfig:{playerClass:"NoOfflineVideoPlayer"},subtitleFormat:"vtt",subtitleTimeUnit:"second",site:"khanacademy",startResetPlaybackRate:!0},{className:"SiteDubbingRules",domain:"*://courses.edx.org/*",dubbingPages:["*://courses.edx.org/*"],injectPages:["*://courses.edx.org/*"],playBtnContainerSelector:".undefined",playBtnCss:{btnCss:"epicgames-dubbing-button",logoCss:"youtube-dubbing-logo",containerCss:"youtube-dubbing-container"},mediaSelector:"video",enabled:!0,videoIdExtract:{type:"attr",buildType:"raw",prefix:"edx_",values:[".video","data-course-id"]},subtitleFetchMethod:"edx",edxConfig:{parseConfig:{subtitleExtract:{subtitleLanguageName:"lang"},titleExtract:{type:"tab"},videoIdExtract:{type:"attr",buildType:"raw",prefix:"edx_",values:[".video","data-course-id"]}}},playerConfig:{playerClass:"EdxPlayer"},subtitleFormat:"vtt",subtitleTimeUnit:"millisecond",site:"edx",startResetPlaybackRate:!0},{className:"SiteDubbingRules",domain:"*://cdnapisec.kaltura.com/*",dubbingPages:["*://cdnapisec.kaltura.com/html5/*"],injectPages:["*://cdnapisec.kaltura.com/html5/*"],playBtnContainerSelector:".undefined",playBtnCss:{btnCss:"youtube-dubbing-button",logoCss:"youtube-dubbing-logo",containerCss:"custom-play-btn-container"},mediaSelector:"video, audio",enabled:!0,videoIdExtract:{type:"urlPath",buildType:"raw",values:["/html5/:slug1/:slug2/:slug3/:slug4/:slug5/uiconf_id/:slug6/entry_id/:videoId","videoId"],prefix:"kaltura_"},subtitleFetchMethod:"domTrack",domTrackConfig:{parseConfig:{subtitleExtract:{subtitleLanguageName:"srclang",domKind:"subtitles"},titleExtract:{type:"tab"},videoIdExtract:{type:"urlPath",buildType:"raw",values:["/html5/:slug1/:slug2/:slug3/:slug4/:slug5/uiconf_id/:slug6/entry_id/:videoId","videoId"],prefix:"kaltura_"}}},playerConfig:{playerClass:"KalturaPlayer"},subtitleFormat:"srt",subtitleTimeUnit:"second",site:"kaltura",startResetPlaybackRate:!0,needWebRequest:!0},{className:"SiteDubbingRules",domain:"*://www.ixl.com/*",dubbingPages:["*://www.ixl.com/*"],injectPages:["*://www.ixl.com/*"],playBtnContainerSelector:".undefined",playBtnCss:{btnCss:"youtube-dubbing-button",logoCss:"youtube-dubbing-logo",containerCss:"custom-play-btn-container"},mediaSelector:"video, audio",enabled:!0,videoIdExtract:{type:"urlPath",buildType:"raw",values:["/:slug1/:slug2/:videoId","videoId"],prefix:"ixl_"},subtitleFetchMethod:"ixl",domTrackConfig:{parseConfig:{subtitleExtract:{subtitleLanguageName:"srclang",domKind:"subtitles"},titleExtract:{type:"tab"},videoIdExtract:{type:"urlPath",buildType:"raw",values:["/:slug1/:slug2/:videoId","videoId"],prefix:"ixl_"}}},playerConfig:{playerClass:"IxlPlayer"},subtitleFormat:"vtt",subtitleTimeUnit:"second",site:"kaltura",startResetPlaybackRate:!0,needWebRequest:!0},{className:"SiteDubbingRules",domain:"*://anthropic.skilljar.com/*",dubbingPages:["*://anthropic.skilljar.com/*/*"],injectPages:["*://anthropic.skilljar.com/*"],playBtnContainerSelector:".jw-button-container",playBtnCss:{btnCss:"skilljar-dubbing-button",logoCss:"youtube-dubbing-logo",containerCss:"youtube-dubbing-container"},mediaSelector:"video",enabled:!0,videoIdExtract:{type:"urlPath",buildType:"raw",prefix:"claude_",values:["/:slug/:videoId","videoId"]},subtitleFetchMethod:"jwplayer",playerConfig:{playerClass:"JwPlayer"},subtitleFormat:"srt",subtitleTimeUnit:"second",site:"anthropic_skilljar",startResetPlaybackRate:!0}])}getYoutubeMultiPatternExtractVideoIdConfig(){return rt.stringify({configMap:this.getYouTubeExtractVideoIdConfigMap()})}getYouTubeExtractVideoIdConfigMap(){const e=new Map;return e.set("*://*.youtube.com/watch*",{type:"urlQueryParam",buildType:"raw",values:["v"]}),e.set("*://*.youtube.com/shorts/*",{type:"urlPath",buildType:"raw",values:["/shorts/:videoId","videoId"]}),e.set("*://*.youtube.com/live/*",{type:"urlPath",buildType:"raw",values:["/live/:videoId","videoId"]}),e}getDropboxMultiPatternExtractVideoIdConfig(){return rt.stringify({configMap:this.getDropboxExtractVideoIdConfigMap()})}getDropboxExtractVideoIdConfigMap(){const e=new Map;return e.set("*://*.dropbox.com/preview/*",{type:"urlPath",buildType:"raw",prefix:"dropbox_",values:["/preview/:videoId","videoId"]}),e.set("*://*.dropbox.com/scl/fi/*",{type:"urlPath",buildType:"raw",prefix:"dropbox_",values:["/scl/fi/:videoId/:fileName","videoId"]}),e}getBiliMultiTypeExtractVideoIdConfig(){return rt.stringify({configList:this.getBiliExtractVideoIdConfigList()})}getBiliExtractVideoIdConfigList(){return[{type:"urlPath",buildType:"raw",values:["/video/:bvid","bvid"]},{type:"urlQueryParam",buildType:"raw",values:["p"],defaultValue:"1"}]}getJSONBiliMultiTypeExtractVideoIdConfig(){return rt.stringify({configList:this.getJSONBiliExtractVideoIdConfigList()})}getJSONBiliExtractVideoIdConfigList(){return[{type:"jsonPath",buildType:"raw",values:["$.data.bvid"]},{type:"jsonPath",buildType:"raw",values:["$.data.page_no"]}]}match(e){return this.rules.find(t=>new gr(t.domain).includes(e)&&t.dubbingPages.some(r=>new gr(r).includes(e))&&(!t.excludeKeywords||t.excludeKeywords.every(r=>!e.toString().includes(r))))}static shouldIgnoreLocationChange(e,t,r){if(!e)return!1;const n=e.videoIdExtract.type;if(n!=="urlPath"&&n!=="multi-pattern"&&n!=="urlQueryParam"&&n!=="multi-type")return!1;for(const s of e.dubbingPages)if(new gr(s).includes(t)&&new gr(s).includes(r)){let a=new ur(null,"",void 0);a.setParam("matchUrl",t);const o=Vt.extractVideoId(e.videoIdExtract,a);a=new ur(null,"",void 0),a.setParam("matchUrl",r);const l=Vt.extractVideoId(e.videoIdExtract,a);if(o!==void 0&&o===l)return!0}return!1}static isSameDubbingPage(e,t,r){const n=e.videoIdExtract.type;if(n!=="urlPath"&&n!=="multi-pattern"&&n!=="urlQueryParam"&&n!=="multi-type")return t===r;for(const s of e.dubbingPages)if(new gr(s).includes(t)&&new gr(s).includes(r)){let a=new ur(null,"",void 0);a.setParam("matchUrl",t);const o=Vt.extractVideoId(e.videoIdExtract,a);a=new ur(null,"",void 0),a.setParam("matchUrl",r);const l=Vt.extractVideoId(e.videoIdExtract,a);if(o!==void 0&&o===l)return!0}return!1}matchInjectPages(e){return this.rules.find(t=>new gr(t.domain).includes(e)&&t.injectPages.some(r=>new gr(r).includes(e)))}matchDubbingPages(e){return this.rules.find(t=>new gr(t.domain).includes(e)&&t.dubbingPages.some(r=>new gr(r).includes(e)))}}class no{constructor(){re(this,"siteDubbingRulesService",new Ip);re(this,"result");re(this,"lastComputeSearch");re(this,"lastResultType");re(this,"metadataSubject");var e,t;console.log("SubtitleRequestInfoStreamService, current url == "+window.location.href),this.metadataSubject=new bD(1),(e=window.pageContentRpc)==null||e.onMessage("sendRequestInfo",r=>this.metadataSubject.next(r.data)),(t=window.pageContentRpc)==null||t.onMessage("onUrlChange",()=>{var r;this.lastComputeSearch&&this.lastResultType&&((r=window.pageContentRpc)==null||r.sendMessage("getRequestMetadata",{search:this.lastComputeSearch(),resultType:this.lastResultType}).then())})}observeSubtitleRequests(e,t,r){var n;return this.lastComputeSearch=e,this.lastResultType=t,this.result||(this.result=this.metadataSubject.asObservable().pipe(Mt(s=>t==="m3u8"||r==="youtube"?or(s):or(s).pipe(Mt(a=>{const o={credentials:"include"},l=ti.addParam(a.url,"youtubedubbing","true");return er(fetch(l,o).catch(u=>fetch(l)))}),Mt(a=>{if(!a.ok)throw new Error(`Fetch 失败: ${a.status}`);return er(t==="json"?a.json():a.text())}))))),this.siteDubbingRulesService.matchDubbingPages(window.location.href)&&((n=window.pageContentRpc)==null||n.sendMessage("getRequestMetadata",{search:e(),resultType:t}).then()),this.result}resendRequest(){var e;this.siteDubbingRulesService.matchDubbingPages(window.location.href)&&this.lastComputeSearch&&this.lastResultType&&((e=window.pageContentRpc)==null||e.sendMessage("getRequestMetadata",{search:this.lastComputeSearch(),resultType:this.lastResultType}).then())}}class Np extends Yr{constructor(){super(...arguments);re(this,"subtitleRequestInfoStreamService",new no)}createMetadataObservable(t){const r=t.siteDubbingRules.apiInterceptConfig;if(r===void 0)throw console.error("ApiInterceptBasedMediaMetadataService: apiInterceptConfig is undefined for site",t.siteDubbingRules),new Error("The website is missing the apiInterceptConfig configuration.");return this.subtitleRequestInfoStreamService.observeSubtitleRequests(this.getSearch.bind(this,t),"json").pipe(Mt(n=>{var o;const s=document.querySelector(t.siteDubbingRules.mediaSelector),a=new ur(s,t.tabTitle,n);return(o=r.parseConfig)!=null&&o.isLiveVideoExtract?er(new Ec().getIsLive(r.parseConfig.isLiveVideoExtract,a)).pipe(lr(l=>this.extractMediaMetadata(r.parseConfig,a,l))):or(this.extractMediaMetadata(r.parseConfig,a,!1))}))}getSearch(t){return t.siteDubbingRules.site}}class c3 extends Yr{constructor(){super();re(this,"windowBasedService");re(this,"apiInterceptService");this.windowBasedService=new rS,this.apiInterceptService=new Np}createMetadataObservable(t){const r=this.windowBasedService.createMetadataObservable(t).pipe(ts(1)),n=this.apiInterceptService.createMetadataObservable(t);return YD(r,n)}}class Cp{convertToOriginSubtitles(e,t=!0){var n;const r=[];for(let s=0;s<e.length;s++){const a=e[s];if(a.segs===void 0)continue;if(a.segs.length===1){if(a.segs[0].utf8===`
`)continue;if(Ct.isSoundEffectMarker(a.segs[0].utf8))continue;if(It.isEmpty((n=a.segs[0].utf8)==null?void 0:n.trim()))continue}const o=this.convertOriginSubtitle(a);r.push(o)}if(t)for(let s of r)s.start=s.start/1e3,s.end=s.end/1e3,s.dur=s.dur/1e3;return r}convertOriginSubtitle(e){const t=e.segs;let r="";for(let n of t)r+=n.utf8+" ";return{start:e.tStartMs,end:e.tStartMs+e.dDurationMs,dur:e.dDurationMs,text:r,processPunctuation:!0}}}class h3{constructor(){re(this,"youtubeOriginSubtitleService",new Cp)}async parse(e,t){const n=JSON.parse(e).events;let s={hasPunctuation:!1,subtitles:[],originSubtitles:[]};s.originSubtitles=this.youtubeOriginSubtitleService.convertToOriginSubtitles(n);for(let a=0;a<n.length;a++){const o=n[a];if(o.segs===void 0)continue;if(o.segs.length===1){if(o.segs[0].utf8===`
`)continue;if(this.isSoundEffectMarker(o.segs[0].utf8))continue}const l=n[a+1],u=this.convertSubtitles(o,l);jt.containsOnlyPunctuationAndSpaces(u.text)||s.subtitles.push(u)}return s}isSoundEffectMarker(e){return e.startsWith("[")&&e.endsWith("]")}convertSubtitles(e,t){if(e.segs===void 0)throw new Error("Subtitle events must be provided");const r=e.segs;let n;for(let s=0;s<r.length;s++){const a=r[s];if(n===void 0)n=this.createSubtitle(e,a,s,t);else{const o=this.createSubtitle(e,a,s,t);n=Ct.appendSubtitle(n,o,!0)}}return n&&(n.text=Ct.normalizeSubtitleText(n.text)),n}createSubtitle(e,t,r,n){let s=e.tStartMs;t.tOffsetMs!==void 0&&(s+=t.tOffsetMs),s=s/1e3;let a=this.calculateSegmentEndTime(e,r+1,n)/1e3;return{start:s,end:a,dur:a-s,text:t.utf8,processPunctuation:!1}}calculateSegmentEndTime(e,t,r){if(e.segs===void 0)throw new Error("Subtitle events must be provided");let s=e.segs[t];return s!==void 0?e.tStartMs+s.tOffsetMs:r!==void 0?r.tStartMs:e.tStartMs+e.dDurationMs}}class d3 extends vp{constructor(){super(...arguments);re(this,"youtubeOriginSubtitleService",new Cp)}async parseSubtitle(t,r){const s=JSON.parse(t).events;let a=this.youtubeOriginSubtitleService.convertToOriginSubtitles(s,!1);const o=[];let l=!1;for(let u=0;u<s.length;u++){const h=s[u],d=h.segs;if(d===void 0||It.isEmpty(d))continue;const p=this.createSubtitle(h,d[0]);!l&&Ct.hasPunctuation(p.text)&&(l=!0),o.push(p)}return{subtitles:o,hasPunctuation:l,originSubtitles:a}}createSubtitle(t,r){return{start:t.tStartMs,end:t.tStartMs+t.dDurationMs,dur:t.dDurationMs,text:Ct.normalizeSubtitleText(r.utf8),processPunctuation:!0}}}class f3{constructor(){re(this,"punctuationSubtitleService",new vs);re(this,"youtubeOriginSubtitleService",new Cp)}async parse(e,t){const n=JSON.parse(e).events;let s={hasPunctuation:!0,subtitles:[],originSubtitles:[]};return s.originSubtitles=this.youtubeOriginSubtitleService.convertToOriginSubtitles(n),s.subtitles=this.segmentYouTubeAsrSubtitles(n),s.subtitles=this.punctuationSubtitleService.segmentSubtitlesBySentence(s.subtitles),s}segmentYouTubeAsrSubtitles(e){var r;const t=[];for(let n=0;n<e.length;n++){const s=e[n];if(s.segs===void 0)continue;if(s.segs.length===1){if(s.segs[0].utf8===`
`)continue;if(Ct.isSoundEffectMarker(s.segs[0].utf8))continue;if(It.isEmpty((r=s.segs[0].utf8)==null?void 0:r.trim()))continue}const a=e[n+1],o=this.convertSubtitles(s,a);if(!It.isEmpty(o))if(It.isEmpty(t))t.push(...o);else{const l=It.last(t);jt.endsWithPunctuation(l.text)?t.push(...o):(Ct.appendSubtitle(l,o[0],!0),o.length>1&&t.push(...o.slice(1)))}}return t}convertSubtitles(e,t){if(e.segs===void 0)throw new Error("Subtitle events must be provided");const r=e.segs,n=[];let s;for(let a=0;a<r.length;a++){const o=r[a];if(s===void 0)s=this.createSubtitle(e,o,a,t);else{const l=this.createSubtitle(e,o,a,t);s=Ct.appendSubtitle(s,l,!1)}jt.endsWithPunctuation(s.text)&&(s.text=Ct.normalizeSubtitleText(s.text),n.push(s),s=void 0)}return s!==void 0&&(s.text=Ct.normalizeSubtitleText(s.text),n.push(s)),n}createSubtitle(e,t,r,n){let s=e.tStartMs;t.tOffsetMs!==void 0&&(s+=t.tOffsetMs),s=s/1e3;let a=this.calculateSegmentEndTime(e,r+1,n)/1e3;return{start:s,end:a,dur:a-s,text:t.utf8,processPunctuation:!0}}calculateSegmentEndTime(e,t,r){if(e.segs===void 0)throw new Error("Subtitle events must be provided");let s=e.segs[t];return s!==void 0?e.tStartMs+s.tOffsetMs:r!==void 0?r.tStartMs:e.tStartMs+e.dDurationMs}}class iS{static fromMutationObserver(e,t){return eR(r=>{const n=new MutationObserver(s=>r(s));return n.observe(e,t),n},(r,n)=>n.disconnect())}static fromAttributeChanges(e,t){return this.fromMutationObserver(e,{attributes:!0,attributeFilter:t})}static async waitForPunctuation(e){const t=Uh(0,200).pipe(Tr(()=>e()),ts(1));await Oh(t)}}class Qs{static getPlayerId(){return new gr("*://*.youtube.com/shorts/*").includes(window.location.href)?"shorts-player":"movie_player"}static createWatchAdsObservable(){const e=Le(".html5-video-player");if(e.hasClass("ad-showing")){const t=e[0];return iS.fromAttributeChanges(t,["class"]).pipe(Tr(r=>r.some(()=>!e.hasClass("ad-showing"))))}}static createPlayerClassObservable(){const t=Le(".html5-video-player")[0];return iS.fromAttributeChanges(t,["class"])}}class g3 extends Yr{constructor(){super(...arguments);re(this,"lastVideoId");re(this,"subtitleRequestInfoStreamService",new no);re(this,"siteDubbingRulesService",new Ip);re(this,"captionRestoreTimer");re(this,"savedCaptionState")}createMetadataObservable(t){return console.log("[debug-metadata] enter createMetadataObservable"),es(500).pipe(Tr(()=>this.siteDubbingRulesService.matchDubbingPages(window.location.href)!==void 0),lr(()=>{var n,s;const r=document.getElementById(Qs.getPlayerId());if(!(!r||r.getPlayerState()===3))return(s=(n=r.getPlayerResponse())==null?void 0:n.videoDetails)==null?void 0:s.videoId}),Tr(r=>r!=null),Tr(r=>this.lastVideoId===void 0||r!==this.lastVideoId),Jl(r=>this.lastVideoId=r),Mt(r=>{const n=document.getElementById(Qs.getPlayerId());if(console.log("[debug-metadata] enter createMetadataObservable switch map, videoId == ["+r+"], player state == "+n.getPlayerState()),n.getPlayerState()===-1||n.getPlayerState()===2){const s=Le(`#${Qs.getPlayerId()} > div.html5-video-container > video`)[0];return console.log("[debug-metadata] start youtube play"),s.play().catch(a=>console.error("try play media occur error",a)),or(r)}else return or(r)}),Mt(r=>{var u;console.log("[debug-metadata] enter createMetadataObservable switch map videoId == "+r);const s=document.getElementById(Qs.getPlayerId()).getPlayerResponse(),a=Le(`#${Qs.getPlayerId()} > div.html5-video-container > video`)[0],o=t.siteDubbingRules.windowVariableConfig,l=new ur(a,t.tabTitle,s);return(u=o==null?void 0:o.parseConfig)!=null&&u.isLiveVideoExtract?er(new Ec().getIsLive(o.parseConfig.isLiveVideoExtract,l)).pipe(lr(h=>this.extractMediaMetadata(o.parseConfig,l,h))):or(this.extractMediaMetadata(o.parseConfig,l,!1))}))}async transformMetadata(t,r){if(t.subtitleMetadata===void 0)return t;const n=t.subtitleMetadata.language,s=document.getElementById(Qs.getPlayerId());if(!s)return t;if(console.log("[debug-metadata] enter transformMetadata, videoId == "+t.videoId+", player state == "+s.getPlayerState()),!this.savedCaptionState)try{const u=localStorage.getItem("yt-player-sticky-caption"),h=u?JSON.parse(u).data:null,d=localStorage.getItem("yt-player-caption-sticky-language"),p=d?JSON.parse(d).data:null,g=h==="true"||h===!0,m=p||"";this.savedCaptionState={wasEnabled:g,originalLanguage:m},console.log(`[debug-metadata] transformMetadata开始时保存用户字幕偏好: enabled=${g}, language=${m}, sticky=${h}`)}catch(u){console.log("[debug-metadata] 保存用户字幕偏好失败:",u)}const a=this.subtitleRequestInfoStreamService.observeSubtitleRequests(()=>JSON.stringify({videoId:"youtube_"+t.videoId,language:n,now:new Date().getTime()}),"json","youtube").pipe(P0(7e3),zl(u=>{if(u instanceof M0){if(!(this.siteDubbingRulesService.matchDubbingPages(location.href)!==void 0&&this.lastVideoId===t.videoId))return Lo;this.enableCaptionsWithReset(s,n)}return L0(()=>u)}),sR({delay:0}),Tr(u=>u.site==="youtube_"+t.videoId),Jl(u=>{console.log("[debug-metadata] ===== TAP: 收到字幕请求 ====="),console.log(`[debug-metadata] 请求信息: site=${u.site}, url=${u.url}`),console.log(`[debug-metadata] 当前 videoId=${t.videoId}, lastVideoId=${this.lastVideoId}`),console.log("[debug-metadata] 立即调用恢复字幕状态"),this.restoreUserCaptionState(s)}),Mt(u=>{console.log("[debug-metadata] enter switchMap, videoId == "+t.videoId);const h=TN.parse(u.url);return er(this.fetchYouTubeSubtitle(u,n).then(d=>this.parseYouTubeSubtitle(d,r,t.subtitleMetadata.isAsr,h.variant==="punctuated"))).pipe(lr(d=>d.errorStatus&&d.errorStatus===429?(t.errorStatus=429,t):(console.log("[debug-metadata] enter after parseYouTubeSubtitle, videoId == "+t.videoId),t.originSubtitles=d.originSubtitles,t.subtitles=d.subtitles,t.subtitleMetadata.hasPunctuation=d.hasPunctuation,t)),zl(d=>d&&d.message==="Empty subtitle text"?Lo:L0(()=>d)))}),nR(()=>{console.log("[debug-metadata] finalize: 清理字幕恢复定时器"),this.captionRestoreTimer!==void 0&&(clearTimeout(this.captionRestoreTimer),this.captionRestoreTimer=void 0)}),tR(t)),o=Oh(a),l=()=>{console.log(`[debug-metadata] onReady triggered, videoId: ${t.videoId}`),this.enableCaptionsWithReset(s,n),s.removeEventListener("onReady",l)};return s.addEventListener("onReady",l),setTimeout(()=>{console.log("[debug-metadata] 延迟首次调用 enableCaptionsWithReset，给YouTube时间恢复用户字幕设置"),this.enableCaptionsWithReset(s,n)},500),s.addEventListener("onApiChange",()=>{console.log("[debug-metadata] enter onApiChange, videoId == "+t.videoId),this.enableCaptionsWithReset(s,n)}),o}async fetchYouTubeSubtitle(t,r){const n={credentials:"include"},s=ti.replaceParam(ti.addParam(t.url,"youtubedubbing","true"),"lang",r),a=await fetch(s,n).catch(o=>fetch(s));if(!a.ok){if(a.status===429)return"429";throw new Error(`Fetch 失败: ${a.status}`)}return a.text()}enableCaptionsWithReset(t,r){if(this.captionRestoreTimer!==void 0&&(clearTimeout(this.captionRestoreTimer),this.captionRestoreTimer=void 0,console.log("[debug-metadata] 清除旧的字幕恢复定时器")),console.log("[debug-metadata] ===== enableCaptionsWithReset 开始 ====="),console.log(`[debug-metadata] 目标语言: ${r}`),console.log("[debug-metadata] 已保存的用户偏好:",this.savedCaptionState),!this.savedCaptionState){console.log("[debug-metadata] 警告：没有保存的用户偏好状态，跳过字幕操作");return}const n=this.savedCaptionState.wasEnabled,s=this.savedCaptionState.originalLanguage;if(n&&s===r){console.log(`[debug-metadata] 用户偏好已开启目标语言字幕(${r})`),console.log("[debug-metadata] 尝试静默触发字幕请求"),t.setOption("captions","track",{}),t.setOption("captions","track",{languageCode:r}),console.log("[debug-metadata] 已静默触发请求，字幕保持开启"),console.log("[debug-metadata] ===== enableCaptionsWithReset 结束（静默触发）=====");return}const o=(t.getOption("captions","track")||{}).languageCode||"";o&&(t.setOption("captions","track",{}),console.log(`[debug-metadata] 当前有字幕(${o})，先禁用`)),t.unloadModule("captions"),t.loadModule("captions"),console.log("[debug-metadata] 已重置字幕模块"),t.setOption("captions","track",{languageCode:r}),console.log(`[debug-metadata] 已启用字幕以触发请求: ${r}`),this.captionRestoreTimer=window.setTimeout(()=>{console.log("[debug-metadata] 兜底定时器触发，强制恢复字幕状态"),this.restoreUserCaptionState(t)},5e3),console.log("[debug-metadata] ===== enableCaptionsWithReset 结束 =====")}restoreUserCaptionState(t){if(console.log("[debug-metadata] ===== restoreUserCaptionState 开始 ====="),console.log("[debug-metadata] 保存的字幕状态:",this.savedCaptionState),!this.savedCaptionState){console.log("[debug-metadata] 没有保存的字幕状态，跳过恢复"),console.log("[debug-metadata] ===== restoreUserCaptionState 结束（跳过）=====");return}this.captionRestoreTimer!==void 0&&(clearTimeout(this.captionRestoreTimer),this.captionRestoreTimer=void 0,console.log("[debug-metadata] 清除定时器成功"));const n=(t.getOption("captions","track")||{}).languageCode||"";console.log(`[debug-metadata] 当前字幕语言: ${n}`),this.savedCaptionState.wasEnabled?n===this.savedCaptionState.originalLanguage?console.log(`[debug-metadata] 当前字幕语言(${n})已是用户原语言，无需恢复，保持开启状态`):(t.setOption("captions","track",{languageCode:this.savedCaptionState.originalLanguage}),console.log(`[debug-metadata] 恢复用户原字幕设置: ${this.savedCaptionState.originalLanguage}`)):(t.setOption("captions","track",{}),console.log("[debug-metadata] 用户原本未开启字幕，已关闭临时字幕")),console.log("[debug-metadata] 清空 savedCaptionState"),this.savedCaptionState=void 0,console.log("[debug-metadata] ===== restoreUserCaptionState 结束 =====")}parseYouTubeSubtitle(t,r,n,s){return t==="429"?Promise.resolve({originSubtitles:[],subtitles:[],hasPunctuation:!1,errorStatus:429}):!t||t.trim().length===0?(console.log("[debug-metadata] subtitleText is empty, resend request"),this.subtitleRequestInfoStreamService.resendRequest(),Promise.reject(new Error("Empty subtitle text"))):n||this.isAsrSubtitle(t)?s||!n?new f3().parse(t,r):new h3().parse(t,r):new d3().parse(t,r)}isAsrSubtitle(t){const n=JSON.parse(t).events;return this.findFirstSegArray(n).length>1}findFirstSegArray(t){for(let r=0;r<t.length;r++){const n=t[r];if(n.segs&&n.segs.length>0)return n.segs}return[]}}class p3{static findTrack(e,t,r){for(let n of e)if(n.kind===r&&n.language===t)return n}}class m3 extends Ko{getSubtitles(e,t){let r=[];const n=this.findMuxVideoByMedia(t.media);if(!n)throw console.error("Failed to find mux-video element in Shadow Root, cannot extract subtitles"),new Error("MuxBasedExtractSubtitleService: Unable to locate mux-video element required for subtitle extraction");for(let s of t.media.textTracks)s.kind==="subtitles"&&r.push(this.buildSubtitleMediaData(s,n));return r}buildSubtitleMediaData(e,t){return{url:t.src,language:e.language,isAsr:!1,hasPunctuation:!0}}postProcessSubtitle(e,t){if(e===void 0)return;const r=p3.findTrack(t.media.textTracks,e.language,"subtitles");return r&&(r.mode="showing"),e}findMuxVideoByMedia(e){const t=e.shadowRoot;if(!t)console.error("未找到 Shadow Root");else{const r=t.querySelector("mux-video");if(r)return console.log("找到 mux-video 元素: ",r),r;console.error("在 Shadow Root 中未找到 mux-video")}}}class y3 extends Yr{constructor(){super(...arguments);re(this,"lastPlaybackId")}createMetadataObservable(t){if(t.siteDubbingRules.muxConfig===void 0)throw console.error("MuxBasedMediaMetadataService: muxConfig is undefined for site",t.siteDubbingRules),new Error("the website is missing the muxConfig configuration.");return es(200).pipe(lr(r=>{const n=document.querySelector(t.siteDubbingRules.mediaSelector);return n?Le(n).attr("playback-id"):null}),Tr(r=>r!=null),Tr(r=>this.lastPlaybackId===void 0||r!==this.lastPlaybackId),Jl(r=>{this.lastPlaybackId=r}),Mt(r=>{const n=document.querySelector(t.siteDubbingRules.mediaSelector);return n&&Le(n).attr("playback-id")===r?this.handleMediaLoadStat(n,t):Lo}))}handleMediaLoadStat(t,r){return t.readyState>=1?this.createObservableFromLoadedMedia(t,r):Bh(t,"loadedmetadata").pipe(ts(1),Mt(()=>this.createObservableFromLoadedMedia(t,r)))}createObservableFromLoadedMedia(t,r){const n=new ur(t,r.tabTitle);if(r.siteDubbingRules.muxConfig===void 0)throw console.error("MuxBasedMediaMetadataService: muxConfig is undefined for site",r.siteDubbingRules),new Error("the website is missing the muxConfig configuration.");return r.siteDubbingRules.muxConfig.parseConfig.isLiveVideoExtract?er(new u2().getIsLive(r.siteDubbingRules.muxConfig.parseConfig.isLiveVideoExtract,n)).pipe(lr(s=>this.extractMediaMetadata(r.siteDubbingRules.muxConfig.parseConfig,n,s))):or(this.extractMediaMetadata(r.siteDubbingRules.muxConfig.parseConfig,n,!1))}extractMediaMetadata(t,r,n){var s;return{videoId:Vt.extractVideoId(t.videoIdExtract,r),title:Vt.extractTitle(t.titleExtract,r),subtitleMetadata:new m3().getBestSubtitle(t.subtitleExtract,r),subtitleLevel:hn.YELLOW,videoLanguage:Vt.extractVideoLanguage(t,r),isPrivate:!1,channelId:"",duration:((s=r.media)==null?void 0:s.duration)??0,isLiveVideo:n,supportLanguageCode:["SG"],subtitles:[],originSubtitles:[]}}async transformMetadata(t,r){if(t.subtitleMetadata===void 0)return t;const n=await this.m3u8ParserService.parserSubtitle(t.subtitleMetadata.url,t.subtitleMetadata.language,r);return n&&(t.originSubtitles=n.originSubtitles,t.subtitles=n.subtitles,t.subtitleMetadata.hasPunctuation=n.hasPunctuation),t}}class v3 extends Yr{constructor(){super(...arguments);re(this,"siteDubbingRulesService",new Ip)}createMetadataObservable(t){var s;if(t.siteDubbingRules.windowVariableConfig===void 0)throw console.error("BiliBasedMediaMetadataService: windowVariableConfig is undefined for site",t.siteDubbingRules),new Error("The website is missing the windowVariableConfig configuration.");if(t.siteDubbingRules.apiInterceptConfig===void 0)throw console.error("BiliBasedMediaMetadataService: apiInterceptConfig is undefined for site",t.siteDubbingRules),new Error("The website is missing the apiInterceptConfig configuration.");const r=new ED(this.siteDubbingRulesService.matchDubbingPages(window.location.href)!==void 0);(s=window.pageContentRpc)==null||s.onMessage("onUrlChange",a=>{console.log("on onUrlChange message data == ",a.data),r.next(!0)});const n=t.siteDubbingRules.apiInterceptConfig;return r.pipe(Tr(a=>a),Mt(()=>es(200).pipe(lr(()=>{const a=window.__INITIAL_STATE__;return console.log("find bili data == ",a+", current URL == "+window.location.href),a}),Tr(a=>a!==void 0),ts(1),Mt(a=>{if(window.location.href.startsWith("https://m.bilibili.com/")){const o=a;return er(fetch(`https://api.bilibili.com/x/player/wbi/v2?aid=${o.video.viewInfo.aid}&cid=${o.video.viewInfo.cid}`,{credentials:"include"}).then(l=>l.json()))}else{const o=a;return er(fetch(`https://api.bilibili.com/x/player/wbi/v2?aid=${o.aid}&cid=${o.cid}`,{credentials:"include"}).then(l=>l.json()))}}),Mt(a=>{var u;console.log("enter window switch map");const o=document.querySelector(t.siteDubbingRules.mediaSelector),l=new ur(o,t.tabTitle,a);return(u=n.parseConfig)!=null&&u.isLiveVideoExtract?er(new Ec().getIsLive(n.parseConfig.isLiveVideoExtract,l)).pipe(lr(h=>this.extractMediaMetadata(n.parseConfig,l,h))):or(this.extractMediaMetadata(n.parseConfig,l,!1))}))))}}class E3 extends Yr{createMetadataObservable(e){if(e.siteDubbingRules.videoJsConfig===void 0)throw console.error("AjaxVttBasedMediaMetadataService: videoJsConfig is undefined for site",e.siteDubbingRules),new Error("The website is missing the videoJsConfig configuration.");return es(200).pipe(lr(()=>{var t;return(t=document.querySelector("div.video-js"))==null?void 0:t.player}),Tr(t=>t!=null&&t.readyState()>=1),ts(1),Mt(t=>{const r=t.textTracks().tracks_;console.log("enter videoJs have player, tracks.length == ",r.length);const n=document.querySelector(e.siteDubbingRules.mediaSelector),s=new ur(n,e.tabTitle);return r.length>1&&s.setParam("subtitleUrl",r[0].src),or(this.extractMediaMetadata(e.siteDubbingRules.videoJsConfig.parseConfig,s,!1))}))}getBestSubtitle(e,t){if(t.getParam("subtitleUrl"))return{url:t.getParam("subtitleUrl"),language:"auto",isAsr:!1,hasPunctuation:!0}}}class b3 extends Yr{constructor(){super(...arguments);re(this,"punctuationSubtitleService",new vs);re(this,"subtitleRequestInfoStreamService",new no)}createMetadataObservable(t){return this.subtitleRequestInfoStreamService.observeSubtitleRequests(()=>t.siteDubbingRules.site,"json").pipe(Mt(r=>{const n=document.querySelector(t.siteDubbingRules.mediaSelector),s=new ur(n,t.tabTitle);return s.setParam("subtitleJson",r),s.setParam("rules",t.siteDubbingRules),or(this.extractMediaMetadata(t.siteDubbingRules.dropboxConfig.parseConfig,s,!1))}))}extractMediaMetadata(t,r,n){var l;const s=r.getParam("subtitleJson"),a=r.getParam("rules");let o=Ct.convertDropboxSegmentsToSubtitles(s.segments);return o=this.punctuationSubtitleService.postProcessParsedResult(o,a),{videoId:Vt.extractVideoId(t.videoIdExtract,r),title:r.tabTitle,subtitleMetadata:{url:void 0,language:s.transcriptLocale,isAsr:!1,hasPunctuation:o.hasPunctuation},subtitleLevel:hn.YELLOW,videoLanguage:dr.fromLanguage,isPrivate:!1,channelId:"",duration:((l=r.media)==null?void 0:l.duration)??0,isLiveVideo:n,supportLanguageCode:["SG"],subtitles:o.subtitles,originSubtitles:o.originSubtitles,mediaUrl:r.getParam("mediaUrl")}}async transformMetadata(t,r){return t}}var wp={exports:{}};/**
 * [js-sha256]{@link https://github.com/emn178/js-sha256}
 *
 * @version 0.11.1
 * @author Chen, Yi-Cyuan [emn178@gmail.com]
 * @copyright Chen, Yi-Cyuan 2014-2025
 * @license MIT
 */var nS;function A3(){return nS||(nS=1,function(i){(function(){var e="input is invalid type",t=typeof window=="object",r=t?window:{};r.JS_SHA256_NO_WINDOW&&(t=!1);var n=!t&&typeof self=="object",s=!r.JS_SHA256_NO_NODE_JS&&typeof process=="object"&&process.versions&&process.versions.node&&process.type!="renderer";s?r=wi:n&&(r=self);var a=!r.JS_SHA256_NO_COMMON_JS&&!0&&i.exports,o=!r.JS_SHA256_NO_ARRAY_BUFFER&&typeof ArrayBuffer<"u",l="0123456789abcdef".split(""),u=[-2147483648,8388608,32768,128],h=[24,16,8,0],d=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],p=["hex","array","digest","arrayBuffer"],g=[];(r.JS_SHA256_NO_NODE_JS||!Array.isArray)&&(Array.isArray=function(w){return Object.prototype.toString.call(w)==="[object Array]"}),o&&(r.JS_SHA256_NO_ARRAY_BUFFER_IS_VIEW||!ArrayBuffer.isView)&&(ArrayBuffer.isView=function(w){return typeof w=="object"&&w.buffer&&w.buffer.constructor===ArrayBuffer});var m=function(w,C){return function(M){return new R(C,!0).update(M)[w]()}},v=function(w){var C=m("hex",w);s&&(C=E(C,w)),C.create=function(){return new R(w)},C.update=function(I){return C.create().update(I)};for(var M=0;M<p.length;++M){var L=p[M];C[L]=m(L,w)}return C},E=function(w,C){var M=_d,L=_d.Buffer,I=C?"sha224":"sha256",U;L.from&&!r.JS_SHA256_NO_BUFFER_FROM?U=L.from:U=function($){return new L($)};var q=function($){if(typeof $=="string")return M.createHash(I).update($,"utf8").digest("hex");if($==null)throw new Error(e);return $.constructor===ArrayBuffer&&($=new Uint8Array($)),Array.isArray($)||ArrayBuffer.isView($)||$.constructor===L?M.createHash(I).update(U($)).digest("hex"):w($)};return q},A=function(w,C){return function(M,L){return new _(M,C,!0).update(L)[w]()}},D=function(w){var C=A("hex",w);C.create=function(I){return new _(I,w)},C.update=function(I,U){return C.create(I).update(U)};for(var M=0;M<p.length;++M){var L=p[M];C[L]=A(L,w)}return C};function R(w,C){C?(g[0]=g[16]=g[1]=g[2]=g[3]=g[4]=g[5]=g[6]=g[7]=g[8]=g[9]=g[10]=g[11]=g[12]=g[13]=g[14]=g[15]=0,this.blocks=g):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],w?(this.h0=3238371032,this.h1=914150663,this.h2=812702999,this.h3=4144912697,this.h4=4290775857,this.h5=1750603025,this.h6=1694076839,this.h7=3204075428):(this.h0=1779033703,this.h1=3144134277,this.h2=1013904242,this.h3=2773480762,this.h4=1359893119,this.h5=2600822924,this.h6=528734635,this.h7=1541459225),this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0,this.is224=w}R.prototype.update=function(w){if(!this.finalized){var C,M=typeof w;if(M!=="string"){if(M==="object"){if(w===null)throw new Error(e);if(o&&w.constructor===ArrayBuffer)w=new Uint8Array(w);else if(!Array.isArray(w)&&(!o||!ArrayBuffer.isView(w)))throw new Error(e)}else throw new Error(e);C=!0}for(var L,I=0,U,q=w.length,$=this.blocks;I<q;){if(this.hashed&&(this.hashed=!1,$[0]=this.block,this.block=$[16]=$[1]=$[2]=$[3]=$[4]=$[5]=$[6]=$[7]=$[8]=$[9]=$[10]=$[11]=$[12]=$[13]=$[14]=$[15]=0),C)for(U=this.start;I<q&&U<64;++I)$[U>>>2]|=w[I]<<h[U++&3];else for(U=this.start;I<q&&U<64;++I)L=w.charCodeAt(I),L<128?$[U>>>2]|=L<<h[U++&3]:L<2048?($[U>>>2]|=(192|L>>>6)<<h[U++&3],$[U>>>2]|=(128|L&63)<<h[U++&3]):L<55296||L>=57344?($[U>>>2]|=(224|L>>>12)<<h[U++&3],$[U>>>2]|=(128|L>>>6&63)<<h[U++&3],$[U>>>2]|=(128|L&63)<<h[U++&3]):(L=65536+((L&1023)<<10|w.charCodeAt(++I)&1023),$[U>>>2]|=(240|L>>>18)<<h[U++&3],$[U>>>2]|=(128|L>>>12&63)<<h[U++&3],$[U>>>2]|=(128|L>>>6&63)<<h[U++&3],$[U>>>2]|=(128|L&63)<<h[U++&3]);this.lastByteIndex=U,this.bytes+=U-this.start,U>=64?(this.block=$[16],this.start=U-64,this.hash(),this.hashed=!0):this.start=U}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}},R.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var w=this.blocks,C=this.lastByteIndex;w[16]=this.block,w[C>>>2]|=u[C&3],this.block=w[16],C>=56&&(this.hashed||this.hash(),w[0]=this.block,w[16]=w[1]=w[2]=w[3]=w[4]=w[5]=w[6]=w[7]=w[8]=w[9]=w[10]=w[11]=w[12]=w[13]=w[14]=w[15]=0),w[14]=this.hBytes<<3|this.bytes>>>29,w[15]=this.bytes<<3,this.hash()}},R.prototype.hash=function(){var w=this.h0,C=this.h1,M=this.h2,L=this.h3,I=this.h4,U=this.h5,q=this.h6,$=this.h7,X=this.blocks,ne,se,ce,ie,H,J,ve,fe,De,Ie,we;for(ne=16;ne<64;++ne)H=X[ne-15],se=(H>>>7|H<<25)^(H>>>18|H<<14)^H>>>3,H=X[ne-2],ce=(H>>>17|H<<15)^(H>>>19|H<<13)^H>>>10,X[ne]=X[ne-16]+se+X[ne-7]+ce<<0;for(we=C&M,ne=0;ne<64;ne+=4)this.first?(this.is224?(fe=300032,H=X[0]-1413257819,$=H-150054599<<0,L=H+24177077<<0):(fe=704751109,H=X[0]-210244248,$=H-1521486534<<0,L=H+143694565<<0),this.first=!1):(se=(w>>>2|w<<30)^(w>>>13|w<<19)^(w>>>22|w<<10),ce=(I>>>6|I<<26)^(I>>>11|I<<21)^(I>>>25|I<<7),fe=w&C,ie=fe^w&M^we,ve=I&U^~I&q,H=$+ce+ve+d[ne]+X[ne],J=se+ie,$=L+H<<0,L=H+J<<0),se=(L>>>2|L<<30)^(L>>>13|L<<19)^(L>>>22|L<<10),ce=($>>>6|$<<26)^($>>>11|$<<21)^($>>>25|$<<7),De=L&w,ie=De^L&C^fe,ve=$&I^~$&U,H=q+ce+ve+d[ne+1]+X[ne+1],J=se+ie,q=M+H<<0,M=H+J<<0,se=(M>>>2|M<<30)^(M>>>13|M<<19)^(M>>>22|M<<10),ce=(q>>>6|q<<26)^(q>>>11|q<<21)^(q>>>25|q<<7),Ie=M&L,ie=Ie^M&w^De,ve=q&$^~q&I,H=U+ce+ve+d[ne+2]+X[ne+2],J=se+ie,U=C+H<<0,C=H+J<<0,se=(C>>>2|C<<30)^(C>>>13|C<<19)^(C>>>22|C<<10),ce=(U>>>6|U<<26)^(U>>>11|U<<21)^(U>>>25|U<<7),we=C&M,ie=we^C&L^Ie,ve=U&q^~U&$,H=I+ce+ve+d[ne+3]+X[ne+3],J=se+ie,I=w+H<<0,w=H+J<<0,this.chromeBugWorkAround=!0;this.h0=this.h0+w<<0,this.h1=this.h1+C<<0,this.h2=this.h2+M<<0,this.h3=this.h3+L<<0,this.h4=this.h4+I<<0,this.h5=this.h5+U<<0,this.h6=this.h6+q<<0,this.h7=this.h7+$<<0},R.prototype.hex=function(){this.finalize();var w=this.h0,C=this.h1,M=this.h2,L=this.h3,I=this.h4,U=this.h5,q=this.h6,$=this.h7,X=l[w>>>28&15]+l[w>>>24&15]+l[w>>>20&15]+l[w>>>16&15]+l[w>>>12&15]+l[w>>>8&15]+l[w>>>4&15]+l[w&15]+l[C>>>28&15]+l[C>>>24&15]+l[C>>>20&15]+l[C>>>16&15]+l[C>>>12&15]+l[C>>>8&15]+l[C>>>4&15]+l[C&15]+l[M>>>28&15]+l[M>>>24&15]+l[M>>>20&15]+l[M>>>16&15]+l[M>>>12&15]+l[M>>>8&15]+l[M>>>4&15]+l[M&15]+l[L>>>28&15]+l[L>>>24&15]+l[L>>>20&15]+l[L>>>16&15]+l[L>>>12&15]+l[L>>>8&15]+l[L>>>4&15]+l[L&15]+l[I>>>28&15]+l[I>>>24&15]+l[I>>>20&15]+l[I>>>16&15]+l[I>>>12&15]+l[I>>>8&15]+l[I>>>4&15]+l[I&15]+l[U>>>28&15]+l[U>>>24&15]+l[U>>>20&15]+l[U>>>16&15]+l[U>>>12&15]+l[U>>>8&15]+l[U>>>4&15]+l[U&15]+l[q>>>28&15]+l[q>>>24&15]+l[q>>>20&15]+l[q>>>16&15]+l[q>>>12&15]+l[q>>>8&15]+l[q>>>4&15]+l[q&15];return this.is224||(X+=l[$>>>28&15]+l[$>>>24&15]+l[$>>>20&15]+l[$>>>16&15]+l[$>>>12&15]+l[$>>>8&15]+l[$>>>4&15]+l[$&15]),X},R.prototype.toString=R.prototype.hex,R.prototype.digest=function(){this.finalize();var w=this.h0,C=this.h1,M=this.h2,L=this.h3,I=this.h4,U=this.h5,q=this.h6,$=this.h7,X=[w>>>24&255,w>>>16&255,w>>>8&255,w&255,C>>>24&255,C>>>16&255,C>>>8&255,C&255,M>>>24&255,M>>>16&255,M>>>8&255,M&255,L>>>24&255,L>>>16&255,L>>>8&255,L&255,I>>>24&255,I>>>16&255,I>>>8&255,I&255,U>>>24&255,U>>>16&255,U>>>8&255,U&255,q>>>24&255,q>>>16&255,q>>>8&255,q&255];return this.is224||X.push($>>>24&255,$>>>16&255,$>>>8&255,$&255),X},R.prototype.array=R.prototype.digest,R.prototype.arrayBuffer=function(){this.finalize();var w=new ArrayBuffer(this.is224?28:32),C=new DataView(w);return C.setUint32(0,this.h0),C.setUint32(4,this.h1),C.setUint32(8,this.h2),C.setUint32(12,this.h3),C.setUint32(16,this.h4),C.setUint32(20,this.h5),C.setUint32(24,this.h6),this.is224||C.setUint32(28,this.h7),w};function _(w,C,M){var L,I=typeof w;if(I==="string"){var U=[],q=w.length,$=0,X;for(L=0;L<q;++L)X=w.charCodeAt(L),X<128?U[$++]=X:X<2048?(U[$++]=192|X>>>6,U[$++]=128|X&63):X<55296||X>=57344?(U[$++]=224|X>>>12,U[$++]=128|X>>>6&63,U[$++]=128|X&63):(X=65536+((X&1023)<<10|w.charCodeAt(++L)&1023),U[$++]=240|X>>>18,U[$++]=128|X>>>12&63,U[$++]=128|X>>>6&63,U[$++]=128|X&63);w=U}else if(I==="object"){if(w===null)throw new Error(e);if(o&&w.constructor===ArrayBuffer)w=new Uint8Array(w);else if(!Array.isArray(w)&&(!o||!ArrayBuffer.isView(w)))throw new Error(e)}else throw new Error(e);w.length>64&&(w=new R(C,!0).update(w).array());var ne=[],se=[];for(L=0;L<64;++L){var ce=w[L]||0;ne[L]=92^ce,se[L]=54^ce}R.call(this,C,M),this.update(se),this.oKeyPad=ne,this.inner=!0,this.sharedMemory=M}_.prototype=new R,_.prototype.finalize=function(){if(R.prototype.finalize.call(this),this.inner){this.inner=!1;var w=this.array();R.call(this,this.is224,this.sharedMemory),this.update(this.oKeyPad),this.update(w),R.prototype.finalize.call(this)}};var F=v();F.sha256=F,F.sha224=v(!0),F.sha256.hmac=D(),F.sha224.hmac=D(!0),a?i.exports=F:(r.sha256=F.sha256,r.sha224=F.sha224)})()}(wp)),wp.exports}var Lp=A3();class S3 extends Yr{constructor(){super(...arguments);re(this,"punctuationSubtitleService",new vs);re(this,"subtitleRequestInfoStreamService",new no)}createMetadataObservable(t){return this.subtitleRequestInfoStreamService.observeSubtitleRequests(()=>"common","vtt").pipe(Mt(r=>er(this.parserVtt(r))),Mt(r=>{const n=document.querySelector(t.siteDubbingRules.mediaSelector),s=new ur(n,t.tabTitle);return s.setParam("vttParsedResult",r),s.setParam("rules",t.siteDubbingRules),or(this.extractMediaMetadata(t.siteDubbingRules.commonVttConfig.parseConfig,s,!1))}))}async parserVtt(t){const r=await pl(t);return Ct.convertVttEntriesToSubtitles(r.cues)}extractMediaMetadata(t,r,n){var l;let s=r.getParam("vttParsedResult"),a=r.getParam("rules");return s=this.punctuationSubtitleService.postProcessParsedResult(s,a),{videoId:this.extractVideoId(t,r),title:r.tabTitle,subtitleMetadata:{url:void 0,language:"auto",isAsr:!1,hasPunctuation:s.hasPunctuation},subtitleLevel:hn.YELLOW,videoLanguage:dr.fromLanguage,isPrivate:!1,channelId:"",duration:((l=r.media)==null?void 0:l.duration)??0,isLiveVideo:n,supportLanguageCode:["SG"],subtitles:s.subtitles,originSubtitles:s.originSubtitles,mediaUrl:r.getParam("mediaUrl")}}computeVideoId(t){const r=`${ti.removeQueryParams(t)}`;return this.getSite()+"_"+Lp.sha256(r)}extractVideoId(t,r){return t.videoIdExtract.type==="undefined"?this.computeVideoId(window.location.href):Vt.extractVideoId(t.videoIdExtract,r)}getSite(){return"common"}async transformMetadata(t,r){return t}}class x3 extends Ko{constructor(){super(...arguments);re(this,"m3u8ParserService",new eS)}getSubtitles(t,r){return this.m3u8ParserService.parserSubtitleMetadataArray(r)}}class T3 extends Yr{constructor(){super(...arguments);re(this,"m3u8ExtractSubtitleService",new x3);re(this,"subtitleRequestInfoStreamService",new no);re(this,"punctuationSubtitleService",new vs)}createMetadataObservable(t){return this.subtitleRequestInfoStreamService.observeSubtitleRequests(()=>"common","m3u8").pipe(Jl(r=>this.syncMediaElementSrc(t,r.url)),Mt(r=>{console.log("enter m3u8 switch map, current url == "+window.location.href);const n={credentials:"include"},s=ti.addParam(r.url,"youtubedubbing","true");return er(fetch(s,n).catch(a=>fetch(s)))}),Mt(r=>{if(!r.ok)throw new Error(`Fetch 失败: ${r.status}`);return er(r.text()).pipe(lr(n=>({url:r.url,responseText:n})))}),Mt(r=>{const n=this.m3u8ParserService.parseManifest(r.responseText);console.log(`m3u8 manifest == ${JSON.stringify(n)}`);const s=new ur(document.querySelector(t.siteDubbingRules.mediaSelector),t.tabTitle);return s.setParam("mediaType","m3u8"),s.setParam("m3u8Manifest",n),s.setParam("mediaUrl",r.url),or(this.extractMediaMetadata(t.siteDubbingRules.mediaParseConfig.parseConfig,s,!1))}))}async transformMetadata(t,r){if(t.subtitleMetadata===void 0)return t;let n;return ti.endsWith(t.mediaUrl,".m3u8")?(n=await this.m3u8ParserService.parserSubtitlesBySubtitleUrl(t.subtitleMetadata.url),n=this.punctuationSubtitleService.postProcessParsedResult(n,r),t.originSubtitles=n.originSubtitles,t.subtitles=n.subtitles,t.subtitleMetadata.hasPunctuation=n.hasPunctuation,t):super.transformMetadata(t,r)}extractMediaMetadata(t,r,n){var s;return{videoId:this.extractVideoId(t,r),title:r.tabTitle,subtitleMetadata:this.getM3u8BestSubtitle(r),subtitleLevel:hn.YELLOW,videoLanguage:dr.fromLanguage,isPrivate:!1,channelId:"",duration:((s=r.media)==null?void 0:s.duration)??0,isLiveVideo:n,supportLanguageCode:["SG"],subtitles:[],originSubtitles:[],mediaUrl:r.getParam("mediaUrl")}}getM3u8BestSubtitle(t){const r={subtitleLanguageName:"srclang"};return this.m3u8ExtractSubtitleService.getBestSubtitle(r,t)}syncMediaElementSrc(t,r,n){const s=n??document.querySelector(t.siteDubbingRules.mediaSelector);if(s){const a=s.getAttribute("youtube-dubbing-src");if(!a||a!==s.src){const o=this.computeVideoId(r,window.location.href);s.setAttribute("youtube-dubbing-src",s.src),s.setAttribute("youtube-dubbing-videoId",o)}}}computeVideoId(t,r){const n=`${ti.removeQueryParams(t)}:${ti.removeQueryParams(r)}`;return"common_"+Lp.sha256(n)}extractVideoId(t,r){return t.videoIdExtract.type==="undefined"?r.media.getAttribute("youtube-dubbing-videoId"):Vt.extractVideoId(t.videoIdExtract,r)}}class D3 extends Np{getSearch(e){const t=document.querySelector(e.siteDubbingRules.mediaSelector),r=Vt.extractVideoId(e.siteDubbingRules.videoIdExtract,new ur(t,e.tabTitle,void 0));return console.log("udemy.videoId == "+r),r}}class R3 extends Ko{getSubtitles(e,t){return console.log("find tracks length == ",Le(".subtitles").find(".subtitles-menu").length),Qr.of(Le(".subtitles").find(".subtitles-menu")).map(this.createSubtitleMetadata).toArray()}createSubtitleMetadata(e){return{url:"",language:Le(e).prop("lang"),isAsr:!1,hasPunctuation:!0}}}class I3 extends Yr{constructor(){super(...arguments);re(this,"punctuationSubtitleService",new vs)}createMetadataObservable(t){if(t.siteDubbingRules.edxConfig===void 0)throw console.error("EdxDomBasedMediaMetadataService: edxConfig is undefined for site",t.siteDubbingRules),new Error("the website is missing the edxConfig configuration.");const r=t.siteDubbingRules.edxConfig,n=document.querySelector(t.siteDubbingRules.mediaSelector),s=new ur(n,t.tabTitle);return es(500).pipe(Tr(()=>Le(".subtitles-menu").length>0),ts(1),Mt(()=>or(this.extractMediaMetadata(r.parseConfig,s,!1))))}getBestSubtitle(t,r){return new R3().getBestSubtitle(t.subtitleExtract,r)}async transformMetadata(t,r){if(t.subtitleMetadata===void 0)return t;let n=this.convertSubtitles(t);return n=this.punctuationSubtitleService.postProcessParsedResult(n,r),t.originSubtitles=n.originSubtitles,t.subtitles=n.subtitles,t.subtitleMetadata.hasPunctuation=n.hasPunctuation,t}convertSubtitles(t){let r=Qr.of(Le(`.subtitles-menu[lang=${t.subtitleMetadata.language}]`).find("li")).filter(a=>!a.className.includes("spacing")).filter(a=>!this.isMusicOrEmpty(Le(a).text())).toArray(),n=[],s=[];for(let a=0;a<r.length;a++){const o=Le(r[a]);let l=o.text();a===0&&(l=l.substring(l.indexOf(":")+1));let u=Number.parseInt(o.find("span").attr("data-start")),h=0;a===r.length-1?h=t.duration:h=Number.parseInt(Le(r[a+1]).find("span").attr("data-start")),n.push({start:u,end:h,dur:h-u,text:l,processPunctuation:!0}),s.push({start:u,end:h,dur:h-u,text:l,processPunctuation:!0})}return{subtitles:n,originSubtitles:s,hasPunctuation:!0}}isMusicOrEmpty(t){let r=t.trim();return r.length===0?!0:!!(r.startsWith("[")&&r.endsWith("]"))}}class N3 extends Yr{constructor(){super(...arguments);re(this,"punctuationSubtitleService",new vs);re(this,"subtitleRequestInfoStreamService",new no)}createMetadataObservable(t){return this.subtitleRequestInfoStreamService.observeSubtitleRequests(()=>"common","srt").pipe(Mt(r=>er(this.parserSrt(r))),Mt(r=>{const n=document.querySelector(t.siteDubbingRules.mediaSelector),s=new ur(n,t.tabTitle);return s.setParam("vttParsedResult",r),s.setParam("rules",t.siteDubbingRules),or(this.extractMediaMetadata(t.siteDubbingRules.commonSrtConfig.parseConfig,s,!1))}))}async parserSrt(t){const r=await pl(t,{type:"srt"});return Ct.convertVttEntriesToSubtitles(r.cues)}extractMediaMetadata(t,r,n){var l;let s=r.getParam("vttParsedResult"),a=r.getParam("rules");return s=this.punctuationSubtitleService.postProcessParsedResult(s,a),{videoId:this.extractVideoId(t,r),title:r.tabTitle,subtitleMetadata:{url:void 0,language:"auto",isAsr:!1,hasPunctuation:s.hasPunctuation},subtitleLevel:hn.YELLOW,videoLanguage:dr.fromLanguage,isPrivate:!1,channelId:"",duration:((l=r.media)==null?void 0:l.duration)??0,isLiveVideo:n,supportLanguageCode:["SG"],subtitles:s.subtitles,originSubtitles:s.originSubtitles,mediaUrl:r.getParam("mediaUrl")}}computeVideoId(t){const r=`${ti.removeQueryParams(t)}`;return this.getSite()+"_"+Lp.sha256(r)}extractVideoId(t,r){return t.videoIdExtract.type==="undefined"?this.computeVideoId(window.location.href):Vt.extractVideoId(t.videoIdExtract,r)}getSite(){return"common"}async transformMetadata(t,r){return t}}class C3 extends DE{findTracks(e,t){const r=document.getElementById("kalutra-player_ifp");return r!=null&&r.contentDocument&&e.media?(console.log("find track length == ",Le(e.media,r.contentDocument).find(t).length),Le(e.media,r.contentDocument).find(t)):super.findTracks(e,t)}}class w3 extends tS{findMedia(e){var t,r;return(r=(t=document.getElementById("kalutra-player_ifp"))==null?void 0:t.contentDocument)==null?void 0:r.querySelector(e)}findTracks(e){const t=document.getElementById("kalutra-player_ifp");return t!=null&&t.contentDocument&&e?Le(e,t.contentDocument).find('track[kind="captions"], track[kind="subtitles"]'):super.findTracks(e)}getBestSubtitle(e,t){return new C3().getBestSubtitle(e.subtitleExtract,t)}}var _p,sS;function L3(){return sS||(sS=1,_p={aa:{name:"Afar",nativeName:"Afaraf"},ab:{name:"Abkhaz",nativeName:"аҧсуа бызшәа"},ae:{name:"Avestan",nativeName:"avesta"},af:{name:"Afrikaans",nativeName:"Afrikaans"},ak:{name:"Akan",nativeName:"Akan"},am:{name:"Amharic",nativeName:"አማርኛ"},an:{name:"Aragonese",nativeName:"aragonés"},ar:{name:"Arabic",nativeName:"العربية"},as:{name:"Assamese",nativeName:"অসমীয়া"},av:{name:"Avaric",nativeName:"авар мацӀ"},ay:{name:"Aymara",nativeName:"aymar aru"},az:{name:"Azerbaijani",nativeName:"azərbaycan dili"},ba:{name:"Bashkir",nativeName:"башҡорт теле"},be:{name:"Belarusian",nativeName:"беларуская мова"},bg:{name:"Bulgarian",nativeName:"български език"},bi:{name:"Bislama",nativeName:"Bislama"},bm:{name:"Bambara",nativeName:"bamanankan"},bn:{name:"Bengali",nativeName:"বাংলা"},bo:{name:"Tibetan",nativeName:"བོད་ཡིག"},br:{name:"Breton",nativeName:"brezhoneg"},bs:{name:"Bosnian",nativeName:"bosanski jezik"},ca:{name:"Catalan",nativeName:"Català"},ce:{name:"Chechen",nativeName:"нохчийн мотт"},ch:{name:"Chamorro",nativeName:"Chamoru"},co:{name:"Corsican",nativeName:"corsu"},cr:{name:"Cree",nativeName:"ᓀᐦᐃᔭᐍᐏᐣ"},cs:{name:"Czech",nativeName:"Čeština"},cu:{name:"Old Church Slavonic",nativeName:"ѩзыкъ словѣньскъ"},cv:{name:"Chuvash",nativeName:"чӑваш чӗлхи"},cy:{name:"Welsh",nativeName:"Cymraeg"},da:{name:"Danish",nativeName:"Dansk"},de:{name:"German",nativeName:"Deutsch"},dv:{name:"Divehi",nativeName:"ދިވެހި"},dz:{name:"Dzongkha",nativeName:"རྫོང་ཁ"},ee:{name:"Ewe",nativeName:"Eʋegbe"},el:{name:"Greek",nativeName:"Ελληνικά"},en:{name:"English",nativeName:"English"},eo:{name:"Esperanto",nativeName:"Esperanto"},es:{name:"Spanish",nativeName:"Español"},et:{name:"Estonian",nativeName:"eesti"},eu:{name:"Basque",nativeName:"euskara"},fa:{name:"Persian",nativeName:"فارسی"},ff:{name:"Fula",nativeName:"Fulfulde"},fi:{name:"Finnish",nativeName:"suomi"},fj:{name:"Fijian",nativeName:"vosa Vakaviti"},fo:{name:"Faroese",nativeName:"Føroyskt"},fr:{name:"French",nativeName:"Français"},fy:{name:"Western Frisian",nativeName:"Frysk"},ga:{name:"Irish",nativeName:"Gaeilge"},gd:{name:"Scottish Gaelic",nativeName:"Gàidhlig"},gl:{name:"Galician",nativeName:"galego"},gn:{name:"Guaraní",nativeName:"Avañe'ẽ"},gu:{name:"Gujarati",nativeName:"ગુજરાતી"},gv:{name:"Manx",nativeName:"Gaelg"},ha:{name:"Hausa",nativeName:"هَوُسَ"},he:{name:"Hebrew",nativeName:"עברית"},hi:{name:"Hindi",nativeName:"हिन्दी"},ho:{name:"Hiri Motu",nativeName:"Hiri Motu"},hr:{name:"Croatian",nativeName:"Hrvatski"},ht:{name:"Haitian",nativeName:"Kreyòl ayisyen"},hu:{name:"Hungarian",nativeName:"magyar"},hy:{name:"Armenian",nativeName:"Հայերեն"},hz:{name:"Herero",nativeName:"Otjiherero"},ia:{name:"Interlingua",nativeName:"Interlingua"},id:{name:"Indonesian",nativeName:"Bahasa Indonesia"},ie:{name:"Interlingue",nativeName:"Interlingue"},ig:{name:"Igbo",nativeName:"Asụsụ Igbo"},ii:{name:"Nuosu",nativeName:"ꆈꌠ꒿ Nuosuhxop"},ik:{name:"Inupiaq",nativeName:"Iñupiaq"},io:{name:"Ido",nativeName:"Ido"},is:{name:"Icelandic",nativeName:"Íslenska"},it:{name:"Italian",nativeName:"Italiano"},iu:{name:"Inuktitut",nativeName:"ᐃᓄᒃᑎᑐᑦ"},ja:{name:"Japanese",nativeName:"日本語"},jv:{name:"Javanese",nativeName:"basa Jawa"},ka:{name:"Georgian",nativeName:"ქართული"},kg:{name:"Kongo",nativeName:"Kikongo"},ki:{name:"Kikuyu",nativeName:"Gĩkũyũ"},kj:{name:"Kwanyama",nativeName:"Kuanyama"},kk:{name:"Kazakh",nativeName:"қазақ тілі"},kl:{name:"Kalaallisut",nativeName:"kalaallisut"},km:{name:"Khmer",nativeName:"ខេមរភាសា"},kn:{name:"Kannada",nativeName:"ಕನ್ನಡ"},ko:{name:"Korean",nativeName:"한국어"},kr:{name:"Kanuri",nativeName:"Kanuri"},ks:{name:"Kashmiri",nativeName:"कश्मीरी"},ku:{name:"Kurdish",nativeName:"Kurdî"},kv:{name:"Komi",nativeName:"коми кыв"},kw:{name:"Cornish",nativeName:"Kernewek"},ky:{name:"Kyrgyz",nativeName:"Кыргызча"},la:{name:"Latin",nativeName:"latine"},lb:{name:"Luxembourgish",nativeName:"Lëtzebuergesch"},lg:{name:"Ganda",nativeName:"Luganda"},li:{name:"Limburgish",nativeName:"Limburgs"},ln:{name:"Lingala",nativeName:"Lingála"},lo:{name:"Lao",nativeName:"ພາສາລາວ"},lt:{name:"Lithuanian",nativeName:"lietuvių kalba"},lu:{name:"Luba-Katanga",nativeName:"Kiluba"},lv:{name:"Latvian",nativeName:"latviešu valoda"},mg:{name:"Malagasy",nativeName:"fiteny malagasy"},mh:{name:"Marshallese",nativeName:"Kajin M̧ajeļ"},mi:{name:"Māori",nativeName:"te reo Māori"},mk:{name:"Macedonian",nativeName:"македонски јазик"},ml:{name:"Malayalam",nativeName:"മലയാളം"},mn:{name:"Mongolian",nativeName:"Монгол хэл"},mr:{name:"Marathi",nativeName:"मराठी"},ms:{name:"Malay",nativeName:"Bahasa Melayu"},mt:{name:"Maltese",nativeName:"Malti"},my:{name:"Burmese",nativeName:"ဗမာစာ"},na:{name:"Nauru",nativeName:"Dorerin Naoero"},nb:{name:"Norwegian Bokmål",nativeName:"Norsk bokmål"},nd:{name:"Northern Ndebele",nativeName:"isiNdebele"},ne:{name:"Nepali",nativeName:"नेपाली"},ng:{name:"Ndonga",nativeName:"Owambo"},nl:{name:"Dutch",nativeName:"Nederlands"},nn:{name:"Norwegian Nynorsk",nativeName:"Norsk nynorsk"},no:{name:"Norwegian",nativeName:"Norsk"},nr:{name:"Southern Ndebele",nativeName:"isiNdebele"},nv:{name:"Navajo",nativeName:"Diné bizaad"},ny:{name:"Chichewa",nativeName:"chiCheŵa"},oc:{name:"Occitan",nativeName:"occitan"},oj:{name:"Ojibwe",nativeName:"ᐊᓂᔑᓈᐯᒧᐎᓐ"},om:{name:"Oromo",nativeName:"Afaan Oromoo"},or:{name:"Oriya",nativeName:"ଓଡ଼ିଆ"},os:{name:"Ossetian",nativeName:"ирон æвзаг"},pa:{name:"Panjabi",nativeName:"ਪੰਜਾਬੀ"},pi:{name:"Pāli",nativeName:"पाऴि"},pl:{name:"Polish",nativeName:"Polski"},ps:{name:"Pashto",nativeName:"پښتو"},pt:{name:"Portuguese",nativeName:"Português"},qu:{name:"Quechua",nativeName:"Runa Simi"},rm:{name:"Romansh",nativeName:"rumantsch grischun"},rn:{name:"Kirundi",nativeName:"Ikirundi"},ro:{name:"Romanian",nativeName:"Română"},ru:{name:"Russian",nativeName:"Русский"},rw:{name:"Kinyarwanda",nativeName:"Ikinyarwanda"},sa:{name:"Sanskrit",nativeName:"संस्कृतम्"},sc:{name:"Sardinian",nativeName:"sardu"},sd:{name:"Sindhi",nativeName:"सिन्धी"},se:{name:"Northern Sami",nativeName:"Davvisámegiella"},sg:{name:"Sango",nativeName:"yângâ tî sängö"},si:{name:"Sinhala",nativeName:"සිංහල"},sk:{name:"Slovak",nativeName:"Slovenčina"},sl:{name:"Slovenian",nativeName:"slovenščina"},sm:{name:"Samoan",nativeName:"gagana fa'a Samoa"},sn:{name:"Shona",nativeName:"chiShona"},so:{name:"Somali",nativeName:"Soomaaliga"},sq:{name:"Albanian",nativeName:"Shqip"},sr:{name:"Serbian",nativeName:"српски језик"},ss:{name:"Swati",nativeName:"SiSwati"},st:{name:"Southern Sotho",nativeName:"Sesotho"},su:{name:"Sundanese",nativeName:"Basa Sunda"},sv:{name:"Swedish",nativeName:"Svenska"},sw:{name:"Swahili",nativeName:"Kiswahili"},ta:{name:"Tamil",nativeName:"தமிழ்"},te:{name:"Telugu",nativeName:"తెలుగు"},tg:{name:"Tajik",nativeName:"тоҷикӣ"},th:{name:"Thai",nativeName:"ไทย"},ti:{name:"Tigrinya",nativeName:"ትግርኛ"},tk:{name:"Turkmen",nativeName:"Türkmençe"},tl:{name:"Tagalog",nativeName:"Wikang Tagalog"},tn:{name:"Tswana",nativeName:"Setswana"},to:{name:"Tonga",nativeName:"faka Tonga"},tr:{name:"Turkish",nativeName:"Türkçe"},ts:{name:"Tsonga",nativeName:"Xitsonga"},tt:{name:"Tatar",nativeName:"татар теле"},tw:{name:"Twi",nativeName:"Twi"},ty:{name:"Tahitian",nativeName:"Reo Tahiti"},ug:{name:"Uyghur",nativeName:"ئۇيغۇرچە‎"},uk:{name:"Ukrainian",nativeName:"Українська"},ur:{name:"Urdu",nativeName:"اردو"},uz:{name:"Uzbek",nativeName:"Ўзбек"},ve:{name:"Venda",nativeName:"Tshivenḓa"},vi:{name:"Vietnamese",nativeName:"Tiếng Việt"},vo:{name:"Volapük",nativeName:"Volapük"},wa:{name:"Walloon",nativeName:"walon"},wo:{name:"Wolof",nativeName:"Wollof"},xh:{name:"Xhosa",nativeName:"isiXhosa"},yi:{name:"Yiddish",nativeName:"ייִדיש"},yo:{name:"Yoruba",nativeName:"Yorùbá"},za:{name:"Zhuang",nativeName:"Saɯ cueŋƅ"},zh:{name:"Chinese",nativeName:"中文"},zu:{name:"Zulu",nativeName:"isiZulu"}}),_p}var Mp,aS;function _3(){if(aS)return Mp;aS=1;const i=L3(),e={},t={},r=[],n=[],s=[];for(const a in i){const{name:o,nativeName:l}=i[a];e[a]=t[o.toLowerCase()]=t[l.toLowerCase()]={code:a,name:o,nativeName:l},r.push(a),n.push(o),s.push(l)}return Mp=class vh{static getLanguages(o=[]){return o.map(l=>vh.validate(l)?Object.assign({},e[l]):{code:l,name:"",nativeName:""})}static getName(o){return vh.validate(o)?i[o].name:""}static getAllNames(){return n.slice()}static getNativeName(o){return vh.validate(o)?i[o].nativeName:""}static getAllNativeNames(){return s.slice()}static getCode(o){return o=o.toLowerCase(),t.hasOwnProperty(o)?t[o].code:""}static getAllCodes(){return r.slice()}static validate(o){return i.hasOwnProperty(o)}},Mp}var M3=_3();const bs=Vs(M3);class P3 extends Yr{createMetadataObservable(e){return es(500).pipe(lr(()=>this.tryGetPlayer()),Tr(t=>t!==void 0),Tr(t=>this.hasUsableCaptions(t)),ts(1),Mt(t=>er(this.buildMetadata(t,e))))}tryGetPlayer(){const e=window.jwplayer;if(typeof e=="function")try{const t=e(0);return!t||typeof t.getCaptionsList!="function"?void 0:t}catch(t){console.error("Failed to access jwplayer instance",t);return}}hasUsableCaptions(e){var r;const t=(r=e.getCaptionsList)==null?void 0:r.call(e);return Array.isArray(t)&&t.some(n=>n&&n.id!=="off")}async buildMetadata(e,t){const r=this.createMetadataFromPlayer(e,t);return this.transformMetadata(r,t.siteDubbingRules)}createMetadataFromPlayer(e,t){var u,h;const r=document.querySelector(t.siteDubbingRules.mediaSelector);if(!r)throw new Error("JW Player media element not found on page");const n=new ur(r,t.tabTitle),s=this.normalizeCaptions(((u=e.getCaptionsList)==null?void 0:u.call(e))??[]),a=this.selectSubtitle(s),o=(h=e.getPlaylistItem)==null?void 0:h.call(e),l=a?this.toSubtitleMetadata(a):void 0;return{videoId:Vt.extractVideoId(t.siteDubbingRules.videoIdExtract,n),title:(o==null?void 0:o.title)??t.tabTitle,subtitleMetadata:l,subtitleLevel:hn.YELLOW,videoLanguage:(l==null?void 0:l.language)??dr.fromLanguage,isPrivate:!1,channelId:"",duration:Number.isFinite(r.duration)?r.duration:0,isLiveVideo:!1,supportLanguageCode:["SG"],subtitles:[],originSubtitles:[]}}normalizeCaptions(e){return e.filter(t=>t&&t.id!=="off").map(t=>({id:t.id,label:t.label??t.id}))}selectSubtitle(e){return e.length===0?void 0:e.find(r=>dr.matchFromLanguage(this.mapLanguageCode(r.label)))??e[0]}toSubtitleMetadata(e){const t=this.mapLanguageCode(e.label);return{url:e.id,language:t,isAsr:!1,hasPunctuation:!0}}mapLanguageCode(e){const t=e==null?void 0:e.trim();if(!t)return dr.fromLanguage;const r=this.sanitizeCaptionLabel(t),n=this.resolveLanguageCode(r);if(n)return n;const s=r.toLowerCase();return s.length>0?s:dr.fromLanguage}sanitizeCaptionLabel(e){return e.replace(/\([^)]*\)/g," ").replace(/\[[^\]]*]/g," ").replace(/\s+/g," ").trim()}resolveLanguageCode(e){const t=e.replace(/_/g,"-"),r=t.toLowerCase();if(bs.validate(r))return r;const n=r.split("-")[0];if(bs.validate(n))return n;const s=this.tryParseLanguageFromLocale(t);if(s&&bs.validate(s))return s;const a=bs.getCode(e);if(a)return a;const o=e.normalize("NFD").replace(/[\u0300-\u036f]/g,"");if(o!==e){const l=bs.getCode(o);if(l)return l}for(const l of this.extractLabelFragments(t)){const u=l.toLowerCase();if(bs.validate(u))return u;const h=bs.getCode(l);if(h)return h;const d=u.split("-")[0];if(bs.validate(d))return d}return s??void 0}tryParseLanguageFromLocale(e){var t;try{return((t=new Intl.Locale(e).language)==null?void 0:t.toLowerCase())??void 0}catch{return}}extractLabelFragments(e){return e.replace(/\([^)]*\)/g," ").replace(/\[[^\]]*]/g," ").split(/[\s,/]+/).map(t=>t.trim()).filter(t=>t.length>0)}}const k3=ks(()=>{console.log("[debug-metadata] enter inject script",QT),window.pageContentRpc.onMessage("sendRuleToInjectScript",i=>{if(console.log("[debug-metadata] enter sendRuleToInjectScript",i.data),i.data.className!=="InjectScriptParam")return;const e=i.data;dr.fromLanguage=e.fromLanguage,Io(e.siteDubbingRules.subtitleFetchMethod).with("domTrack",()=>new tS().observeMediaMetadata(e)).with("apiIntercept",()=>new Np().observeMediaMetadata(e)).with("windowVariable",()=>new rS().observeMediaMetadata(e)).with("hybrid",()=>new c3().observeMediaMetadata(e)).with("youtube",()=>new g3().observeMediaMetadata(e)).with("mux",()=>new y3().observeMediaMetadata(e)).with("bili",()=>new v3().observeMediaMetadata(e)).with("videojs",()=>new E3().observeMediaMetadata(e)).with("dropbox",()=>new b3().observeMediaMetadata(e)).with("commonVtt",()=>new S3().observeMediaMetadata(e)).with("commonM3u8",()=>new T3().observeMediaMetadata(e)).with("udemy",()=>new D3().observeMediaMetadata(e)).with("edx",()=>new I3().observeMediaMetadata(e)).with("commonSrt",()=>new N3().observeMediaMetadata(e)).with("ixl",()=>new w3().observeMediaMetadata(e)).with("jwplayer",()=>new P3().observeMediaMetadata(e)).exhaustive().subscribe(r=>{Le(document.body).attr("youtube-dubbing-player-videoId",r.videoId),window.pageContentRpc.sendMessage("sendMetadataToContentScript",r)})}),window.pageContentRpc.onMessage("hideSubtitle",()=>{document.getElementById(Qs.getPlayerId()).setOption("captions","track",{})}),console.log("[debug-metadata] start sendMessage onload"),window.pageContentRpc.sendMessage("onload").then()});function u9(){}function bc(i,...e){}const O3={debug:(...i)=>bc(console.debug,...i),log:(...i)=>bc(console.log,...i),warn:(...i)=>bc(console.warn,...i),error:(...i)=>bc(console.error,...i)},F3=(async()=>{try{return await k3.main()}catch(i){throw O3.error('The unlisted script "injectScript" crashed on startup!',i),i}})(),B3=/,/g,U3="-->";class oS extends bp{parse(e,t){var r,n;if(e==="")this.a&&(this.j.push(this.a),(n=(r=this.f).onCue)==null||n.call(r,this.a),this.a=null),this.c=vl.None;else if(this.c===vl.Cue)this.a.text+=(this.a.text?`
`:"")+e;else if(e.includes(U3)){const s=this.o(e,t);s&&(this.a=new Ep(s[0],s[1],s[2].join(" ")),this.a.id=this.l,this.c=vl.Cue)}this.l=e}o(e,t){return super.o(e.replace(B3,"."),t)}}function $3(){return new oS}const G3=Object.freeze(Object.defineProperty({__proto__:null,SRTParser:oS,default:$3},Symbol.toStringTag,{value:"Module"})),Ac=/^Format:[\s\t]*/,lS=/^Style:[\s\t]*/,uS=/^Dialogue:[\s\t]*/,Sc=/[\s\t]*,[\s\t]*/,cS=/\{[^}]+\}/g,hS=/\\N/g,dS=/^\[(.*)[\s\t]?Styles\]$/,Pp=/^\[(.*)[\s\t]?Events\]$/;class fS{constructor(){re(this,"f");re(this,"O",0);re(this,"a",null);re(this,"j",[]);re(this,"k",[]);re(this,"N",null);re(this,"d");re(this,"P",{})}async init(e){this.f=e,e.errors&&(this.d=(await Promise.resolve().then(()=>gS)).ParseErrorBuilder)}parse(e,t){var r,n;if(this.O)switch(this.O){case 1:if(e==="")this.O=0;else if(lS.test(e))if(this.N){const s=e.replace(lS,"").split(Sc);this.S(s)}else this.e((r=this.d)==null?void 0:r.T("Style",t));else Ac.test(e)?this.N=e.replace(Ac,"").split(Sc):Pp.test(e)&&(this.N=null,this.O=2);break;case 2:if(e==="")this.Q();else if(uS.test(e))if(this.Q(),this.N){const s=e.replace(uS,"").split(Sc),a=this.U(s,t);a&&(this.a=a)}else this.e((n=this.d)==null?void 0:n.T("Dialogue",t));else this.a?this.a.text+=`
`+e.replace(cS,"").replace(hS,`
`):Ac.test(e)?this.N=e.replace(Ac,"").split(Sc):dS.test(e)?(this.N=null,this.O=1):Pp.test(e)&&(this.N=null)}else e===""||(dS.test(e)?(this.N=null,this.O=1):Pp.test(e)&&(this.N=null,this.O=2))}done(){return{metadata:{},cues:this.j,regions:[],errors:this.k}}Q(){var e,t;this.a&&(this.j.push(this.a),(t=(e=this.f).onCue)==null||t.call(e,this.a),this.a=null)}S(e){let t="Default",r={},n,s="center",a="bottom",o,l=1.2,u,h,d=3,p=[];for(let g=0;g<this.N.length;g++){const m=this.N[g],v=e[g];switch(m){case"Name":t=v;break;case"Fontname":r["font-family"]=v;break;case"Fontsize":r["font-size"]=`calc(${v} / var(--overlay-height))`;break;case"PrimaryColour":const E=kp(v);E&&(r["--cue-color"]=E);break;case"BorderStyle":d=parseInt(v,10);break;case"BackColour":h=kp(v);break;case"OutlineColour":const A=kp(v);A&&(u=A);break;case"Bold":parseInt(v)&&(r["font-weight"]="bold");break;case"Italic":parseInt(v)&&(r["font-style"]="italic");break;case"Underline":parseInt(v)&&(r["text-decoration"]="underline");break;case"StrikeOut":parseInt(v)&&(r["text-decoration"]="line-through");break;case"Spacing":r["letter-spacing"]=v+"px";break;case"AlphaLevel":r.opacity=parseFloat(v);break;case"ScaleX":p.push(`scaleX(${parseFloat(v)/100})`);break;case"ScaleY":p.push(`scaleY(${parseFloat(v)/100})`);break;case"Angle":p.push(`rotate(${v}deg)`);break;case"Shadow":l=parseInt(v,10)*1.2;break;case"MarginL":r["--cue-width"]="auto",r["--cue-left"]=parseFloat(v)+"px";break;case"MarginR":r["--cue-width"]="auto",r["--cue-right"]=parseFloat(v)+"px";break;case"MarginV":o=parseFloat(v);break;case"Outline":n=parseInt(v,10);break;case"Alignment":const D=parseInt(v,10);switch(D>=4&&(a=D>=7?"top":"center"),D%3){case 1:s="start";break;case 2:s="center";break;case 3:s="end";break}}}if(r.R=a,r["--cue-white-space"]="normal",r["--cue-line-height"]="normal",r["--cue-text-align"]=s,a==="center"?(r["--cue-top"]="50%",p.push("translateY(-50%)")):r[`--cue-${a}`]=(o||0)+"px",d===1&&(r["--cue-padding-y"]="0"),(d===1||h)&&(r["--cue-bg-color"]=d===1?"none":h),d===3&&u&&(r["--cue-outline"]=`${n}px solid ${u}`),d===1&&typeof n=="number"){const g=h??"#000";r["--cue-text-shadow"]=[u&&Op(n*1.2,l*1.2,u),u?Op(n*(n/2),l*(n/2),g):Op(n,l,g)].filter(Boolean).join(", ")}p.length&&(r["--cue-transform"]=p.join(" ")),this.P[t]=r}U(e,t){const r=this.V(e),n=this.o(r.Start,r.End,t);if(!n)return;const s=new Ep(n[0],n[1],""),a={...this.P[r.Style]||{}},o=r.Name?`<v ${r.Name}>`:"",l=a.R,u=r.MarginL&&parseFloat(r.MarginL),h=r.MarginR&&parseFloat(r.MarginR),d=r.MarginV&&parseFloat(r.MarginV);return u&&(a["--cue-width"]="auto",a["--cue-left"]=u+"px"),h&&(a["--cue-width"]="auto",a["--cue-right"]=h+"px"),d&&l!=="center"&&(a[`--cue-${l}`]=d+"px"),s.text=o+e.slice(this.N.length-1).join(", ").replace(cS,"").replace(hS,`
`),delete a.R,Object.keys(a).length&&(s.style=a),s}V(e){const t={};for(let r=0;r<this.N.length;r++)t[this.N[r]]=e[r];return t}o(e,t,r){var a,o,l;const n=El(e),s=El(t);if(n!==null&&s!==null&&s>n)return[n,s];n===null&&this.e((a=this.d)==null?void 0:a.q(e,r)),s===null&&this.e((o=this.d)==null?void 0:o.r(t,r)),n!=null&&s!==null&&s>n&&this.e((l=this.d)==null?void 0:l.s(n,s,r))}e(e){var t,r;if(e){if(this.k.push(e),this.f.strict)throw this.f.cancel(),e;(r=(t=this.f).onError)==null||r.call(t,e)}}}function kp(i){const e=parseInt(i.replace("&H",""),16);if(e>=0){const r=(e>>24&255^255)/255,n=e>>16&255,s=e>>8&255;return"rgba("+[e&255,s,n,r].join(",")+")"}return null}function Op(i,e,t){const r=Math.ceil(2*Math.PI*i);let n="";for(let s=0;s<r;s++){const a=2*Math.PI*s/r;n+=i*Math.cos(a)+"px "+e*Math.sin(a)+"px 0 "+t+(s==r-1?"":",")}return n}function q3(){return new fS}const V3=Object.freeze(Object.defineProperty({__proto__:null,SSAParser:fS,default:q3},Symbol.toStringTag,{value:"Module"})),gS=Object.freeze(Object.defineProperty({__proto__:null,ParseErrorBuilder:{p(){return new kn({code:Pn.BadSignature,reason:"missing WEBVTT file header",line:1})},q(i,e){return new kn({code:Pn.BadTimestamp,reason:`cue start timestamp \`${i}\` is invalid on line ${e}`,line:e})},r(i,e){return new kn({code:Pn.BadTimestamp,reason:`cue end timestamp \`${i}\` is invalid on line ${e}`,line:e})},s(i,e,t){return new kn({code:Pn.BadTimestamp,reason:`cue end timestamp \`${e}\` is greater than start \`${i}\` on line ${t}`,line:t})},w(i,e,t){return new kn({code:Pn.BadSettingValue,reason:`invalid value for cue setting \`${i}\` on line ${t} (value: ${e})`,line:t})},v(i,e,t){return new kn({code:Pn.UnknownSetting,reason:`unknown cue setting \`${i}\` on line ${t} (value: ${e})`,line:t})},u(i,e,t){return new kn({code:Pn.BadSettingValue,reason:`invalid value for region setting \`${i}\` on line ${t} (value: ${e})`,line:t})},t(i,e,t){return new kn({code:Pn.UnknownSetting,reason:`unknown region setting \`${i}\` on line ${t} (value: ${e})`,line:t})},T(i,e){return new kn({code:Pn.BadFormat,reason:`format missing for \`${i}\` block on line ${e}`,line:e})}}},Symbol.toStringTag,{value:"Module"}));return F3}();
injectscript;